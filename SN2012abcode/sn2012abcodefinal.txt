opengl software
addpath(genpath('C:\Program Files\MATLAB\R2012a\toolbox\altmany-export_fig-173eda0'))
addpath(genpath('C:\Program Files\MATLAB\R2015b\toolbox\altmany-export_fig-173eda0'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\altmany-export_fig-2763b78'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\useradded\append_pdfs'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\useradded\export_fig'))
plotting = figure;
set(gcf,'color','w');
set(plotting,'units','normalized','outerposition',[0 0 1 1]);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(gcf,'renderer','painters')
colormap jet

%12167

%read in data

%light curves
[ROTSELC(1,:) ROTSELC(2,:) ROTSELC(3,:) ROTSELC(4,:) ROTSELC(5,:) ROTSELC(6,:)] = textread('lightcurve_sn2012ab_rotse_sub.dat','%f%f%f%f%f%f','delimiter',' ');
[LC1999em(1,:) LC1999em(2,:) LC1999em(3,:) LC1999em(4,:) LC1999em(5,:)] = textread('SN1999emLC.txt','%f%f%f%f%f','delimiter',' ');
[LC1998S(1,:) LC1998S(2,:) LC1998S(3,:)] = textread('SN1998SLC_R.txt','%f%f%f','delimiter',' ');
[LC2003hf(1,:) LC2003hf(2,:) LC2003hf(3,:) LC2003hf(4,:) LC2003hf(5,:) LC2003hf(6,:) LC2003hf(7,:) LC2003hf(8,:) LC2003hf(9,:) LC2003hf(10,:)] = textread('sn03hf-faran.txt','%f%f%f%f%f%f%f%f%f%f','delimiter',' ');


%spectra
[hetms1_20120207 hetms2_20120207] =textread('victoria_het_120207t.dat','%f%f','delimiter',' ');
[hetms1_20120216 hetms2_20120216] =textread('victoria_het_120216t.dat','%f%f','delimiter',' ');
[hetms1_20120301 hetms2_20120301] =textread('victoria_het_120301t.dat','%f%f','delimiter',' ');
[spolm1_20120416 spolm2_20120416] =textread('sn2012ab.flx.mmt.txt','%f%f','delimiter',' ');
[spolb1_20120323 spolb2_20120323] =textread('mar23_sn2012ab.flx.txt','%f%f','delimiter',' ');
[keckD1_20121115 keckD2_20121115] =textread('SN2012ab-20121115.651-b.flm','%f%f','delimiter',' ');
[mmtbc1_20120529 mmtbc2_20120529] =textread('sn2012ab_1200_6415_20120529_fluxcal.txt','%f%f','delimiter',' ');
[mmtbc1_20120301 mmtbc2_20120301] =textread('sn2012ab_MMT_BCH_1200_6350_20120301_fluxcal.txt','%f%f','delimiter',' ');
[mmtbc1_20120417 mmtbc2_20120417] =textread('sn2012ab_MMT_BCH_1200_6350_20120416_fluxcal.txt','%f%f','delimiter',' ');
[mmtbc1_20120701 mmtbc2_20120701] =textread('sn2012ab_MMT_BCH_300_6409_20120701_fluxcal.txt','%f%f','delimiter',' ');
[Lkast1_20120223 Lkast2_20120223 Lkast3_20120223] =textread('sn2012ab-20120223.306-ui.flm','%f%f%f','delimiter',' ');
[Lkast1_20120428 Lkast2_20120428 Lkast3_20120428] =textread('sn2012ab-20120428.397-ui.flm','%f%f%f','delimiter',' ');
[keckL1_20120616 keckL2_20120616 keckL3_20120616] =textread('sn2012ab-20120616.363-br.flm','%f%f%f','delimiter',' ');
[keckD1_20150521 keckD2_20150521] =textread('SN2012ab_host.ms.trim.txt','%f%f','delimiter',' ');

[spec2003hf20030928(1,:) spec2003hf20030928(2,:)] = textread('sn2003hf-20030928.236-br.flm','%f%f','delimiter',' ');
[spec1999em_day45(1,:) spec1999em_day45(2,:)] = textread('SN1999em_day45_digitized.txt','%f%f','delimiter',' ');
[spec1998S_day72(1,:) spec1998S_day72(2,:)] = textread('SN19998S_day72_digitized.txt','%f%f','delimiter',' ');
[spec2010jl20110102(1,:) spec2010jl20110102(2,:)] = textread('2011jan02_sn2010jl.flx.txt','%f%f','delimiter',' ');

[SDSS1_20080213_temp(1,:) SDSS2_20080213(1,:)]  = textread('spSpec-54509-2880-413.txt','%f%f','delimiter',' ');
SDSS1_20080213(1,:) = 10.^SDSS1_20080213_temp(1,:);


%spol special values
[p1 p2] =textread('sn2012ab_allcomb.p.mmt.txt','%f%f','delimiter',' ');
[t1 t2] =textread('sn2012ab_allcomb.t.mmt.txt','%f%f','delimiter',' ');
[q1 q2] =textread('sn2012ab_allcomb.q.mmt.txt','%f%f','delimiter',' ');
[u1 u2] =textread('sn2012ab_allcomb.u.mmt.txt','%f%f','delimiter',' ');
%[qsum1 qsum2] =textread('sn2012abcomb.qsum.txt','%f%f','delimiter',' ');
%[usum1 usum2] =textread('sn2012abcomb.usum.txt','%f%f','delimiter',' ');
[qsigmmt1 qsigmmt2] =textread('sn2012ab_allcomb.qsig.mmt.txt','%f%f','delimiter',' ');
[usigmmt1 usigmmt2] =textread('sn2012ab_allcomb.usig.mmt.txt','%f%f','delimiter',' ');
[tsigmmt1 tsigmmt2] =textread('sn2012ab_allcomb.tsig.mmt.txt','%f%f','delimiter',' ');
[psigmmt1 psigmmt2] =textread('sn2012ab_allcomb.psig.mmt.txt','%f%f','delimiter',' ');


%[p1 p2] =textread('sn2012abcomb.p.txt','%f%f','delimiter',' ');
%[t1 t2] =textread('sn2012abcomb.t.txt','%f%f','delimiter',' ');
%[q1 q2] =textread('sn2012abcomb.q.txt','%f%f','delimiter',' ');
%[u1 u2] =textread('sn2012abcomb.u.txt','%f%f','delimiter',' ');
%[qsum1 qsum2] =textread('sn2012abcomb.qsum.txt','%f%f','delimiter',' ');
%[usum1 usum2] =textread('sn2012abcomb.usum.txt','%f%f','delimiter',' ');



%[qmmt1 qmmt2] =textread('sn2012ab_allcomb.q.mmt.txt','%f%f','delimiter',' ');
%[ummt1 ummt2] =textread('sn2012ab_allcomb.u.mmt.txt','%f%f','delimiter',' ');
%[qsummmt1 qsummmt2] =textread('sn2012ab_allcomb.qsum.mmt.txt','%f%f','delimiter',' ');
%[usummmt1 usummmt2] =textread('sn2012ab_allcomb.usum.mmt.txt','%f%f','delimiter',' ');
%[qsigmmt1 qsigmmt2] =textread('sn2012ab_allcomb.qsig.mmt.txt','%f%f','delimiter',' ');
%[usigmmt1 usigmmt2] =textread('sn2012ab_allcomb.usig.mmt.txt','%f%f','delimiter',' ');
%[tsigmmt1 tsigmmt2] =textread('sn2012ab_allcomb.tsig.mmt.txt','%f%f','delimiter',' ');
%[psigmmt1 psigmmt2] =textread('sn2012ab_allcomb.psig.mmt.txt','%f%f','delimiter',' ');



[qbok1 qbok2] =textread('sn2012ab_allcomb.q.bok.txt','%f%f','delimiter',' ');
[ubok1 ubok2] =textread('sn2012ab_allcomb.u.bok.txt','%f%f','delimiter',' ');
[qsumbok1 qsumbok2] =textread('sn2012ab_allcomb.qsum.bok.txt','%f%f','delimiter',' ');
[usumbok1 usumbok2] =textread('sn2012ab_allcomb.usum.bok.txt','%f%f','delimiter',' ');
[qsigbok1 qsigbok2] =textread('sn2012ab_allcomb.qsig.bok.txt','%f%f','delimiter',' ');
[usigbok1 usigbok2] =textread('sn2012ab_allcomb.usig.bok.txt','%f%f','delimiter',' ');
[tsigbok1 tsigbok2] =textread('sn2012ab_allcomb.tsig.bok.txt','%f%f','delimiter',' ');
[psigbok1 psigbok2] =textread('sn2012ab_allcomb.psig.bok.txt','%f%f','delimiter',' ');
pbok1 = qbok1;


%constants and definitions
discoverydatejd = juliandate(2012,01,31.35);
jdtomjd=-2400000.5;
redshiftdistance = 82.3; %in Mpc
redshiftdistancemodulus = -5*(log10(82.3*10^6)-1);
A_R = 0.045;
A_V = 0.057;
%A_V_NaID = 0.2379;
%A_R_NaID = 0.1926;
%A_V_NaID = 0.3237;
%A_R_NaID = 0.2621;
A_V_NaID = 0.1858;
A_R_NaID = 0.1504;

redshiftdistance1999em = 8.2;
redshiftdistancemodulus1999em = -5*(log10(8.2*10^6)-1);
A_R1999em= 3.1 * 0.04;
z1999em = 0.002392;

distance1998S = 15.612;
distancemodulus1998S = -5*(log10(distance1998S*10^6)-1);
A_R1998S= 3.1 * 0.050;
E_BmVgal1998S = 0.20;
A_R1998Sgal = 0.5189;

distance2010jl = 48.8;
distancemodulus2010jl = -5*(log10(distance2010jl*10^6)-1);
A_R2010jl = 0.059;
A_V2010jl = 0.075;
z2010jl = 0.010697;

redshiftdistance2003hf = 127.7;
redshiftdistancemodulus2003hf = -5*(log10(redshiftdistance2003hf*10^6)-1);
A_R2003hf = 0.047;
A_V2003hf = 0.060;
z2003hf = 0.031302;

z=0.018;
c=2.99792458*10^10;

%light curve values
ROTSEabsmag = ROTSELC(3,:)+redshiftdistancemodulus-A_R-A_R_NaID;
ROTSEabslim = ROTSELC(6,:)+redshiftdistancemodulus-A_R-A_R_NaID;
peakdate = ROTSELC(1,find(min(ROTSELC(3,isfinite(ROTSELC(3,:))))==ROTSELC(3,:)));
ROTSEerror = ROTSELC(4,:) - ROTSELC(3,:);
peakdatejd = peakdate + 2400000.5;

%here
LC1999emmjd = juliandate(LC1999em(3,:),LC1999em(1,:),LC1999em(2,:))-2400000.5;
peakdate1999em = LC1999emmjd(min(find(LC1999em(4,:)==min(LC1999em(4,:)))));
LC1999emabsmag = LC1999em(4,:)+redshiftdistancemodulus1999em-A_R1999em;

LC1998Smjd = LC1998S(1,:)+2450000-2400000.5;
peakdate1998S = LC1998Smjd(min(find(LC1998S(2,:)==min(LC1998S(2,:)))));
LC1998Sabsmag = LC1998S(2,:)+distancemodulus1998S-A_R1998S-A_R1998Sgal;

LC2003hfmjd = LC2003hf(1,:);
peakdate2003hf = 52863;
LC2003hfabsmag = LC2003hf(7,:)+redshiftdistancemodulus2003hf-A_R2003hf;


%deredshift

hetms1_20120207 = hetms1_20120207/(1+z);
hetms1_20120216 = hetms1_20120216/(1+z);
hetms1_20120301 = hetms1_20120301/(1+z);
spolm1_20120416 = spolm1_20120416/(1+z);
spolb1_20120323 = spolb1_20120323/(1+z);
mmtbc1_20120301 = mmtbc1_20120301/(1+z);
mmtbc1_20120417 = mmtbc1_20120417/(1+z);
mmtbc1_20120529 = mmtbc1_20120529/(1+z);
mmtbc1_20120701 = mmtbc1_20120701/(1+z);
keckD1_20121115 = keckD1_20121115/(1+z);
Lkast1_20120223 = Lkast1_20120223/(1+z);
Lkast1_20120428 = Lkast1_20120428/(1+z);
keckL1_20120616 = keckL1_20120616/(1+z);
keckD1_20150521 = keckD1_20150521/(1+z);

SDSS1_20080213 = SDSS1_20080213/(1+z);

p1 = p1/(1+z);
t1 = t1/(1+z);
q1 = q1/(1+z);
u1 = u1/(1+z);
qbok1 = qbok1/(1+z);
ubok1 = ubok1/(1+z);
pbok1 = pbok1/(1+z);
qsigmmt1 = qsigmmt1/(1+z);
usigmmt1 = usigmmt1/(1+z);
qsigbok1 = qsigbok1/(1+z);
usigbok1 = usigbok1/(1+z);
tsigbok1 = tsigbok1/(1+z);
psigbok1 = psigbok1/(1+z);
psigmmt1 = psigmmt1/(1+z);
tsigmmt1 = tsigmmt1/(1+z);

spec2003hf20030928(1,:) = spec2003hf20030928(1,:) ./ (1+z2003hf);
spec2010jl20110102(1,:) = spec2010jl20110102(1,:) ./ (1+z2010jl);

%measure the wavelength interval
median(Lkast1_20120223)/(Lkast1_20120223(2)-Lkast1_20120223(1))
median(Lkast1_20120428)/(Lkast1_20120428(2)-Lkast1_20120428(1))

%dont think the digitized versions need to be deredshifted but I will have to once I get the final data
%spec1999em_day45(1,:) = spec1999em_day45(1,:)./ (1+z1999em); 

wavelengthfile = fopen('spectralwavelengths.txt','w');
fprintf(wavelengthfile,'%5.0f',min(hetms1_20120207))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(hetms1_20120207))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(hetms1_20120216))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(hetms1_20120216))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(Lkast1_20120223))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(Lkast1_20120223))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(mmtbc1_20120301))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(mmtbc1_20120301))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(hetms1_20120301))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(hetms1_20120301))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(spolb1_20120323))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(spolb1_20120323))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(spolm1_20120416))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(spolm1_20120416))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(mmtbc1_20120417))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(mmtbc1_20120417))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(Lkast1_20120428))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(Lkast1_20120428))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(mmtbc1_20120529))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(mmtbc1_20120529))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(keckL1_20120616))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(keckL1_20120616))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(mmtbc1_20120701))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(mmtbc1_20120701))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(keckD1_20121115))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(keckD1_20121115))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',min(keckD1_20150521))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',max(keckD1_20150521))
fprintf(wavelengthfile,'\n')
fclose(wavelengthfile);







%truncate data if ugly edges
Lkast2_20120223 = Lkast2_20120223(find(Lkast1_20120223<9100));
mmtbc2_20120301 = mmtbc2_20120301;
spolb2_20120323 = spolb2_20120323(find(spolb1_20120323<7417));
spolm2_20120416 = spolm2_20120416;
mmtbc2_20120417 = mmtbc2_20120417;
Lkast2_20120428 = Lkast2_20120428(find((Lkast1_20120428>3500) & (Lkast1_20120428<9100)));
mmtbc2_20120529 = mmtbc2_20120529;
keckL2_20120616 = keckL2_20120616(find((keckL1_20120616>3500)&(keckL1_20120616<9100)));
mmtbc2_20120701 = mmtbc2_20120701(find((mmtbc1_20120701>4000)&(mmtbc1_20120701<7425)));
keckD2_20121115 = keckD2_20121115(find((keckD1_20121115>4500)&(keckD1_20121115<9100)));
keckD2_20150521 = keckD2_20150521(find((keckD1_20150521>4500)&(keckD1_20150521<9100)));

Lkast1_20120223 = Lkast1_20120223(find(Lkast1_20120223<9100));
mmtbc1_20120301 = mmtbc1_20120301;
spolb1_20120323 = spolb1_20120323(find(spolb1_20120323<7417));
spolm1_20120416 = spolm1_20120416;
mmtbc1_20120417 = mmtbc1_20120417;
Lkast1_20120428 = Lkast1_20120428(find((Lkast1_20120428>3500) & (Lkast1_20120428<9100)));
mmtbc1_20120529 = mmtbc1_20120529;
keckL1_20120616 = keckL1_20120616(find((keckL1_20120616>3500)&(keckL1_20120616<9100)));
mmtbc1_20120701 = mmtbc1_20120701(find((mmtbc1_20120701>4000)&(mmtbc1_20120701<7425)));
keckD1_20121115 = keckD1_20121115(find((keckD1_20121115>4500)&(keckD1_20121115<9100)));
keckD1_20150521 = keckD1_20150521(find((keckD1_20150521>4500)&(keckD1_20150521<9100)));

%dereddening
hetms2_20120207 = deredden(hetms1_20120207,hetms2_20120207,A_V+A_V_NaID);
hetms2_20120216 = deredden(hetms1_20120216,hetms2_20120216,A_V+A_V_NaID);
hetms2_20120301 = deredden(hetms1_20120301,hetms2_20120301,A_V+A_V_NaID);
Lkast2_20120223 = deredden(Lkast1_20120223,Lkast2_20120223,A_V+A_V_NaID);
mmtbc2_20120301 = deredden(mmtbc1_20120301,mmtbc2_20120301,A_V+A_V_NaID);
spolb2_20120323 = deredden(spolb1_20120323,spolb2_20120323,A_V+A_V_NaID);
spolm2_20120416 = deredden(spolm1_20120416,spolm2_20120416,A_V+A_V_NaID);
mmtbc2_20120417 = deredden(mmtbc1_20120417,mmtbc2_20120417,A_V+A_V_NaID);
Lkast2_20120428 = deredden(Lkast1_20120428,Lkast2_20120428,A_V+A_V_NaID);
mmtbc2_20120529 = deredden(mmtbc1_20120529,mmtbc2_20120529,A_V+A_V_NaID);
keckL2_20120616 = deredden(keckL1_20120616,keckL2_20120616,A_V+A_V_NaID);
mmtbc2_20120701 = deredden(mmtbc1_20120701,mmtbc2_20120701,A_V+A_V_NaID);
keckD2_20121115 = deredden(keckD1_20121115,keckD2_20121115,A_V+A_V_NaID);
keckD2_20150521 = deredden(keckD1_20150521,keckD2_20150521,A_V+A_V_NaID);

SDSS2_20080213 = deredden(SDSS1_20080213,SDSS2_20080213,A_V+A_V_NaID);


spec2003hf20030928(3,:) = deredden(spec2003hf20030928(1,:),spec2003hf20030928(2,:),A_V2003hf);
spec2010jl20110102(3,:) = deredden(spec2010jl20110102(1,:),spec2010jl20110102(2,:),A_V2010jl);

%dates
reldate(1)  = juliandate(2012,02,23) - discoverydatejd;
reldate(2)  = juliandate(2012,03,01) - discoverydatejd;
reldate(3)  = juliandate(2012,03,23) - discoverydatejd;
reldate(4)  = juliandate(2012,04,16) - discoverydatejd;
reldate(5)  = juliandate(2012,04,17) - discoverydatejd;
reldate(6)  = juliandate(2012,04,28) - discoverydatejd;
reldate(7)  = juliandate(2012,05,29) - discoverydatejd;
reldate(8)  = juliandate(2012,06,16) - discoverydatejd;
reldate(9)  = juliandate(2012,07,01) - discoverydatejd;
reldate(10) = juliandate(2012,11,15) - discoverydatejd;
reldate(11) = juliandate(2015,05,21) - discoverydatejd;
reldate(12) = juliandate(2012,02,07) - discoverydatejd;
reldate(13) = juliandate(2012,02,16) - discoverydatejd;
reldate(14) = juliandate(2012,03,01) - discoverydatejd;

reldateSDSS = juliandate(2008,02,13) - discoverydatejd;

%get mjd values for table
juliandate(2012,02,07) + jdtomjd
juliandate(2012,02,16) + jdtomjd
juliandate(2012,02,23) + jdtomjd
juliandate(2012,03,01) + jdtomjd
juliandate(2012,03,01) + jdtomjd
juliandate(2012,03,23) + jdtomjd
juliandate(2012,04,16) + jdtomjd
juliandate(2012,04,17) + jdtomjd
juliandate(2012,04,28) + jdtomjd
juliandate(2012,05,29) + jdtomjd
juliandate(2012,06,16) + jdtomjd
juliandate(2012,07,01) + jdtomjd
juliandate(2012,11,15) + jdtomjd
juliandate(2015,05,21) + jdtomjd

%get relative dates for table
55955.36 - jdtomjd - discoverydatejd
55956.36 - jdtomjd - discoverydatejd
55957.37 - jdtomjd - discoverydatejd
55958.36 - jdtomjd - discoverydatejd
55959.36 - jdtomjd - discoverydatejd
55960.34 - jdtomjd - discoverydatejd
55971.41 - jdtomjd - discoverydatejd
55972.35 - jdtomjd - discoverydatejd
55973.31 - jdtomjd - discoverydatejd
55976.31 - jdtomjd - discoverydatejd
55978.30 - jdtomjd - discoverydatejd
55979.30 - jdtomjd - discoverydatejd
55982.29 - jdtomjd - discoverydatejd
55984.28 - jdtomjd - discoverydatejd
55986.35 - jdtomjd - discoverydatejd
55987.27 - jdtomjd - discoverydatejd
55988.29 - jdtomjd - discoverydatejd
55990.26 - jdtomjd - discoverydatejd
55992.25 - jdtomjd - discoverydatejd
55993.25 - jdtomjd - discoverydatejd
55997.29 - jdtomjd - discoverydatejd
55998.24 - jdtomjd - discoverydatejd
56002.24 - jdtomjd - discoverydatejd
56009.22 - jdtomjd - discoverydatejd
56010.22 - jdtomjd - discoverydatejd
56012.28 - jdtomjd - discoverydatejd
56014.20 - jdtomjd - discoverydatejd
56016.20 - jdtomjd - discoverydatejd
56017.20 - jdtomjd - discoverydatejd
56019.19 - jdtomjd - discoverydatejd
56021.18 - jdtomjd - discoverydatejd
56028.26 - jdtomjd - discoverydatejd
56034.23 - jdtomjd - discoverydatejd
56035.26 - jdtomjd - discoverydatejd
56041.16 - jdtomjd - discoverydatejd
56047.14 - jdtomjd - discoverydatejd
56048.22 - jdtomjd - discoverydatejd
56064.17 - jdtomjd - discoverydatejd




%stitching 

%clf
%plot(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6880/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6980/(1+z)),1,'first'))),keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6880/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6980/(1+z)),1,'first'))))
%hold all
%plot(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(7000/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(7100/(1+z)),1,'first'))),keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(7000/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(7100/(1+z)),1,'first'))))



lowfit = fit(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6880/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6980/(1+z)),1,'first'))),keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6880/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6980/(1+z)),1,'first'))),'poly1','Robust','Bisquare');
highfit = fit(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(7000/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(7100/(1+z)),1,'first'))),keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(7000/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(7100/(1+z)),1,'first'))),'poly1','Robust','Bisquare');

lowup = (lowfit(6990)+highfit(6990))/2 - lowfit(6990)
highdown = (lowfit(6990)+highfit(6990))/2 - highfit(6990)



%clf
%plot(lowfit,keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6880/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6980/(1+z)),1,'first'))),keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6880/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6980/(1+z)),1,'first'))))
%hold all
%plot(highfit,keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(7000/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(7100/(1+z)),1,'first'))),keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(7000/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(7100/(1+z)),1,'first'))))


%clf
%plot(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(4750/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6990/(1+z)),1,'first'))),lowup + keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(4750/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6990/(1+z)),1,'first'))))
%hold all
%plot(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6990/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(9200/(1+z)),1,'first'))),highdown + keckD2_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<(6990/(1+z)),1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(9200/(1+z)),1,'first'))))

keckD2_20150521(keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6990/(1+z)),1,'first'))) = lowup + keckD2_20150521(keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>(6990/(1+z)),1,'first')))

keckD2_20150521(keckD1_20150521>keckD1_20150521(find(keckD1_20150521>(6990/(1+z)),1,'first'))) = highdown + keckD2_20150521(keckD1_20150521>keckD1_20150521(find(keckD1_20150521>(6990/(1+z)),1,'first')))




%clf
%plot(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(5300/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6250/(1+z)),1,'first'))),keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(5300/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6250/(1+z)),1,'first'))))
%hold all
%plot(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(7000/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(8500/(1+z)),1,'first'))),keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(7000/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(8500/(1+z)),1,'first'))))




day289lowfit = fit(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(5300/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6250/(1+z)),1,'first'))),keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(5300/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6250/(1+z)),1,'first'))),'poly1','Robust','Bisquare');
day289highfit = fit(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(7000/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(8500/(1+z)),1,'first'))),keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(7000/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(8500/(1+z)),1,'first'))),'poly1','Robust','Bisquare');


day289lowup = (day289lowfit(6625)+day289highfit(6625))/2 - day289lowfit(6625)
day289highdown = (day289lowfit(6625)+day289highfit(6625))/2 - day289highfit(6625)





%clf
%plot(day289lowfit,keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(5300/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6900/(1+z)),1,'first'))),keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(5300/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6900/(1+z)),1,'first'))))
%hold all
%plot(day289highfit,keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(7000/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(8500/(1+z)),1,'first'))),keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(7000/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(8500/(1+z)),1,'first'))))


%clf
%plot(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(4750/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6990/(1+z)),1,'first'))),day289lowup + keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(4750/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6990/(1+z)),1,'first'))))
%hold all
%plot(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(6990/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(9200/(1+z)),1,'first'))),day289highdown + keckD2_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<(6990/(1+z)),1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(9200/(1+z)),1,'first'))))

keckD2_20121115(keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6990/(1+z)),1,'first'))) = day289lowup + keckD2_20121115(keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>(6990/(1+z)),1,'first')))

keckD2_20121115(keckD1_20121115>keckD1_20121115(find(keckD1_20121115>(6990/(1+z)),1,'first'))) = day289highdown + keckD2_20121115(keckD1_20121115>keckD1_20121115(find(keckD1_20121115>(6990/(1+z)),1,'first')))











%estimates of magnitude to flux conversion from light curve weight
%FR0 in ergs cm^-2 s^-1 A^-1
%FR = FR0*10^((mR -mR0)/(-2.5))
LCdates = ROTSELC(1,:)-(discoverydatejd+jdtomjd)
FR0 = 217.7*10^-11;
mR0 = 0.186;

frac = (reldate(1) - LCdates(find(LCdates < reldate(1),1,'last')))/ (LCdates(find(LCdates > reldate(1),1,'first')) - LCdates(find(LCdates < reldate(1),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(1),1,'first')) - ROTSEabsmag(find(LCdates < reldate(1),1,'last')));
mR_20120223 = ROTSEabsmag(find(LCdates < reldate(1),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120223 = FR0*10^((mR_20120223 -mR0)/(-2.5))
meanR_20120223 = mean(Lkast2_20120223((Lkast1_20120223>4000)&(Lkast1_20120223<9000)))

frac = (reldate(2) - LCdates(find(LCdates < reldate(2),1,'last')))/ (LCdates(find(LCdates > reldate(2),1,'first')) - LCdates(find(LCdates < reldate(2),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(2),1,'first')) - ROTSEabsmag(find(LCdates < reldate(2),1,'last')));
mR_20120301 = ROTSEabsmag(find(LCdates < reldate(2),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120301 = FR0*10^((mR_20120301 -mR0)/(-2.5))
meanR_20120301 = mean(mmtbc2_20120301((mmtbc1_20120301>4000)&(mmtbc1_20120301<9000)))

frac = (reldate(3) - LCdates(find(LCdates < reldate(3),1,'last')))/ (LCdates(find(LCdates > reldate(3),1,'first')) - LCdates(find(LCdates < reldate(3),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(3),1,'first')) - ROTSEabsmag(find(LCdates < reldate(3),1,'last')));
mR_20120323 = ROTSEabsmag(find(LCdates < reldate(3),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120323 = FR0*10^((mR_20120323 -mR0)/(-2.5))
meanR_20120323 = mean(spolb2_20120323((spolb1_20120323>4000)&(spolb1_20120323<9000)))

frac = (reldate(4) - LCdates(find(LCdates < reldate(4),1,'last')))/ (LCdates(find(LCdates > reldate(4),1,'first')) - LCdates(find(LCdates < reldate(4),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(4),1,'first')) - ROTSEabsmag(find(LCdates < reldate(4),1,'last')));
mR_20120416 = ROTSEabsmag(find(LCdates < reldate(4),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120416 = FR0*10^((mR_20120416 -mR0)/(-2.5))
meanR_20120416 = mean(spolm2_20120416((spolm1_20120416>4000)&(spolm1_20120416<9000)))

frac = (reldate(5) - LCdates(find(LCdates < reldate(5),1,'last')))/ (LCdates(find(LCdates > reldate(5),1,'first')) - LCdates(find(LCdates < reldate(5),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(5),1,'first')) - ROTSEabsmag(find(LCdates < reldate(5),1,'last')));
mR_20120417 = ROTSEabsmag(find(LCdates < reldate(5),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120417 = FR0*10^((mR_20120417 -mR0)/(-2.5))
meanR_20120417 = mean(mmtbc2_20120417((mmtbc1_20120417>4000)&(mmtbc1_20120417<9000)))

frac = (reldate(12) - LCdates(find(LCdates < reldate(12),1,'last')))/ (LCdates(find(LCdates > reldate(12),1,'first')) - LCdates(find(LCdates < reldate(12),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(12),1,'first')) - ROTSEabsmag(find(LCdates < reldate(12),1,'last')));
mR_20120207 = ROTSEabsmag(find(LCdates < reldate(12),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120207 = FR0*10^((mR_20120207 -mR0)/(-2.5))
meanR_20120207 = mean(hetms2_20120207((hetms1_20120207>4000)&(hetms1_20120207<9000)))

frac = (reldate(13) - LCdates(find(LCdates < reldate(13),1,'last')))/ (LCdates(find(LCdates > reldate(13),1,'first')) - LCdates(find(LCdates < reldate(13),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(13),1,'first')) - ROTSEabsmag(find(LCdates < reldate(13),1,'last')));
mR_20120216 = ROTSEabsmag(find(LCdates < reldate(13),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120216 = FR0*10^((mR_20120216 -mR0)/(-2.5))
meanR_20120216 = mean(hetms2_20120216((hetms1_20120216>4000)&(hetms1_20120216<9000)))

frac = (reldate(14) - LCdates(find(LCdates < reldate(14),1,'last')))/ (LCdates(find(LCdates > reldate(14),1,'first')) - LCdates(find(LCdates < reldate(14),1,'last')));
scaling = (ROTSEabsmag(find(LCdates > reldate(14),1,'first')) - ROTSEabsmag(find(LCdates < reldate(14),1,'last')));
mR_20120301_2 = ROTSEabsmag(find(LCdates < reldate(14),1,'last')) + scaling * frac - redshiftdistancemodulus
FR_20120301_2 = FR0*10^((mR_20120301_2 -mR0)/(-2.5))
meanR_20120301_2 = mean(hetms2_20120301((hetms1_20120301>4000)&(hetms1_20120301<9000)))

allLCdates = (ROTSELC(1,:)-(discoverydatejd+jdtomjd));
dateoflastmag = allLCdates(34);
lastmag = ROTSEabsmag(34) - redshiftdistancemodulus
lastflux = FR0*10^((lastmag - mR0)/(-2.5))



fluxcalLkast2_20120223 = Lkast2_20120223.*FR_20120223./meanR_20120223;
fluxcalmmtbc2_20120301 = mmtbc2_20120301.*FR_20120301./meanR_20120301;
fluxcalspolb2_20120323 = spolb2_20120323.*FR_20120323./meanR_20120323;
fluxcalspolm2_20120416 = spolm2_20120416.*FR_20120416./meanR_20120416;
fluxcalmmtbc2_20120417 = mmtbc2_20120417.*FR_20120417./meanR_20120417;
fluxcalLkast2_20120428 = Lkast2_20120428.*1*10^(-15);
fluxcalmmtbc2_20120529 = mmtbc2_20120529.*1;
fluxcalkeckL2_20120616 = keckL2_20120616.*1*10^(-15);
fluxcalmmtbc2_20120701 = mmtbc2_20120701.*1;
fluxcalkeckD2_20121115 = keckD2_20121115.*1;
fluxcalhetms2_20120207 = hetms2_20120207.*FR_20120207./meanR_20120207;
fluxcalhetms2_20120216 = hetms2_20120216.*FR_20120216./meanR_20120216;
fluxcalhetms2_20120301 = hetms2_20120301.*FR_20120301./meanR_20120301_2;

%R band range
5200
6580
7960

mrefvegaR=0.186;
fluxrefvegaR=217.7*10^-11;
Rbandwidth=1380;

trapz(hetms1_20120216(find(hetms1_20120216>5890&hetms1_20120216<7270)),hetms2_20120216(find(hetms1_20120216>5890&hetms1_20120216<7270)))


fluxestRhetms2_20120207 = sum(hetms2_20120207(find(hetms1_20120207>5890&hetms1_20120207<7270)))       *(hetms1_20120207(2)-hetms1_20120207(1));
fluxestRhetms2_20120216 = sum(hetms2_20120216(find(hetms1_20120216>5890&hetms1_20120216<7270)))       *(hetms1_20120216(2)-hetms1_20120216(1));
fluxestRhetms2_20120301 = sum(hetms2_20120301(find(hetms1_20120301>5890&hetms1_20120301<7270)))       *(hetms1_20120301(2)-hetms1_20120301(1));
fluxestRLkast2_20120223 = sum(Lkast2_20120223(find(Lkast1_20120223>5890&Lkast1_20120223<7270)))*10^-15*(Lkast1_20120223(2)-Lkast1_20120223(1));
fluxestRmmtbc2_20120301 = sum(mmtbc2_20120301(find(mmtbc1_20120301>5890&mmtbc1_20120301<7270)))       *(mmtbc1_20120301(2)-mmtbc1_20120301(1));
fluxestRspolb2_20120323 = sum(spolb2_20120323(find(spolb1_20120323>5890&spolb1_20120323<7270)))       *(spolb1_20120323(2)-spolb1_20120323(1));
fluxestRspolm2_20120416 = sum(spolm2_20120416(find(spolm1_20120416>5890&spolm1_20120416<7270)))       *(spolm1_20120416(2)-spolm1_20120416(1));
fluxestRmmtbc2_20120417 = sum(mmtbc2_20120417(find(mmtbc1_20120417>5890&mmtbc1_20120417<7270)))       *(mmtbc1_20120417(2)-mmtbc1_20120417(1));
fluxestRLkast2_20120428 = sum(Lkast2_20120428(find(Lkast1_20120428>5890&Lkast1_20120428<7270)))*10^-15*(Lkast1_20120428(2)-Lkast1_20120428(1));
fluxestRmmtbc2_20120529 = sum(mmtbc2_20120529(find(mmtbc1_20120529>5890&mmtbc1_20120529<7270)))       *(mmtbc1_20120529(2)-mmtbc1_20120529(1));
fluxestRkeckL2_20120616 = sum(keckL2_20120616(find(keckL1_20120616>5890&keckL1_20120616<7270)))*10^-15*(keckL1_20120616(2)-keckL1_20120616(1));
fluxestRmmtbc2_20120701 = sum(mmtbc2_20120701(find(mmtbc1_20120701>5890&mmtbc1_20120701<7270)))       *(mmtbc1_20120701(2)-mmtbc1_20120701(1));
fluxestRkeckD2_20121115 = sum(keckD2_20121115(find(keckD1_20121115>5890&keckD1_20121115<7270)))       *(keckD1_20121115(2)-keckD1_20121115(1));
fluxestRkeckD2_20150521 = sum(keckD2_20150521(find(keckD1_20150521>5890&keckD1_20150521<7270)))       *(keckD1_20150521(2)-keckD1_20150521(1));

%dont have photometry for dates after this
FR_20120216/fluxestRhetms2_20120216
FR_20120223/fluxestRLkast2_20120223
FR_20120301_2/fluxestRhetms2_20120301
FR_20120323/fluxestRspolb2_20120323


magestRhetms2_20120207 = mrefvegaR - 2.5*log10(fluxestRhetms2_20120207/(fluxrefvegaR*Rbandwidth))
magestRhetms2_20120216 = mrefvegaR - 2.5*log10(fluxestRhetms2_20120216/(fluxrefvegaR*Rbandwidth))
magestRhetms2_20120301 = mrefvegaR - 2.5*log10(fluxestRhetms2_20120301/(fluxrefvegaR*Rbandwidth))
magestRLkast2_20120223 = mrefvegaR - 2.5*log10(fluxestRLkast2_20120223/(fluxrefvegaR*Rbandwidth))
magestRmmtbc2_20120301 = mrefvegaR - 2.5*log10(fluxestRmmtbc2_20120301/(fluxrefvegaR*Rbandwidth))
magestRspolb2_20120323 = mrefvegaR - 2.5*log10(fluxestRspolb2_20120323/(fluxrefvegaR*Rbandwidth))
magestRspolm2_20120416 = mrefvegaR - 2.5*log10(fluxestRspolm2_20120416/(fluxrefvegaR*Rbandwidth))
magestRmmtbc2_20120417 = mrefvegaR - 2.5*log10(fluxestRmmtbc2_20120417/(fluxrefvegaR*Rbandwidth))
magestRLkast2_20120428 = mrefvegaR - 2.5*log10(fluxestRLkast2_20120428/(fluxrefvegaR*Rbandwidth))
magestRmmtbc2_20120529 = mrefvegaR - 2.5*log10(fluxestRmmtbc2_20120529/(fluxrefvegaR*Rbandwidth))
magestRkeckL2_20120616 = mrefvegaR - 2.5*log10(fluxestRkeckL2_20120616/(fluxrefvegaR*Rbandwidth))
magestRmmtbc2_20120701 = mrefvegaR - 2.5*log10(fluxestRmmtbc2_20120701/(fluxrefvegaR*Rbandwidth))
magestRkeckD2_20121115 = mrefvegaR - 2.5*log10(fluxestRkeckD2_20121115/(fluxrefvegaR*Rbandwidth))
magestRkeckD2_20150521 = mrefvegaR - 2.5*log10(fluxestRkeckD2_20150521/(fluxrefvegaR*Rbandwidth))

absmagestRhetms2_20120207 = magestRhetms2_20120207+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRhetms2_20120216 = magestRhetms2_20120216+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRhetms2_20120301 = magestRhetms2_20120301+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRLkast2_20120223 = magestRLkast2_20120223+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRmmtbc2_20120301 = magestRmmtbc2_20120301+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRspolb2_20120323 = magestRspolb2_20120323+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRspolm2_20120416 = magestRspolm2_20120416+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRmmtbc2_20120417 = magestRmmtbc2_20120417+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRLkast2_20120428 = magestRLkast2_20120428+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRmmtbc2_20120529 = magestRmmtbc2_20120529+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRkeckL2_20120616 = magestRkeckL2_20120616+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRmmtbc2_20120701 = magestRmmtbc2_20120701+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRkeckD2_20121115 = magestRkeckD2_20121115+redshiftdistancemodulus-A_R-A_R_NaID
absmagestRkeckD2_20150521 = magestRkeckD2_20150521+redshiftdistancemodulus-A_R-A_R_NaID


fluxvalLkast2_20120223 = Lkast2_20120223.*1*10^-15;
fluxvalmmtbc2_20120301 = mmtbc2_20120301.*1;
fluxvalspolb2_20120323 = spolb2_20120323.*1;
fluxvalspolm2_20120416 = spolm2_20120416.*1;
fluxvalmmtbc2_20120417 = mmtbc2_20120417.*1;
fluxvalLkast2_20120428 = Lkast2_20120428.*1*10^(-15);
fluxvalmmtbc2_20120529 = mmtbc2_20120529.*1;
fluxvalkeckL2_20120616 = keckL2_20120616.*1*10^(-15);
fluxvalmmtbc2_20120701 = mmtbc2_20120701.*1;
fluxvalkeckD2_20121115 = keckD2_20121115.*1;
fluxcalhetms2_20120207 = hetms2_20120207.*1;
fluxcalhetms2_20120216 = hetms2_20120216.*1;
fluxcalhetms2_20120301 = hetms2_20120301.*1;


%various continuum fitting regions
%halpha continuum

halphafitlowrangeLkast1_20120223  = Lkast1_20120223(find(Lkast1_20120223>6200,10,'first'));
halphafitlowrangemmtbc1_20120301  = mmtbc1_20120301(find(mmtbc1_20120301>6200,10,'first'));
halphafitlowrangespolb1_20120323  = spolb1_20120323(find(spolb1_20120323>6200,10,'first'));
halphafitlowrangespolm1_20120416  = spolm1_20120416(find(spolm1_20120416>6200,10,'first'));
halphafitlowrangemmtbc1_20120417  = mmtbc1_20120417(find(mmtbc1_20120417>6200,10,'first'));
halphafitlowrangeLkast1_20120428  = Lkast1_20120428(find(Lkast1_20120428>6200,10,'first'));
halphafitlowrangemmtbc1_20120529  = mmtbc1_20120529(find(mmtbc1_20120529>6200,10,'first'));
halphafitlowrangekeckL1_20120616  = keckL1_20120616(find(keckL1_20120616>6200,10,'first'));
halphafitlowrangemmtbc1_20120701  = mmtbc1_20120701(find(mmtbc1_20120701>6200,10,'first'));
halphafitlowrangekeckD1_20121115  = keckD1_20121115(find(keckD1_20121115>6200,10,'first'));
halphafitlowrangekeckD1_20150521  = keckD1_20150521(find(keckD1_20150521>6200,50,'first'));
halphafitlowrangehetms1_20120207  = hetms1_20120207(find(hetms1_20120207>6200,10,'first'));
halphafitlowrangehetms1_20120216  = hetms1_20120216(find(hetms1_20120216>6200,10,'first'));
halphafitlowrangehetms1_20120301  = hetms1_20120301(find(hetms1_20120301>6200,10,'first'));

halphafithighrangeLkast1_20120223 = Lkast1_20120223(find(Lkast1_20120223<7010,10,'last'));
halphafithighrangemmtbc1_20120301 = mmtbc1_20120301(find(mmtbc1_20120301<7050,10,'last'));
halphafithighrangespolb1_20120323 = spolb1_20120323(find(spolb1_20120323<7000,10,'last'));
halphafithighrangespolm1_20120416 = spolm1_20120416(find(spolm1_20120416<7050,10,'last'));
halphafithighrangemmtbc1_20120417 = mmtbc1_20120417(find(mmtbc1_20120417<7050,10,'last'));
halphafithighrangeLkast1_20120428 = Lkast1_20120428(find(Lkast1_20120428<7050,10,'last'));
halphafithighrangemmtbc1_20120529 = mmtbc1_20120529(find(mmtbc1_20120529<6850,10,'last'));
halphafithighrangekeckL1_20120616 = keckL1_20120616(find(keckL1_20120616<7050,10,'last'));
halphafithighrangemmtbc1_20120701 = mmtbc1_20120701(find(mmtbc1_20120701<7050,10,'last'));
halphafithighrangekeckD1_20121115 = keckD1_20121115(find(keckD1_20121115<7050,10,'last'));
halphafithighrangekeckD1_20150521 = keckD1_20150521(find(keckD1_20150521<7050,50,'last'));
halphafithighrangehetms1_20120207 = hetms1_20120207(find(hetms1_20120207<7050,10,'last'));
halphafithighrangehetms1_20120216 = hetms1_20120216(find(hetms1_20120216<7050,10,'last'));
halphafithighrangehetms1_20120301 = hetms1_20120301(find(hetms1_20120301<7000,10,'last'));

halphafitlowrangeLkast2_20120223  = Lkast2_20120223(find(Lkast1_20120223>6200,10,'first'));
halphafitlowrangemmtbc2_20120301  = mmtbc2_20120301(find(mmtbc1_20120301>6200,10,'first'));
halphafitlowrangespolb2_20120323  = spolb2_20120323(find(spolb1_20120323>6200,10,'first'));
halphafitlowrangespolm2_20120416  = spolm2_20120416(find(spolm1_20120416>6200,10,'first'));
halphafitlowrangemmtbc2_20120417  = mmtbc2_20120417(find(mmtbc1_20120417>6200,10,'first'));
halphafitlowrangeLkast2_20120428  = Lkast2_20120428(find(Lkast1_20120428>6200,10,'first'));
halphafitlowrangemmtbc2_20120529  = mmtbc2_20120529(find(mmtbc1_20120529>6200,10,'first'));
halphafitlowrangekeckL2_20120616  = keckL2_20120616(find(keckL1_20120616>6200,10,'first'));
halphafitlowrangemmtbc2_20120701  = mmtbc2_20120701(find(mmtbc1_20120701>6200,10,'first'));
halphafitlowrangekeckD2_20121115  = keckD2_20121115(find(keckD1_20121115>6200,10,'first'));
halphafitlowrangekeckD2_20150521  = keckD2_20150521(find(keckD1_20150521>6200,50,'first'));
halphafitlowrangehetms2_20120207  = hetms2_20120207(find(hetms1_20120207>6200,10,'first'));
halphafitlowrangehetms2_20120216  = hetms2_20120216(find(hetms1_20120216>6200,10,'first'));
halphafitlowrangehetms2_20120301  = hetms2_20120301(find(hetms1_20120301>6200,10,'first'));
  
halphafithighrangeLkast2_20120223 = Lkast2_20120223(find(Lkast1_20120223<7010,10,'last'));
halphafithighrangemmtbc2_20120301 = mmtbc2_20120301(find(mmtbc1_20120301<7050,10,'last'));
halphafithighrangespolb2_20120323 = spolb2_20120323(find(spolb1_20120323<7000,10,'last'));
halphafithighrangespolm2_20120416 = spolm2_20120416(find(spolm1_20120416<7050,10,'last'));
halphafithighrangemmtbc2_20120417 = mmtbc2_20120417(find(mmtbc1_20120417<7050,10,'last'));
halphafithighrangeLkast2_20120428 = Lkast2_20120428(find(Lkast1_20120428<7050,10,'last'));
halphafithighrangemmtbc2_20120529 = mmtbc2_20120529(find(mmtbc1_20120529<6850,10,'last'));
halphafithighrangekeckL2_20120616 = keckL2_20120616(find(keckL1_20120616<7050,10,'last'));
halphafithighrangemmtbc2_20120701 = mmtbc2_20120701(find(mmtbc1_20120701<7050,10,'last'));
halphafithighrangekeckD2_20121115 = keckD2_20121115(find(keckD1_20121115<7050,10,'last'));
halphafithighrangekeckD2_20150521 = keckD2_20150521(find(keckD1_20150521<7050,50,'last'));
halphafithighrangehetms2_20120207 = hetms2_20120207(find(hetms1_20120207<7050,10,'last'));
halphafithighrangehetms2_20120216 = hetms2_20120216(find(hetms1_20120216<7050,10,'last'));
halphafithighrangehetms2_20120301 = hetms2_20120301(find(hetms1_20120301<7000,10,'last'));


halphafitlowmeanLkast2_20120223 = mean(halphafitlowrangeLkast2_20120223);
halphafitlowmeanmmtbc2_20120301 = mean(halphafitlowrangemmtbc2_20120301);
halphafitlowmeanspolb2_20120323 = mean(halphafitlowrangespolb2_20120323);
halphafitlowmeanspolm2_20120416 = mean(halphafitlowrangespolm2_20120416);
halphafitlowmeanmmtbc2_20120417 = mean(halphafitlowrangemmtbc2_20120417);
halphafitlowmeanLkast2_20120428 = mean(halphafitlowrangeLkast2_20120428);
halphafitlowmeanmmtbc2_20120529 = mean(halphafitlowrangemmtbc2_20120529);
halphafitlowmeankeckL2_20120616 = mean(halphafitlowrangekeckL2_20120616);
halphafitlowmeanmmtbc2_20120701 = mean(halphafitlowrangemmtbc2_20120701);
halphafitlowmeankeckD2_20121115 = mean(halphafitlowrangekeckD2_20121115);
halphafitlowmeankeckD2_20150521 = mean(halphafitlowrangekeckD2_20150521);
halphafitlowmeanhetms2_20120207 = mean(halphafitlowrangehetms2_20120207);
halphafitlowmeanhetms2_20120216 = mean(halphafitlowrangehetms2_20120216);
halphafitlowmeanhetms2_20120301 = mean(halphafitlowrangehetms2_20120301);

halphafitlowstdLkast2_20120223 = std(halphafitlowrangeLkast2_20120223);
halphafitlowstdmmtbc2_20120301 = std(halphafitlowrangemmtbc2_20120301);
halphafitlowstdspolb2_20120323 = std(halphafitlowrangespolb2_20120323);
halphafitlowstdspolm2_20120416 = std(halphafitlowrangespolm2_20120416);
halphafitlowstdmmtbc2_20120417 = std(halphafitlowrangemmtbc2_20120417);
halphafitlowstdLkast2_20120428 = std(halphafitlowrangeLkast2_20120428);
halphafitlowstdmmtbc2_20120529 = std(halphafitlowrangemmtbc2_20120529);
halphafitlowstdkeckL2_20120616 = std(halphafitlowrangekeckL2_20120616);
halphafitlowstdmmtbc2_20120701 = std(halphafitlowrangemmtbc2_20120701);
halphafitlowstdkeckD2_20121115 = std(halphafitlowrangekeckD2_20121115);
halphafitlowstdkeckD2_20150521 = std(halphafitlowrangekeckD2_20150521);
halphafitlowstdhetms2_20120207 = std(halphafitlowrangehetms2_20120207);
halphafitlowstdhetms2_20120216 = std(halphafitlowrangehetms2_20120216);
halphafitlowstdhetms2_20120301 = std(halphafitlowrangehetms2_20120301);

halphafithighmeanLkast2_20120223 = mean(halphafithighrangeLkast2_20120223);
halphafithighmeanmmtbc2_20120301 = mean(halphafithighrangemmtbc2_20120301);
halphafithighmeanspolb2_20120323 = mean(halphafithighrangespolb2_20120323);
halphafithighmeanspolm2_20120416 = mean(halphafithighrangespolm2_20120416);
halphafithighmeanmmtbc2_20120417 = mean(halphafithighrangemmtbc2_20120417);
halphafithighmeanLkast2_20120428 = mean(halphafithighrangeLkast2_20120428);
halphafithighmeanmmtbc2_20120529 = mean(halphafithighrangemmtbc2_20120529);
halphafithighmeankeckL2_20120616 = mean(halphafithighrangekeckL2_20120616);
halphafithighmeanmmtbc2_20120701 = mean(halphafithighrangemmtbc2_20120701);
halphafithighmeankeckD2_20121115 = mean(halphafithighrangekeckD2_20121115);
halphafithighmeankeckD2_20150521 = mean(halphafithighrangekeckD2_20150521);
halphafithighmeanhetms2_20120207 = mean(halphafithighrangehetms2_20120207);
halphafithighmeanhetms2_20120216 = mean(halphafithighrangehetms2_20120216);
halphafithighmeanhetms2_20120301 = mean(halphafithighrangehetms2_20120301);

halphafithighstdLkast2_20120223 = std(halphafithighrangeLkast2_20120223);
halphafithighstdmmtbc2_20120301 = std(halphafithighrangemmtbc2_20120301);
halphafithighstdspolb2_20120323 = std(halphafithighrangespolb2_20120323);
halphafithighstdspolm2_20120416 = std(halphafithighrangespolm2_20120416);
halphafithighstdmmtbc2_20120417 = std(halphafithighrangemmtbc2_20120417);
halphafithighstdLkast2_20120428 = std(halphafithighrangeLkast2_20120428);
halphafithighstdmmtbc2_20120529 = std(halphafithighrangemmtbc2_20120529);
halphafithighstdkeckL2_20120616 = std(halphafithighrangekeckL2_20120616);
halphafithighstdmmtbc2_20120701 = std(halphafithighrangemmtbc2_20120701);
halphafithighstdkeckD2_20121115 = std(halphafithighrangekeckD2_20121115);
halphafithighstdkeckD2_20150521 = std(halphafithighrangekeckD2_20150521);
halphafithighstdhetms2_20120207 = std(halphafithighrangehetms2_20120207);
halphafithighstdhetms2_20120216 = std(halphafithighrangehetms2_20120216);
halphafithighstdhetms2_20120301 = std(halphafithighrangehetms2_20120301);

i=1;
while i<=length(halphafitlowrangeLkast2_20120223)
	if(abs(halphafitlowrangeLkast2_20120223(i) - halphafitlowmeanLkast2_20120223) > 2*halphafitlowstdLkast2_20120223)
		halphafitlowrangeLkast2_20120223(i)
		halphafitlowrangeLkast1_20120223(i)	= [];
		halphafitlowrangeLkast2_20120223(i) = [];
	else
		i=i+1;
	end
end


i=1;
while i<=length(halphafitlowrangeLkast2_20120223)
	if(abs(halphafitlowrangeLkast2_20120223(i) - halphafitlowmeanLkast2_20120223) > 2*halphafitlowstdLkast2_20120223)
		halphafitlowrangeLkast2_20120223(i)
		halphafitlowrangeLkast1_20120223(i)	= [];
		halphafitlowrangeLkast2_20120223(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangemmtbc2_20120301)
	if(abs(halphafitlowrangemmtbc2_20120301(i) - halphafitlowmeanmmtbc2_20120301) > 2*halphafitlowstdmmtbc2_20120301)
		halphafitlowrangemmtbc2_20120301(i)
		halphafitlowrangemmtbc1_20120301(i)	= [];
		halphafitlowrangemmtbc2_20120301(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangespolb2_20120323)
	if(abs(halphafitlowrangespolb2_20120323(i) - halphafitlowmeanspolb2_20120323) > 2*halphafitlowstdspolb2_20120323)
		halphafitlowrangespolb2_20120323(i)
		halphafitlowrangespolb1_20120323(i)	= [];
		halphafitlowrangespolb2_20120323(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangespolm2_20120416)
	if(abs(halphafitlowrangespolm2_20120416(i) - halphafitlowmeanspolm2_20120416) > 2*halphafitlowstdspolm2_20120416)
		halphafitlowrangespolm2_20120416(i)
		halphafitlowrangespolm1_20120416(i)	= [];
		halphafitlowrangespolm2_20120416(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangemmtbc2_20120417)
	if(abs(halphafitlowrangemmtbc2_20120417(i) - halphafitlowmeanmmtbc2_20120417) > 2*halphafitlowstdmmtbc2_20120417)
		halphafitlowrangemmtbc2_20120417(i)
		halphafitlowrangemmtbc1_20120417(i)	= [];
		halphafitlowrangemmtbc2_20120417(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangeLkast2_20120428)
	if(abs(halphafitlowrangeLkast2_20120428(i) - halphafitlowmeanLkast2_20120428) > 2*halphafitlowstdLkast2_20120428)
		halphafitlowrangeLkast2_20120428(i)
		halphafitlowrangeLkast1_20120428(i)	= [];
		halphafitlowrangeLkast2_20120428(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangemmtbc2_20120529)
	if(abs(halphafitlowrangemmtbc2_20120529(i) - halphafitlowmeanmmtbc2_20120529) > 2*halphafitlowstdmmtbc2_20120529)
		halphafitlowrangemmtbc2_20120529(i)
		halphafitlowrangemmtbc1_20120529(i)	= [];
		halphafitlowrangemmtbc2_20120529(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangekeckL2_20120616)
	if(abs(halphafitlowrangekeckL2_20120616(i) - halphafitlowmeankeckL2_20120616) > 2*halphafitlowstdkeckL2_20120616)
		halphafitlowrangekeckL2_20120616(i)
		halphafitlowrangekeckL1_20120616(i)	= [];
		halphafitlowrangekeckL2_20120616(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangemmtbc2_20120701)
	if(abs(halphafitlowrangemmtbc2_20120701(i) - halphafitlowmeanmmtbc2_20120701) > 2*halphafitlowstdmmtbc2_20120701)
		halphafitlowrangemmtbc2_20120701(i)
		halphafitlowrangemmtbc1_20120701(i)	= [];
		halphafitlowrangemmtbc2_20120701(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangekeckD2_20121115)
	if(abs(halphafitlowrangekeckD2_20121115(i) - halphafitlowmeankeckD2_20121115) > 2*halphafitlowstdkeckD2_20121115)
		halphafitlowrangekeckD2_20121115(i)
		halphafitlowrangekeckD1_20121115(i)	= [];
		halphafitlowrangekeckD2_20121115(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangekeckD2_20150521)
	if(abs(halphafitlowrangekeckD2_20150521(i) - halphafitlowmeankeckD2_20150521) > 2*halphafitlowstdkeckD2_20150521)
		halphafitlowrangekeckD2_20150521(i)
		halphafitlowrangekeckD1_20150521(i)	= [];
		halphafitlowrangekeckD2_20150521(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangehetms2_20120207)
	if(abs(halphafitlowrangehetms2_20120207(i) - halphafitlowmeanhetms2_20120207) > 2*halphafitlowstdhetms2_20120207)
		halphafitlowrangehetms2_20120207(i)
		halphafitlowrangehetms1_20120207(i)	= [];
		halphafitlowrangehetms2_20120207(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=1:length(halphafitlowrangehetms2_20120216)
	if(abs(halphafitlowrangehetms2_20120216(i) - halphafitlowmeanhetms2_20120216) > 2*halphafitlowstdhetms2_20120216)
		halphafitlowrangehetms2_20120216(i)
		halphafitlowrangehetms1_20120216(i)	= [];
		halphafitlowrangehetms2_20120216(i) = [];
	else
		i=i+1;
	end
end

i=1;
while i<=length(halphafitlowrangehetms2_20120301)
	if(abs(halphafitlowrangehetms2_20120301(i) - halphafitlowmeanhetms2_20120301) > 2*halphafitlowstdhetms2_20120301)
		halphafitlowrangehetms2_20120301(i)
		halphafitlowrangehetms1_20120301(i)	= [];
		halphafitlowrangehetms2_20120301(i) = [];
	else
		i=i+1;
	end
end



halphafitLkast2_20120223 = fit(cat(1,halphafitlowrangeLkast1_20120223,halphafithighrangeLkast1_20120223),cat(1,halphafitlowrangeLkast2_20120223,halphafithighrangeLkast2_20120223),'poly1','Robust','Bisquare');
halphafitmmtbc2_20120301 = fit(cat(1,halphafitlowrangemmtbc1_20120301,halphafithighrangemmtbc1_20120301),cat(1,halphafitlowrangemmtbc2_20120301,halphafithighrangemmtbc2_20120301),'poly1','Robust','Bisquare');
halphafitspolb2_20120323 = fit(cat(1,halphafitlowrangespolb1_20120323,halphafithighrangespolb1_20120323),cat(1,halphafitlowrangespolb2_20120323,halphafithighrangespolb2_20120323),'poly1','Robust','Bisquare');
halphafitspolm2_20120416 = fit(cat(1,halphafitlowrangespolm1_20120416,halphafithighrangespolm1_20120416),cat(1,halphafitlowrangespolm2_20120416,halphafithighrangespolm2_20120416),'poly1','Robust','Bisquare');
halphafitmmtbc2_20120417 = fit(cat(1,halphafitlowrangemmtbc1_20120417,halphafithighrangemmtbc1_20120417),cat(1,halphafitlowrangemmtbc2_20120417,halphafithighrangemmtbc2_20120417),'poly1','Robust','Bisquare');
halphafitLkast2_20120428 = fit(cat(1,halphafitlowrangeLkast1_20120428,halphafithighrangeLkast1_20120428),cat(1,halphafitlowrangeLkast2_20120428,halphafithighrangeLkast2_20120428),'poly1','Robust','Bisquare');
halphafitmmtbc2_20120529 = fit(cat(1,halphafitlowrangemmtbc1_20120529,halphafithighrangemmtbc1_20120529),cat(1,halphafitlowrangemmtbc2_20120529,halphafithighrangemmtbc2_20120529),'poly1','Robust','Bisquare');
halphafitkeckL2_20120616 = fit(cat(1,halphafitlowrangekeckL1_20120616,halphafithighrangekeckL1_20120616),cat(1,halphafitlowrangekeckL2_20120616,halphafithighrangekeckL2_20120616),'poly1','Robust','Bisquare');
halphafitmmtbc2_20120701 = fit(cat(1,halphafitlowrangemmtbc1_20120701,halphafithighrangemmtbc1_20120701),cat(1,halphafitlowrangemmtbc2_20120701,halphafithighrangemmtbc2_20120701),'poly1','Robust','Bisquare');
halphafitkeckD2_20121115 = fit(cat(1,halphafitlowrangekeckD1_20121115,halphafithighrangekeckD1_20121115),cat(1,halphafitlowrangekeckD2_20121115,halphafithighrangekeckD2_20121115),'poly1','Robust','Bisquare');
halphafitkeckD2_20150521 = fit(cat(1,halphafitlowrangekeckD1_20150521,halphafithighrangekeckD1_20150521),cat(1,halphafitlowrangekeckD2_20150521,halphafithighrangekeckD2_20150521),'poly1','Robust','Bisquare');
halphafithetms2_20120207 = fit(cat(1,halphafitlowrangehetms1_20120207,halphafithighrangehetms1_20120207),cat(1,halphafitlowrangehetms2_20120207,halphafithighrangehetms2_20120207),'poly1','Robust','Bisquare');
halphafithetms2_20120216 = fit(cat(1,halphafitlowrangehetms1_20120216,halphafithighrangehetms1_20120216),cat(1,halphafitlowrangehetms2_20120216,halphafithighrangehetms2_20120216),'poly1','Robust','Bisquare');
halphafithetms2_20120301 = fit(cat(1,halphafitlowrangehetms1_20120301,halphafithighrangehetms1_20120301),cat(1,halphafitlowrangehetms2_20120301,halphafithighrangehetms2_20120301),'poly1','Robust','Bisquare');




halphanormLkast2_20120223 = mean(halphafitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>6462)&(Lkast1_20120223<6662))));
halphanormmmtbc2_20120301 = mean(halphafitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>6462)&(mmtbc1_20120301<6662))));
halphanormspolb2_20120323 = mean(halphafitspolb2_20120323(spolb1_20120323((spolb1_20120323>6462)&(spolb1_20120323<6662))));
halphanormspolm2_20120416 = mean(halphafitspolm2_20120416(spolm1_20120416((spolm1_20120416>6462)&(spolm1_20120416<6662))));
halphanormmmtbc2_20120417 = mean(halphafitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>6462)&(mmtbc1_20120417<6662))));
halphanormLkast2_20120428 = mean(halphafitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>6462)&(Lkast1_20120428<6662))));
halphanormmmtbc2_20120529 = mean(halphafitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>6462)&(mmtbc1_20120529<6662))));
halphanormkeckL2_20120616 = mean(halphafitkeckL2_20120616(keckL1_20120616((keckL1_20120616>6462)&(keckL1_20120616<6662))));
halphanormmmtbc2_20120701 = mean(halphafitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>6462)&(mmtbc1_20120701<6662))));
halphanormkeckD2_20121115 = mean(halphafitkeckD2_20121115(keckD1_20121115((keckD1_20121115>6462)&(keckD1_20121115<6662))));
halphanormkeckD2_20150521 = mean(halphafitkeckD2_20150521(keckD1_20150521((keckD1_20150521>6462)&(keckD1_20150521<6662))));
halphanormhetms2_20120207 = mean(halphafithetms2_20120207(hetms1_20120207((hetms1_20120207>6462)&(hetms1_20120207<6662))));
halphanormhetms2_20120216 = mean(halphafithetms2_20120216(hetms1_20120216((hetms1_20120216>6462)&(hetms1_20120216<6662))));
halphanormhetms2_20120301 = mean(halphafithetms2_20120301(hetms1_20120301((hetms1_20120301>6462)&(hetms1_20120301<6662))));


Lkast2_20120223_halphacontnorm = Lkast2_20120223/halphanormLkast2_20120223;
mmtbc2_20120301_halphacontnorm = mmtbc2_20120301/halphanormmmtbc2_20120301;
spolb2_20120323_halphacontnorm = spolb2_20120323/halphanormspolb2_20120323;
spolm2_20120416_halphacontnorm = spolm2_20120416/halphanormspolm2_20120416;
mmtbc2_20120417_halphacontnorm = mmtbc2_20120417/halphanormmmtbc2_20120417;
Lkast2_20120428_halphacontnorm = Lkast2_20120428/halphanormLkast2_20120428;
mmtbc2_20120529_halphacontnorm = mmtbc2_20120529/halphanormmmtbc2_20120529;
keckL2_20120616_halphacontnorm = keckL2_20120616/halphanormkeckL2_20120616;
mmtbc2_20120701_halphacontnorm = mmtbc2_20120701/halphanormmmtbc2_20120701;
keckD2_20121115_halphacontnorm = keckD2_20121115/halphanormkeckD2_20121115;
keckD2_20150521_halphacontnorm = keckD2_20150521/halphanormkeckD2_20150521;
hetms2_20120207_halphacontnorm = hetms2_20120207/halphanormhetms2_20120207;
hetms2_20120216_halphacontnorm = hetms2_20120216/halphanormhetms2_20120216;
hetms2_20120301_halphacontnorm = hetms2_20120301/halphanormhetms2_20120301;


Lkast2_20120223_halphacontfitnormsub = (Lkast2_20120223 - halphafitLkast2_20120223(Lkast1_20120223))./halphafitLkast2_20120223(Lkast1_20120223);
mmtbc2_20120301_halphacontfitnormsub = (mmtbc2_20120301 - halphafitmmtbc2_20120301(mmtbc1_20120301))./halphafitmmtbc2_20120301(mmtbc1_20120301);
spolb2_20120323_halphacontfitnormsub = (spolb2_20120323 - halphafitspolb2_20120323(spolb1_20120323))./halphafitspolb2_20120323(spolb1_20120323);
spolm2_20120416_halphacontfitnormsub = (spolm2_20120416 - halphafitspolm2_20120416(spolm1_20120416))./halphafitspolm2_20120416(spolm1_20120416);
mmtbc2_20120417_halphacontfitnormsub = (mmtbc2_20120417 - halphafitmmtbc2_20120417(mmtbc1_20120417))./halphafitmmtbc2_20120417(mmtbc1_20120417);
Lkast2_20120428_halphacontfitnormsub = (Lkast2_20120428 - halphafitLkast2_20120428(Lkast1_20120428))./halphafitLkast2_20120428(Lkast1_20120428);
mmtbc2_20120529_halphacontfitnormsub = (mmtbc2_20120529 - halphafitmmtbc2_20120529(mmtbc1_20120529))./halphafitmmtbc2_20120529(mmtbc1_20120529);
keckL2_20120616_halphacontfitnormsub = (keckL2_20120616 - halphafitkeckL2_20120616(keckL1_20120616))./halphafitkeckL2_20120616(keckL1_20120616);
mmtbc2_20120701_halphacontfitnormsub = (mmtbc2_20120701 - halphafitmmtbc2_20120701(mmtbc1_20120701))./halphafitmmtbc2_20120701(mmtbc1_20120701);
keckD2_20121115_halphacontfitnormsub = (keckD2_20121115 - halphafitkeckD2_20121115(keckD1_20121115))./halphafitkeckD2_20121115(keckD1_20121115);
keckD2_20150521_halphacontfitnormsub = (keckD2_20150521 - halphafitkeckD2_20150521(keckD1_20150521))./halphafitkeckD2_20150521(keckD1_20150521);
hetms2_20120207_halphacontfitnormsub = (hetms2_20120207 - halphafithetms2_20120207(hetms1_20120207))./halphafithetms2_20120207(hetms1_20120207);
hetms2_20120216_halphacontfitnormsub = (hetms2_20120216 - halphafithetms2_20120216(hetms1_20120216))./halphafithetms2_20120216(hetms1_20120216)
hetms2_20120301_halphacontfitnormsub = (hetms2_20120301 - halphafithetms2_20120301(hetms1_20120301))./halphafithetms2_20120301(hetms1_20120301);





clf
plot(halphafitLkast2_20120223,Lkast1_20120223,Lkast2_20120223)
line([halphafitlowrangeLkast1_20120223(1) halphafitlowrangeLkast1_20120223(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangeLkast1_20120223(length(halphafitlowrangeLkast1_20120223)) halphafitlowrangeLkast1_20120223(length(halphafitlowrangeLkast1_20120223))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangeLkast1_20120223(1) halphafithighrangeLkast1_20120223(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangeLkast1_20120223(length(halphafithighrangeLkast1_20120223)) halphafithighrangeLkast1_20120223(length(halphafithighrangeLkast1_20120223))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(Lkast2_20120223(find(Lkast1_20120223>6000&Lkast1_20120223<7000)))]])
htext = text(5750,max(Lkast2_20120223)*0.4,'halphafitLkast2\_20120223 day 23','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitLkast2_20120223.eps'], 'epsc');
eval(['!epstopdf halphafitLkast2_20120223.eps']);



clf
plot(halphafitmmtbc2_20120301,mmtbc1_20120301,mmtbc2_20120301)
line([halphafitlowrangemmtbc1_20120301(1) halphafitlowrangemmtbc1_20120301(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangemmtbc1_20120301(length(halphafitlowrangemmtbc1_20120301)) halphafitlowrangemmtbc1_20120301(length(halphafitlowrangemmtbc1_20120301))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangemmtbc1_20120301(1) halphafithighrangemmtbc1_20120301(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangemmtbc1_20120301(length(halphafithighrangemmtbc1_20120301)) halphafithighrangemmtbc1_20120301(length(halphafithighrangemmtbc1_20120301))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(mmtbc2_20120301(find(mmtbc1_20120301>6000&mmtbc1_20120301<7000)))]])
htext = text(5750,max(mmtbc2_20120301)*0.8,'halphafitmmtbc2\_20120301 day 30','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitmmtbc2_20120301.eps'], 'epsc');
eval(['!epstopdf halphafitmmtbc2_20120301.eps']);



clf
plot(halphafitspolb2_20120323,spolb1_20120323,spolb2_20120323)
line([halphafitlowrangespolb1_20120323(1) halphafitlowrangespolb1_20120323(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangespolb1_20120323(length(halphafitlowrangespolb1_20120323)) halphafitlowrangespolb1_20120323(length(halphafitlowrangespolb1_20120323))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangespolb1_20120323(1) halphafithighrangespolb1_20120323(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangespolb1_20120323(length(halphafithighrangespolb1_20120323)) halphafithighrangespolb1_20120323(length(halphafithighrangespolb1_20120323))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(spolb2_20120323(find(spolb1_20120323>6000&spolb1_20120323<7000)))]])
htext = text(5750,max(spolb2_20120323)*0.7,'halphafitspolb2\_20120323 day 52','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitspolb2_20120323.eps'], 'epsc');
eval(['!epstopdf halphafitspolb2_20120323.eps']);



clf
plot(halphafitspolm2_20120416,spolm1_20120416,spolm2_20120416)
line([halphafitlowrangespolm1_20120416(1) halphafitlowrangespolm1_20120416(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangespolm1_20120416(length(halphafitlowrangespolm1_20120416)) halphafitlowrangespolm1_20120416(length(halphafitlowrangespolm1_20120416))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangespolm1_20120416(1) halphafithighrangespolm1_20120416(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangespolm1_20120416(length(halphafithighrangespolm1_20120416)) halphafithighrangespolm1_20120416(length(halphafithighrangespolm1_20120416))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(spolm2_20120416(find(spolm1_20120416>6000&spolm1_20120416<7000)))]])
htext = text(5750,max(spolm2_20120416)*0.9,'halphafitspolm2\_20120416 day 76','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitspolm2_20120416.eps'], 'epsc');
eval(['!epstopdf halphafitspolm2_20120416.eps']);



clf
plot(halphafitmmtbc2_20120417,mmtbc1_20120417,mmtbc2_20120417)
line([halphafitlowrangemmtbc1_20120417(1) halphafitlowrangemmtbc1_20120417(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangemmtbc1_20120417(length(halphafitlowrangemmtbc1_20120417)) halphafitlowrangemmtbc1_20120417(length(halphafitlowrangemmtbc1_20120417))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangemmtbc1_20120417(1) halphafithighrangemmtbc1_20120417(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangemmtbc1_20120417(length(halphafithighrangemmtbc1_20120417)) halphafithighrangemmtbc1_20120417(length(halphafithighrangemmtbc1_20120417))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(mmtbc2_20120417(find(mmtbc1_20120417>6000&mmtbc1_20120417<7000)))]])
htext = text(5750,max(mmtbc2_20120417)*0.9,'halphafitmmtbc2\_20120417 day 77','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitmmtbc2_20120417.eps'], 'epsc');
eval(['!epstopdf halphafitmmtbc2_20120417.eps']);


clf
plot(halphafitLkast2_20120428,Lkast1_20120428,Lkast2_20120428)
line([halphafitlowrangeLkast1_20120428(1) halphafitlowrangeLkast1_20120428(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangeLkast1_20120428(length(halphafitlowrangeLkast1_20120428)) halphafitlowrangeLkast1_20120428(length(halphafitlowrangeLkast1_20120428))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangeLkast1_20120428(1) halphafithighrangeLkast1_20120428(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangeLkast1_20120428(length(halphafithighrangeLkast1_20120428)) halphafithighrangeLkast1_20120428(length(halphafithighrangeLkast1_20120428))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(Lkast2_20120428(find(Lkast1_20120428>6000&Lkast1_20120428<7000)))]])
htext = text(5750,max(Lkast2_20120428)*0.9,'halphafitLkast2\_20120428 day 88','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitLkast2_20120428.eps'], 'epsc');
eval(['!epstopdf halphafitLkast2_20120428.eps']);


clf
plot(halphafitmmtbc2_20120529,mmtbc1_20120529,mmtbc2_20120529)
line([halphafitlowrangemmtbc1_20120529(1) halphafitlowrangemmtbc1_20120529(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangemmtbc1_20120529(length(halphafitlowrangemmtbc1_20120529)) halphafitlowrangemmtbc1_20120529(length(halphafitlowrangemmtbc1_20120529))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangemmtbc1_20120529(1) halphafithighrangemmtbc1_20120529(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangemmtbc1_20120529(length(halphafithighrangemmtbc1_20120529)) halphafithighrangemmtbc1_20120529(length(halphafithighrangemmtbc1_20120529))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(mmtbc2_20120529(find(mmtbc1_20120529>6000&mmtbc1_20120529<7000)))]])
htext = text(5750,max(mmtbc2_20120529)*0.9,'halphafitmmtbc2\_20120529 day 119','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitmmtbc2_20120529.eps'], 'epsc');
eval(['!epstopdf halphafitmmtbc2_20120529.eps']);


clf
plot(halphafitkeckL2_20120616,keckL1_20120616,keckL2_20120616)
line([halphafitlowrangekeckL1_20120616(1) halphafitlowrangekeckL1_20120616(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangekeckL1_20120616(length(halphafitlowrangekeckL1_20120616)) halphafitlowrangekeckL1_20120616(length(halphafitlowrangekeckL1_20120616))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangekeckL1_20120616(1) halphafithighrangekeckL1_20120616(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangekeckL1_20120616(length(halphafithighrangekeckL1_20120616)) halphafithighrangekeckL1_20120616(length(halphafithighrangekeckL1_20120616))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(keckL2_20120616(find(keckL1_20120616>6000&keckL1_20120616<7000)))]])
htext = text(5750,max(keckL2_20120616)*0.9,'halphafitkeckL2\_20120616 day 137','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitkeckL2_20120616.eps'], 'epsc');
eval(['!epstopdf halphafitkeckL2_20120616.eps']);


clf
plot(halphafitmmtbc2_20120701,mmtbc1_20120701,mmtbc2_20120701)
line([halphafitlowrangemmtbc1_20120701(1) halphafitlowrangemmtbc1_20120701(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangemmtbc1_20120701(length(halphafitlowrangemmtbc1_20120701)) halphafitlowrangemmtbc1_20120701(length(halphafitlowrangemmtbc1_20120701))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangemmtbc1_20120701(1) halphafithighrangemmtbc1_20120701(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangemmtbc1_20120701(length(halphafithighrangemmtbc1_20120701)) halphafithighrangemmtbc1_20120701(length(halphafithighrangemmtbc1_20120701))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(mmtbc2_20120701(find(mmtbc1_20120701>6000&mmtbc1_20120701<7000)))]])
htext = text(5750,max(mmtbc2_20120701)*0.9,'halphafitmmtbc2\_20120701 day 152','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitmmtbc2_20120701.eps'], 'epsc');
eval(['!epstopdf halphafitmmtbc2_20120701.eps']);


clf
plot(halphafitkeckD2_20121115,keckD1_20121115,keckD2_20121115)
line([halphafitlowrangekeckD1_20121115(1) halphafitlowrangekeckD1_20121115(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangekeckD1_20121115(length(halphafitlowrangekeckD1_20121115)) halphafitlowrangekeckD1_20121115(length(halphafitlowrangekeckD1_20121115))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangekeckD1_20121115(1) halphafithighrangekeckD1_20121115(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangekeckD1_20121115(length(halphafithighrangekeckD1_20121115)) halphafithighrangekeckD1_20121115(length(halphafithighrangekeckD1_20121115))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(keckD2_20121115(find(keckD1_20121115>6000&keckD1_20121115<7000)))]])
htext = text(5750,max(keckD2_20121115)*0.9,'halphafitkeckD2\_20121115 day 289','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitkeckD2_20121115.eps'], 'epsc');
eval(['!epstopdf halphafitkeckD2_20121115.eps']);


clf
plot(halphafitkeckD2_20150521,keckD1_20150521,keckD2_20150521)
line([halphafitlowrangekeckD1_20150521(1) halphafitlowrangekeckD1_20150521(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangekeckD1_20150521(length(halphafitlowrangekeckD1_20150521)) halphafitlowrangekeckD1_20150521(length(halphafitlowrangekeckD1_20150521))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangekeckD1_20150521(1) halphafithighrangekeckD1_20150521(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangekeckD1_20150521(length(halphafithighrangekeckD1_20150521)) halphafithighrangekeckD1_20150521(length(halphafithighrangekeckD1_20150521))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(keckD2_20150521(find(keckD1_20150521>6000&keckD1_20150521<7000)))]])
htext = text(5750,max(keckD2_20150521)*0.9,'halphafitkeckD2\_20150521 day 1206','Color', 'black','FontSize',22)
saveas(plotting, ['halphafitkeckD2_20150521.eps'], 'epsc');
eval(['!epstopdf halphafitkeckD2_20150521.eps']);


clf
plot(halphafithetms2_20120207,hetms1_20120207,hetms2_20120207)
line([halphafitlowrangehetms1_20120207(1) halphafitlowrangehetms1_20120207(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangehetms1_20120207(length(halphafitlowrangehetms1_20120207)) halphafitlowrangehetms1_20120207(length(halphafitlowrangehetms1_20120207))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangehetms1_20120207(1) halphafithighrangehetms1_20120207(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangehetms1_20120207(length(halphafithighrangehetms1_20120207)) halphafithighrangehetms1_20120207(length(halphafithighrangehetms1_20120207))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(hetms2_20120207(find(hetms1_20120207>6000&hetms1_20120207<7000)))]])
htext = text(5750,max(hetms2_20120207)*0.52,'halphafithetms2\_20120207 day 7','Color', 'black','FontSize',22)
saveas(plotting, ['halphafithetms2_20120207.eps'], 'epsc');
eval(['!epstopdf halphafithetms2_20120207.eps']);


clf
plot(halphafithetms2_20120216,hetms1_20120216,hetms2_20120216)
line([halphafitlowrangehetms1_20120216(1) halphafitlowrangehetms1_20120216(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangehetms1_20120216(length(halphafitlowrangehetms1_20120216)) halphafitlowrangehetms1_20120216(length(halphafitlowrangehetms1_20120216))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangehetms1_20120216(1) halphafithighrangehetms1_20120216(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangehetms1_20120216(length(halphafithighrangehetms1_20120216)) halphafithighrangehetms1_20120216(length(halphafithighrangehetms1_20120216))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(hetms2_20120216(find(hetms1_20120216>6000&hetms1_20120216<7000)))]])
htext = text(5750,max(hetms2_20120216)*0.62,'halphafithetms2\_20120216 day 16','Color', 'black','FontSize',22)
saveas(plotting, ['halphafithetms2_20120216.eps'], 'epsc');
eval(['!epstopdf halphafithetms2_20120216.eps']);


clf
plot(halphafithetms2_20120301,hetms1_20120301,hetms2_20120301)
line([halphafitlowrangehetms1_20120301(1) halphafitlowrangehetms1_20120301(1)],[0 100],'Color',[1 0 0])
line([halphafitlowrangehetms1_20120301(length(halphafitlowrangehetms1_20120301)) halphafitlowrangehetms1_20120301(length(halphafitlowrangehetms1_20120301))],[0 100],'Color',[1 0 0])
line([6125 6125],[0 100])
line([7000 7000],[0 100])
line([halphafithighrangehetms1_20120301(1) halphafithighrangehetms1_20120301(1)],[0 100],'Color',[1 0 0])
line([halphafithighrangehetms1_20120301(length(halphafithighrangehetms1_20120301)) halphafithighrangehetms1_20120301(length(halphafithighrangehetms1_20120301))],[0 100],'Color',[1 0 0])
axis([[5500 7500] [0 1.2*max(hetms2_20120301(find(hetms1_20120301>6000&hetms1_20120301<7000)))]])
htext = text(5750,max(hetms2_20120301)*0.6,'halphafithetms2\_20120301 day 30','Color', 'black','FontSize',22)
saveas(plotting, ['halphafithetms2_20120301.eps'], 'epsc');
eval(['!epstopdf halphafithetms2_20120301.eps']);



delete('combinedhalphafitplots.pdf')
append_pdfs('combinedhalphafitplots.pdf','halphafithetms2_20120207.pdf','halphafithetms2_20120216.pdf','halphafitLkast2_20120223.pdf','halphafithetms2_20120301.pdf','halphafitmmtbc2_20120301.pdf','halphafitspolb2_20120323.pdf','halphafitspolm2_20120416.pdf','halphafitmmtbc2_20120417.pdf','halphafitLkast2_20120428.pdf','halphafitmmtbc2_20120529.pdf','halphafitkeckL2_20120616.pdf','halphafitmmtbc2_20120701.pdf','halphafitkeckD2_20121115.pdf','halphafitkeckD2_20150521.pdf')
















%clf
%plot(Lkast1_20120428,Lkast2_20120428_halphacontfitnormsub)
%hold all
%plot(halphafitLkast2_20120428,Lkast1_20120428,Lkast2_20120428)
%%axis([[6200 6900] [-1 2]])
%saveas(plotting, ['FWHMtest1.eps'], 'epsc');
%eval(['!epstopdf FWHMtest1.eps']);
%
%
%
%clf
%plot(keckD1_20121115,keckD2_20121115_halphacontfitnormsub)
%hold all
%%plot(spolb1_20120323,spolb2_20120323_halphacontnorm-1)
%plot(halphafitkeckD2_20121115,keckD1_20121115,keckD2_20121115)
%%axis([[6200 6900] [-1 2]])
%saveas(plotting, ['FWHMtest1.eps'], 'epsc');
%eval(['!epstopdf FWHMtest1.eps']);
%
%
%
%

%clf
%plot(hetms1_20120216,hetms2_20120216_halphacontnorm)
%hold all
%%plot(mmtbc1_20120216,mmtbc2_20120216_halphacontnorm-1)
plot(halphafithetms2_20120216,hetms1_20120216,hetms2_20120216)
%axis([[5000 7000] [-1 2]])
%
%
%
%clf
%plot(spolb1_20120323,spolb2_20120323_halphacontfitnormsub)
%hold all
%plot(spolb1_20120323,spolb2_20120323_halphacontnorm-1)
%plot(halphafitspolb2_20120323,spolb1_20120323,spolb2_20120323)
%axis([[6200 6900] [-1 2]])




%hbeta
%probably should also fit 

%spolb2_20120323
%spolm2_20120416
%mmtbc2_20120701

hbetafitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120223<4500)|(Lkast1_20120223>5600)|(Lkast1_20120223>4750&Lkast1_20120223<5200));
hbetafitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120428<4500)|(Lkast1_20120428>5600)|(Lkast1_20120428>4750&Lkast1_20120428<5200));
hbetafitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<4500)|(keckL1_20120616>5600)|(keckL1_20120616>4750&keckL1_20120616<5200));
hbetafitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<4500)|(keckD1_20121115>5600)|(keckD1_20121115>4750&keckD1_20121115<5200));
hbetafitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<4500)|(keckD1_20150521>5600)|(keckD1_20150521>4750&keckD1_20150521<5200));


hbetanorm_20120223 = mean(hbetafitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>4761)&(Lkast1_20120223<4961))));
hbetanorm_20120428 = mean(hbetafitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>4761)&(Lkast1_20120428<4961))));
hbetanorm_20120616 = mean(hbetafitkeckL2_20120616(keckL1_20120616((keckL1_20120616>4761)&(keckL1_20120616<4961))));
hbetanorm_20121115 = mean(hbetafitkeckD2_20121115(keckD1_20121115((keckD1_20121115>4761)&(keckD1_20121115<4961))));
hbetanorm_20150521 = mean(hbetafitkeckD2_20150521(keckD1_20150521((keckD1_20150521>4761)&(keckD1_20150521<4961))));

Lkast2_20120223_hbetacontnorm = Lkast2_20120223/mean(hbetafitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>4761)&(Lkast1_20120223<4961))));
Lkast2_20120428_hbetacontnorm = Lkast2_20120428/mean(hbetafitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>4761)&(Lkast1_20120428<4961))));
keckL2_20120616_hbetacontnorm = keckL2_20120616/mean(hbetafitkeckL2_20120616(keckL1_20120616((keckL1_20120616>4761)&(keckL1_20120616<4961))));
keckD2_20121115_hbetacontnorm = keckD2_20121115/mean(hbetafitkeckD2_20121115(keckD1_20121115((keckD1_20121115>4761)&(keckD1_20121115<4961))));
keckD2_20150521_hbetacontnorm = keckD2_20150521/mean(hbetafitkeckD2_20150521(keckD1_20150521((keckD1_20150521>4761)&(keckD1_20150521<4961))));


Lkast2_20120223_hbetacontfitnormsub = (Lkast2_20120223 - hbetafitLkast2_20120223(Lkast1_20120223))./hbetafitLkast2_20120223(Lkast1_20120223);
Lkast2_20120428_hbetacontfitnormsub = (Lkast2_20120428 - hbetafitLkast2_20120428(Lkast1_20120428))./hbetafitLkast2_20120428(Lkast1_20120428);
keckL2_20120616_hbetacontfitnormsub = (keckL2_20120616 - hbetafitkeckL2_20120616(keckL1_20120616))./hbetafitkeckL2_20120616(keckL1_20120616);
keckD2_20121115_hbetacontfitnormsub = (keckD2_20121115 - hbetafitkeckD2_20121115(keckD1_20121115))./hbetafitkeckD2_20121115(keckD1_20121115);
keckD2_20150521_hbetacontfitnormsub = (keckD2_20150521 - hbetafitkeckD2_20150521(keckD1_20150521))./hbetafitkeckD2_20150521(keckD1_20150521);


hbetafithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<4500)|(hetms1_20120207>5600)|(hetms1_20120207>4750&hetms1_20120207<5200));
hbetanorm_20120207 = mean(hbetafithetms2_20120207(hetms1_20120207((hetms1_20120207>4761)&(hetms1_20120207<4961))));
hetms2_20120207_hbetacontnorm = hetms2_20120207/mean(hbetafithetms2_20120207(hetms1_20120207((hetms1_20120207>4761)&(hetms1_20120207<4961))));
hetms2_20120207_hbetacontfitnormsub = (hetms2_20120207 - hbetafithetms2_20120207(hetms1_20120207))./hbetafithetms2_20120207(hetms1_20120207);
hbetafithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<4500)|(hetms1_20120216>5600)|(hetms1_20120216>4750&hetms1_20120216<5200));
hbetanorm_20120216 = mean(hbetafithetms2_20120216(hetms1_20120216((hetms1_20120216>4761)&(hetms1_20120216<4961))));
hetms2_20120216_hbetacontnorm = hetms2_20120216/mean(hbetafithetms2_20120216(hetms1_20120216((hetms1_20120216>4761)&(hetms1_20120216<4961))));
hetms2_20120216_hbetacontfitnormsub = (hetms2_20120216 - hbetafithetms2_20120216(hetms1_20120216))./hbetafithetms2_20120216(hetms1_20120216);
hbetafithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<4500)|(hetms1_20120301>5600)|(hetms1_20120301>4750&hetms1_20120301<5200));
hbetanorm_20120301 = mean(hbetafithetms2_20120301(hetms1_20120301((hetms1_20120301>4761)&(hetms1_20120301<4961))));
hetms2_20120301_hbetacontnorm = hetms2_20120301/mean(hbetafithetms2_20120301(hetms1_20120301((hetms1_20120301>4761)&(hetms1_20120301<4961))));
hetms2_20120301_hbetacontfitnormsub = (hetms2_20120301 - hbetafithetms2_20120301(hetms1_20120301))./hbetafithetms2_20120301(hetms1_20120301);



clf
plot(hbetafithetms2_20120301,hetms1_20120301,hetms2_20120301)
axis([[4500 5800] [8*10^-15 18*10^-15]])




%HII region line continuum determinations
%OIII 4959
OIII1fitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120223<4929)|(Lkast1_20120223>4989)|(Lkast1_20120223>4949&Lkast1_20120223<4969));
OIII1fitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120428<4929)|(Lkast1_20120428>4989)|(Lkast1_20120428>4949&Lkast1_20120428<4969));
OIII1fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<4929)|(keckL1_20120616>4989)|(keckL1_20120616>4949&keckL1_20120616<4969));
OIII1fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<4929)|(mmtbc1_20120701>4989)|(mmtbc1_20120701>4949&mmtbc1_20120701<4969));
OIII1fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<4929)|(keckD1_20121115>4989)|(keckD1_20121115>4949&keckD1_20121115<4969));
OIII1fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<4929)|(keckD1_20150521>4989)|(keckD1_20150521>4949&keckD1_20150521<4969));

OIII1norm_20120223 = mean(OIII1fitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>4949)&(Lkast1_20120223<4969))));
OIII1norm_20120428 = mean(OIII1fitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>4949)&(Lkast1_20120428<4969))));
OIII1norm_20120616 = mean(OIII1fitkeckL2_20120616(keckL1_20120616((keckL1_20120616>4949)&(keckL1_20120616<4969))));
OIII1norm_20120701 = mean(OIII1fitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>4949)&(mmtbc1_20120701<4969))));
OIII1norm_20121115 = mean(OIII1fitkeckD2_20121115(keckD1_20121115((keckD1_20121115>4949)&(keckD1_20121115<4969))));
OIII1norm_20150521 = mean(OIII1fitkeckD2_20150521(keckD1_20150521((keckD1_20150521>4949)&(keckD1_20150521<4969))));

Lkast2_20120223_OIII1contnorm = Lkast2_20120223/OIII1norm_20120223;
Lkast2_20120428_OIII1contnorm = Lkast2_20120428/OIII1norm_20120428;
keckL2_20120616_OIII1contnorm = keckL2_20120616/OIII1norm_20120616;
mmtbc2_20120701_OIII1contnorm = mmtbc2_20120701/OIII1norm_20120701;
keckD2_20121115_OIII1contnorm = keckD2_20121115/OIII1norm_20121115;
keckD2_20150521_OIII1contnorm = keckD2_20150521/OIII1norm_20150521;

Lkast2_20120223_OIII1contnormsub = Lkast2_20120223_OIII1contnorm - 1;
Lkast2_20120428_OIII1contnormsub = Lkast2_20120428_OIII1contnorm - 1;
keckL2_20120616_OIII1contnormsub = keckL2_20120616_OIII1contnorm - 1;
mmtbc2_20120701_OIII1contnormsub = mmtbc2_20120701_OIII1contnorm - 1;
keckD2_20121115_OIII1contnormsub = keckD2_20121115_OIII1contnorm - 1;
keckD2_20150521_OIII1contnormsub = keckD2_20150521_OIII1contnorm - 1;


OIII1(1) = 10^-15 * OIII1norm_20120223 * trapz(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<4955,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>4966,1,'first'))),Lkast2_20120223_OIII1contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<4955,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>4966,1,'first'))));
OIII1(6) = 10^-15 * OIII1norm_20120428 * trapz(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<4955,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>4964,1,'first'))),Lkast2_20120428_OIII1contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<4955,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>4964,1,'first'))));
OIII1(8) = 10^-15 * OIII1norm_20120616 * trapz(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<4952,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>4961.5,1,'first'))),keckL2_20120616_OIII1contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<4952,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>4961.5,1,'first'))));
OIII1(9) = OIII1norm_20120701 * trapz(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4953,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>4963.5,1,'first'))),mmtbc2_20120701_OIII1contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4953,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>4963.5,1,'first'))));
OIII1(10) = OIII1norm_20121115 * trapz(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4950,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>4957,1,'first'))),keckD2_20121115_OIII1contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4950,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>4957,1,'first'))));
OIII1(11) = OIII1norm_20150521 * trapz(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<4956,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>4965,1,'first'))),keckD2_20150521_OIII1contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<4956,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>4965,1,'first'))));


OIII1fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<4929)|(hetms1_20120207>4989)|(hetms1_20120207>4939&hetms1_20120207<4979));
OIII1norm_20120207 = mean(OIII1fithetms2_20120207(hetms1_20120207((hetms1_20120207>4949)&(hetms1_20120207<4969))));
hetms2_20120207_OIII1contnorm = hetms2_20120207/OIII1norm_20120207;
hetms2_20120207_OIII1contnormsub = hetms2_20120207_OIII1contnorm - 1;
OIII1(12) =  OIII1norm_20120207 * trapz(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4935,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>4969,1,'first'))),hetms2_20120207_OIII1contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4935,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>4969,1,'first'))));

OIII1fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<4929)|(hetms1_20120216>4989)|(hetms1_20120216>4939&hetms1_20120216<4979));
OIII1norm_20120216 = mean(OIII1fithetms2_20120216(hetms1_20120216((hetms1_20120216>4949)&(hetms1_20120216<4969))));
hetms2_20120216_OIII1contnorm = hetms2_20120216/OIII1norm_20120216;
hetms2_20120216_OIII1contnormsub = hetms2_20120216_OIII1contnorm - 1;
OIII1(13) = OIII1norm_20120216 * trapz(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4941,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>4967,1,'first'))),hetms2_20120216_OIII1contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4941,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>4967,1,'first'))));

OIII1fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<4914)|(hetms1_20120301>4989)|(hetms1_20120301>4929&hetms1_20120301<4979));
OIII1norm_20120301_2 = mean(OIII1fithetms2_20120301(hetms1_20120301((hetms1_20120301>4949)&(hetms1_20120301<4969))));
hetms2_20120301_OIII1contnorm = hetms2_20120301/OIII1norm_20120301_2;
hetms2_20120301_OIII1contnormsub = hetms2_20120301_OIII1contnorm - 1;
OIII1(14) = OIII1norm_20120301_2 * trapz(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4935,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>4969,1,'first'))),hetms2_20120301_OIII1contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4935,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>4969,1,'first'))));




OIII1fitspolb2_20120323 = fit(spolb1_20120323,spolb2_20120323,'poly3','Robust','Bisquare','Exclude',(spolb1_20120323<4929)|(spolb1_20120323>4979)|(spolb1_20120323>4939&spolb1_20120323<4974));
OIII1norm_20120207 = mean(OIII1fitspolb2_20120323(spolb1_20120323((spolb1_20120323>4949)&(spolb1_20120323<4970))));
spolb2_20120323_OIII1contnorm = spolb2_20120323/OIII1norm_20120207;
spolb2_20120323_OIII1contnormsub = spolb2_20120323_OIII1contnorm - 1;
OIII1(3) =  OIII1norm_20120207 * trapz(spolb1_20120323(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4945,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>4970,1,'first'))),spolb2_20120323_OIII1contnormsub(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4945,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>4970,1,'first'))));
errOIII1(3)= OIII1(3) * 1/2*5*std(spolb2_20120323_OIII1contnormsub(spolb1_20120323>4970 & spolb1_20120323 < 4990));


OIII1fitspolm2_20120416 = fit(spolm1_20120416,spolm2_20120416,'poly3','Robust','Bisquare','Exclude',(spolm1_20120416<4929)|(spolm1_20120416>4989)|(spolm1_20120416>4939&spolm1_20120416<4979));
OIII1norm_20120207 = mean(OIII1fitspolm2_20120416(spolm1_20120416((spolm1_20120416>4949)&(spolm1_20120416<4969))));
spolm2_20120416_OIII1contnorm = spolm2_20120416/OIII1norm_20120207;
spolm2_20120416_OIII1contnormsub = spolm2_20120416_OIII1contnorm - 1;
OIII1(4) =  OIII1norm_20120207 * trapz(spolm1_20120416(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4935,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>4969,1,'first'))),spolm2_20120416_OIII1contnormsub(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4935,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>4969,1,'first'))));
errOIII1(4)= OIII1(4) * 1/2*5*std(spolm2_20120416_OIII1contnormsub(spolm1_20120416>4970 & spolm1_20120416 < 4990));









errOIII1(1) = OIII1(1)  * 1/2*5*std(Lkast2_20120223_OIII1contnormsub(Lkast1_20120223>4970 & Lkast1_20120223 < 4990));
errOIII1(6) = OIII1(6)  * 1/2*5*std(Lkast2_20120428_OIII1contnormsub(Lkast1_20120428>4970 & Lkast1_20120428 < 4990));
errOIII1(8) = OIII1(8)  * 1/2*5*std(keckL2_20120616_OIII1contnormsub(keckL1_20120616>4970 & keckL1_20120616 < 4990));
errOIII1(9) = OIII1(9)  * 1/2*5*std(mmtbc2_20120701_OIII1contnormsub(mmtbc1_20120701>4970 & mmtbc1_20120701 < 4990));
errOIII1(10)= OIII1(10) * 1/2*5*std(keckD2_20121115_OIII1contnormsub(keckD1_20121115>4970 & keckD1_20121115 < 4990));
errOIII1(11)= OIII1(11) * 1/2*5*std(keckD2_20150521_OIII1contnormsub(keckD1_20150521>4970 & keckD1_20150521 < 4990));
errOIII1(12)= OIII1(12) * 1/2*5*std(hetms2_20120207_OIII1contnormsub(hetms1_20120207>4970 & hetms1_20120207 < 4990));
errOIII1(13)= OIII1(13) * 1/2*5*std(hetms2_20120216_OIII1contnormsub(hetms1_20120216>4970 & hetms1_20120216 < 4990));
errOIII1(14)= OIII1(14) * 1/2*5*std(hetms2_20120301_OIII1contnormsub(hetms1_20120301>4970 & hetms1_20120301 < 4990));




clf
plot(Lkast1_20120223,Lkast2_20120223_OIII1contnormsub)
hold all
area(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<4955,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>4966,1,'first'))),Lkast2_20120223_OIII1contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<4955,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>4966,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_1_23.eps'], 'epsc');
eval(['!epstopdf OIII1_1_23.eps']);


%clf
%plot(spolb1_20120323,spolb2_20120323_OIII1contnormsub)
%hold all
%area(spolb1_20120323(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4945,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>4970,1,'first'))),spolb2_20120323_OIII1contnormsub(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4945,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>4970,1,'first'))));
%xlim([4909,5009])
%saveas(plotting, ['OIII1_1_23.eps'], 'epsc');
%eval(['!epstopdf OIII1_1_23.eps']);
%
%clf
%plot(spolm1_20120416,spolm2_20120416_OIII1contnormsub)
%hold all
%area(spolm1_20120416(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4955,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>4966,1,'first'))),spolm2_20120416_OIII1contnormsub(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4955,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>4966,1,'first'))));
%xlim([4909,5009])
%saveas(plotting, ['OIII1_1_23.eps'], 'epsc');
%eval(['!epstopdf OIII1_1_23.eps']);
%



clf
plot(Lkast1_20120428,Lkast2_20120428_OIII1contnormsub)
hold all
area(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<4955,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428<4964,1,'last'))),Lkast2_20120428_OIII1contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<4955,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428<4964,1,'last'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_6_88.eps'], 'epsc');
eval(['!epstopdf OIII1_6_88.eps']);

clf
plot(keckL1_20120616,keckL2_20120616_OIII1contnormsub)
hold all
area(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<4952,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>4961.5,1,'first'))),keckL2_20120616_OIII1contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<4952,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>4961.5,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_8_137.eps'], 'epsc');
eval(['!epstopdf OIII1_8_137.eps']);

clf
plot(mmtbc1_20120701,mmtbc2_20120701_OIII1contnormsub)
hold all
area(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4953,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>4963.5,1,'first'))),mmtbc2_20120701_OIII1contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4953,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>4963.5,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_9_152.eps'], 'epsc');
eval(['!epstopdf OIII1_9_152.eps']);

clf
plot(keckD1_20121115,keckD2_20121115_OIII1contnormsub)
hold all
area(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4950,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>4957,1,'first'))),keckD2_20121115_OIII1contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4950,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>4957,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_10_289.eps'], 'epsc');
eval(['!epstopdf OIII1_10_289.eps']);



clf
plot(keckD1_20150521,keckD2_20150521_OIII1contnormsub)
hold all
area(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<4956,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>4965,1,'first'))),keckD2_20150521_OIII1contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<4956,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>4965,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_11_1206.eps'], 'epsc');
eval(['!epstopdf OIII1_11_1206.eps']);






clf
plot(hetms1_20120207,hetms2_20120207_OIII1contnormsub)
hold all
area(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4935,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>4969,1,'first'))),hetms2_20120207_OIII1contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4935,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>4969,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_12_7.eps'], 'epsc');
eval(['!epstopdf OIII1_12_7.eps']);



clf
plot(hetms1_20120216,hetms2_20120216_OIII1contnormsub)
hold all
area(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4941,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>4967,1,'first'))),hetms2_20120216_OIII1contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4941,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>4967,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_13_16.eps'], 'epsc');
eval(['!epstopdf OIII1_13_16.eps']);


clf
plot(hetms1_20120301,hetms2_20120301_OIII1contnormsub)
hold all
area(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4935,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>4969,1,'first'))),hetms2_20120301_OIII1contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4935,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>4969,1,'first'))));
xlim([4909,5009])
saveas(plotting, ['OIII1_14_30.eps'], 'epsc');
eval(['!epstopdf OIII1_14_30.eps']);












%OIII5007
OIII2fitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120223<4977)|(Lkast1_20120223>5037)|(Lkast1_20120223>4997&Lkast1_20120223<5017));
OIII2fitspolb2_20120323 = fit(spolb1_20120323,spolb2_20120323,'poly3','Robust','Bisquare','Exclude',(spolb1_20120323<4977)|(spolb1_20120323>5037)|(spolb1_20120323>4997&spolb1_20120323<5017));
OIII2fitspolm2_20120416 = fit(spolm1_20120416,spolm2_20120416,'poly3','Robust','Bisquare','Exclude',(spolm1_20120416<4977)|(spolm1_20120416>5037)|(spolm1_20120416>4997&spolm1_20120416<5017));
OIII2fitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120428<4977)|(Lkast1_20120428>5037)|(Lkast1_20120428>4997&Lkast1_20120428<5017));
OIII2fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<4977)|(keckL1_20120616>5037)|(keckL1_20120616>4997&keckL1_20120616<5017));
OIII2fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<4977)|(mmtbc1_20120701>5037)|(mmtbc1_20120701>4997&mmtbc1_20120701<5017));
OIII2fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<4977)|(keckD1_20121115>5037)|(keckD1_20121115>4997&keckD1_20121115<5017));
OIII2fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<4977)|(keckD1_20150521>5037)|(keckD1_20150521>4997&keckD1_20150521<5017));

OIII2norm_20120223 = mean(OIII2fitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>4997)&(Lkast1_20120223<5017))));
OIII2norm_20120323 = mean(OIII2fitspolb2_20120323(spolb1_20120323((spolb1_20120323>4997)&(spolb1_20120323<5017))));
OIII2norm_20120416 = mean(OIII2fitspolm2_20120416(spolm1_20120416((spolm1_20120416>4997)&(spolm1_20120416<5017))));
OIII2norm_20120428 = mean(OIII2fitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>4997)&(Lkast1_20120428<5017))));
OIII2norm_20120616 = mean(OIII2fitkeckL2_20120616(keckL1_20120616((keckL1_20120616>4997)&(keckL1_20120616<5017))));
OIII2norm_20120701 = mean(OIII2fitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>4997)&(mmtbc1_20120701<5017))));
OIII2norm_20121115 = mean(OIII2fitkeckD2_20121115(keckD1_20121115((keckD1_20121115>4997)&(keckD1_20121115<5017))));
OIII2norm_20150521 = mean(OIII2fitkeckD2_20150521(keckD1_20150521((keckD1_20150521>4997)&(keckD1_20150521<5017))));

Lkast2_20120223_OIII2contnorm = Lkast2_20120223/OIII2norm_20120223;
spolb2_20120323_OIII2contnorm = spolb2_20120323/OIII2norm_20120323;
spolm2_20120416_OIII2contnorm = spolm2_20120416/OIII2norm_20120416;
Lkast2_20120428_OIII2contnorm = Lkast2_20120428/OIII2norm_20120428;
keckL2_20120616_OIII2contnorm = keckL2_20120616/OIII2norm_20120616;
mmtbc2_20120701_OIII2contnorm = mmtbc2_20120701/OIII2norm_20120701;
keckD2_20121115_OIII2contnorm = keckD2_20121115/OIII2norm_20121115;
keckD2_20150521_OIII2contnorm = keckD2_20150521/OIII2norm_20150521;

Lkast2_20120223_OIII2contnormsub = Lkast2_20120223_OIII2contnorm - 1;
spolb2_20120323_OIII2contnormsub = spolb2_20120323_OIII2contnorm - 1;
spolm2_20120416_OIII2contnormsub = spolm2_20120416_OIII2contnorm - 1;
Lkast2_20120428_OIII2contnormsub = Lkast2_20120428_OIII2contnorm - 1;
keckL2_20120616_OIII2contnormsub = keckL2_20120616_OIII2contnorm - 1;
mmtbc2_20120701_OIII2contnormsub = mmtbc2_20120701_OIII2contnorm - 1;
keckD2_20121115_OIII2contnormsub = keckD2_20121115_OIII2contnorm - 1;
keckD2_20150521_OIII2contnormsub = keckD2_20150521_OIII2contnorm - 1;

OIII2(1) = 10^-15 * OIII2norm_20120223 * trapz(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<5000,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>5015.5,1,'first'))),Lkast2_20120223_OIII2contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<5000,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>5015.5,1,'first'))));
OIII2(3) = OIII2norm_20120323 * trapz(spolb1_20120323(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4994,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>5016.5,1,'first'))),spolb2_20120323_OIII2contnormsub(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4994,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>5016.5,1,'first'))));
OIII2(4) = OIII2norm_20120416 * trapz(spolm1_20120416(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4995,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>5018.5,1,'first'))),spolm2_20120416_OIII2contnormsub(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4995,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>5018.5,1,'first'))));
OIII2(6) = 10^-15 * OIII2norm_20120428 * trapz(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<5000.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>5011.5,1,'first'))),Lkast2_20120428_OIII2contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<5000.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>5011.5,1,'first'))));
OIII2(8) = 10^-15 * OIII2norm_20120616 * trapz(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))),keckL2_20120616_OIII2contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))));
OIII2(9) = OIII2norm_20120701 * trapz(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4999,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>5013.5,1,'first'))),mmtbc2_20120701_OIII2contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4999,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>5013.5,1,'first'))));
OIII2(10) = OIII2norm_20121115 * trapz(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4997,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>5006,1,'first'))),keckD2_20121115_OIII2contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4997,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>5006,1,'first'))));
OIII2(11) = OIII2norm_20150521 * trapz(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<5003,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>5012,1,'first'))),keckD2_20150521_OIII2contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<5003,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>5012,1,'first'))));



OIII2fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<4977)|(hetms1_20120207>5037)|(hetms1_20120207>4997&hetms1_20120207<5017));
OIII2norm_20120207 = mean(OIII2fithetms2_20120207(hetms1_20120207((hetms1_20120207>4997)&(hetms1_20120207<5017))));
hetms2_20120207_OIII2contnorm = hetms2_20120207/OIII2norm_20120207;
hetms2_20120207_OIII2contnormsub = hetms2_20120207_OIII2contnorm - 1;
OIII2(12) =  OIII2norm_20120207 * trapz(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4998,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>5017,1,'first'))),hetms2_20120207_OIII2contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4998,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>5017,1,'first'))));

OIII2fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<4977)|(hetms1_20120216>5037)|(hetms1_20120216>4997&hetms1_20120216<5017));
OIII2norm_20120216 = mean(OIII2fithetms2_20120216(hetms1_20120216((hetms1_20120216>4997)&(hetms1_20120216<5017))));
hetms2_20120216_OIII2contnorm = hetms2_20120216/OIII2norm_20120216;
hetms2_20120216_OIII2contnormsub = hetms2_20120216_OIII2contnorm - 1;
OIII2(13) = OIII2norm_20120216 * trapz(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4998,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>5017,1,'first'))),hetms2_20120216_OIII2contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4998,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>5017,1,'first'))));

OIII2fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<4977)|(hetms1_20120301>5037)|(hetms1_20120301>4997&hetms1_20120301<5017));
OIII2norm_20120301_2 = mean(OIII2fithetms2_20120301(hetms1_20120301((hetms1_20120301>4997)&(hetms1_20120301<5017))));
hetms2_20120301_OIII2contnorm = hetms2_20120301/OIII2norm_20120301_2;
hetms2_20120301_OIII2contnormsub = hetms2_20120301_OIII2contnorm - 1;
OIII2(14) = OIII2norm_20120301_2 * trapz(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4998,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>5017,1,'first'))),hetms2_20120301_OIII2contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4998,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>5017,1,'first'))));



errOIII2(1) = OIII2(1) * 1/2*5*std(Lkast2_20120223_OIII2contnormsub(Lkast1_20120223>5030 & Lkast1_20120223 < 5050));
errOIII2(3) = OIII2(3) * 1/2*5*std(spolb2_20120323_OIII2contnormsub(spolb1_20120323>5030 & spolb1_20120323 < 5050));
errOIII2(4) = OIII2(4) * 1/2*5*std(spolm2_20120416_OIII2contnormsub(spolm1_20120416>5030 & spolm1_20120416 < 5050));
errOIII2(6) = OIII2(6) * 1/2*5*std(Lkast2_20120428_OIII2contnormsub(Lkast1_20120428>5030 & Lkast1_20120428 < 5050));
errOIII2(8) = OIII2(8) * 1/2*5*std(keckL2_20120616_OIII2contnormsub(keckL1_20120616>5030 & keckL1_20120616 < 5050));
errOIII2(9) = OIII2(9) * 1/2*5*std(mmtbc2_20120701_OIII2contnormsub(mmtbc1_20120701>5030 & mmtbc1_20120701 < 5050));
errOIII2(10)= OIII2(10)* 1/2*5*std(keckD2_20121115_OIII2contnormsub(keckD1_20121115>5030 & keckD1_20121115 < 5050));
errOIII2(11)= OIII2(11)* 1/2*5*std(keckD2_20150521_OIII2contnormsub(keckD1_20150521>5030 & keckD1_20150521 < 5050));
errOIII2(12)= OIII1(12) * 1/2*5*std(hetms2_20120207_OIII1contnormsub(hetms1_20120207>5030 & hetms1_20120207 < 5050));
errOIII2(13)= OIII1(13) * 1/2*5*std(hetms2_20120216_OIII1contnormsub(hetms1_20120216>5030 & hetms1_20120216 < 5050));
errOIII2(14)= OIII1(14) * 1/2*5*std(hetms2_20120301_OIII1contnormsub(hetms1_20120301>5030 & hetms1_20120301 < 5050));


clf
plot(Lkast1_20120223,Lkast2_20120223_OIII2contnormsub)
hold all
area(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<5000,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>5015.5,1,'first'))),Lkast2_20120223_OIII2contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<5000,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>5015.5,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_1_23.eps'], 'epsc');
eval(['!epstopdf OIII2_1_23.eps']);

clf
plot(spolb1_20120323,spolb2_20120323_OIII2contnormsub)
hold all
area(spolb1_20120323(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4994,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>5016.5,1,'first'))),spolb2_20120323_OIII2contnormsub(spolb1_20120323>=spolb1_20120323(find(spolb1_20120323<4994,1,'last')) & spolb1_20120323<=spolb1_20120323(find(spolb1_20120323>5016.5,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_3_52.eps'], 'epsc');
eval(['!epstopdf OIII2_3_52.eps']);

clf
plot(spolm1_20120416,spolm2_20120416_OIII2contnormsub)
hold all
area(spolm1_20120416(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4995,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>5018.5,1,'first'))),spolm2_20120416_OIII2contnormsub(spolm1_20120416>=spolm1_20120416(find(spolm1_20120416<4995,1,'last')) & spolm1_20120416<=spolm1_20120416(find(spolm1_20120416>5018.5,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_4_76.eps'], 'epsc');
eval(['!epstopdf OIII2_4_76.eps']);

clf
plot(Lkast1_20120428,Lkast2_20120428_OIII2contnormsub)
hold all
area(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<5000.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>5011.5,1,'first'))),Lkast2_20120428_OIII2contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<5000.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>5011.5,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_6_88.eps'], 'epsc');
eval(['!epstopdf OIII2_6_88.eps']);

clf
plot(keckL1_20120616,keckL2_20120616_OIII2contnormsub)
hold all
area(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))),keckL2_20120616_OIII2contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_8_137.eps'], 'epsc');
eval(['!epstopdf OIII2_8_137.eps']);

clf
plot(mmtbc1_20120701,mmtbc2_20120701_OIII2contnormsub)
hold all
area(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4999,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>5013.5,1,'first'))),mmtbc2_20120701_OIII2contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<4999,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>5013.5,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_9_152.eps'], 'epsc');
eval(['!epstopdf OIII2_9_152.eps']);

clf
plot(keckD1_20121115,keckD2_20121115_OIII2contnormsub)
hold all
area(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4997,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>5006,1,'first'))),keckD2_20121115_OIII2contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<4997,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>5006,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_10_289.eps'], 'epsc');
eval(['!epstopdf OIII2_10_289.eps']);



clf
plot(keckD1_20150521,keckD2_20150521_OIII2contnormsub)
hold all
area(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<4998,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>5017,1,'first'))),keckD2_20150521_OIII2contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<4998,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>5017,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_11_1206.eps'], 'epsc');
eval(['!epstopdf OIII2_11_1206.eps']);





clf
plot(hetms1_20120207,hetms2_20120207_OIII2contnormsub)
hold all
area(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4998,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>5017,1,'first'))),hetms2_20120207_OIII2contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4998,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>5017,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_12_7.eps'], 'epsc');
eval(['!epstopdf OIII2_12_7.eps']);

clf
plot(hetms1_20120216,hetms2_20120216_OIII2contnormsub)
hold all
area(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4998,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>5017,1,'first'))),hetms2_20120216_OIII2contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4998,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>5017,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_13_16.eps'], 'epsc');
eval(['!epstopdf OIII2_13_16.eps']);


clf
plot(hetms1_20120301,hetms2_20120301_OIII2contnormsub)
hold all
area(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4998,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>5017,1,'first'))),hetms2_20120301_OIII2contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4998,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>5017,1,'first'))));
xlim([4957,5057])
saveas(plotting, ['OIII2_14_30.eps'], 'epsc');
eval(['!epstopdf OIII2_14_30.eps']);




%check 6, 8, 13, 14

%NII 6548
NII1fitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120301<6538)|(mmtbc1_20120301>6558)|(mmtbc1_20120301>6543&mmtbc1_20120301<6553));
NII1fitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120417<6538)|(mmtbc1_20120417>6558)|(mmtbc1_20120417>6543&mmtbc1_20120417<6553));
NII1fitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120529<6538)|(mmtbc1_20120529>6558)|(mmtbc1_20120529>6543&mmtbc1_20120529<6553));
NII1fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<6538)|(keckL1_20120616>6558)|(keckL1_20120616>6543&keckL1_20120616<6553));
NII1fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<6538)|(mmtbc1_20120701>6558)|(mmtbc1_20120701>6543&mmtbc1_20120701<6553));
NII1fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<6538)|(keckD1_20121115>6558)|(keckD1_20121115>6543&keckD1_20121115<6553));
NII1fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<6538)|(keckD1_20150521>6558)|(keckD1_20150521>6543&keckD1_20150521<6553));


NII1norm_20120301 = mean(NII1fitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>6543)&(mmtbc1_20120301<6553))));
NII1norm_20120417 = mean(NII1fitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>6543)&(mmtbc1_20120417<6553))));
NII1norm_20120529 = mean(NII1fitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>6543)&(mmtbc1_20120529<6553))));
NII1norm_20120616 = mean(NII1fitkeckL2_20120616(keckL1_20120616((keckL1_20120616>6543)&(keckL1_20120616<6553))));
NII1norm_20121115 = mean(NII1fitkeckD2_20121115(keckD1_20121115((keckD1_20121115>6543)&(keckD1_20121115<6553))));
NII1norm_20150521 = mean(NII1fitkeckD2_20150521(keckD1_20150521((keckD1_20150521>6543)&(keckD1_20150521<6553))));


mmtbc2_20120301_NII1contnorm = mmtbc2_20120301/NII1norm_20120301;
mmtbc2_20120417_NII1contnorm = mmtbc2_20120417/NII1norm_20120417;
mmtbc2_20120529_NII1contnorm = mmtbc2_20120529/NII1norm_20120529;
keckL2_20120616_NII1contnorm = keckL2_20120616/NII1norm_20120616;
keckD2_20121115_NII1contnorm = keckD2_20121115/NII1norm_20121115;
keckD2_20150521_NII1contnorm = keckD2_20150521/NII1norm_20150521;


mmtbc2_20120301_NII1contnormsub = mmtbc2_20120301_NII1contnorm - 1;
mmtbc2_20120417_NII1contnormsub = mmtbc2_20120417_NII1contnorm - 1;
mmtbc2_20120529_NII1contnormsub = mmtbc2_20120529_NII1contnorm - 1;
keckL2_20120616_NII1contnormsub = keckL2_20120616_NII1contnorm - 1;
keckD2_20121115_NII1contnormsub = keckD2_20121115_NII1contnorm - 1;
keckD2_20150521_NII1contnormsub = keckD2_20150521_NII1contnorm - 1;

NII1(2) = NII1norm_20120301 * trapz(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6545.5,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6550,1,'first'))),mmtbc2_20120301_NII1contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6545.5,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6550,1,'first'))));
NII1(5) = NII1norm_20120417 * trapz(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6547,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6550,1,'first'))),mmtbc2_20120417_NII1contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6547,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6550,1,'first'))));
NII1(7) = NII1norm_20120529 * trapz(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6545.5,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6550,1,'first'))),mmtbc2_20120529_NII1contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6545.5,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6550,1,'first'))));
%NII1(8) = 10^-15 * NII1norm_20120616 * trapz(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))),keckL2_20120616_NII1contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))));
NII1(10) = NII1norm_20121115 * trapz(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6544,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6551,1,'first'))),keckD2_20121115_NII1contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6544,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6551,1,'first'))));
NII1(11) = NII1norm_20150521 * trapz(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6545,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6551,1,'first'))),keckD2_20150521_NII1contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6545,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6551,1,'first'))));


errNII1(2) =  NII1(2) * 1/2*5*std(mmtbc2_20120301_NII1contnormsub(mmtbc1_20120301>6200 & mmtbc1_20120301 < 6230));
errNII1(5) =  NII1(5) * 1/2*5*std(mmtbc2_20120417_NII1contnormsub(mmtbc1_20120417>6200 & mmtbc1_20120417 < 6230));
errNII1(7) =  NII1(7) * 1/2*5*std(mmtbc2_20120529_NII1contnormsub(mmtbc1_20120529>6200 & mmtbc1_20120529 < 6230));
%errNII1(8) = NII1(8) * 1/2*5*std(keckL2_20120616_NII1contnormsub(keckL1_20120616>6200 & keckL1_20120616 < 6230));
errNII1(10) = NII1(10)* 1/2*5*std(keckD2_20121115_NII1contnormsub(keckD1_20121115>6200 & keckD1_20121115 < 6230));
errNII1(11) = NII1(11)* 1/2*5*std(keckD2_20150521_NII1contnormsub(keckD1_20150521>6200 & keckD1_20150521 < 6230));



%NII1fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<5533)|(hetms1_20120207>6598)|(hetms1_20120207>6543&hetms1_20120207<6553));
%NII1norm_20120207 = mean(NII1fithetms2_20120207(hetms1_20120207((hetms1_20120207>6543)&(hetms1_20120207<6553))));
%hetms2_20120207_NII1contnorm = hetms2_20120207/NII1norm_20120207;
%hetms2_20120207_NII1contnormsub = hetms2_20120207_NII1contnorm - 1;
%NII1(12) =  NII1norm_20120207 * trapz(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4998,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6553,1,'first'))),hetms2_20120207_NII1contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<4998,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6553,1,'first'))));
%
%NII1fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<5533)|(hetms1_20120216>6598)|(hetms1_20120216>6543&hetms1_20120216<6553));
%NII1norm_20120216 = mean(NII1fithetms2_20120216(hetms1_20120216((hetms1_20120216>6543)&(hetms1_20120216<6553))));
%hetms2_20120216_NII1contnorm = hetms2_20120216/NII1norm_20120216;
%hetms2_20120216_NII1contnormsub = hetms2_20120216_NII1contnorm - 1;
%NII1(13) = NII1norm_20120216 * trapz(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4998,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6553,1,'first'))),hetms2_20120216_NII1contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<4998,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6553,1,'first'))));
%
%NII1fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<5533)|(hetms1_20120301>6598)|(hetms1_20120301>6543&hetms1_20120301<6553));
%NII1norm_20120301_2 = mean(NII1fithetms2_20120301(hetms1_20120301((hetms1_20120301>6543)&(hetms1_20120301<6553))));
%hetms2_20120301_NII1contnorm = hetms2_20120301/NII1norm_20120301_2;
%hetms2_20120301_NII1contnormsub = hetms2_20120301_NII1contnorm - 1;
%NII1(14) = NII1norm_20120301_2 * trapz(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4998,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6553,1,'first'))),hetms2_20120301_NII1contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<4998,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6553,1,'first'))));
%
%
%errNII1(12)= NII1(12) * 1/2*5*std(hetms2_20120207_NII1contnormsub(hetms1_20120207>5030 & hetms1_20120207 < 5050));
%errNII1(13)= NII1(13) * 1/2*5*std(hetms2_20120216_NII1contnormsub(hetms1_20120216>5030 & hetms1_20120216 < 5050));
%errNII1(14)= NII1(14) * 1/2*5*std(hetms2_20120301_NII1contnormsub(hetms1_20120301>5030 & hetms1_20120301 < 5050));




%clf
%plot(hetms1_20120207,hetms2_20120207_NII1contnormsub)
%hold all
%area(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6545,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6551,1,'first'))),hetms2_20120207_NII1contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6545,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6551,1,'first'))));
%xlim([6400,6700])
%saveas(plotting, ['NII1_12_7.eps'], 'epsc');
%eval(['!epstopdf NII1_12_7.eps']);











clf
plot(mmtbc1_20120301,mmtbc2_20120301_NII1contnormsub)
hold all
area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6545.5,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6550,1,'first'))),mmtbc2_20120301_NII1contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6545.5,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6550,1,'first'))));
xlim([6200,6558])
saveas(plotting, ['NII1_2_30.eps'], 'epsc');
eval(['!epstopdf NII1_2_30.eps']);

clf
plot(mmtbc1_20120417,mmtbc2_20120417_NII1contnormsub)
hold all
area(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6547,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6550,1,'first'))),mmtbc2_20120417_NII1contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6547,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6550,1,'first'))));
xlim([6200,6558])
saveas(plotting, ['NII1_5_77.eps'], 'epsc');
eval(['!epstopdf NII1_5_77.eps']);

clf
plot(mmtbc1_20120529,mmtbc2_20120529_NII1contnormsub)
hold all
area(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6545.5,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6550,1,'first'))),mmtbc2_20120529_NII1contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6545.5,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6550,1,'first'))));
xlim([6200,6558])
saveas(plotting, ['NII1_7_119.eps'], 'epsc');
eval(['!epstopdf NII1_7_119.eps']);

clf
plot(keckL1_20120616,keckL2_20120616_NII1contnormsub)
hold all
area(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))),keckL2_20120616_NII1contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<5001,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>5011.5,1,'first'))));
xlim([6200,6558])
saveas(plotting, ['NII1_8_137.eps'], 'epsc');
eval(['!epstopdf NII1_8_137.eps']);

clf
plot(keckD1_20121115,keckD2_20121115_NII1contnormsub)
hold all
area(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6544,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6551,1,'first'))),keckD2_20121115_NII1contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6544,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6551,1,'first'))));
xlim([6200,6558])
saveas(plotting, ['NII1_10_289.eps'], 'epsc');
eval(['!epstopdf NII1_10_289.eps']);



clf
plot(keckD1_20150521,keckD2_20150521_NII1contnormsub)
hold all
area(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6545,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6551,1,'first'))),keckD2_20150521_NII1contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6545,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6551,1,'first'))));
xlim([6500,6558])
saveas(plotting, ['NII1_11_1206.eps'], 'epsc');
eval(['!epstopdf NII1_11_1206.eps']);







%NII6583 
%exception here at the NII2(1) fit with only poly1 instead of poly3
%exception here at the NII2(6) fit with only poly1 instead of poly3 and different range
NII2fitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly1','Robust','Bisquare','Exclude',(Lkast1_20120223<6573)|(Lkast1_20120223>6593)|(Lkast1_20120223>6578&Lkast1_20120223<6588));
NII2fitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120301<6573)|(mmtbc1_20120301>6593)|(mmtbc1_20120301>6578&mmtbc1_20120301<6588));
NII2fitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120417<6573)|(mmtbc1_20120417>6593)|(mmtbc1_20120417>6578&mmtbc1_20120417<6588));
NII2fitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly1','Robust','Bisquare','Exclude',(Lkast1_20120428<6568)|(Lkast1_20120428>6598)|(Lkast1_20120428>6576&Lkast1_20120428<6590));
NII2fitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120529<6573)|(mmtbc1_20120529>6593)|(mmtbc1_20120529>6578&mmtbc1_20120529<6588));
NII2fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<6573)|(keckL1_20120616>6593)|(keckL1_20120616>6578&keckL1_20120616<6588));
NII2fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<6573)|(mmtbc1_20120701>6593)|(mmtbc1_20120701>6578&mmtbc1_20120701<6588));
NII2fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<6573)|(keckD1_20121115>6593)|(keckD1_20121115>6578&keckD1_20121115<6588));
NII2fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<6573)|(keckD1_20150521>6593)|(keckD1_20150521>6578&keckD1_20150521<6588));


NII2norm_20120223 = mean(NII2fitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>6578)&(Lkast1_20120223<6588))));
NII2norm_20120301 = mean(NII2fitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>6578)&(mmtbc1_20120301<6588))));
NII2norm_20120417 = mean(NII2fitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>6578)&(mmtbc1_20120417<6588))));
NII2norm_20120428 = mean(NII2fitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>6578)&(Lkast1_20120428<6588))));
NII2norm_20120529 = mean(NII2fitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>6578)&(mmtbc1_20120529<6588))));
NII2norm_20120616 = mean(NII2fitkeckL2_20120616(keckL1_20120616((keckL1_20120616>6578)&(keckL1_20120616<6588))));
NII2norm_20120701 = mean(NII2fitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>6578)&(mmtbc1_20120701<6588))));
NII2norm_20121115 = mean(NII2fitkeckD2_20121115(keckD1_20121115((keckD1_20121115>6578)&(keckD1_20121115<6588))));
NII2norm_20150521 = mean(NII2fitkeckD2_20150521(keckD1_20150521((keckD1_20150521>6578)&(keckD1_20150521<6588))));

Lkast2_20120223_NII2contnorm = Lkast2_20120223/NII2norm_20120223;
mmtbc2_20120301_NII2contnorm = mmtbc2_20120301/NII2norm_20120301;
mmtbc2_20120417_NII2contnorm = mmtbc2_20120417/NII2norm_20120417;
Lkast2_20120428_NII2contnorm = Lkast2_20120428/NII2norm_20120428;
mmtbc2_20120529_NII2contnorm = mmtbc2_20120529/NII2norm_20120529;
keckL2_20120616_NII2contnorm = keckL2_20120616/NII2norm_20120616;
mmtbc2_20120701_NII2contnorm = mmtbc2_20120701/NII2norm_20120701;
keckD2_20121115_NII2contnorm = keckD2_20121115/NII2norm_20121115;
keckD2_20150521_NII2contnorm = keckD2_20150521/NII2norm_20150521;

Lkast2_20120223_NII2contnormsub = Lkast2_20120223_NII2contnorm - 1;
mmtbc2_20120301_NII2contnormsub = mmtbc2_20120301_NII2contnorm - 1;
mmtbc2_20120417_NII2contnormsub = mmtbc2_20120417_NII2contnorm - 1;
Lkast2_20120428_NII2contnormsub = Lkast2_20120428_NII2contnorm - 1;
mmtbc2_20120529_NII2contnormsub = mmtbc2_20120529_NII2contnorm - 1;
keckL2_20120616_NII2contnormsub = keckL2_20120616_NII2contnorm - 1;
mmtbc2_20120701_NII2contnormsub = mmtbc2_20120701_NII2contnorm - 1;
keckD2_20121115_NII2contnormsub = keckD2_20121115_NII2contnorm - 1;
keckD2_20150521_NII2contnormsub = keckD2_20150521_NII2contnorm - 1;

NII2(1) = 10^-15 * NII2norm_20120223 * trapz(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6575.5,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6591,1,'first'))),Lkast2_20120223_NII2contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6575.5,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6591,1,'first'))));
NII2(2) = NII2norm_20120301          * trapz(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6580,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6585.5,1,'first'))),mmtbc2_20120301_NII2contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6580,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6585.5,1,'first'))));
NII2(5) = NII2norm_20120417          * trapz(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6581,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6586,1,'first'))),mmtbc2_20120417_NII2contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6581,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6586,1,'first'))));
NII2(6) = 10^-15 * NII2norm_20120428 * trapz(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6572,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6593,1,'first'))),Lkast2_20120428_NII2contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6572,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6593,1,'first'))));
NII2(7) = NII2norm_20120529          * trapz(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6582,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6587,1,'first'))),mmtbc2_20120529_NII2contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6582,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6587,1,'first'))));
NII2(8) = 10^-15 * NII2norm_20120616 * trapz(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6580,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6589,1,'first'))),keckL2_20120616_NII2contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6580,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6589,1,'first'))));
NII2(9) = NII2norm_20120701          * trapz(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6579,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6590,1,'first'))),mmtbc2_20120701_NII2contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6579,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6590,1,'first'))));
NII2(10) = NII2norm_20121115         * trapz(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6579.5,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6587,1,'first'))),keckD2_20121115_NII2contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6579.5,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6587,1,'first'))));
NII2(11) = NII2norm_20150521         * trapz(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6579.5,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6587,1,'first'))),keckD2_20150521_NII2contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6579.5,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6587,1,'first'))));

errNII2(1) =  NII2(1)  * 1/2*5*std(Lkast2_20120223_NII2contnormsub(Lkast1_20120223>6680 & Lkast1_20120223 < 6700));
errNII2(2) =  NII2(2)  * 1/2*5*std(mmtbc2_20120301_NII2contnormsub(mmtbc1_20120301>6680 & mmtbc1_20120301 < 6700));
errNII2(5) =  NII2(5)  * 1/2*5*std(mmtbc2_20120417_NII2contnormsub(mmtbc1_20120417>6680 & mmtbc1_20120417 < 6700));
errNII2(6) =  NII2(6)  * 1/2*5*std(Lkast2_20120428_NII2contnormsub(Lkast1_20120428>6680 & Lkast1_20120428 < 6700));
errNII2(7) =  NII2(7)  * 1/2*5*std(mmtbc2_20120529_NII2contnormsub(mmtbc1_20120529>6680 & mmtbc1_20120529 < 6700));
errNII2(8) =  NII2(8)  * 1/2*5*std(keckL2_20120616_NII2contnormsub(keckL1_20120616>6680 & keckL1_20120616 < 6700));
errNII2(9) =  NII2(9)  * 1/2*5*std(mmtbc2_20120701_NII2contnormsub(mmtbc1_20120701>6680 & mmtbc1_20120701 < 6700));
errNII2(10) = NII2(10) * 1/2*5*std(keckD2_20121115_NII2contnormsub(keckD1_20121115>6680 & keckD1_20121115 < 6700));
errNII2(11) = NII2(11) * 1/2*5*std(keckD2_20150521_NII2contnormsub(keckD1_20150521>6680 & keckD1_20150521 < 6700));

%%weird mean fitting
%NII2fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<6568)|(hetms1_20120207>6598)|(hetms1_20120207>6578&hetms1_20120207<6588));
%%NII2norm_20120207 = mean(NII2fithetms2_20120207(hetms1_20120207((hetms1_20120207>6578)&(hetms1_20120207<6588))));
%NII2norm_20120207 = 3.77*10^-15;
%hetms2_20120207_NII2contnorm = hetms2_20120207/NII2norm_20120207;
%hetms2_20120207_NII2contnormsub = hetms2_20120207_NII2contnorm - 1;
%NII2(12) =  NII2norm_20120207 * trapz(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6579.5,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6587,1,'first'))),hetms2_20120207_NII2contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6579.5,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6587,1,'first'))));
%
%NII2fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<6568)|(hetms1_20120216>6598)|(hetms1_20120216>6578&hetms1_20120216<6588));
%%NII2norm_20120216 = mean(NII2fithetms2_20120216(hetms1_20120216((hetms1_20120216>6578)&(hetms1_20120216<6588))));
%NII2norm_20120216 = 2.18*10^(-15);
%hetms2_20120216_NII2contnorm = hetms2_20120216/NII2norm_20120216;
%hetms2_20120216_NII2contnormsub = hetms2_20120216_NII2contnorm - 1;
%NII2(13) = NII2norm_20120216 * trapz(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6579.5,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6587,1,'first'))),hetms2_20120216_NII2contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6579.5,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6587,1,'first'))));
%
%NII2fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<6568)|(hetms1_20120301>6598)|(hetms1_20120301>6578&hetms1_20120301<6588));
%%NII2norm_20120301_2 = mean(NII2fithetms2_20120301(hetms1_20120301((hetms1_20120301>6578)&(hetms1_20120301<6588))));
%NII2norm_20120301_2 = 7.2*10^(-15);
%hetms2_20120301_NII2contnorm = hetms2_20120301/NII2norm_20120301_2;
%hetms2_20120301_NII2contnormsub = hetms2_20120301_NII2contnorm - 1;
%NII2(14) = NII2norm_20120301_2 * trapz(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6579.5,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6587,1,'first'))),hetms2_20120301_NII2contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6579.5,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6587,1,'first'))));
%
%
%errNII2(12)= NII2(12) * 1/2*5*std(hetms2_20120207_NII2contnormsub(hetms1_20120207>6680 & hetms1_20120207 < 6700));
%errNII2(13)= NII2(13) * 1/2*5*std(hetms2_20120216_NII2contnormsub(hetms1_20120216>6680 & hetms1_20120216 < 6700));
%errNII2(14)= NII2(14) * 1/2*5*std(hetms2_20120301_NII2contnormsub(hetms1_20120301>6680 & hetms1_20120301 < 6700));
%


%clf
%plot(hetms1_20120301,hetms2_20120301_NII2contnormsub)
%hold all
%area(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6579.5,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6587,1,'first'))),hetms2_20120301_NII2contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6579.5,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6587,1,'first'))));
%xlim([6573,6593])
%saveas(plotting, ['NII2_10_1206.eps'], 'epsc');
%eval(['!epstopdf NII2_10_1206.eps']);
%
%
%
%clf
%plot(hetms1_20120207,hetms2_20120207_NII2contnormsub)
%hold all
%area(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6579.5,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6587,1,'first'))),hetms2_20120207_NII2contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6579.5,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6587,1,'first'))));
%xlim([6573,6593])
%saveas(plotting, ['NII2_10_1206.eps'], 'epsc');
%eval(['!epstopdf NII2_10_1206.eps']);






clf
plot(Lkast1_20120223,Lkast2_20120223_NII2contnormsub)
hold all
area(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6575.5,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6591,1,'first'))),Lkast2_20120223_NII2contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6575.5,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6591,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_1_23.eps'], 'epsc');
eval(['!epstopdf NII2_1_23.eps']);

clf
plot(mmtbc1_20120301,mmtbc2_20120301_NII2contnormsub)
hold all
area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6580,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6585.5,1,'first'))),mmtbc2_20120301_NII2contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6580,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6585.5,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_2_30.eps'], 'epsc');
eval(['!epstopdf NII2_2_30.eps']);

clf
plot(mmtbc1_20120417,mmtbc2_20120417_NII2contnormsub)
hold all
area(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6581,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6586,1,'first'))),mmtbc2_20120417_NII2contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6581,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6586,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_5_77.eps'], 'epsc');
eval(['!epstopdf NII2_5_77.eps']);

clf
plot(Lkast1_20120428,Lkast2_20120428_NII2contnormsub)
hold all
area(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6572,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6593,1,'first'))),Lkast2_20120428_NII2contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6572,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6593,1,'first'))));
xlim([6568,6800])
saveas(plotting, ['NII2_6_88.eps'], 'epsc');
eval(['!epstopdf NII2_6_88.eps']);

clf
plot(mmtbc1_20120529,mmtbc2_20120529_NII2contnormsub)
hold all
area(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6582,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6587,1,'first'))),mmtbc2_20120529_NII2contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6582,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6587,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_7_119.eps'], 'epsc');
eval(['!epstopdf NII2_7_119.eps']);

clf
plot(keckL1_20120616,keckL2_20120616_NII2contnormsub)
hold all
area(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6580,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6589,1,'first'))),keckL2_20120616_NII2contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6580,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6589,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_8_137.eps'], 'epsc');
eval(['!epstopdf NII2_8_137.eps']);

clf
plot(mmtbc1_20120701,mmtbc2_20120701_NII2contnormsub)
hold all
area(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6579,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6590,1,'first'))),mmtbc2_20120701_NII2contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6579,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6590,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_9_152.eps'], 'epsc');
eval(['!epstopdf NII2_9_152.eps']);

clf
plot(keckD1_20121115,keckD2_20121115_NII2contnormsub)
hold all
area(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6579.5,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6587,1,'first'))),keckD2_20121115_NII2contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6579.5,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6587,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_10_289.eps'], 'epsc');
eval(['!epstopdf NII2_10_289.eps']);



clf
plot(keckD1_20150521,keckD2_20150521_NII2contnormsub)
hold all
area(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6579.5,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6587,1,'first'))),keckD2_20150521_NII2contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6579.5,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6587,1,'first'))));
xlim([6573,6800])
saveas(plotting, ['NII2_11_1206.eps'], 'epsc');
eval(['!epstopdf NII2_11_1206.eps']);




%check 3,4 

%SII6717
%SII1(1) uses poly1 and different range
%SII1(6) uses poly1 and different range
SII1fitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly1','Robust','Bisquare','Exclude',(Lkast1_20120223<6704)|(Lkast1_20120223>6709)|(Lkast1_20120223>6712&Lkast1_20120223<6722));
SII1fitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120301<6707)|(mmtbc1_20120301>6727)|(mmtbc1_20120301>6712&mmtbc1_20120301<6722));
SII1fitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120417<6707)|(mmtbc1_20120417>6727)|(mmtbc1_20120417>6712&mmtbc1_20120417<6722));
SII1fitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly1','Robust','Bisquare','Exclude',(Lkast1_20120428<6700)|(Lkast1_20120428>6710)|(Lkast1_20120428>6712&Lkast1_20120428<6722));
SII1fitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120529<6707)|(mmtbc1_20120529>6727)|(mmtbc1_20120529>6712&mmtbc1_20120529<6722));
SII1fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<6707)|(keckL1_20120616>6727)|(keckL1_20120616>6712&keckL1_20120616<6722));
SII1fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<6707)|(mmtbc1_20120701>6727)|(mmtbc1_20120701>6712&mmtbc1_20120701<6722));
SII1fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<6707)|(keckD1_20121115>6727)|(keckD1_20121115>6712&keckD1_20121115<6722));
SII1fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<6707)|(keckD1_20150521>6727)|(keckD1_20150521>6712&keckD1_20150521<6722));

SII1norm_20120223 = mean(SII1fitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>6712)&(Lkast1_20120223<6722))));
SII1norm_20120301 = mean(SII1fitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>6712)&(mmtbc1_20120301<6722))));
SII1norm_20120417 = mean(SII1fitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>6712)&(mmtbc1_20120417<6722))));
SII1norm_20120428 = mean(SII1fitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>6712)&(Lkast1_20120428<6722))));
SII1norm_20120529 = mean(SII1fitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>6712)&(mmtbc1_20120529<6722))));
SII1norm_20120616 = mean(SII1fitkeckL2_20120616(keckL1_20120616((keckL1_20120616>6712)&(keckL1_20120616<6722))));
SII1norm_20120701 = mean(SII1fitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>6712)&(mmtbc1_20120701<6722))));
SII1norm_20121115 = mean(SII1fitkeckD2_20121115(keckD1_20121115((keckD1_20121115>6712)&(keckD1_20121115<6722))));
SII1norm_20150521 = mean(SII1fitkeckD2_20150521(keckD1_20150521((keckD1_20150521>6712)&(keckD1_20150521<6722))));


Lkast2_20120223_SII1contnorm = Lkast2_20120223/SII1norm_20120223;
mmtbc2_20120301_SII1contnorm = mmtbc2_20120301/SII1norm_20120301;
mmtbc2_20120417_SII1contnorm = mmtbc2_20120417/SII1norm_20120417;
Lkast2_20120428_SII1contnorm = Lkast2_20120428/SII1norm_20120428;
mmtbc2_20120529_SII1contnorm = mmtbc2_20120529/SII1norm_20120529;
keckL2_20120616_SII1contnorm = keckL2_20120616/SII1norm_20120616;
mmtbc2_20120701_SII1contnorm = mmtbc2_20120701/SII1norm_20120701;
keckD2_20121115_SII1contnorm = keckD2_20121115/SII1norm_20121115;
keckD2_20150521_SII1contnorm = keckD2_20150521/SII1norm_20150521;

Lkast2_20120223_SII1contnormsub = Lkast2_20120223_SII1contnorm - 1;
mmtbc2_20120301_SII1contnormsub = mmtbc2_20120301_SII1contnorm - 1;
mmtbc2_20120417_SII1contnormsub = mmtbc2_20120417_SII1contnorm - 1;
Lkast2_20120428_SII1contnormsub = Lkast2_20120428_SII1contnorm - 1;
mmtbc2_20120529_SII1contnormsub = mmtbc2_20120529_SII1contnorm - 1;
keckL2_20120616_SII1contnormsub = keckL2_20120616_SII1contnorm - 1;
mmtbc2_20120701_SII1contnormsub = mmtbc2_20120701_SII1contnorm - 1;
keckD2_20121115_SII1contnormsub = keckD2_20121115_SII1contnorm - 1;
keckD2_20150521_SII1contnormsub = keckD2_20150521_SII1contnorm - 1;

SII1(1) = 10^-15 * SII1norm_20120223 * trapz(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6707,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6724.5,1,'first'))),Lkast2_20120223_SII1contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6707,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6724.5,1,'first'))));
SII1(2) = SII1norm_20120301 * trapz(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6714,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6718,1,'first'))),mmtbc2_20120301_SII1contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6714,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6718,1,'first'))));
SII1(5) = SII1norm_20120417 * trapz(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6714.5,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6719,1,'first'))),mmtbc2_20120417_SII1contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6714.5,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6719,1,'first'))));
SII1(6) = 10^-15 * SII1norm_20120428 * trapz(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6709.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6721,1,'first'))),Lkast2_20120428_SII1contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6709.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6721,1,'first'))));
SII1(7) = SII1norm_20120529 * trapz(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6714,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6720,1,'first'))),mmtbc2_20120529_SII1contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6714,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6720,1,'first'))));
SII1(8) = 10^-15 * SII1norm_20120616 * trapz(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6710,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6723,1,'first'))),keckL2_20120616_SII1contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6710,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6723,1,'first'))));
SII1(9) = SII1norm_20120701 * trapz(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6713,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6720,1,'first'))),mmtbc2_20120701_SII1contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6713,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6720,1,'first'))));
SII1(10) = SII1norm_20121115 * trapz(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6712,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6720,1,'first'))),keckD2_20121115_SII1contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6712,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6720,1,'first'))));
SII1(11) = SII1norm_20150521 * trapz(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6713,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6721,1,'first'))),keckD2_20150521_SII1contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6713,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6721,1,'first'))));




%SII1fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<6662)|(hetms1_20120207>6767)|(hetms1_20120207>6697&hetms1_20120207<6740));
%SII1norm_20120207 = mean(SII1fithetms2_20120207(hetms1_20120207((hetms1_20120207>6697)&(hetms1_20120207<6740))));
%hetms2_20120207_SII1contnorm = hetms2_20120207/SII1norm_20120207;
%hetms2_20120207_SII1contnormsub = hetms2_20120207_SII1contnorm - 1;
%SII1(12) =  SII1norm_20120207 * trapz(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6694,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6740,1,'first'))),hetms2_20120207_SII1contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6694,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6740,1,'first'))));
%
%SII1fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<6662)|(hetms1_20120216>6767)|(hetms1_20120216>6697&hetms1_20120216<6740));
%SII1norm_20120216 = mean(SII1fithetms2_20120216(hetms1_20120216((hetms1_20120216>6697)&(hetms1_20120216<6740))));
%hetms2_20120216_SII1contnorm = hetms2_20120216/SII1norm_20120216;
%hetms2_20120216_SII1contnormsub = hetms2_20120216_SII1contnorm - 1;
%SII1(13) = SII1norm_20120216 * trapz(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6702,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6740,1,'first'))),hetms2_20120216_SII1contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6702,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6740,1,'first'))));
%
%SII1fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<6662)|(hetms1_20120301>6767)|(hetms1_20120301>6697&hetms1_20120301<6737));
%SII1norm_20120301_2 = mean(SII1fithetms2_20120301(hetms1_20120301((hetms1_20120301>6697)&(hetms1_20120301<6740))));
%hetms2_20120301_SII1contnorm = hetms2_20120301/SII1norm_20120301_2;
%hetms2_20120301_SII1contnormsub = hetms2_20120301_SII1contnorm - 1;
%SII1(14) = SII1norm_20120301_2 * trapz(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))),hetms2_20120301_SII1contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))));
%
%
%errSII1(12)= SII1(12) * 1/2*5*std(hetms2_20120207_SII1contnormsub(hetms1_20120207>6680 & hetms1_20120207 < 6700));
%errSII1(13)= SII1(13) * 1/2*5*std(hetms2_20120216_SII1contnormsub(hetms1_20120216>6680 & hetms1_20120216 < 6700));
%errSII1(14)= SII1(14) * 1/2*5*std(hetms2_20120301_SII1contnormsub(hetms1_20120301>6680 & hetms1_20120301 < 6700));





errSII1(1) = SII1(1)  * 1/2*5*std(Lkast2_20120223_SII1contnormsub(Lkast1_20120223>6680 & Lkast1_20120223 < 6700));
errSII1(2) = SII1(2)  * 1/2*5*std(mmtbc2_20120301_SII1contnormsub(mmtbc1_20120301>6680 & mmtbc1_20120301 < 6700));
errSII1(5) = SII1(5)  * 1/2*5*std(mmtbc2_20120417_SII1contnormsub(mmtbc1_20120417>6680 & mmtbc1_20120417 < 6700));
errSII1(6) = SII1(6)  * 1/2*5*std(Lkast2_20120428_SII1contnormsub(Lkast1_20120428>6680 & Lkast1_20120428 < 6700));
errSII1(7) = SII1(7)  * 1/2*5*std(mmtbc2_20120529_SII1contnormsub(mmtbc1_20120529>6680 & mmtbc1_20120529 < 6700));
errSII1(8) = SII1(8)  * 1/2*5*std(keckL2_20120616_SII1contnormsub(keckL1_20120616>6680 & keckL1_20120616 < 6700));
errSII1(9) = SII1(9)  * 1/2*5*std(mmtbc2_20120701_SII1contnormsub(mmtbc1_20120701>6680 & mmtbc1_20120701 < 6700));
errSII1(10)= SII1(10) * 1/2*5*std(keckD2_20121115_SII1contnormsub(keckD1_20121115>6680 & keckD1_20121115 < 6700));
errSII1(11)= SII1(11) * 1/2*5*std(keckD2_20150521_SII1contnormsub(keckD1_20150521>6680 & keckD1_20150521 < 6700));


clf
plot(Lkast1_20120223,Lkast2_20120223_SII1contnormsub)
hold all
area(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6707,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6724.5,1,'first'))),Lkast2_20120223_SII1contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6707,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6724.5,1,'first'))));
xlim([6600,6726])
saveas(plotting, ['SII1_1_23.eps'], 'epsc');
eval(['!epstopdf SII1_1_23.eps']);

clf
plot(mmtbc1_20120301,mmtbc2_20120301_SII1contnormsub)
hold all
area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6714,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6718,1,'first'))),mmtbc2_20120301_SII1contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6714,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6718,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_2_30.eps'], 'epsc');
eval(['!epstopdf SII1_2_30.eps']);

clf
plot(mmtbc1_20120417,mmtbc2_20120417_SII1contnormsub)
hold all
area(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6714.5,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6719,1,'first'))),mmtbc2_20120417_SII1contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6714.5,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6719,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_5_77.eps'], 'epsc');
eval(['!epstopdf SII1_5_77.eps']);

clf
plot(Lkast1_20120428,Lkast2_20120428_SII1contnormsub)
hold all
area(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6709.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6721,1,'first'))),Lkast2_20120428_SII1contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6709.5,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6721,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_6_88.eps'], 'epsc');
eval(['!epstopdf SII1_6_88.eps']);

clf
plot(mmtbc1_20120529,mmtbc2_20120529_SII1contnormsub)
hold all
area(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6714,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6720,1,'first'))),mmtbc2_20120529_SII1contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6714,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6720,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_7_119.eps'], 'epsc');
eval(['!epstopdf SII1_7_119.eps']);

clf
plot(keckL1_20120616,keckL2_20120616_SII1contnormsub)
hold all
area(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6710,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6723,1,'first'))),keckL2_20120616_SII1contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6710,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6723,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_8_137.eps'], 'epsc');
eval(['!epstopdf SII1_8_137.eps']);

clf
plot(mmtbc1_20120701,mmtbc2_20120701_SII1contnormsub)
hold all
area(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6713,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6720,1,'first'))),mmtbc2_20120701_SII1contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6713,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6720,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_9_152.eps'], 'epsc');
eval(['!epstopdf SII1_9_152.eps']);

clf
plot(keckD1_20121115,keckD2_20121115_SII1contnormsub)
hold all
area(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6712,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6720,1,'first'))),keckD2_20121115_SII1contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6712,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6720,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_10_289.eps'], 'epsc');
eval(['!epstopdf SII1_10_289.eps']);



clf
plot(keckD1_20150521,keckD2_20150521_SII1contnormsub)
hold all
area(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6714,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6722,1,'first'))),keckD2_20150521_SII1contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6714,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6722,1,'first'))));
xlim([6600,6727])
saveas(plotting, ['SII1_11_1206.eps'], 'epsc');
eval(['!epstopdf SII1_11_1206.eps']);




%clf
%plot(hetms1_20120207,hetms2_20120207_SII1contnormsub)
%hold all
%area(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6694,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6740,1,'first'))),hetms2_20120207_SII1contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6694,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6740,1,'first'))));
%xlim([6600,6800])
%saveas(plotting, ['SII1_12_7.eps'], 'epsc');
%eval(['!epstopdf SII1_12_7.eps']);
%
%
%
%clf
%plot(hetms1_20120216,hetms2_20120216_SII1contnormsub)
%hold all
%area(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6702,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6740,1,'first'))),hetms2_20120216_SII1contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6702,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6740,1,'first'))));
%xlim([6600,6800])
%saveas(plotting, ['SII1_13_16.eps'], 'epsc');
%eval(['!epstopdf SII1_13_16.eps']);
%
%
%
%clf
%plot(hetms1_20120301,hetms2_20120301_SII1contnormsub)
%hold all
%area(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))),hetms2_20120301_SII1contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))));
%xlim([6600,6800])
%saveas(plotting, ['SII1_14_30.eps'], 'epsc');
%eval(['!epstopdf SII1_14_30.eps']);
%




%check 3,4 

%SII6731
%SII2(1) uses poly1 and different range
%SII2(6) uses poly1 and different range
SII2fitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly1','Robust','Bisquare','Exclude',(Lkast1_20120223<6736)|(Lkast1_20120223>6771)|(Lkast1_20120223>6726&Lkast1_20120223<6736));
SII2fitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly1','Robust','Bisquare','Exclude',(mmtbc1_20120301<6722)|(mmtbc1_20120301>6740)|(mmtbc1_20120301>6726&mmtbc1_20120301<6736));
SII2fitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120417<6722)|(mmtbc1_20120417>6740)|(mmtbc1_20120417>6726&mmtbc1_20120417<6736));
SII2fitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly1','Robust','Bisquare','Exclude',(Lkast1_20120428<6741)|(Lkast1_20120428>6772)|(Lkast1_20120428>6745&Lkast1_20120428<6760));
SII2fitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120529<6722)|(mmtbc1_20120529>6740)|(mmtbc1_20120529>6726&mmtbc1_20120529<6736));
SII2fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly1','Robust','Bisquare','Exclude',(keckL1_20120616<6740)|(keckL1_20120616>6790)|(keckL1_20120616>6726&keckL1_20120616<6736));
SII2fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<6722)|(mmtbc1_20120701>6740)|(mmtbc1_20120701>6726&mmtbc1_20120701<6736));
SII2fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<6722)|(keckD1_20121115>6740)|(keckD1_20121115>6726&keckD1_20121115<6736));
SII2fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<6722)|(keckD1_20150521>6740)|(keckD1_20150521>6726&keckD1_20150521<6736));


SII2norm_20120223 = mean(SII2fitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>6726)&(Lkast1_20120223<6736))));
SII2norm_20120301 = mean(SII2fitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>6726)&(mmtbc1_20120301<6736))));
SII2norm_20120417 = mean(SII2fitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>6726)&(mmtbc1_20120417<6736))));
SII2norm_20120428 = mean(SII2fitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>6726)&(Lkast1_20120428<6736))));
SII2norm_20120529 = mean(SII2fitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>6726)&(mmtbc1_20120529<6736))));
SII2norm_20120616 = mean(SII2fitkeckL2_20120616(keckL1_20120616((keckL1_20120616>6726)&(keckL1_20120616<6736))));
SII2norm_20120701 = mean(SII2fitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>6726)&(mmtbc1_20120701<6736))));
SII2norm_20121115 = mean(SII2fitkeckD2_20121115(keckD1_20121115((keckD1_20121115>6726)&(keckD1_20121115<6736))));
SII2norm_20150521 = mean(SII2fitkeckD2_20150521(keckD1_20150521((keckD1_20150521>6726)&(keckD1_20150521<6736))));


Lkast2_20120223_SII2contnorm = Lkast2_20120223/SII2norm_20120223;
mmtbc2_20120301_SII2contnorm = mmtbc2_20120301/SII2norm_20120301;
mmtbc2_20120417_SII2contnorm = mmtbc2_20120417/SII2norm_20120417;
Lkast2_20120428_SII2contnorm = Lkast2_20120428/SII2norm_20120428;
mmtbc2_20120529_SII2contnorm = mmtbc2_20120529/SII2norm_20120529;
keckL2_20120616_SII2contnorm = keckL2_20120616/SII2norm_20120616;
mmtbc2_20120701_SII2contnorm = mmtbc2_20120701/SII2norm_20120701;
keckD2_20121115_SII2contnorm = keckD2_20121115/SII2norm_20121115;
keckD2_20150521_SII2contnorm = keckD2_20150521/SII2norm_20150521;


Lkast2_20120223_SII2contnormsub = Lkast2_20120223_SII2contnorm - 1;
mmtbc2_20120301_SII2contnormsub = mmtbc2_20120301_SII2contnorm - 1;
mmtbc2_20120417_SII2contnormsub = mmtbc2_20120417_SII2contnorm - 1;
Lkast2_20120428_SII2contnormsub = Lkast2_20120428_SII2contnorm - 1;
mmtbc2_20120529_SII2contnormsub = mmtbc2_20120529_SII2contnorm - 1;
keckL2_20120616_SII2contnormsub = keckL2_20120616_SII2contnorm - 1;
mmtbc2_20120701_SII2contnormsub = mmtbc2_20120701_SII2contnorm - 1;
keckD2_20121115_SII2contnormsub = keckD2_20121115_SII2contnorm - 1;
keckD2_20150521_SII2contnormsub = keckD2_20150521_SII2contnorm - 1;

SII2(1) = 10^-15 * SII2norm_20120223 * trapz(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6725,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6739,1,'first'))),Lkast2_20120223_SII2contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6725,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6739,1,'first'))));
SII2(2) = SII2norm_20120301 * trapz(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6728,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6732.5,1,'first'))),mmtbc2_20120301_SII2contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6728,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6732.5,1,'first'))));
SII2(5) = SII2norm_20120417 * trapz(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6729,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6732.5,1,'first'))),mmtbc2_20120417_SII2contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6729,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6732.5,1,'first'))));
SII2(6) = 10^-15 * SII2norm_20120428 * trapz(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6723,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6743,1,'first'))),Lkast2_20120428_SII2contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6723,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6743,1,'first'))));
SII2(7) = SII2norm_20120529 * trapz(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6729,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6734,1,'first'))),mmtbc2_20120529_SII2contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6729,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6734,1,'first'))));
SII2(8) = 10^-15 * SII2norm_20120616 * trapz(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6727,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6737,1,'first'))),keckL2_20120616_SII2contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6727,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6737,1,'first'))));
SII2(9) = SII2norm_20120701 * trapz(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6724,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6736,1,'first'))),mmtbc2_20120701_SII2contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6724,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6736,1,'first'))));
SII2(10) = SII2norm_20121115 * trapz(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6727,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6734,1,'first'))),keckD2_20121115_SII2contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6727,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6734,1,'first'))));
SII2(11) = SII2norm_20150521 * trapz(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6726,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6735,1,'first'))),keckD2_20150521_SII2contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6726,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6735,1,'first'))));





%SII2fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<6662)|(hetms1_20120207>6767)|(hetms1_20120207>6697&hetms1_20120207<6740));
%SII2norm_20120207 = mean(SII2fithetms2_20120207(hetms1_20120207((hetms1_20120207>6697)&(hetms1_20120207<6740))));
%hetms2_20120207_SII2contnorm = hetms2_20120207/SII2norm_20120207;
%hetms2_20120207_SII2contnormsub = hetms2_20120207_SII2contnorm - 1;
%SII2(12) =  SII2norm_20120207 * trapz(hetms1_20120207(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6694,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6740,1,'first'))),hetms2_20120207_SII2contnormsub(hetms1_20120207>=hetms1_20120207(find(hetms1_20120207<6694,1,'last')) & hetms1_20120207<=hetms1_20120207(find(hetms1_20120207>6740,1,'first'))));
%
%SII2fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<6662)|(hetms1_20120216>6767)|(hetms1_20120216>6697&hetms1_20120216<6740));
%SII2norm_20120216 = mean(SII2fithetms2_20120216(hetms1_20120216((hetms1_20120216>6697)&(hetms1_20120216<6740))));
%hetms2_20120216_SII2contnorm = hetms2_20120216/SII2norm_20120216;
%hetms2_20120216_SII2contnormsub = hetms2_20120216_SII2contnorm - 1;
%SII2(13) = SII2norm_20120216 * trapz(hetms1_20120216(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6702,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6740,1,'first'))),hetms2_20120216_SII2contnormsub(hetms1_20120216>=hetms1_20120216(find(hetms1_20120216<6702,1,'last')) & hetms1_20120216<=hetms1_20120216(find(hetms1_20120216>6740,1,'first'))));
%
%SII2fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<6662)|(hetms1_20120301>6767)|(hetms1_20120301>6697&hetms1_20120301<6737));
%SII2norm_20120301_2 = mean(SII2fithetms2_20120301(hetms1_20120301((hetms1_20120301>6697)&(hetms1_20120301<6740))));
%hetms2_20120301_SII2contnorm = hetms2_20120301/SII2norm_20120301_2;
%hetms2_20120301_SII2contnormsub = hetms2_20120301_SII2contnorm - 1;
%SII2(14) = SII2norm_20120301_2 * trapz(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))),hetms2_20120301_SII2contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))));
%
%
%errSII2(12)= SII2(12) * 1/2*5*std(hetms2_20120207_SII2contnormsub(hetms1_20120207>6680 & hetms1_20120207 < 6700));
%errSII2(13)= SII2(13) * 1/2*5*std(hetms2_20120216_SII2contnormsub(hetms1_20120216>6680 & hetms1_20120216 < 6700));
%errSII2(14)= SII2(14) * 1/2*5*std(hetms2_20120301_SII2contnormsub(hetms1_20120301>6680 & hetms1_20120301 < 6700));
%


%clf
%plot(hetms1_20120301,hetms2_20120301_SII1contnormsub)
%hold all
%area(hetms1_20120301(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))),hetms2_20120301_SII1contnormsub(hetms1_20120301>=hetms1_20120301(find(hetms1_20120301<6702,1,'last')) & hetms1_20120301<=hetms1_20120301(find(hetms1_20120301>6740,1,'first'))));
%xlim([6600,6800])
%saveas(plotting, ['SII1_10_1206.eps'], 'epsc');
%eval(['!epstopdf SII1_10_1206.eps']);
%













errSII2(1) = SII2(1)  * 1/2*5*std(Lkast2_20120223_SII2contnormsub(Lkast1_20120223>6770 & Lkast1_20120223 < 6790));
errSII2(2) = SII2(2)  * 1/2*5*std(mmtbc2_20120301_SII2contnormsub(mmtbc1_20120301>6770 & mmtbc1_20120301 < 6790));
errSII2(5) = SII2(5)  * 1/2*5*std(mmtbc2_20120417_SII2contnormsub(mmtbc1_20120417>6770 & mmtbc1_20120417 < 6790));
errSII2(6) = SII2(6)  * 1/2*5*std(Lkast2_20120428_SII2contnormsub(Lkast1_20120428>6770 & Lkast1_20120428 < 6790));
errSII2(7) = SII2(7)  * 1/2*5*std(mmtbc2_20120529_SII2contnormsub(mmtbc1_20120529>6770 & mmtbc1_20120529 < 6790));
errSII2(8) = SII2(8)  * 1/2*5*std(keckL2_20120616_SII2contnormsub(keckL1_20120616>6770 & keckL1_20120616 < 6790));
errSII2(9) = SII2(9)  * 1/2*5*std(mmtbc2_20120701_SII2contnormsub(mmtbc1_20120701>6770 & mmtbc1_20120701 < 6790));
errSII2(10)= SII2(10) * 1/2*5*std(keckD2_20121115_SII2contnormsub(keckD1_20121115>6770 & keckD1_20121115 < 6790));
errSII2(11)= SII2(11) * 1/2*5*std(keckD2_20150521_SII2contnormsub(keckD1_20150521>6770 & keckD1_20150521 < 6790));


clf
plot(Lkast1_20120223,Lkast2_20120223_SII2contnormsub)
hold all
area(Lkast1_20120223(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6725,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6740,1,'first'))),Lkast2_20120223_SII2contnormsub(Lkast1_20120223>=Lkast1_20120223(find(Lkast1_20120223<6725,1,'last')) & Lkast1_20120223<=Lkast1_20120223(find(Lkast1_20120223>6740,1,'first'))));
xlim([6722,6850])
saveas(plotting, ['SII2_1_23.eps'], 'epsc');
eval(['!epstopdf SII2_1_23.eps']);

clf
plot(mmtbc1_20120301,mmtbc2_20120301_SII2contnormsub)
hold all
area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6728,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6732.5,1,'first'))),mmtbc2_20120301_SII2contnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<6728,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>6732.5,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_2_30.eps'], 'epsc');
eval(['!epstopdf SII2_2_30.eps']);

clf
plot(mmtbc1_20120417,mmtbc2_20120417_SII2contnormsub)
hold all
area(mmtbc1_20120417(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6729,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6732.5,1,'first'))),mmtbc2_20120417_SII2contnormsub(mmtbc1_20120417>=mmtbc1_20120417(find(mmtbc1_20120417<6729,1,'last')) & mmtbc1_20120417<=mmtbc1_20120417(find(mmtbc1_20120417>6732.5,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_5_77.eps'], 'epsc');
eval(['!epstopdf SII2_5_77.eps']);
eval(['!epstopdf SII2_5_77.eps']);

clf
plot(Lkast1_20120428,Lkast2_20120428_SII2contnormsub)
hold all
area(Lkast1_20120428(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6723,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6743,1,'first'))),Lkast2_20120428_SII2contnormsub(Lkast1_20120428>=Lkast1_20120428(find(Lkast1_20120428<6723,1,'last')) & Lkast1_20120428<=Lkast1_20120428(find(Lkast1_20120428>6743,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_6_88.eps'], 'epsc');
eval(['!epstopdf SII2_6_88.eps']);

clf
plot(mmtbc1_20120529,mmtbc2_20120529_SII2contnormsub)
hold all
area(mmtbc1_20120529(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6729,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6734,1,'first'))),mmtbc2_20120529_SII2contnormsub(mmtbc1_20120529>=mmtbc1_20120529(find(mmtbc1_20120529<6729,1,'last')) & mmtbc1_20120529<=mmtbc1_20120529(find(mmtbc1_20120529>6734,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_7_119.eps'], 'epsc');
eval(['!epstopdf SII2_7_119.eps']);

clf
plot(keckL1_20120616,keckL2_20120616_SII2contnormsub)
hold all
area(keckL1_20120616(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6727,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6737,1,'first'))),keckL2_20120616_SII2contnormsub(keckL1_20120616>=keckL1_20120616(find(keckL1_20120616<6727,1,'last')) & keckL1_20120616<=keckL1_20120616(find(keckL1_20120616>6737,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_8_137.eps'], 'epsc');
eval(['!epstopdf SII2_8_137.eps']);

clf
plot(mmtbc1_20120701,mmtbc2_20120701_SII2contnormsub)
hold all
area(mmtbc1_20120701(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6724,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6736,1,'first'))),mmtbc2_20120701_SII2contnormsub(mmtbc1_20120701>=mmtbc1_20120701(find(mmtbc1_20120701<6724,1,'last')) & mmtbc1_20120701<=mmtbc1_20120701(find(mmtbc1_20120701>6736,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_9_152.eps'], 'epsc');
eval(['!epstopdf SII2_9_152.eps']);

clf
plot(keckD1_20121115,keckD2_20121115_SII2contnormsub)
hold all
area(keckD1_20121115(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6727,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6734,1,'first'))),keckD2_20121115_SII2contnormsub(keckD1_20121115>=keckD1_20121115(find(keckD1_20121115<6727,1,'last')) & keckD1_20121115<=keckD1_20121115(find(keckD1_20121115>6734,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_10_289.eps'], 'epsc');
eval(['!epstopdf SII2_10_289.eps']);

clf
plot(keckD1_20150521,keckD2_20150521_SII2contnormsub)
hold all
area(keckD1_20150521(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6727,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6734,1,'first'))),keckD2_20150521_SII2contnormsub(keckD1_20150521>=keckD1_20150521(find(keckD1_20150521<6727,1,'last')) & keckD1_20150521<=keckD1_20150521(find(keckD1_20150521>6734,1,'first'))));
xlim([6722,6800])
saveas(plotting, ['SII2_11_1206.eps'], 'epsc');
eval(['!epstopdf SII2_11_1206.eps']);




OIII1(10)/OIII1(11)
OIII2(10)/OIII2(11)

SII1(10)/SII1(11)
SII2(10)/SII2(11)

SIIaverage = (SII1(10)/SII1(11)+SII2(10)/SII2(11))/2







%entire spectrum
fitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly5','Robust','Bisquare');
fitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly5','Robust','Bisquare');
fitspolb2_20120323 = fit(spolb1_20120323,spolb2_20120323,'poly5','Robust','Bisquare');
fitspolm2_20120416 = fit(spolm1_20120416,spolm2_20120416,'poly5','Robust','Bisquare');
fitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly5','Robust','Bisquare');
fitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly5','Robust','Bisquare');
fitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly5','Robust','Bisquare');
fitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly5','Robust','Bisquare');
fitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly5','Robust','Bisquare');
fitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly5','Robust','Bisquare');
fitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly5','Robust','Bisquare');

fithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly5','Robust','Bisquare');
fithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly5','Robust','Bisquare');
fithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly5','Robust','Bisquare');



mmtbc2_20120301_contnorm = mmtbc2_20120301/mean(fitmmtbc2_20120301(mmtbc1_20120301));
mmtbc2_20120417_contnorm = mmtbc2_20120417/mean(fitmmtbc2_20120417(mmtbc1_20120417));
mmtbc2_20120529_contnorm = mmtbc2_20120529/mean(fitmmtbc2_20120529(mmtbc1_20120529));
mmtbc2_20120701_contnorm = mmtbc2_20120701/mean(fitmmtbc2_20120701(mmtbc1_20120701));
keckD2_20121115_contnorm = keckD2_20121115/mean(fitkeckD2_20121115(keckD1_20121115));
spolb2_20120323_contnorm = spolb2_20120323/mean(fitspolb2_20120323(spolb1_20120323));
spolm2_20120416_contnorm = spolm2_20120416/mean(fitspolm2_20120416(spolm1_20120416));
Lkast2_20120223_contnorm = Lkast2_20120223/mean(fitLkast2_20120223(Lkast1_20120223));
Lkast2_20120428_contnorm = Lkast2_20120428/mean(fitLkast2_20120428(Lkast1_20120428));
keckL2_20120616_contnorm = keckL2_20120616/mean(fitkeckL2_20120616(keckL1_20120616));
keckD2_20150521_contnorm = keckD2_20150521/mean(fitkeckD2_20150521(keckD1_20150521));

hetms2_20120207_contnorm = hetms2_20120207/mean(fithetms2_20120207(hetms1_20120207));
hetms2_20120216_contnorm = hetms2_20120216/mean(fithetms2_20120216(hetms1_20120216));
hetms2_20120301_contnorm = hetms2_20120301/mean(fithetms2_20120301(hetms1_20120301));


mmtbc2_20120301_contscaled = mmtbc2_20120301/max(mmtbc2_20120301);
mmtbc2_20120417_contscaled = mmtbc2_20120417/max(mmtbc2_20120417);
mmtbc2_20120529_contscaled = mmtbc2_20120529/max(mmtbc2_20120529);
mmtbc2_20120701_contscaled = mmtbc2_20120701/max(mmtbc2_20120701);
keckD2_20121115_contscaled = keckD2_20121115/max(keckD2_20121115);
spolb2_20120323_contscaled = spolb2_20120323/max(spolb2_20120323);
spolm2_20120416_contscaled = spolm2_20120416/max(spolm2_20120416);
Lkast2_20120223_contscaled = Lkast2_20120223/max(Lkast2_20120223);
Lkast2_20120428_contscaled = Lkast2_20120428/max(Lkast2_20120428);
keckL2_20120616_contscaled = keckL2_20120616/max(keckL2_20120616);
keckD2_20150521_contscaled = keckD2_20150521/max(keckD2_20150521);

hetms2_20120207_contscaled = hetms2_20120207/max(hetms2_20120207);
hetms2_20120216_contscaled = hetms2_20120216/max(hetms2_20120216);
hetms2_20120301_contscaled = hetms2_20120301/max(hetms2_20120301);


mmtbc2_20120301_contsub = mmtbc2_20120301_contnorm - 1;
mmtbc2_20120417_contsub = mmtbc2_20120417_contnorm - 1;
mmtbc2_20120529_contsub = mmtbc2_20120529_contnorm - 1;
mmtbc2_20120701_contsub = mmtbc2_20120701_contnorm - 1;
keckD2_20121115_contsub = keckD2_20121115_contnorm - 1;
spolb2_20120323_contsub = spolb2_20120323_contnorm - 1;
spolm2_20120416_contsub = spolm2_20120416_contnorm - 1;
Lkast2_20120223_contsub = Lkast2_20120223_contnorm - 1;
Lkast2_20120428_contsub = Lkast2_20120428_contnorm - 1;
keckL2_20120616_contsub = keckL2_20120616_contnorm - 1;
keckD2_20150521_contsub = keckD2_20150521_contnorm - 1;

hetms2_20120207_contsub = hetms2_20120207_contnorm - 1;
hetms2_20120216_contsub = hetms2_20120216_contnorm - 1;
hetms2_20120301_contsub = hetms2_20120301_contnorm - 1;























%%%Na ID fitting
naIDfitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly5','Robust','Bisquare','Exclude',(keckD1_20121115<5660)|(keckD1_20121115>6100)|(keckD1_20121115>5860&keckD1_20121115<5920));
naIDfitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly5','Robust','Bisquare','Exclude',(Lkast1_20120223<5660)|(Lkast1_20120223>6100)|(Lkast1_20120223>5860&Lkast1_20120223<5920));
naIDfitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly5','Robust','Bisquare','Exclude',(Lkast1_20120428<5660)|(Lkast1_20120428>6100)|(Lkast1_20120428>5860&Lkast1_20120428<5920));
naIDfitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly5','Robust','Bisquare','Exclude',(keckL1_20120616<5660)|(keckL1_20120616>6100)|(keckL1_20120616>5860&keckL1_20120616<5920));
naIDfitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly5','Robust','Bisquare','Exclude',(mmtbc1_20120529<5660)|(mmtbc1_20120529>6100)|(mmtbc1_20120529>5860&mmtbc1_20120529<5920));
naIDfitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly5','Robust','Bisquare','Exclude',(mmtbc1_20120301<5660)|(mmtbc1_20120301>6100)|(mmtbc1_20120301>5860&mmtbc1_20120301<5920));
naIDfitspolm2_20120416 = fit(spolm1_20120416,spolm2_20120416,'poly5','Robust','Bisquare','Exclude',(spolm1_20120416<5660)|(spolm1_20120416>6100)|(spolm1_20120416>5860&spolm1_20120416<5920));
naIDfitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly5','Robust','Bisquare','Exclude',(mmtbc1_20120701<5660)|(mmtbc1_20120701>6100)|(mmtbc1_20120701>5860&mmtbc1_20120701<5920));
naIDfitspolb2_20120323 = fit(spolb1_20120323,spolb2_20120323,'poly5','Robust','Bisquare','Exclude',(spolb1_20120323<5660)|(spolb1_20120323>6100)|(spolb1_20120323>5860&spolb1_20120323<5920));
naIDfitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly5','Robust','Bisquare','Exclude',(mmtbc1_20120417<5660)|(mmtbc1_20120417>6100)|(mmtbc1_20120417>5860&mmtbc1_20120417<5920));

naIDnorm_20120223 = mean(naIDfitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>5885)&(Lkast1_20120223<5900))));
naIDnorm_20120301 = mean(naIDfitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>5885)&(mmtbc1_20120301<5900))));
naIDnorm_20120323 = mean(naIDfitspolb2_20120323(spolb1_20120323((spolb1_20120323>5885)&(spolb1_20120323<5900))));
naIDnorm_20120416 = mean(naIDfitspolm2_20120416(spolm1_20120416((spolm1_20120416>5885)&(spolm1_20120416<5900))));
naIDnorm_20120417 = mean(naIDfitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>5885)&(mmtbc1_20120417<5900))));
naIDnorm_20120428 = mean(naIDfitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>5885)&(Lkast1_20120428<5900))));
naIDnorm_20120529 = mean(naIDfitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>5885)&(mmtbc1_20120529<5900))));
naIDnorm_20120616 = mean(naIDfitkeckL2_20120616(keckL1_20120616((keckL1_20120616>5885)&(keckL1_20120616<5900))));
naIDnorm_20120701 = mean(naIDfitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>5885)&(mmtbc1_20120701<5900))));
naIDnorm_20121115 = mean(naIDfitkeckD2_20121115(keckD1_20121115((keckD1_20121115>5885)&(keckD1_20121115<5900))));

Lkast2_20120223_naIDcontnorm = Lkast2_20120223/naIDnorm_20120223;
mmtbc2_20120301_naIDcontnorm = mmtbc2_20120301/naIDnorm_20120301;
spolb2_20120323_naIDcontnorm = spolb2_20120323/naIDnorm_20120323;
spolm2_20120416_naIDcontnorm = spolm2_20120416/naIDnorm_20120416;
mmtbc2_20120417_naIDcontnorm = mmtbc2_20120417/naIDnorm_20120417;
Lkast2_20120428_naIDcontnorm = Lkast2_20120428/naIDnorm_20120428;
mmtbc2_20120529_naIDcontnorm = mmtbc2_20120529/naIDnorm_20120529;
keckL2_20120616_naIDcontnorm = keckL2_20120616/naIDnorm_20120616;
mmtbc2_20120701_naIDcontnorm = mmtbc2_20120701/naIDnorm_20120701;
keckD2_20121115_naIDcontnorm = keckD2_20121115/naIDnorm_20121115;

Lkast2_20120223_naIDcontnormsub = Lkast2_20120223_naIDcontnorm - 1;
mmtbc2_20120301_naIDcontnormsub = mmtbc2_20120301_naIDcontnorm - 1;
spolb2_20120323_naIDcontnormsub = spolb2_20120323_naIDcontnorm - 1;
spolm2_20120416_naIDcontnormsub = spolm2_20120416_naIDcontnorm - 1;
mmtbc2_20120417_naIDcontnormsub = mmtbc2_20120417_naIDcontnorm - 1;
Lkast2_20120428_naIDcontnormsub = Lkast2_20120428_naIDcontnorm - 1;
mmtbc2_20120529_naIDcontnormsub = mmtbc2_20120529_naIDcontnorm - 1;
keckL2_20120616_naIDcontnormsub = keckL2_20120616_naIDcontnorm - 1;
mmtbc2_20120701_naIDcontnormsub = mmtbc2_20120701_naIDcontnorm - 1;
keckD2_20121115_naIDcontnormsub = keckD2_20121115_naIDcontnorm - 1;


%axis conversion to velocity relative to Halpha
%velocity in km/s
lambdaHalpha = 6562.81;
velHalpha_20120301 = 10^-5 .* c.* (mmtbc1_20120301-lambdaHalpha)./lambdaHalpha;
velHalpha_20120417 = 10^-5 .* c.* (mmtbc1_20120417-lambdaHalpha)./lambdaHalpha;
velHalpha_20120529 = 10^-5 .* c.* (mmtbc1_20120529-lambdaHalpha)./lambdaHalpha;
velHalpha_20120701 = 10^-5 .* c.* (mmtbc1_20120701-lambdaHalpha)./lambdaHalpha;
velHalpha_20121115 = 10^-5 .* c.* (keckD1_20121115-lambdaHalpha)./lambdaHalpha;
velHalpha_20120323 = 10^-5 .* c.* (spolb1_20120323-lambdaHalpha)./lambdaHalpha;
velHalpha_20120416 = 10^-5 .* c.* (spolm1_20120416-lambdaHalpha)./lambdaHalpha;
velHalpha_20120223 = 10^-5 .* c.* (Lkast1_20120223-lambdaHalpha)./lambdaHalpha;
velHalpha_20120428 = 10^-5 .* c.* (Lkast1_20120428-lambdaHalpha)./lambdaHalpha;
velHalpha_20120616 = 10^-5 .* c.* (keckL1_20120616-lambdaHalpha)./lambdaHalpha;
velHalpha_20150521 = 10^-5 .* c.* (keckD1_20150521-lambdaHalpha)./lambdaHalpha;
velHalpha_20120207 = 10^-5 .* c.* (hetms1_20120207-lambdaHalpha)./lambdaHalpha;
velHalpha_20120216 = 10^-5 .* c.* (hetms1_20120216-lambdaHalpha)./lambdaHalpha;
velHalpha_20120301_2 = 10^-5 .* c.* (hetms1_20120301-lambdaHalpha)./lambdaHalpha;


%axis conversion to velocity relative to Hbeta
lambdaHbeta = 4861.363;
velHbeta_20120301 = 10^-5 .* c.* (mmtbc1_20120301-lambdaHbeta)./lambdaHbeta;
velHbeta_20120417 = 10^-5 .* c.* (mmtbc1_20120417-lambdaHbeta)./lambdaHbeta;
velHbeta_20120529 = 10^-5 .* c.* (mmtbc1_20120529-lambdaHbeta)./lambdaHbeta;
velHbeta_20120701 = 10^-5 .* c.* (mmtbc1_20120701-lambdaHbeta)./lambdaHbeta;
velHbeta_20121115 = 10^-5 .* c.* (keckD1_20121115-lambdaHbeta)./lambdaHbeta;
velHbeta_20120323 = 10^-5 .* c.* (spolb1_20120323-lambdaHbeta)./lambdaHbeta;
velHbeta_20120416 = 10^-5 .* c.* (spolm1_20120416-lambdaHbeta)./lambdaHbeta;
velHbeta_20120223 = 10^-5 .* c.* (Lkast1_20120223-lambdaHbeta)./lambdaHbeta;
velHbeta_20120428 = 10^-5 .* c.* (Lkast1_20120428-lambdaHbeta)./lambdaHbeta;
velHbeta_20120616 = 10^-5 .* c.* (keckL1_20120616-lambdaHbeta)./lambdaHbeta;
velHbeta_20120207 = 10^-5 .* c.* (hetms1_20120207-lambdaHbeta)./lambdaHbeta;
velHbeta_20120216 = 10^-5 .* c.* (hetms1_20120216-lambdaHbeta)./lambdaHbeta;
velHbeta_20120301_2 = 10^-5 .* c.* (hetms1_20120301-lambdaHbeta)./lambdaHbeta;


%NaID line measurement
stdNaID(1) = std(Lkast2_20120223_naIDcontnormsub(Lkast1_20120223>5900 & Lkast1_20120223 < 6100))
NaID1(1) = trapz(Lkast1_20120223(Lkast1_20120223>5893 & Lkast1_20120223 < 5901),Lkast2_20120223_naIDcontnormsub(Lkast1_20120223>5893 & Lkast1_20120223 < 5901))
NaID2(1) = trapz(Lkast1_20120223(Lkast1_20120223>5885 & Lkast1_20120223 <= 5893),Lkast2_20120223_naIDcontnormsub(Lkast1_20120223>5885 & Lkast1_20120223 <= 5893))

stdNaID(2) = std(mmtbc2_20120301_naIDcontnormsub(mmtbc1_20120301>5900 & mmtbc1_20120301 < 6100))
NaID1(2) = trapz(mmtbc1_20120301(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901),mmtbc2_20120301_naIDcontnormsub(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901))
NaID2(2) = trapz(mmtbc1_20120301(mmtbc1_20120301>5885 & mmtbc1_20120301 <= 5893),mmtbc2_20120301_naIDcontnormsub(mmtbc1_20120301>5885 & mmtbc1_20120301 <= 5893))

stdNaID(3) = std(spolb2_20120323_naIDcontnormsub(spolb1_20120323>5900 & spolb1_20120323 < 6100))
NaID1(3) = trapz(spolb1_20120323(spolb1_20120323>5893 & spolb1_20120323 < 5901),spolb2_20120323_naIDcontnormsub(spolb1_20120323>5893 & spolb1_20120323 < 5901))
NaID2(3) = trapz(spolb1_20120323(spolb1_20120323>5885 & spolb1_20120323 <= 5893),spolb2_20120323_naIDcontnormsub(spolb1_20120323>5885 & spolb1_20120323 <= 5893))

stdNaID(4) = std(spolm2_20120416_naIDcontnormsub(spolm1_20120416>5900 & spolm1_20120416 < 6100))
NaID1(4) = trapz(spolm1_20120416(spolm1_20120416>5893 & spolm1_20120416 < 5901),spolm2_20120416_naIDcontnormsub(spolm1_20120416>5893 & spolm1_20120416 < 5901))
NaID2(4) = trapz(spolm1_20120416(spolm1_20120416>5885 & spolm1_20120416 <= 5893),spolm2_20120416_naIDcontnormsub(spolm1_20120416>5885 & spolm1_20120416 <= 5893))

stdNaID(5) = std(mmtbc2_20120417_naIDcontnormsub(mmtbc1_20120417>5900 & mmtbc1_20120417 < 6100))
NaID1(5) = trapz(mmtbc1_20120417(mmtbc1_20120417>5893 & mmtbc1_20120417 < 5901),mmtbc2_20120417_naIDcontnormsub(mmtbc1_20120417>5893 & mmtbc1_20120417 < 5901))
NaID2(5) = trapz(mmtbc1_20120417(mmtbc1_20120417>5885 & mmtbc1_20120417 <= 5893),mmtbc2_20120417_naIDcontnormsub(mmtbc1_20120417>5885 & mmtbc1_20120417 <= 5893))

stdNaID(6) = std(Lkast2_20120428_naIDcontnormsub(Lkast1_20120428>5900 & Lkast1_20120428 < 6100))
NaID1(6) = trapz(Lkast1_20120428(Lkast1_20120428>5893 & Lkast1_20120428 < 5901),Lkast2_20120428_naIDcontnormsub(Lkast1_20120428>5893 & Lkast1_20120428 < 5901))
NaID2(6) = trapz(Lkast1_20120428(Lkast1_20120428>5885 & Lkast1_20120428 <= 5893),Lkast2_20120428_naIDcontnormsub(Lkast1_20120428>5885 & Lkast1_20120428 <= 5893))

stdNaID(7) = std(mmtbc2_20120529_naIDcontnormsub(mmtbc1_20120529>5900 & mmtbc1_20120529 < 6100))
NaID1(7) = trapz(mmtbc1_20120529(mmtbc1_20120529>5893 & mmtbc1_20120529 < 5901),mmtbc2_20120529_naIDcontnormsub(mmtbc1_20120529>5893 & mmtbc1_20120529 < 5901))
NaID2(7) = trapz(mmtbc1_20120529(mmtbc1_20120529>5885 & mmtbc1_20120529 <= 5893),mmtbc2_20120529_naIDcontnormsub(mmtbc1_20120529>5885 & mmtbc1_20120529 <= 5893))

stdNaID(8) = std(keckL2_20120616_naIDcontnormsub(keckL1_20120616>5900 & keckL1_20120616 < 6100))
NaID1(8) = trapz(keckL1_20120616(keckL1_20120616>5893 & keckL1_20120616 < 5901),keckL2_20120616_naIDcontnormsub(keckL1_20120616>5893 & keckL1_20120616 < 5901))
NaID2(8) = trapz(keckL1_20120616(keckL1_20120616>5885 & keckL1_20120616 <= 5893),keckL2_20120616_naIDcontnormsub(keckL1_20120616>5885 & keckL1_20120616 <= 5893))

stdNaID(9) = std(mmtbc2_20120701_naIDcontnormsub(mmtbc1_20120701>5900 & mmtbc1_20120701 < 6100))
NaID1(9) = trapz(mmtbc1_20120701(mmtbc1_20120701>5893 & mmtbc1_20120701 < 5901),mmtbc2_20120701_naIDcontnormsub(mmtbc1_20120701>5893 & mmtbc1_20120701 < 5901))
NaID2(9) = trapz(mmtbc1_20120701(mmtbc1_20120701>5885 & mmtbc1_20120701 <= 5893),mmtbc2_20120701_naIDcontnormsub(mmtbc1_20120701>5885 & mmtbc1_20120701 <= 5893))

stdNaID(10) = std(keckD2_20121115_naIDcontnormsub(keckD1_20121115>5900 & keckD1_20121115 < 6100))
NaID1(10) = trapz(keckD1_20121115(keckD1_20121115>5893 & keckD1_20121115 < 5901),keckD2_20121115_naIDcontnormsub(keckD1_20121115>5893 & keckD1_20121115 < 5901))
NaID2(10) = trapz(keckD1_20121115(keckD1_20121115>5885 & keckD1_20121115 <= 5893),keckD2_20121115_naIDcontnormsub(keckD1_20121115>5885 & keckD1_20121115 <= 5893))



Lkast2_20120223_naIDcontfitnormsub = (Lkast2_20120223 - naIDfitLkast2_20120223(Lkast1_20120223))./naIDfitLkast2_20120223(Lkast1_20120223);
mmtbc2_20120301_naIDcontfitnormsub = (mmtbc2_20120301 - naIDfitmmtbc2_20120301(mmtbc1_20120301))./naIDfitmmtbc2_20120301(mmtbc1_20120301);
spolb2_20120323_naIDcontfitnormsub = (spolb2_20120323 - naIDfitspolb2_20120323(spolb1_20120323))./naIDfitspolb2_20120323(spolb1_20120323);
spolm2_20120416_naIDcontfitnormsub = (spolm2_20120416 - naIDfitspolm2_20120416(spolm1_20120416))./naIDfitspolm2_20120416(spolm1_20120416);
mmtbc2_20120417_naIDcontfitnormsub = (mmtbc2_20120417 - naIDfitmmtbc2_20120417(mmtbc1_20120417))./naIDfitmmtbc2_20120417(mmtbc1_20120417);
Lkast2_20120428_naIDcontfitnormsub = (Lkast2_20120428 - naIDfitLkast2_20120428(Lkast1_20120428))./naIDfitLkast2_20120428(Lkast1_20120428);
mmtbc2_20120529_naIDcontfitnormsub = (mmtbc2_20120529 - naIDfitmmtbc2_20120529(mmtbc1_20120529))./naIDfitmmtbc2_20120529(mmtbc1_20120529);
keckL2_20120616_naIDcontfitnormsub = (keckL2_20120616 - naIDfitkeckL2_20120616(keckL1_20120616))./naIDfitkeckL2_20120616(keckL1_20120616);
mmtbc2_20120701_naIDcontfitnormsub = (mmtbc2_20120701 - naIDfitmmtbc2_20120701(mmtbc1_20120701))./naIDfitmmtbc2_20120701(mmtbc1_20120701);
keckD2_20121115_naIDcontfitnormsub = (keckD2_20121115 - naIDfitkeckD2_20121115(keckD1_20121115))./naIDfitkeckD2_20121115(keckD1_20121115);

stdNaIDcontfit(2) = (mmtbc1_20120301(5)-mmtbc1_20120301(4))*std(mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>5900 & mmtbc1_20120301 < 6100))*sqrt(length(mmtbc1_20120301(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901)))
NaID1contfit(2) = trapz(mmtbc1_20120301(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901))
NaID2contfit(2) = trapz(mmtbc1_20120301(mmtbc1_20120301>5885 & mmtbc1_20120301 <= 5893),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>5885 & mmtbc1_20120301 <= 5893))


%sodium doublet at 5889.950 and 5895.924
clf
plot(mmtbc1_20120301(mmtbc1_20120301>5593 & mmtbc1_20120301 < 6101),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>5593 & mmtbc1_20120301 < 6101),'Color',[0 0 0],'LineWidth',3)
hold all
%h(1) = area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5893,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5901,1,'first'))),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5893,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5901,1,'first'))));
%h(2) = area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5885,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5893,1,'first'))),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5885,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5893,1,'first'))));
%h(1).FaceColor = [0.3 0.3 0.3];
%h(2).FaceColor = [0.3 0.3 0.3];
line([0 10000],[0 0],'Color',[0.33 0.33 0.33],'LineStyle','--')
line([5889.950 5889.950],[-1 1],'Color',[0 0 0],'LineStyle','--')
line([5895.924 5895.924],[-1 1],'Color',[0 0 0],'LineStyle','--')
htext = text(5905,0.09,'SN 2012ab','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'black')
set(htext, 'FontSize',40)
htext = text(5905,0.07,'Na I D Absorption','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'black')
set(htext, 'FontSize',40)
htext = text(5905,0.05,'Day 30 MMT','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'black')
set(htext, 'FontSize',40)
xlim([5835,5951])
ylim([-0.1 0.1])
set(gca,'box','on')
set(gca,'FontSize',40)
xlabel('Rest Wavelength ($\rm{\AA}$)','interpreter','latex','FontSize',44,'FontName','CMU Serif Roman')
ylabel('Normalized Flux','interpreter','latex','FontSize',44,'FontName','CMU Serif Roman')

%saveas(plotting, ['NaID.eps'], 'epsc');
%eval(['!epstopdf NaID.eps']);

export_fig C:\Users\Cbilinski\Desktop\Figures\NaID.pdf -pdf



%test galactic sodium line
%sodium doublet at 5889.950 and 5895.924
clf
plot(mmtbc1_20120301(mmtbc1_20120301>5593 & mmtbc1_20120301 < 6101),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>5593 & mmtbc1_20120301 < 6101),'Color',[0 0 0],'LineWidth',3)
hold all
%h(1) = area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5893,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5901,1,'first'))),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5893,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5901,1,'first'))));
%h(2) = area(mmtbc1_20120301(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5885,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5893,1,'first'))),mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>=mmtbc1_20120301(find(mmtbc1_20120301<5885,1,'last')) & mmtbc1_20120301<=mmtbc1_20120301(find(mmtbc1_20120301>5893,1,'first'))));
%h(1).FaceColor = [0.3 0.3 0.3];
%h(2).FaceColor = [0.3 0.3 0.3];
line([0 10000],[0 0],'Color',[0.33 0.33 0.33],'LineStyle','--')
line([5889.950 5889.950],[-1 1],'Color',[0 0 0],'LineStyle','--')
line([5895.924 5895.924],[-1 1],'Color',[0 0 0],'LineStyle','--')
htext = text(5905,0.07,'SN 2012ab','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'black')
set(htext, 'FontSize',30)
htext = text(5905,0.06,'Na I D Absorption','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'black')
set(htext, 'FontSize',30)
htext = text(5905,0.05,'Day 30 MMT','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'black')
set(htext, 'FontSize',30)
xlim([5736,5842])
ylim([-0.1 0.1])
set(gca,'box','on')
set(gca,'FontSize',30)
xlabel('Rest Wavelength ($\rm{\AA}$)','interpreter','latex','FontSize',30,'FontName','CMU Serif Roman')
ylabel('Normalized Flux','interpreter','latex','FontSize',30,'FontName','CMU Serif Roman')

%center of both sodium lines in Galaxy
(5842+5736)/2
%upper limit on galactic sodium line 
(mmtbc1_20120301(5)-mmtbc1_20120301(4))*std(mmtbc2_20120301_naIDcontfitnormsub(mmtbc1_20120301>5739 & mmtbc1_20120301 < 5839)) * sqrt(length(mmtbc1_20120301(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901))+length(mmtbc1_20120301(mmtbc1_20120301>5885 & mmtbc1_20120301 <= 5893)))























stdNaIDcontfit(2)
NaID1contfit(2) 
NaID2contfit(2) 




%with better fit
%Poznanski
Rv = 3.08;
Ebv_Poz = 10^(1.17*(-NaID1contfit(2)+-NaID2contfit(2))-1.85)
Ebv_Poz*Rv

%MZ from Mathematica notebook
Ebv_MZ = 0.0875145


%richmond
Ebv_R1 = 0.025 + 0.454 * -NaID1contfit(2)
Ebv_R2 = 0.015 + 0.370 * -NaID2contfit(2)

Ebv_Ravg = (Ebv_R1 + Ebv_R2) / 2

%Turatto
Ebv_Tmodel1 = -0.04 + 0.51 * -(NaID1contfit(2)+NaID1contfit(2))
Ebv_Tmodel2 = -0.01 + 0.16 * -(NaID1contfit(2)+NaID1contfit(2))

Ebv_Tavg = (Ebv_Tmodel1 + Ebv_Tmodel2) / 2


Ebv_average = (Ebv_Poz + Ebv_MZ + Ebv_Ravg + Ebv_Tavg)/4
AV_est = Ebv_average * Rv

%ISPmax = 9 * Ebv_average
%AV_totalhostplusMW = A_V + AV_est
%Ebv_totalhostplusMW = AV_totalhostplusMW/3.08

ISPmax = 9 * Ebv_Poz
AV_totalhostplusMW = A_V + Ebv_Poz*Rv
Ebv_totalhostplusMW = AV_totalhostplusMW/Rv

%convert to AR at midpoint wavelength of 6580A
R_V = 3.08;
xAR = 10000/6580;
yAR = xAR - 1.82;
aAR = 1 + 0.104*yAR - 0.609*yAR.^2 +0.701*yAR.^3 + 1.137*yAR.^4 - 1.718*yAR.^5 - 0.827*yAR.^6 + 1.647*yAR.^7 - 0.505*yAR.^8;
bAR = 1.952*yAR + 2.908*yAR.^2 - 3.989*yAR.^3 - 7.985*yAR.^4 + 11.102*yAR.^5 +5.491*yAR.^6 - 10.805*yAR.^7 + 3.347*yAR.^8;
A_AR_NaID = A_V_NaID .* (aAR + bAR./R_V)
A_AR = AV_totalhostplusMW .* (aAR + bAR./R_V)











%%Poznanski
%Rv = 3.08;
%Ebv_Poz = 10^(1.17*(-NaID1(2)+-NaID2(2))-1.85);
%
%
%%MZ
%Ebv_MZ = 0.0936972;
%
%Ebv_average = (Ebv_Poz + Ebv_MZ)/2
%AV_est = (Ebv_Poz + Ebv_MZ)/2*Rv
%
%ISPmax = 9 * (Ebv_Poz + Ebv_MZ)/2
%
%AV_totalhostplusMW = A_V + A_V_NaID
%Ebv_totalhostplusMW = AV_totalhostplusMW/3.08



%%%equivalent width calculations
%excluding dates with no red continuum to fit
reldatered = [reldate(12) reldate(13) reldate(1) reldate(14) reldate(3:4) reldate(6) reldate(8:11)];

%hbeta 4861.363
Lkast2_20120223_interphbeta = Lkast2_20120223_hbetacontnorm;
Lkast2_20120428_interphbeta = Lkast2_20120428_hbetacontnorm;
keckL2_20120616_interphbeta = keckL2_20120616_hbetacontnorm;
keckD2_20121115_interphbeta = keckD2_20121115_hbetacontnorm;
keckD2_20150521_interphbeta = keckD2_20150521_hbetacontnorm;

Lkast2_20120223_interphbeta(find(Lkast1_20120223>4855,1,'first'):find(Lkast1_20120223 >= 4866,1,'first')) = interp1([find(Lkast1_20120223>4855,1,'first') find(Lkast1_20120223 >= 4866,1,'first')] , [Lkast2_20120223_interphbeta(find(Lkast1_20120223>4855,1,'first')) Lkast2_20120223_interphbeta(find(Lkast1_20120223 >= 4866,1,'first'))] , linspace(find(Lkast1_20120223>4855,1,'first'),find(Lkast1_20120223 >= 4866,1,'first'),length(find(Lkast1_20120223>4855,1,'first'):find(Lkast1_20120223 >= 4866,1,'first'))));
Lkast2_20120428_interphbeta(find(Lkast1_20120428>4856,1,'first'):find(Lkast1_20120428 >= 4870,1,'first')) = interp1([find(Lkast1_20120428>4856,1,'first') find(Lkast1_20120428 >= 4870,1,'first')] , [Lkast2_20120428_interphbeta(find(Lkast1_20120428>4856,1,'first')) Lkast2_20120428_interphbeta(find(Lkast1_20120428 >= 4870,1,'first'))] , linspace(find(Lkast1_20120428>4856,1,'first'),find(Lkast1_20120428 >= 4870,1,'first'),length(find(Lkast1_20120428>4856,1,'first'):find(Lkast1_20120428 >= 4870,1,'first'))));
keckL2_20120616_interphbeta(find(keckL1_20120616>4857,1,'first'):find(keckL1_20120616 >= 4864,1,'first')) = interp1([find(keckL1_20120616>4857,1,'first') find(keckL1_20120616 >= 4864,1,'first')] , [keckL2_20120616_interphbeta(find(keckL1_20120616>4857,1,'first')) keckL2_20120616_interphbeta(find(keckL1_20120616 >= 4864,1,'first'))] , linspace(find(keckL1_20120616>4857,1,'first'),find(keckL1_20120616 >= 4864,1,'first'),length(find(keckL1_20120616>4857,1,'first'):find(keckL1_20120616 >= 4864,1,'first'))));
keckD2_20121115_interphbeta(find(keckD1_20121115>4850,1,'first'):find(keckD1_20121115 >= 4858,1,'first')) = interp1([find(keckD1_20121115>4850,1,'first') find(keckD1_20121115 >= 4858,1,'first')] , [keckD2_20121115_interphbeta(find(keckD1_20121115>4850,1,'first')) keckD2_20121115_interphbeta(find(keckD1_20121115 >= 4858,1,'first'))] , linspace(find(keckD1_20121115>4850,1,'first'),find(keckD1_20121115 >= 4858,1,'first'),length(find(keckD1_20121115>4850,1,'first'):find(keckD1_20121115 >= 4858,1,'first'))));
keckD2_20150521_interphbeta(find(keckD1_20150521>4858,1,'first'):find(keckD1_20150521 >= 4866,1,'first')) = interp1([find(keckD1_20150521>4858,1,'first') find(keckD1_20150521 >= 4866,1,'first')] , [keckD2_20150521_interphbeta(find(keckD1_20150521>4858,1,'first')) keckD2_20150521_interphbeta(find(keckD1_20150521 >= 4866,1,'first'))] , linspace(find(keckD1_20150521>4858,1,'first'),find(keckD1_20150521 >= 4866,1,'first'),length(find(keckD1_20150521>4858,1,'first'):find(keckD1_20150521 >= 4866,1,'first'))));



Lkast2_20120223_interphbetasub = -Lkast2_20120223_interphbeta + Lkast2_20120223_hbetacontnorm;
Lkast2_20120428_interphbetasub = -Lkast2_20120428_interphbeta + Lkast2_20120428_hbetacontnorm;
keckL2_20120616_interphbetasub = -keckL2_20120616_interphbeta + keckL2_20120616_hbetacontnorm;
keckD2_20121115_interphbetasub = -keckD2_20121115_interphbeta + keckD2_20121115_hbetacontnorm;
keckD2_20150521_interphbetasub = -keckD2_20150521_interphbeta + keckD2_20150521_hbetacontnorm;

Fluxlowhbeta(3) = 10^-15 * hbetanorm_20120223 * trapz(Lkast1_20120223(find(Lkast1_20120223 > 4840 & Lkast1_20120223 < 4880)),Lkast2_20120223_interphbetasub(find(Lkast1_20120223 > 4840 & Lkast1_20120223 < 4880)));
Fluxlowhbeta(5) = 10^-15 * hbetanorm_20120428 * trapz(Lkast1_20120428(find(Lkast1_20120428 > 4840 & Lkast1_20120428 < 4880)),Lkast2_20120428_interphbetasub(find(Lkast1_20120428 > 4840 & Lkast1_20120428 < 4880)));
Fluxlowhbeta(6) = 10^-15 * hbetanorm_20120616 * trapz(keckL1_20120616(find(keckL1_20120616 > 4840 & keckL1_20120616 < 4880)),keckL2_20120616_interphbetasub(find(keckL1_20120616 > 4840 & keckL1_20120616 < 4880)));
Fluxlowhbeta(7) = 1 *      hbetanorm_20121115 * trapz(keckD1_20121115(find(keckD1_20121115 > 4840 & keckD1_20121115 < 4880)),keckD2_20121115_interphbetasub(find(keckD1_20121115 > 4840 & keckD1_20121115 < 4880)));
Fluxlowhbeta(8) = 1 *      hbetanorm_20150521 * trapz(keckD1_20150521(find(keckD1_20150521 > 4840 & keckD1_20150521 < 4880)),keckD2_20150521_interphbetasub(find(keckD1_20150521 > 4840 & keckD1_20150521 < 4880)));

dFluxlowhbeta(3) = Fluxlowhbeta(3) * 1/2 * 5*std(Lkast2_20120223_interphbeta(find(Lkast1_20120223 > 5100 & Lkast1_20120223 < 5300)));
dFluxlowhbeta(5) = Fluxlowhbeta(5) * 1/2 * 5*std(Lkast2_20120428_interphbeta(find(Lkast1_20120428 > 5100 & Lkast1_20120428 < 5300)));
dFluxlowhbeta(6) = Fluxlowhbeta(6) * 1/2 * 5*std(keckL2_20120616_interphbeta(find(keckL1_20120616 > 5100 & keckL1_20120616 < 5300)));
dFluxlowhbeta(7) = Fluxlowhbeta(7) * 1/2 * 5*std(keckD2_20121115_interphbeta(find(keckD1_20121115 > 5100 & keckD1_20121115 < 5300)));
dFluxlowhbeta(8) = Fluxlowhbeta(8) * 1/2 * 5*std(keckD2_20150521_interphbeta(find(keckD1_20150521 > 5100 & keckD1_20150521 < 5300)));


hetms2_20120207_interphbeta = hetms2_20120207_hbetacontnorm;
hetms2_20120207_interphbeta(find(hetms1_20120207>4846,1,'first'):find(hetms1_20120207 >= 4870,1,'first')) = interp1([find(hetms1_20120207>4846,1,'first') find(hetms1_20120207 >= 4870,1,'first')] , [hetms2_20120207_interphbeta(find(hetms1_20120207>4846,1,'first')) hetms2_20120207_interphbeta(find(hetms1_20120207 >= 4870,1,'first'))] , linspace(find(hetms1_20120207>4846,1,'first'),find(hetms1_20120207 >= 4870,1,'first'),length(find(hetms1_20120207>4846,1,'first'):find(hetms1_20120207 >= 4870,1,'first'))));
hetms2_20120207_interphbetasub = -hetms2_20120207_interphbeta + hetms2_20120207_hbetacontnorm;
Fluxlowhbeta(1) = 1 *      hbetanorm_20120207 * trapz(hetms1_20120207(find(hetms1_20120207 > 4840 & hetms1_20120207 < 4880)),hetms2_20120207_interphbetasub(find(hetms1_20120207 > 4840 & hetms1_20120207 < 4880)));
dFluxlowhbeta(1) = Fluxlowhbeta(1) * 1/2 * 5*std(hetms2_20120207_interphbeta(find(hetms1_20120207 > 5100 & hetms1_20120207 < 5300)));



hetms2_20120216_interphbeta = hetms2_20120216_hbetacontnorm;
hetms2_20120216_interphbeta(find(hetms1_20120216>4846,1,'first'):find(hetms1_20120216 >= 4870,1,'first')) = interp1([find(hetms1_20120216>4846,1,'first') find(hetms1_20120216 >= 4870,1,'first')] , [hetms2_20120216_interphbeta(find(hetms1_20120216>4846,1,'first')) hetms2_20120216_interphbeta(find(hetms1_20120216 >= 4870,1,'first'))] , linspace(find(hetms1_20120216>4846,1,'first'),find(hetms1_20120216 >= 4870,1,'first'),length(find(hetms1_20120216>4846,1,'first'):find(hetms1_20120216 >= 4870,1,'first'))));
hetms2_20120216_interphbetasub = -hetms2_20120216_interphbeta + hetms2_20120216_hbetacontnorm;
Fluxlowhbeta(2) = 1 *      hbetanorm_20120216 * trapz(hetms1_20120216(find(hetms1_20120216 > 4840 & hetms1_20120216 < 4880)),hetms2_20120216_interphbetasub(find(hetms1_20120216 > 4840 & hetms1_20120216 < 4880)));
dFluxlowhbeta(2) = Fluxlowhbeta(2) * 1/2 * 5*std(hetms2_20120216_interphbeta(find(hetms1_20120216 > 5100 & hetms1_20120216 < 5300)));

hetms2_20120301_interphbeta = hetms2_20120301_hbetacontnorm;
hetms2_20120301_interphbeta(find(hetms1_20120301>4846,1,'first'):find(hetms1_20120301 >= 4870,1,'first')) = interp1([find(hetms1_20120301>4846,1,'first') find(hetms1_20120301 >= 4870,1,'first')] , [hetms2_20120301_interphbeta(find(hetms1_20120301>4846,1,'first')) hetms2_20120301_interphbeta(find(hetms1_20120301 >= 4870,1,'first'))] , linspace(find(hetms1_20120301>4846,1,'first'),find(hetms1_20120301 >= 4870,1,'first'),length(find(hetms1_20120301>4846,1,'first'):find(hetms1_20120301 >= 4870,1,'first'))));
hetms2_20120301_interphbetasub = -hetms2_20120301_interphbeta + hetms2_20120301_hbetacontnorm;
Fluxlowhbeta(4) = 1 *      hbetanorm_20120301 * trapz(hetms1_20120301(find(hetms1_20120301 > 4840 & hetms1_20120301 < 4880)),hetms2_20120301_interphbetasub(find(hetms1_20120301 > 4840 & hetms1_20120301 < 4880)));
dFluxlowhbeta(4) = Fluxlowhbeta(4) * 1/2 * 5*std(hetms2_20120301_interphbeta(find(hetms1_20120301 > 5100 & hetms1_20120301 < 5300)));


clf
hold all
plot(hetms1_20120301(find(hetms1_20120301>4761 & hetms1_20120301 < 4961))/10^3,hetms2_20120301_interphbetasub(find(hetms1_20120301>4761 & hetms1_20120301 < 4961)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120301(find(hetms1_20120301>4761 & hetms1_20120301 < 4961))/10^3,hetms2_20120301_hbetacontnorm(find(hetms1_20120301>4761 & hetms1_20120301 < 4961)),'--','LineWidth',2,'Color',[0 0 0])


clf
hold all
plot(keckD1_20150521(find(keckD1_20150521>4761 & keckD1_20150521 < 4961))/10^3,keckD2_20150521_interphbetasub(find(keckD1_20150521>4761 & keckD1_20150521 < 4961)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20150521(find(keckD1_20150521>4761 & keckD1_20150521 < 4961))/10^3,keckD2_20150521_hbetacontnorm(find(keckD1_20150521>4761 & keckD1_20150521 < 4961)),'--','LineWidth',2,'Color',[0 0 0])

clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 4961))/10^3,keckD2_20121115_interphbetasub(find(keckD1_20121115>4761 & keckD1_20121115 < 4961)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 4961))/10^3,keckD2_20121115_hbetacontnorm(find(keckD1_20121115>4761 & keckD1_20121115 < 4961)),'--','LineWidth',2,'Color',[0 0 0])




%left right line calculations


hetms2_20120207_halphacontfitnormsubinterp = hetms2_20120207_halphacontfitnormsub;
hetms2_20120216_halphacontfitnormsubinterp = hetms2_20120216_halphacontfitnormsub;
Lkast2_20120223_halphacontfitnormsubinterp = Lkast2_20120223_halphacontfitnormsub;
mmtbc2_20120301_halphacontfitnormsubinterp = mmtbc2_20120301_halphacontfitnormsub;
hetms2_20120301_halphacontfitnormsubinterp = hetms2_20120301_halphacontfitnormsub;
spolb2_20120323_halphacontfitnormsubinterp = spolb2_20120323_halphacontfitnormsub;
spolm2_20120416_halphacontfitnormsubinterp = spolm2_20120416_halphacontfitnormsub;
mmtbc2_20120417_halphacontfitnormsubinterp = mmtbc2_20120417_halphacontfitnormsub;
Lkast2_20120428_halphacontfitnormsubinterp = Lkast2_20120428_halphacontfitnormsub;
mmtbc2_20120529_halphacontfitnormsubinterp = mmtbc2_20120529_halphacontfitnormsub;
keckL2_20120616_halphacontfitnormsubinterp = keckL2_20120616_halphacontfitnormsub;
mmtbc2_20120701_halphacontfitnormsubinterp = mmtbc2_20120701_halphacontfitnormsub;
keckD2_20121115_halphacontfitnormsubinterp = keckD2_20121115_halphacontfitnormsub;
keckD2_20150521_halphacontfitnormsubinterp = keckD2_20150521_halphacontfitnormsub;



hetms2_20120207_centern = hetms1_20120207(hetms2_20120207_halphacontfitnormsubinterp==max(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6462.8 & hetms1_20120207<6662.8))))
hetms2_20120216_centern = hetms1_20120216(hetms2_20120216_halphacontfitnormsubinterp==max(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6462.8 & hetms1_20120216<6662.8))))
Lkast2_20120223_centern = Lkast1_20120223(Lkast2_20120223_halphacontfitnormsubinterp==max(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6462.8 & Lkast1_20120223<6662.8))))
mmtbc2_20120301_centern = mmtbc1_20120301(mmtbc2_20120301_halphacontfitnormsubinterp==max(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6462.8 & mmtbc1_20120301<6662.8))))
hetms2_20120301_centern = hetms1_20120301(hetms2_20120301_halphacontfitnormsubinterp==max(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6462.8 & hetms1_20120301<6662.8))))
spolb2_20120323_centern = spolb1_20120323(spolb2_20120323_halphacontfitnormsubinterp==max(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6462.8 & spolb1_20120323<6662.8))))
spolm2_20120416_centern = spolm1_20120416(spolm2_20120416_halphacontfitnormsubinterp==max(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6462.8 & spolm1_20120416<6662.8))))
mmtbc2_20120417_centern = mmtbc1_20120417(mmtbc2_20120417_halphacontfitnormsubinterp==max(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6462.8 & mmtbc1_20120417<6662.8))))
Lkast2_20120428_centern = Lkast1_20120428(Lkast2_20120428_halphacontfitnormsubinterp==max(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6462.8 & Lkast1_20120428<6662.8))))
mmtbc2_20120529_centern = mmtbc1_20120529(mmtbc2_20120529_halphacontfitnormsubinterp==max(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6462.8 & mmtbc1_20120529<6662.8))))
keckL2_20120616_centern = keckL1_20120616(keckL2_20120616_halphacontfitnormsubinterp==max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6462.8 & keckL1_20120616<6662.8))))
mmtbc2_20120701_centern = mmtbc1_20120701(mmtbc2_20120701_halphacontfitnormsubinterp==max(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6462.8 & mmtbc1_20120701<6662.8))))
keckD2_20121115_centern = keckD1_20121115(keckD2_20121115_halphacontfitnormsubinterp==max(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6462.8 & keckD1_20121115<6662.8))))
keckD2_20150521_centern = keckD1_20150521(keckD2_20150521_halphacontfitnormsubinterp==max(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6462.8 & keckD1_20150521<6662.8))))


%hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6551,1,'first')) = interp1([find(hetms1_20120207>6543,1,'first') find(hetms1_20120207 >= 6551,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6551,1,'first'))] , linspace(find(hetms1_20120207>6543,1,'first'),find(hetms1_20120207 >= 6551,1,'first'),length(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6551,1,'first'))));
hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6593,1,'first')) = interp1([find(hetms1_20120207>6543,1,'first') find(hetms1_20120207 >= 6593,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6593,1,'first'))] , linspace(find(hetms1_20120207>6543,1,'first'),find(hetms1_20120207 >= 6593,1,'first'),length(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6593,1,'first'))));
%hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6577,1,'first'):find(hetms1_20120207 >= 6593,1,'first')) = interp1([find(hetms1_20120207>6577,1,'first') find(hetms1_20120207 >= 6593,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6577,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6593,1,'first'))] , linspace(find(hetms1_20120207>6577,1,'first'),find(hetms1_20120207 >= 6593,1,'first'),length(find(hetms1_20120207>6577,1,'first'):find(hetms1_20120207 >= 6593,1,'first'))));
hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6700,1,'first'):find(hetms1_20120207 >= 6748,1,'first')) = interp1([find(hetms1_20120207>6700,1,'first') find(hetms1_20120207 >= 6748,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6700,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6748,1,'first'))] , linspace(find(hetms1_20120207>6700,1,'first'),find(hetms1_20120207 >= 6748,1,'first'),length(find(hetms1_20120207>6700,1,'first'):find(hetms1_20120207 >= 6748,1,'first'))));


%hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6551,1,'first')) = interp1([find(hetms1_20120216>6543,1,'first') find(hetms1_20120216 >= 6551,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6551,1,'first'))] , linspace(find(hetms1_20120216>6543,1,'first'),find(hetms1_20120216 >= 6551,1,'first'),length(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6551,1,'first'))));
hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6573,1,'first')) = interp1([find(hetms1_20120216>6543,1,'first') find(hetms1_20120216 >= 6573,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6573,1,'first'))] , linspace(find(hetms1_20120216>6543,1,'first'),find(hetms1_20120216 >= 6573,1,'first'),length(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6573,1,'first'))));
%hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6577,1,'first'):find(hetms1_20120216 >= 6593,1,'first')) = interp1([find(hetms1_20120216>6577,1,'first') find(hetms1_20120216 >= 6593,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6577,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6593,1,'first'))] , linspace(find(hetms1_20120216>6577,1,'first'),find(hetms1_20120216 >= 6593,1,'first'),length(find(hetms1_20120216>6577,1,'first'):find(hetms1_20120216 >= 6593,1,'first'))));
hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6700,1,'first'):find(hetms1_20120216 >= 6748,1,'first')) = interp1([find(hetms1_20120216>6700,1,'first') find(hetms1_20120216 >= 6748,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6700,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6748,1,'first'))] , linspace(find(hetms1_20120216>6700,1,'first'),find(hetms1_20120216 >= 6748,1,'first'),length(find(hetms1_20120216>6700,1,'first'):find(hetms1_20120216 >= 6748,1,'first'))));


%hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6551,1,'first')) = interp1([find(hetms1_20120301>6543,1,'first') find(hetms1_20120301 >= 6551,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6551,1,'first'))] , linspace(find(hetms1_20120301>6543,1,'first'),find(hetms1_20120301 >= 6551,1,'first'),length(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6551,1,'first'))));
hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6593,1,'first')) = interp1([find(hetms1_20120301>6543,1,'first') find(hetms1_20120301 >= 6593,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6593,1,'first'))] , linspace(find(hetms1_20120301>6543,1,'first'),find(hetms1_20120301 >= 6593,1,'first'),length(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6593,1,'first'))));
%hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6577,1,'first'):find(hetms1_20120301 >= 6593,1,'first')) = interp1([find(hetms1_20120301>6577,1,'first') find(hetms1_20120301 >= 6593,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6577,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6593,1,'first'))] , linspace(find(hetms1_20120301>6577,1,'first'),find(hetms1_20120301 >= 6593,1,'first'),length(find(hetms1_20120301>6577,1,'first'):find(hetms1_20120301 >= 6593,1,'first'))));
hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6700,1,'first'):find(hetms1_20120301 >= 6748,1,'first')) = interp1([find(hetms1_20120301>6700,1,'first') find(hetms1_20120301 >= 6748,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6700,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6748,1,'first'))] , linspace(find(hetms1_20120301>6700,1,'first'),find(hetms1_20120301 >= 6748,1,'first'),length(find(hetms1_20120301>6700,1,'first'):find(hetms1_20120301 >= 6748,1,'first'))));

mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first')) = interp1([find(mmtbc1_20120301>6543,1,'first') find(mmtbc1_20120301 >= 6551,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6543,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120301>6543,1,'first'),find(mmtbc1_20120301 >= 6551,1,'first'),length(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first'))));
mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first')) = interp1([find(mmtbc1_20120301>6557,1,'first') find(mmtbc1_20120301 >= 6570,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6557,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120301>6557,1,'first'),find(mmtbc1_20120301 >= 6570,1,'first'),length(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first'))));
mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first')) = interp1([find(mmtbc1_20120301>6579,1,'first') find(mmtbc1_20120301 >= 6587,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6579,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120301>6579,1,'first'),find(mmtbc1_20120301 >= 6587,1,'first'),length(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first'))));
mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6700,1,'first'):find(mmtbc1_20120301 >= 6777,1,'first')) = interp1([find(mmtbc1_20120301>6700,1,'first') find(mmtbc1_20120301 >= 6777,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6700,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6777,1,'first'))] , linspace(find(mmtbc1_20120301>6700,1,'first'),find(mmtbc1_20120301 >= 6777,1,'first'),length(find(mmtbc1_20120301>6700,1,'first'):find(mmtbc1_20120301 >= 6777,1,'first'))));

spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first')) = interp1([find(spolm1_20120416>6543,1,'first') find(spolm1_20120416 >= 6551,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6543,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6551,1,'first'))] , linspace(find(spolm1_20120416>6543,1,'first'),find(spolm1_20120416 >= 6551,1,'first'),length(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6551,1,'first'):find(spolm1_20120416 >= 6570,1,'first')) = interp1([find(spolm1_20120416>6551,1,'first') find(spolm1_20120416 >= 6570,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6551,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6570,1,'first'))] , linspace(find(spolm1_20120416>6551,1,'first'),find(spolm1_20120416 >= 6570,1,'first'),length(find(spolm1_20120416>6551,1,'first'):find(spolm1_20120416 >= 6570,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first')) = interp1([find(spolm1_20120416>6579,1,'first') find(spolm1_20120416 >= 6587,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6579,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6587,1,'first'))] , linspace(find(spolm1_20120416>6579,1,'first'),find(spolm1_20120416 >= 6587,1,'first'),length(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6700,1,'first'):find(spolm1_20120416 >= 6735,1,'first')) = interp1([find(spolm1_20120416>6700,1,'first') find(spolm1_20120416 >= 6735,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6700,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6735,1,'first'))] , linspace(find(spolm1_20120416>6700,1,'first'),find(spolm1_20120416 >= 6735,1,'first'),length(find(spolm1_20120416>6700,1,'first'):find(spolm1_20120416 >= 6735,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6733,1,'first'):find(spolm1_20120416 >= 6817,1,'first')) = interp1([find(spolm1_20120416>6733,1,'first') find(spolm1_20120416 >= 6817,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6733,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6817,1,'first'))] , linspace(find(spolm1_20120416>6733,1,'first'),find(spolm1_20120416 >= 6817,1,'first'),length(find(spolm1_20120416>6733,1,'first'):find(spolm1_20120416 >= 6817,1,'first'))));



mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first')) = interp1([find(mmtbc1_20120529>6543,1,'first') find(mmtbc1_20120529 >= 6551,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6543,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120529>6543,1,'first'),find(mmtbc1_20120529 >= 6551,1,'first'),length(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first')) = interp1([find(mmtbc1_20120529>6557,1,'first') find(mmtbc1_20120529 >= 6570,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6557,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120529>6557,1,'first'),find(mmtbc1_20120529 >= 6570,1,'first'),length(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first')) = interp1([find(mmtbc1_20120529>6579,1,'first') find(mmtbc1_20120529 >= 6587,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6579,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120529>6579,1,'first'),find(mmtbc1_20120529 >= 6587,1,'first'),length(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6700,1,'first'):find(mmtbc1_20120529 >= 6739,1,'first')) = interp1([find(mmtbc1_20120529>6700,1,'first') find(mmtbc1_20120529 >= 6739,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6700,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6739,1,'first'))] , linspace(find(mmtbc1_20120529>6700,1,'first'),find(mmtbc1_20120529 >= 6739,1,'first'),length(find(mmtbc1_20120529>6700,1,'first'):find(mmtbc1_20120529 >= 6739,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6737,1,'first'):find(mmtbc1_20120529 >= 6769,1,'first')) = interp1([find(mmtbc1_20120529>6737,1,'first') find(mmtbc1_20120529 >= 6769,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6737,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6769,1,'first'))] , linspace(find(mmtbc1_20120529>6737,1,'first'),find(mmtbc1_20120529 >= 6769,1,'first'),length(find(mmtbc1_20120529>6737,1,'first'):find(mmtbc1_20120529 >= 6769,1,'first'))));


mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first')) = interp1([find(mmtbc1_20120701>6543,1,'first') find(mmtbc1_20120701 >= 6551,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6543,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120701>6543,1,'first'),find(mmtbc1_20120701 >= 6551,1,'first'),length(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first'))));
mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6557,1,'first'):find(mmtbc1_20120701 >= 6578,1,'first')) = interp1([find(mmtbc1_20120701>6557,1,'first') find(mmtbc1_20120701 >= 6578,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6557,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6578,1,'first'))] , linspace(find(mmtbc1_20120701>6557,1,'first'),find(mmtbc1_20120701 >= 6578,1,'first'),length(find(mmtbc1_20120701>6557,1,'first'):find(mmtbc1_20120701 >= 6578,1,'first'))));
mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6578,1,'first'):find(mmtbc1_20120701 >= 6592,1,'first')) = interp1([find(mmtbc1_20120701>6578,1,'first') find(mmtbc1_20120701 >= 6592,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6578,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6592,1,'first'))] , linspace(find(mmtbc1_20120701>6578,1,'first'),find(mmtbc1_20120701 >= 6592,1,'first'),length(find(mmtbc1_20120701>6578,1,'first'):find(mmtbc1_20120701 >= 6592,1,'first'))));
mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6700,1,'first'):find(mmtbc1_20120701 >= 6748,1,'first')) = interp1([find(mmtbc1_20120701>6700,1,'first') find(mmtbc1_20120701 >= 6748,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6700,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6748,1,'first'))] , linspace(find(mmtbc1_20120701>6700,1,'first'),find(mmtbc1_20120701 >= 6748,1,'first'),length(find(mmtbc1_20120701>6700,1,'first'):find(mmtbc1_20120701 >= 6748,1,'first'))));

keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6543,1,'first'):find(keckD1_20121115 >= 6551,1,'first')) = interp1([find(keckD1_20121115>6543,1,'first') find(keckD1_20121115 >= 6551,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6543,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6551,1,'first'))] , linspace(find(keckD1_20121115>6543,1,'first'),find(keckD1_20121115 >= 6551,1,'first'),length(find(keckD1_20121115>6543,1,'first'):find(keckD1_20121115 >= 6551,1,'first'))));
keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6557,1,'first'):find(keckD1_20121115 >= 6570,1,'first')) = interp1([find(keckD1_20121115>6557,1,'first') find(keckD1_20121115 >= 6570,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6557,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6570,1,'first'))] , linspace(find(keckD1_20121115>6557,1,'first'),find(keckD1_20121115 >= 6570,1,'first'),length(find(keckD1_20121115>6557,1,'first'):find(keckD1_20121115 >= 6570,1,'first'))));
keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6579,1,'first'):find(keckD1_20121115 >= 6587,1,'first')) = interp1([find(keckD1_20121115>6579,1,'first') find(keckD1_20121115 >= 6587,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6579,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6587,1,'first'))] , linspace(find(keckD1_20121115>6579,1,'first'),find(keckD1_20121115 >= 6587,1,'first'),length(find(keckD1_20121115>6579,1,'first'):find(keckD1_20121115 >= 6587,1,'first'))));
keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6700,1,'first'):find(keckD1_20121115 >= 6748,1,'first')) = interp1([find(keckD1_20121115>6700,1,'first') find(keckD1_20121115 >= 6748,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6700,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6748,1,'first'))] , linspace(find(keckD1_20121115>6700,1,'first'),find(keckD1_20121115 >= 6748,1,'first'),length(find(keckD1_20121115>6700,1,'first'):find(keckD1_20121115 >= 6748,1,'first'))));

spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6543,1,'first'):find(spolb1_20120323 >= 6551,1,'first')) = interp1([find(spolb1_20120323>6543,1,'first') find(spolb1_20120323 >= 6551,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6543,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6551,1,'first'))] , linspace(find(spolb1_20120323>6543,1,'first'),find(spolb1_20120323 >= 6551,1,'first'),length(find(spolb1_20120323>6543,1,'first'):find(spolb1_20120323 >= 6551,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6553,1,'first'):find(spolb1_20120323 >= 6577,1,'first')) = interp1([find(spolb1_20120323>6553,1,'first') find(spolb1_20120323 >= 6577,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6553,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6577,1,'first'))] , linspace(find(spolb1_20120323>6553,1,'first'),find(spolb1_20120323 >= 6577,1,'first'),length(find(spolb1_20120323>6553,1,'first'):find(spolb1_20120323 >= 6577,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6577,1,'first'):find(spolb1_20120323 >= 6597,1,'first')) = interp1([find(spolb1_20120323>6577,1,'first') find(spolb1_20120323 >= 6597,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6577,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6597,1,'first'))] , linspace(find(spolb1_20120323>6577,1,'first'),find(spolb1_20120323 >= 6597,1,'first'),length(find(spolb1_20120323>6577,1,'first'):find(spolb1_20120323 >= 6597,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6700,1,'first'):find(spolb1_20120323 >= 6735,1,'first')) = interp1([find(spolb1_20120323>6700,1,'first') find(spolb1_20120323 >= 6735,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6700,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6735,1,'first'))] , linspace(find(spolb1_20120323>6700,1,'first'),find(spolb1_20120323 >= 6735,1,'first'),length(find(spolb1_20120323>6700,1,'first'):find(spolb1_20120323 >= 6735,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6731,1,'first'):find(spolb1_20120323 >= 6817,1,'first')) = interp1([find(spolb1_20120323>6731,1,'first') find(spolb1_20120323 >= 6817,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6731,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6817,1,'first'))] , linspace(find(spolb1_20120323>6731,1,'first'),find(spolb1_20120323 >= 6817,1,'first'),length(find(spolb1_20120323>6731,1,'first'):find(spolb1_20120323 >= 6817,1,'first'))));


mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first')) = interp1([find(mmtbc1_20120417>6543,1,'first') find(mmtbc1_20120417 >= 6551,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6543,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120417>6543,1,'first'),find(mmtbc1_20120417 >= 6551,1,'first'),length(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first')) = interp1([find(mmtbc1_20120417>6553,1,'first') find(mmtbc1_20120417 >= 6577,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6553,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6577,1,'first'))] , linspace(find(mmtbc1_20120417>6553,1,'first'),find(mmtbc1_20120417 >= 6577,1,'first'),length(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first')) = interp1([find(mmtbc1_20120417>6577,1,'first') find(mmtbc1_20120417 >= 6597,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6577,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6597,1,'first'))] , linspace(find(mmtbc1_20120417>6577,1,'first'),find(mmtbc1_20120417 >= 6597,1,'first'),length(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6705,1,'first'):find(mmtbc1_20120417 >= 6735,1,'first')) = interp1([find(mmtbc1_20120417>6705,1,'first') find(mmtbc1_20120417 >= 6735,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6705,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6735,1,'first'))] , linspace(find(mmtbc1_20120417>6705,1,'first'),find(mmtbc1_20120417 >= 6735,1,'first'),length(find(mmtbc1_20120417>6705,1,'first'):find(mmtbc1_20120417 >= 6735,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6737,1,'first'):find(mmtbc1_20120417 >= 6786,1,'first')) = interp1([find(mmtbc1_20120417>6737,1,'first') find(mmtbc1_20120417 >= 6786,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6737,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6786,1,'first'))] , linspace(find(mmtbc1_20120417>6737,1,'first'),find(mmtbc1_20120417 >= 6786,1,'first'),length(find(mmtbc1_20120417>6737,1,'first'):find(mmtbc1_20120417 >= 6786,1,'first'))));


Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6543,1,'first'):find(Lkast1_20120223 >= 6551,1,'first')) = interp1([find(Lkast1_20120223>6543,1,'first') find(Lkast1_20120223 >= 6551,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6543,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6551,1,'first'))] , linspace(find(Lkast1_20120223>6543,1,'first'),find(Lkast1_20120223 >= 6551,1,'first'),length(find(Lkast1_20120223>6543,1,'first'):find(Lkast1_20120223 >= 6551,1,'first'))));
Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6554,1,'first'):find(Lkast1_20120223 >= 6574,1,'first')) = interp1([find(Lkast1_20120223>6554,1,'first') find(Lkast1_20120223 >= 6574,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6554,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6574,1,'first'))] , linspace(find(Lkast1_20120223>6554,1,'first'),find(Lkast1_20120223 >= 6574,1,'first'),length(find(Lkast1_20120223>6554,1,'first'):find(Lkast1_20120223 >= 6574,1,'first'))));
Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6576,1,'first'):find(Lkast1_20120223 >= 6590,1,'first')) = interp1([find(Lkast1_20120223>6576,1,'first') find(Lkast1_20120223 >= 6590,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6576,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6590,1,'first'))] , linspace(find(Lkast1_20120223>6576,1,'first'),find(Lkast1_20120223 >= 6590,1,'first'),length(find(Lkast1_20120223>6576,1,'first'):find(Lkast1_20120223 >= 6590,1,'first'))));                  
Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6700,1,'first'):find(Lkast1_20120223 >= 6748,1,'first')) = interp1([find(Lkast1_20120223>6700,1,'first') find(Lkast1_20120223 >= 6748,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6700,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6748,1,'first'))] , linspace(find(Lkast1_20120223>6700,1,'first'),find(Lkast1_20120223 >= 6748,1,'first'),length(find(Lkast1_20120223>6700,1,'first'):find(Lkast1_20120223 >= 6748,1,'first'))));

Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6543,1,'first'):find(Lkast1_20120428 >= 6551,1,'first')) = interp1([find(Lkast1_20120428>6543,1,'first') find(Lkast1_20120428 >= 6551,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6543,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6551,1,'first'))] , linspace(find(Lkast1_20120428>6543,1,'first'),find(Lkast1_20120428 >= 6551,1,'first'),length(find(Lkast1_20120428>6543,1,'first'):find(Lkast1_20120428 >= 6551,1,'first'))));
Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6552,1,'first'):find(Lkast1_20120428 >= 6572,1,'first')) = interp1([find(Lkast1_20120428>6552,1,'first') find(Lkast1_20120428 >= 6572,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6552,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6572,1,'first'))] , linspace(find(Lkast1_20120428>6552,1,'first'),find(Lkast1_20120428 >= 6572,1,'first'),length(find(Lkast1_20120428>6552,1,'first'):find(Lkast1_20120428 >= 6572,1,'first'))));
Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6572,1,'first'):find(Lkast1_20120428 >= 6593,1,'first')) = interp1([find(Lkast1_20120428>6572,1,'first') find(Lkast1_20120428 >= 6593,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6572,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6593,1,'first'))] , linspace(find(Lkast1_20120428>6572,1,'first'),find(Lkast1_20120428 >= 6593,1,'first'),length(find(Lkast1_20120428>6572,1,'first'):find(Lkast1_20120428 >= 6593,1,'first'))));
Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6700,1,'first'):find(Lkast1_20120428 >= 6748,1,'first')) = interp1([find(Lkast1_20120428>6700,1,'first') find(Lkast1_20120428 >= 6748,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6700,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6748,1,'first'))] , linspace(find(Lkast1_20120428>6700,1,'first'),find(Lkast1_20120428 >= 6748,1,'first'),length(find(Lkast1_20120428>6700,1,'first'):find(Lkast1_20120428 >= 6748,1,'first'))));

keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6535,1,'first'):find(keckL1_20120616 >= 6551,1,'first')) = interp1([find(keckL1_20120616>6535,1,'first') find(keckL1_20120616 >= 6551,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6535,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6551,1,'first'))] , linspace(find(keckL1_20120616>6535,1,'first'),find(keckL1_20120616 >= 6551,1,'first'),length(find(keckL1_20120616>6535,1,'first'):find(keckL1_20120616 >= 6551,1,'first'))));
keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6557,1,'first'):find(keckL1_20120616 >= 6570,1,'first')) = interp1([find(keckL1_20120616>6557,1,'first') find(keckL1_20120616 >= 6570,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6557,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6570,1,'first'))] , linspace(find(keckL1_20120616>6557,1,'first'),find(keckL1_20120616 >= 6570,1,'first'),length(find(keckL1_20120616>6557,1,'first'):find(keckL1_20120616 >= 6570,1,'first'))));
keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6579,1,'first'):find(keckL1_20120616 >= 6589,1,'first')) = interp1([find(keckL1_20120616>6579,1,'first') find(keckL1_20120616 >= 6589,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6579,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6589,1,'first'))] , linspace(find(keckL1_20120616>6579,1,'first'),find(keckL1_20120616 >= 6589,1,'first'),length(find(keckL1_20120616>6579,1,'first'):find(keckL1_20120616 >= 6589,1,'first'))));
keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6700,1,'first'):find(keckL1_20120616 >= 6748,1,'first')) = interp1([find(keckL1_20120616>6700,1,'first') find(keckL1_20120616 >= 6748,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6700,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6748,1,'first'))] , linspace(find(keckL1_20120616>6700,1,'first'),find(keckL1_20120616 >= 6748,1,'first'),length(find(keckL1_20120616>6700,1,'first'):find(keckL1_20120616 >= 6748,1,'first'))));

keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6543,1,'first'):find(keckD1_20150521 >= 6551,1,'first')) = interp1([find(keckD1_20150521>6543,1,'first') find(keckD1_20150521 >= 6551,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6543,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6551,1,'first'))] , linspace(find(keckD1_20150521>6543,1,'first'),find(keckD1_20150521 >= 6551,1,'first'),length(find(keckD1_20150521>6543,1,'first'):find(keckD1_20150521 >= 6551,1,'first'))));
keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6557,1,'first'):find(keckD1_20150521 >= 6570,1,'first')) = interp1([find(keckD1_20150521>6557,1,'first') find(keckD1_20150521 >= 6570,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6557,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6570,1,'first'))] , linspace(find(keckD1_20150521>6557,1,'first'),find(keckD1_20150521 >= 6570,1,'first'),length(find(keckD1_20150521>6557,1,'first'):find(keckD1_20150521 >= 6570,1,'first'))));
keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6579,1,'first'):find(keckD1_20150521 >= 6587,1,'first')) = interp1([find(keckD1_20150521>6579,1,'first') find(keckD1_20150521 >= 6587,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6579,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6587,1,'first'))] , linspace(find(keckD1_20150521>6579,1,'first'),find(keckD1_20150521 >= 6587,1,'first'),length(find(keckD1_20150521>6579,1,'first'):find(keckD1_20150521 >= 6587,1,'first'))));
keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6700,1,'first'):find(keckD1_20150521 >= 6748,1,'first')) = interp1([find(keckD1_20150521>6700,1,'first') find(keckD1_20150521 >= 6748,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6700,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6748,1,'first'))] , linspace(find(keckD1_20150521>6700,1,'first'),find(keckD1_20150521 >= 6748,1,'first'),length(find(keckD1_20150521>6700,1,'first'):find(keckD1_20150521 >= 6748,1,'first'))));


%other below


%clf
%hold all
%plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,keckD2_20121115_interpsub(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 1 0])
%plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 0 0])



%find center of broad line

hetms2_20120207_centerb = hetms1_20120207(hetms2_20120207_halphacontfitnormsubinterp==max(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6462.8 & hetms1_20120207<6662.8))))
hetms2_20120216_centerb = hetms1_20120216(hetms2_20120216_halphacontfitnormsubinterp==max(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6462.8 & hetms1_20120216<6662.8))))
Lkast2_20120223_centerb = Lkast1_20120223(Lkast2_20120223_halphacontfitnormsubinterp==max(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6462.8 & Lkast1_20120223<6662.8))))
mmtbc2_20120301_centerb = mmtbc1_20120301(mmtbc2_20120301_halphacontfitnormsubinterp==max(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6462.8 & mmtbc1_20120301<6662.8))))
hetms2_20120301_centerb = hetms1_20120301(hetms2_20120301_halphacontfitnormsubinterp==max(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6462.8 & hetms1_20120301<6662.8))))
spolb2_20120323_centerb = spolb1_20120323(spolb2_20120323_halphacontfitnormsubinterp==max(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6462.8 & spolb1_20120323<6662.8))))
spolm2_20120416_centerb = spolm1_20120416(spolm2_20120416_halphacontfitnormsubinterp==max(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6462.8 & spolm1_20120416<6662.8))))
mmtbc2_20120417_centerb = mmtbc1_20120417(mmtbc2_20120417_halphacontfitnormsubinterp==max(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6462.8 & mmtbc1_20120417<6662.8))))
Lkast2_20120428_centerb = Lkast1_20120428(Lkast2_20120428_halphacontfitnormsubinterp==max(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6462.8 & Lkast1_20120428<6662.8))))
mmtbc2_20120529_centerb = mmtbc1_20120529(mmtbc2_20120529_halphacontfitnormsubinterp==max(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6462.8 & mmtbc1_20120529<6662.8))))
keckL2_20120616_centerb = keckL1_20120616(keckL2_20120616_halphacontfitnormsubinterp==max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6462.8 & keckL1_20120616<6662.8))))
mmtbc2_20120701_centerb = mmtbc1_20120701(mmtbc2_20120701_halphacontfitnormsubinterp==max(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6462.8 & mmtbc1_20120701<6662.8))))
keckD2_20121115_centerb = keckD1_20121115(keckD2_20121115_halphacontfitnormsubinterp==max(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6462.8 & keckD1_20121115<6662.8))))
keckD2_20150521_centerb = keckD1_20150521(keckD2_20150521_halphacontfitnormsubinterp==max(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6462.8 & keckD1_20150521<6662.8))))












%measure EW on each side

leftEWhigh(1) = trapz(hetms1_20120207(find(hetms1_20120207 >= 6213 & hetms1_20120207 <= hetms2_20120207_centern)),hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6213 & hetms1_20120207 <= hetms2_20120207_centern)))
leftNEWerr(1) = 5*std(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6000 & hetms1_20120207 <= 6300)));
leftdEWhigh(1) = leftNEWerr(1) * leftEWhigh(1);
rightEWhigh(1) = trapz(hetms1_20120207(find(hetms1_20120207 >= hetms2_20120207_centern & hetms1_20120207 <= 6913)),hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= hetms2_20120207_centern & hetms1_20120207 <= 6913))) 
rightNEWerr(1) = 5*std(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6000 & hetms1_20120207 <= 6300)));
rightdEWhigh(1) = rightNEWerr(1) * rightEWhigh(1);

leftEWhigh(2) = trapz(hetms1_20120216(find(hetms1_20120216 >= 6213 & hetms1_20120216 <= hetms2_20120216_centern)),hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6213 & hetms1_20120216 <= hetms2_20120216_centern)))
leftNEWerr(2) = 5*std(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6000 & hetms1_20120216 <= 6300)));
leftdEWhigh(2) = leftNEWerr(2) * leftEWhigh(2);
rightEWhigh(2) = trapz(hetms1_20120216(find(hetms1_20120216 >= hetms2_20120216_centern & hetms1_20120216 <= 6913)),hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= hetms2_20120216_centern & hetms1_20120216 <= 6913))) 
rightNEWerr(2) = 5*std(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6000 & hetms1_20120216 <= 6300)));
rightdEWhigh(2) = rightNEWerr(2) * rightEWhigh(2);

leftEWhigh(3) = trapz(Lkast1_20120223(find(Lkast1_20120223 >= 6213 & Lkast1_20120223 <= Lkast2_20120223_centern)),Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6213 & Lkast1_20120223 <= Lkast2_20120223_centern)))
leftNEWerr(3) = 5*std(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6000 & Lkast1_20120223 <= 6300)));
leftdEWhigh(3) = leftNEWerr(3) * leftEWhigh(3);
rightEWhigh(3) = trapz(Lkast1_20120223(find(Lkast1_20120223 >= Lkast2_20120223_centern & Lkast1_20120223 <= 6913)),Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= Lkast2_20120223_centern & Lkast1_20120223 <= 6913))) 
rightNEWerr(3) = 5*std(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6000 & Lkast1_20120223 <= 6300)));
rightdEWhigh(3) = rightNEWerr(3) * rightEWhigh(3);

leftEWhigh(4) = trapz(hetms1_20120301(find(hetms1_20120301 >= 6213 & hetms1_20120301 <= hetms2_20120301_centern)),hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6213 & hetms1_20120301 <= hetms2_20120301_centern)))
leftNEWerr(4) = 5*std(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6000 & hetms1_20120301 <= 6300)));
leftdEWhigh(4) = leftNEWerr(4) * leftEWhigh(4);
rightEWhigh(4) = trapz(hetms1_20120301(find(hetms1_20120301 >= hetms2_20120301_centern & hetms1_20120301 <= 6913)),hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= hetms2_20120301_centern & hetms1_20120301 <= 6913))) 
rightNEWerr(4) = 5*std(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6000 & hetms1_20120301 <= 6300)));
rightdEWhigh(4) = rightNEWerr(4) * rightEWhigh(4);

leftEWhigh(5) = trapz(mmtbc1_20120301(find(mmtbc1_20120301 >= 6213 & mmtbc1_20120301 <= mmtbc2_20120301_centern)),mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6213 & mmtbc1_20120301 <= mmtbc2_20120301_centern)))
leftNEWerr(5) = 5*std(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6000 & mmtbc1_20120301 <= 6300)));
leftdEWhigh(5) = leftNEWerr(5) * leftEWhigh(5);
rightEWhigh(5) = trapz(mmtbc1_20120301(find(mmtbc1_20120301 >= mmtbc2_20120301_centern & mmtbc1_20120301 <= 6913)),mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= mmtbc2_20120301_centern & mmtbc1_20120301 <= 6913))) 
rightNEWerr(5) = 5*std(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6000 & mmtbc1_20120301 <= 6300)));
rightdEWhigh(5) = rightNEWerr(5) * rightEWhigh(5);

leftEWhigh(6) = trapz(spolb1_20120323(find(spolb1_20120323 >= 6213 & spolb1_20120323 <= spolb2_20120323_centern)),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6213 & spolb1_20120323 <= spolb2_20120323_centern)))
leftNEWerr(6) = 5*std(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6000 & spolb1_20120323 <= 6300)));
leftdEWhigh(6) = leftNEWerr(6) * leftEWhigh(6);
rightEWhigh(6) = trapz(spolb1_20120323(find(spolb1_20120323 >= spolb2_20120323_centern & spolb1_20120323 <= 6913)),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= spolb2_20120323_centern & spolb1_20120323 <= 6913))) 
rightNEWerr(6) = 5*std(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6000 & spolb1_20120323 <= 6300)));
rightdEWhigh(6) = rightNEWerr(6) * rightEWhigh(6);

leftEWhigh(7) = trapz(spolm1_20120416(find(spolm1_20120416 >= 6213 & spolm1_20120416 <= spolm2_20120416_centern)),spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6213 & spolm1_20120416 <= spolm2_20120416_centern)))
leftNEWerr(7) = 5*std(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6000 & spolm1_20120416 <= 6300)));
leftdEWhigh(7) = leftNEWerr(7) * leftEWhigh(7);
rightEWhigh(7) = trapz(spolm1_20120416(find(spolm1_20120416 >= spolm2_20120416_centern & spolm1_20120416 <= 6913)),spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= spolm2_20120416_centern & spolm1_20120416 <= 6913))) 
rightNEWerr(7) = 5*std(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6000 & spolm1_20120416 <= 6300)));
rightdEWhigh(7) = rightNEWerr(7) * rightEWhigh(7);

leftEWhigh(8) = trapz(mmtbc1_20120417(find(mmtbc1_20120417 >= 6213 & mmtbc1_20120417 <= mmtbc2_20120417_centern)),mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6213 & mmtbc1_20120417 <= mmtbc2_20120417_centern)))
leftNEWerr(8) = 5*std(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6000 & mmtbc1_20120417 <= 6300)));
leftdEWhigh(8) = leftNEWerr(8) * leftEWhigh(8);
rightEWhigh(8) = trapz(mmtbc1_20120417(find(mmtbc1_20120417 >= mmtbc2_20120417_centern & mmtbc1_20120417 <= 6913)),mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= mmtbc2_20120417_centern & mmtbc1_20120417 <= 6913))) 
rightNEWerr(8) = 5*std(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6000 & mmtbc1_20120417 <= 6300)));
rightdEWhigh(8) = rightNEWerr(8) * rightEWhigh(8);

leftEWhigh(9) = trapz(Lkast1_20120428(find(Lkast1_20120428 >= 6213 & Lkast1_20120428 <= Lkast2_20120428_centern)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6213 & Lkast1_20120428 <= Lkast2_20120428_centern)))
leftNEWerr(9) = 5*std(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6000 & Lkast1_20120428 <= 6300)));
leftdEWhigh(9) = leftNEWerr(9) * leftEWhigh(9);
rightEWhigh(9) = trapz(Lkast1_20120428(find(Lkast1_20120428 >= Lkast2_20120428_centern & Lkast1_20120428 <= 6913)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= Lkast2_20120428_centern & Lkast1_20120428 <= 6913))) 
rightNEWerr(9) = 5*std(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6000 & Lkast1_20120428 <= 6300)));
rightdEWhigh(9) = rightNEWerr(9) * rightEWhigh(9);

leftEWhigh(10) = trapz(mmtbc1_20120529(find(mmtbc1_20120529 >= 6213 & mmtbc1_20120529 <= mmtbc2_20120529_centern)),mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6213 & mmtbc1_20120529 <= mmtbc2_20120529_centern)))
leftNEWerr(10) = 5*std(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6000 & mmtbc1_20120529 <= 6300)));
leftdEWhigh(10) = leftNEWerr(10) * leftEWhigh(10);
rightEWhigh(10) = trapz(mmtbc1_20120529(find(mmtbc1_20120529 >= mmtbc2_20120529_centern & mmtbc1_20120529 <= 6913)),mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= mmtbc2_20120529_centern & mmtbc1_20120529 <= 6913)))
rightNEWerr(10) = 5*std(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6000 & mmtbc1_20120529 <= 6300)));
rightdEWhigh(10) = rightNEWerr(10) * rightEWhigh(10);

leftEWhigh(11) = trapz(keckL1_20120616(find(keckL1_20120616 >= 6213 & keckL1_20120616 <= keckL2_20120616_centern)),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6213 & keckL1_20120616 <= keckL2_20120616_centern)))
leftNEWerr(11) = 5*std(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6000 & keckL1_20120616 <= 6300)));
leftdEWhigh(11) = leftNEWerr(11) * leftEWhigh(11);
rightEWhigh(11) = trapz(keckL1_20120616(find(keckL1_20120616 >= keckL2_20120616_centern & keckL1_20120616 <= 6913)),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= keckL2_20120616_centern & keckL1_20120616 <= 6913)))
rightNEWerr(11) = 5*std(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6000 & keckL1_20120616 <= 6300)));
rightdEWhigh(11) = rightNEWerr(11) * rightEWhigh(11);

leftEWhigh(12) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 >= 6213 & mmtbc1_20120701 <= mmtbc2_20120701_centern)),mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6213 & mmtbc1_20120701 <= mmtbc2_20120701_centern)))
leftNEWerr(12) = 5*std(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6000 & mmtbc1_20120701 <= 6300)));
leftdEWhigh(12) = leftNEWerr(12) * leftEWhigh(12);
rightEWhigh(12) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 >= mmtbc2_20120701_centern & mmtbc1_20120701 <= 6913)),mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= mmtbc2_20120701_centern & mmtbc1_20120701 <= 6913)))
rightNEWerr(12) = 5*std(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6000 & mmtbc1_20120701 <= 6300)));
rightdEWhigh(12) = rightNEWerr(12) * rightEWhigh(12);

leftEWhigh(13) = trapz(keckD1_20121115(find(keckD1_20121115 >= 6213 & keckD1_20121115 <= keckD2_20121115_centern)),keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6213 & keckD1_20121115 <= keckD2_20121115_centern)))
leftNEWerr(13) = 5*std(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6000 & keckD1_20121115 <= 6300)));
leftdEWhigh(13) = leftNEWerr(13) * leftEWhigh(13);
rightEWhigh(13) = trapz(keckD1_20121115(find(keckD1_20121115 >= keckD2_20121115_centern & keckD1_20121115 <= 6913)),keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= keckD2_20121115_centern & keckD1_20121115 <= 6913)))
rightNEWerr(13) = 5*std(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6000 & keckD1_20121115 <= 6300)));
rightdEWhigh(13) = rightNEWerr(13) * rightEWhigh(13);

leftEWhigh(14) = trapz(keckD1_20150521(find(keckD1_20150521 >= 6213 & keckD1_20150521 <= keckD2_20150521_centern)),keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6213 & keckD1_20150521 <= keckD2_20150521_centern)))
leftNEWerr(14) = 5*std(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6000 & keckD1_20150521 <= 6300)));
leftdEWhigh(14) = leftNEWerr(14) * leftEWhigh(14);
rightEWhigh(14) = trapz(keckD1_20150521(find(keckD1_20150521 >= keckD2_20150521_centern & keckD1_20150521 <= 6913)),keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= keckD2_20150521_centern & keckD1_20150521 <= 6913)))
rightNEWerr(14) = 5*std(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6000 & keckD1_20150521 <= 6300)));
rightdEWhigh(14) = rightNEWerr(14) * rightEWhigh(14);



%using location of peak of narrow component as maximum value for half width half maximum measurement
%interpolate between actual 0.5



for i=1:length(hetms1_20120207(find(hetms1_20120207 >= 6213 & hetms1_20120207 <= hetms2_20120207_centern)))
	leftfracheight(1,i) = hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6213,1,'first')+(i-1))/hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern));
end
for i=1:length(hetms1_20120207(find(hetms1_20120207 >= hetms2_20120207_centern & hetms1_20120207 <= 6913)))
	rightfracheight(1,i) = hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern)+(i-1))/hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern));
end

leftfracdif(1) = (leftfracheight(1,find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last')+1) - leftfracheight(1,find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last')))
leftwavdif(1) = (hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last'))) - hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last')-1)))
leftfracinterpoladjustment(1) = (0.5 - leftfracheight(1,find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last')))*(leftwavdif(1)/leftfracdif(1))
widthofleft50height(1) = hetms2_20120207_centern - (hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last')-1))+leftfracinterpoladjustment(1))

rightfracdif(1) = (rightfracheight(1,find(rightfracheight(1,:)<=0.5&rightfracheight(1,:)>0,1,'first')-1) - rightfracheight(1,find(rightfracheight(1,:)<=0.5&rightfracheight(1,:)>0,1,'first')))
rightwavdif(1) = (hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(rightfracheight(1,:)<=0.5&rightfracheight(1,:)>0,1,'first'))) - hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(rightfracheight(1,:)<=0.5&rightfracheight(1,:)>0,1,'first')-1)))
rightfracinterpoladjustment(1) = (0.5 - rightfracheight(1,find(rightfracheight(1,:)<=0.5&rightfracheight(1,:)>0,1,'first')))*(rightwavdif(1)/rightfracdif(1))
widthofright50height(1) = (hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern) + (find(rightfracheight(1,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(1)) - hetms2_20120207_centern 


for i=1:length(hetms1_20120216(find(hetms1_20120216 >= 6213 & hetms1_20120216 <= hetms2_20120216_centern)))
	leftfracheight(2,i) = hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6213,1,'first')+(i-1))/hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern));
end
for i=1:length(hetms1_20120216(find(hetms1_20120216 >= hetms2_20120216_centern & hetms1_20120216 <= 6913)))
	rightfracheight(2,i) = hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern)+(i-1))/hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern));
end
leftfracdif(2) = (leftfracheight(2,find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last')+1) - leftfracheight(2,find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last')))
leftwavdif(2) = (hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last'))) - hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last')-1)))
leftfracinterpoladjustment(2) = (0.5 - leftfracheight(2,find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last')))*(leftwavdif(2)/leftfracdif(2))
widthofleft50height(2) = hetms2_20120216_centern - (hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last')-1))+leftfracinterpoladjustment(2))

rightfracdif(2) = (rightfracheight(2,find(rightfracheight(2,:)<=0.5&rightfracheight(2,:)>0,1,'first')-1) - rightfracheight(2,find(rightfracheight(2,:)<=0.5&rightfracheight(2,:)>0,1,'first')))
rightwavdif(2) = (hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(rightfracheight(2,:)<=0.5&rightfracheight(2,:)>0,1,'first'))) - hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(rightfracheight(2,:)<=0.5&rightfracheight(2,:)>0,1,'first')-1)))
rightfracinterpoladjustment(2) = (0.5 - rightfracheight(2,find(rightfracheight(2,:)<=0.5&rightfracheight(2,:)>0,1,'first')))*(rightwavdif(2)/rightfracdif(2))
widthofright50height(2) = (hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern) + (find(rightfracheight(2,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(2)) - hetms2_20120216_centern 

for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= 6213 & Lkast1_20120223 <= Lkast2_20120223_centern)))
	leftfracheight(3,i) = Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6213,1,'first')+(i-1))/Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern));
end
for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= Lkast2_20120223_centern & Lkast1_20120223 <= 6913)))
	rightfracheight(3,i) = Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern)+(i-1))/Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern));
end
leftfracdif(3) = (leftfracheight(3,find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last')+1) - leftfracheight(3,find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last')))
leftwavdif(3) = (Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last'))) - Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last')-1)))
leftfracinterpoladjustment(3) = (0.5 - leftfracheight(3,find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last')))*(leftwavdif(3)/leftfracdif(3))
widthofleft50height(3) = Lkast2_20120223_centern - (Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last')-1))+leftfracinterpoladjustment(3))

rightfracdif(3) = (rightfracheight(3,find(rightfracheight(3,:)<=0.5&rightfracheight(3,:)>0,1,'first')-1) - rightfracheight(3,find(rightfracheight(3,:)<=0.5&rightfracheight(3,:)>0,1,'first')))
rightwavdif(3) = (Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(rightfracheight(3,:)<=0.5&rightfracheight(3,:)>0,1,'first'))) - Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(rightfracheight(3,:)<=0.5&rightfracheight(3,:)>0,1,'first')-1)))
rightfracinterpoladjustment(3) = (0.5 - rightfracheight(3,find(rightfracheight(3,:)<=0.5&rightfracheight(3,:)>0,1,'first')))*(rightwavdif(3)/rightfracdif(3))
widthofright50height(3) = (Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern) + (find(rightfracheight(3,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(3)) - Lkast2_20120223_centern 



for i=1:length(hetms1_20120301(find(hetms1_20120301 >= 6213 & hetms1_20120301 <= hetms2_20120301_centern)))
	leftfracheight(4,i) = hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6213,1,'first')+(i-1))/hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern));
end
for i=1:length(hetms1_20120301(find(hetms1_20120301 >= hetms2_20120301_centern & hetms1_20120301 <= 6913)))
	rightfracheight(4,i) = hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern)+(i-1))/hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern));
end
leftfracdif(4) = (leftfracheight(4,find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last')+1) - leftfracheight(4,find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last')))
leftwavdif(4) = (hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last'))) - hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last')-1)))
leftfracinterpoladjustment(4) = (0.5 - leftfracheight(4,find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last')))*(leftwavdif(4)/leftfracdif(4))
widthofleft50height(4) = hetms2_20120301_centern - (hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last')-1))+leftfracinterpoladjustment(4))

rightfracdif(4) = (rightfracheight(4,find(rightfracheight(4,:)<=0.5&rightfracheight(4,:)>0,1,'first')-1) - rightfracheight(4,find(rightfracheight(4,:)<=0.5&rightfracheight(4,:)>0,1,'first')))
rightwavdif(4) = (hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(rightfracheight(4,:)<=0.5&rightfracheight(4,:)>0,1,'first'))) - hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(rightfracheight(4,:)<=0.5&rightfracheight(4,:)>0,1,'first')-1)))
rightfracinterpoladjustment(4) = (0.5 - rightfracheight(4,find(rightfracheight(4,:)<=0.5&rightfracheight(4,:)>0,1,'first')))*(rightwavdif(4)/rightfracdif(4))
widthofright50height(4) = (hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern) + (find(rightfracheight(4,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(4)) - hetms2_20120301_centern 


for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= 6213 & mmtbc1_20120301 <= mmtbc2_20120301_centern)))
	leftfracheight(5,i) = mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6213,1,'first')+(i-1))/mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern));
end
for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= mmtbc2_20120301_centern & mmtbc1_20120301 <= 6913)))
	rightfracheight(5,i) = mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern)+(i-1))/mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern));
end
leftfracdif(5) = (leftfracheight(5,find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last')+1) - leftfracheight(5,find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last')))
leftwavdif(5) = (mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last'))) - mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last')-1)))
leftfracinterpoladjustment(5) = (0.5 - leftfracheight(5,find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last')))*(leftwavdif(5)/leftfracdif(5))
widthofleft50height(5) = mmtbc2_20120301_centern - (mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last')-1))+leftfracinterpoladjustment(5))

rightfracdif(5) = (rightfracheight(5,find(rightfracheight(5,:)<=0.5&rightfracheight(5,:)>0,1,'first')-1) - rightfracheight(5,find(rightfracheight(5,:)<=0.5&rightfracheight(5,:)>0,1,'first')))
rightwavdif(5) = (mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(rightfracheight(5,:)<=0.5&rightfracheight(5,:)>0,1,'first'))) - mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(rightfracheight(5,:)<=0.5&rightfracheight(5,:)>0,1,'first')-1)))
rightfracinterpoladjustment(5) = (0.5 - rightfracheight(5,find(rightfracheight(5,:)<=0.5&rightfracheight(5,:)>0,1,'first')))*(rightwavdif(5)/rightfracdif(5))
widthofright50height(5) = (mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern) + (find(rightfracheight(5,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(5)) - mmtbc2_20120301_centern 


for i=1:length(spolb1_20120323(find(spolb1_20120323 >= 6213 & spolb1_20120323 <= spolb2_20120323_centern)))
	leftfracheight(6,i) = spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6213,1,'first')+(i-1))/spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern));
end
for i=1:length(spolb1_20120323(find(spolb1_20120323 >= spolb2_20120323_centern & spolb1_20120323 <= 6913)))
	rightfracheight(6,i) = spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern)+(i-1))/spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern));
end
leftfracdif(6) = (leftfracheight(6,find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last')+1) - leftfracheight(6,find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last')))
leftwavdif(6) = (spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last'))) - spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last')-1)))
leftfracinterpoladjustment(6) = (0.5 - leftfracheight(6,find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last')))*(leftwavdif(6)/leftfracdif(6))
widthofleft50height(6) = spolb2_20120323_centern - (spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last')-1))+leftfracinterpoladjustment(6))

rightfracdif(6) = (rightfracheight(6,find(rightfracheight(6,:)<=0.5&rightfracheight(6,:)>0,1,'first')-1) - rightfracheight(6,find(rightfracheight(6,:)<=0.5&rightfracheight(6,:)>0,1,'first')))
rightwavdif(6) = (spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(rightfracheight(6,:)<=0.5&rightfracheight(6,:)>0,1,'first'))) - spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(rightfracheight(6,:)<=0.5&rightfracheight(6,:)>0,1,'first')-1)))
rightfracinterpoladjustment(6) = (0.5 - rightfracheight(6,find(rightfracheight(6,:)<=0.5&rightfracheight(6,:)>0,1,'first')))*(rightwavdif(6)/rightfracdif(6))
widthofright50height(6) = (spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern) + (find(rightfracheight(6,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(6)) - spolb2_20120323_centern 


for i=1:length(spolm1_20120416 (find(spolm1_20120416  >= 6213 & spolm1_20120416  <= spolm2_20120416_centern)))
	leftfracheight(7,i) = spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  >= 6213,1,'first')+(i-1))/spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern));
end
for i=1:length(spolm1_20120416 (find(spolm1_20120416  >= spolm2_20120416_centern & spolm1_20120416  <= 6913)))
	rightfracheight(7,i) = spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern)+(i-1))/spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern));
end
leftfracdif(7) = (leftfracheight(7,find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last')+1) - leftfracheight(7,find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last')))
leftwavdif(7) = (spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last'))) - spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last')-1)))
leftfracinterpoladjustment(7) = (0.5 - leftfracheight(7,find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last')))*(leftwavdif(7)/leftfracdif(7))
widthofleft50height(7) = spolm2_20120416_centern - (spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last')-1))+leftfracinterpoladjustment(7))

rightfracdif(7) = (rightfracheight(7,find(rightfracheight(7,:)<=0.5&rightfracheight(7,:)>0,1,'first')-1) - rightfracheight(7,find(rightfracheight(7,:)<=0.5&rightfracheight(7,:)>0,1,'first')))
rightwavdif(7) = (spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(rightfracheight(7,:)<=0.5&rightfracheight(7,:)>0,1,'first'))) - spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(rightfracheight(7,:)<=0.5&rightfracheight(7,:)>0,1,'first')-1)))
rightfracinterpoladjustment(7) = (0.5 - rightfracheight(7,find(rightfracheight(7,:)<=0.5&rightfracheight(7,:)>0,1,'first')))*(rightwavdif(7)/rightfracdif(7))
widthofright50height(7) = (spolm1_20120416(find(spolm1_20120416 == spolm2_20120416_centern) + (find(rightfracheight(7,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(7)) - spolm2_20120416_centern 


for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= 6213 & mmtbc1_20120417 <= mmtbc2_20120417_centern)))
	leftfracheight(8,i) = mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6213,1,'first')+(i-1))/mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern));
end
for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= mmtbc2_20120417_centern & mmtbc1_20120417 <= 6913)))
	rightfracheight(8,i) = mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern)+(i-1))/mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern));
end
leftfracdif(8) = (leftfracheight(8,find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last')+1) - leftfracheight(8,find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last')))
leftwavdif(8) = (mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last'))) - mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last')-1)))
leftfracinterpoladjustment(8) = (0.5 - leftfracheight(8,find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last')))*(leftwavdif(8)/leftfracdif(8))
widthofleft50height(8) = mmtbc2_20120417_centern - (mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last')-1))+leftfracinterpoladjustment(8))

rightfracdif(8) = (rightfracheight(8,find(rightfracheight(8,:)<=0.5&rightfracheight(8,:)>0,1,'first')-1) - rightfracheight(8,find(rightfracheight(8,:)<=0.5&rightfracheight(8,:)>0,1,'first')))
rightwavdif(8) = (mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(rightfracheight(8,:)<=0.5&rightfracheight(8,:)>0,1,'first'))) - mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(rightfracheight(8,:)<=0.5&rightfracheight(8,:)>0,1,'first')-1)))
rightfracinterpoladjustment(8) = (0.5 - rightfracheight(8,find(rightfracheight(8,:)<=0.5&rightfracheight(8,:)>0,1,'first')))*(rightwavdif(8)/rightfracdif(8))
widthofright50height(8) = (mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern) + (find(rightfracheight(8,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(8)) - mmtbc2_20120417_centern 


for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= 6213 & Lkast1_20120428 <= Lkast2_20120428_centern)))
	leftfracheight(9,i) = Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6213,1,'first')+(i-1))/Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern));
end
for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= Lkast2_20120428_centern & Lkast1_20120428 <= 6913)))
	rightfracheight(9,i) = Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern)+(i-1))/Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern));
end
leftfracdif(9) = (leftfracheight(9,find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last')+1) - leftfracheight(9,find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last')))
leftwavdif(9) = (Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last'))) - Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last')-1)))
leftfracinterpoladjustment(9) = (0.5 - leftfracheight(9,find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last')))*(leftwavdif(9)/leftfracdif(9))
widthofleft50height(9) = Lkast2_20120428_centern - (Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last')-1))+leftfracinterpoladjustment(9))

rightfracdif(9) = (rightfracheight(9,find(rightfracheight(9,:)<=0.5&rightfracheight(9,:)>0,1,'first')-1) - rightfracheight(9,find(rightfracheight(9,:)<=0.5&rightfracheight(9,:)>0,1,'first')))
rightwavdif(9) = (Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(rightfracheight(9,:)<=0.5&rightfracheight(9,:)>0,1,'first'))) - Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(rightfracheight(9,:)<=0.5&rightfracheight(9,:)>0,1,'first')-1)))
rightfracinterpoladjustment(9) = (0.5 - rightfracheight(9,find(rightfracheight(9,:)<=0.5&rightfracheight(9,:)>0,1,'first')))*(rightwavdif(9)/rightfracdif(9))
widthofright50height(9) = (Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern) + (find(rightfracheight(9,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(9)) - Lkast2_20120428_centern 


for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= 6213 & mmtbc1_20120529 <= mmtbc2_20120529_centern)))
	leftfracheight(10,i) = mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6213,1,'first')+(i-1))/mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern));
end
for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= mmtbc2_20120529_centern & mmtbc1_20120529 <= 6913)))
	rightfracheight(10,i) = mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern)+(i-1))/mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern));
end
leftfracdif(10) = (leftfracheight(10,find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last')+1) - leftfracheight(10,find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last')))
leftwavdif(10) = (mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last'))) - mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last')-1)))
leftfracinterpoladjustment(10) = (0.5 - leftfracheight(10,find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last')))*(leftwavdif(10)/leftfracdif(10))
widthofleft50height(10) = mmtbc2_20120529_centern - (mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last')-1))+leftfracinterpoladjustment(10))

rightfracdif(10) = (rightfracheight(10,find(rightfracheight(10,:)<=0.5&rightfracheight(10,:)>0,1,'first')-1) - rightfracheight(10,find(rightfracheight(10,:)<=0.5&rightfracheight(10,:)>0,1,'first')))
rightwavdif(10) = (mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(rightfracheight(10,:)<=0.5&rightfracheight(10,:)>0,1,'first'))) - mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(rightfracheight(10,:)<=0.5&rightfracheight(10,:)>0,1,'first')-1)))
rightfracinterpoladjustment(10) = (0.5 - rightfracheight(10,find(rightfracheight(10,:)<=0.5&rightfracheight(10,:)>0,1,'first')))*(rightwavdif(10)/rightfracdif(10))
widthofright50height(10) = (mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern) + (find(rightfracheight(10,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(10)) - mmtbc2_20120529_centern 


for i=1:length(keckL1_20120616(find(keckL1_20120616 >= 6213 & keckL1_20120616 <= keckL2_20120616_centern)))
	leftfracheight(11,i) = keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6213,1,'first')+(i-1))/keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern));
end
for i=1:length(keckL1_20120616(find(keckL1_20120616 >= keckL2_20120616_centern & keckL1_20120616 <= 6913)))
	rightfracheight(11,i) = keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern)+(i-1))/keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern));
end
leftfracdif(11) = (leftfracheight(11,find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last')+1) - leftfracheight(11,find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last')))
leftwavdif(11) = (keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last'))) - keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last')-1)))
leftfracinterpoladjustment(11) = (0.5 - leftfracheight(11,find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last')))*(leftwavdif(11)/leftfracdif(11))
widthofleft50height(11) = keckL2_20120616_centern - (keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last')-1))+leftfracinterpoladjustment(11))

rightfracdif(11) = (rightfracheight(11,find(rightfracheight(11,:)<=0.5&rightfracheight(11,:)>0,1,'first')-1) - rightfracheight(11,find(rightfracheight(11,:)<=0.5&rightfracheight(11,:)>0,1,'first')))
rightwavdif(11) = (keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(rightfracheight(11,:)<=0.5&rightfracheight(11,:)>0,1,'first'))) - keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(rightfracheight(11,:)<=0.5&rightfracheight(11,:)>0,1,'first')-1)))
rightfracinterpoladjustment(11) = (0.5 - rightfracheight(11,find(rightfracheight(11,:)<=0.5&rightfracheight(11,:)>0,1,'first')))*(rightwavdif(11)/rightfracdif(11))
widthofright50height(11) = (keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern) + (find(rightfracheight(11,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(11)) - keckL2_20120616_centern 


for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= 6213 & mmtbc1_20120701 <= mmtbc2_20120701_centern)))
	leftfracheight(12,i) = mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6213,1,'first')+(i-1))/mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern));
end
for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= mmtbc2_20120701_centern & mmtbc1_20120701 <= 6913)))
	rightfracheight(12,i) = mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern)+(i-1))/mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern));
end
leftfracdif(12) = (leftfracheight(12,find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last')+1) - leftfracheight(12,find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last')))
leftwavdif(12) = (mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last'))) - mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last')-1)))
leftfracinterpoladjustment(12) = (0.5 - leftfracheight(12,find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last')))*(leftwavdif(12)/leftfracdif(12))
widthofleft50height(12) = mmtbc2_20120701_centern - (mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last')-1))+leftfracinterpoladjustment(12))

rightfracdif(12) = (rightfracheight(12,find(rightfracheight(12,:)<=0.5&rightfracheight(12,:)>0,1,'first')-1) - rightfracheight(12,find(rightfracheight(12,:)<=0.5&rightfracheight(12,:)>0,1,'first')))
rightwavdif(12) = (mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(rightfracheight(12,:)<=0.5&rightfracheight(12,:)>0,1,'first'))) - mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(rightfracheight(12,:)<=0.5&rightfracheight(12,:)>0,1,'first')-1)))
rightfracinterpoladjustment(12) = (0.5 - rightfracheight(12,find(rightfracheight(12,:)<=0.5&rightfracheight(12,:)>0,1,'first')))*(rightwavdif(12)/rightfracdif(12))
widthofright50height(12) = (mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern) + (find(rightfracheight(12,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(12)) - mmtbc2_20120701_centern 


for i=1:length(keckD1_20121115(find(keckD1_20121115 >= 6213 & keckD1_20121115 <= keckD2_20121115_centern)))
	leftfracheight(13,i) = keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6213,1,'first')+(i-1))/keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern));
end
for i=1:length(keckD1_20121115(find(keckD1_20121115 >= keckD2_20121115_centern & keckD1_20121115 <= 6913)))
	rightfracheight(13,i) = keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern)+(i-1))/keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern));
end
leftfracdif(13) = (leftfracheight(13,find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last')+1) - leftfracheight(13,find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last')))
leftwavdif(13) = (keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last'))) - keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last')-1)))
leftfracinterpoladjustment(13) = (0.5 - leftfracheight(13,find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last')))*(leftwavdif(13)/leftfracdif(13))
widthofleft50height(13) = keckD2_20121115_centern - (keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last')-1))+leftfracinterpoladjustment(13))

rightfracdif(13) = (rightfracheight(13,find(rightfracheight(13,:)<=0.5&rightfracheight(13,:)>0,1,'first')-1) - rightfracheight(13,find(rightfracheight(13,:)<=0.5&rightfracheight(13,:)>0,1,'first')))
rightwavdif(13) = (keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(rightfracheight(13,:)<=0.5&rightfracheight(13,:)>0,1,'first'))) - keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(rightfracheight(13,:)<=0.5&rightfracheight(13,:)>0,1,'first')-1)))
rightfracinterpoladjustment(13) = (0.5 - rightfracheight(13,find(rightfracheight(13,:)<=0.5&rightfracheight(13,:)>0,1,'first')))*(rightwavdif(13)/rightfracdif(13))
widthofright50height(13) = (keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern) + (find(rightfracheight(13,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(13)) - keckD2_20121115_centern 


for i=1:length(keckD1_20150521(find(keckD1_20150521 >= 6213 & keckD1_20150521 <= keckD2_20150521_centern)))
	leftfracheight(14,i) = keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6213,1,'first')+(i-1))/keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern));
end
for i=1:length(keckD1_20150521(find(keckD1_20150521 >= keckD2_20150521_centern & keckD1_20150521 <= 6913)))
	rightfracheight(14,i) = keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern)+(i-1))/keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern));
end
leftfracdif(14) = (leftfracheight(14,find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last')+1) - leftfracheight(14,find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last')))
leftwavdif(14) = (keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last'))) - keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last')-1)))
leftfracinterpoladjustment(14) = (0.5 - leftfracheight(14,find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last')))*(leftwavdif(14)/leftfracdif(14))
widthofleft50height(14) = keckD2_20150521_centern - (keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last')-1))+leftfracinterpoladjustment(14))

rightfracdif(14) = (rightfracheight(14,find(rightfracheight(14,:)<=0.5&rightfracheight(14,:)>0,1,'first')-1) - rightfracheight(14,find(rightfracheight(14,:)<=0.5&rightfracheight(14,:)>0,1,'first')))
rightwavdif(14) = (keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(rightfracheight(14,:)<=0.5&rightfracheight(14,:)>0,1,'first'))) - keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(rightfracheight(14,:)<=0.5&rightfracheight(14,:)>0,1,'first')-1)))
rightfracinterpoladjustment(14) = (0.5 - rightfracheight(14,find(rightfracheight(14,:)<=0.5&rightfracheight(14,:)>0,1,'first')))*(rightwavdif(14)/rightfracdif(14))
widthofright50height(14) = (keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern) + (find(rightfracheight(14,:)<=0.5,1,'first')-1))+rightfracinterpoladjustment(14)) - keckD2_20150521_centern 






%using location of peak of broad component as maximum value for half width half maximum measurement
%width of right broad 50 height etc. are the number of angstroms from the center of the narrow line at which you reach 50% of maximum height of the broad line
%interpolate between actual 0.5

for i=1:length(hetms1_20120207(find(hetms1_20120207 >= 6213 & hetms1_20120207 <= hetms2_20120207_centern)))
	leftbroadfracheight(1,i) = hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6213,1,'first')+(i-1))/hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centerb));
end
for i=1:length(hetms1_20120207(find(hetms1_20120207 >= hetms2_20120207_centern & hetms1_20120207 <= 6913)))
	rightbroadfracheight(1,i) = hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern)+(i-1))/hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centerb));
end

leftbroadfracdif(1) = (leftbroadfracheight(1,find(leftbroadfracheight(1,:)<=0.5&leftbroadfracheight(1,:)>0,1,'last')+1) - leftbroadfracheight(1,find(leftbroadfracheight(1,:)<=0.5&leftbroadfracheight(1,:)>0,1,'last')))
leftbroadwavdif(1) = (hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(leftbroadfracheight(1,:)<=0.5&leftbroadfracheight(1,:)>0,1,'last'))) - hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(leftbroadfracheight(1,:)<=0.5&leftbroadfracheight(1,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(1) = (0.5 - leftbroadfracheight(1,find(leftbroadfracheight(1,:)<=0.5&leftbroadfracheight(1,:)>0,1,'last')))*(leftbroadwavdif(1)/leftbroadfracdif(1))
widthofleftbroad50height(1) = hetms2_20120207_centern - (hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(leftbroadfracheight(1,:)<=0.5&leftbroadfracheight(1,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(1))

rightbroadfracdif(1) = (rightbroadfracheight(1,find(rightbroadfracheight(1,:)<=0.5&rightbroadfracheight(1,:)>0,1,'first')-1) - rightbroadfracheight(1,find(rightbroadfracheight(1,:)<=0.5&rightbroadfracheight(1,:)>0,1,'first')))
rightbroadwavdif(1) = (hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(rightbroadfracheight(1,:)<=0.5&rightbroadfracheight(1,:)>0,1,'first'))) - hetms1_20120207(find(hetms1_20120207 >= 6213,1,'first') + (find(rightbroadfracheight(1,:)<=0.5&rightbroadfracheight(1,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(1) = (0.5 - rightbroadfracheight(1,find(rightbroadfracheight(1,:)<=0.5&rightbroadfracheight(1,:)>0,1,'first')))*(rightbroadwavdif(1)/rightbroadfracdif(1))
widthofrightbroad50height(1) = (hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern) + (find(rightbroadfracheight(1,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(1)) - hetms2_20120207_centern 


for i=1:length(hetms1_20120216(find(hetms1_20120216 >= 6213 & hetms1_20120216 <= hetms2_20120216_centern)))
	leftbroadfracheight(2,i) = hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6213,1,'first')+(i-1))/hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centerb));
end
for i=1:length(hetms1_20120216(find(hetms1_20120216 >= hetms2_20120216_centern & hetms1_20120216 <= 6913)))
	rightbroadfracheight(2,i) = hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern)+(i-1))/hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centerb));
end
leftbroadfracdif(2) = (leftbroadfracheight(2,find(leftbroadfracheight(2,:)<=0.5&leftbroadfracheight(2,:)>0,1,'last')+1) - leftbroadfracheight(2,find(leftbroadfracheight(2,:)<=0.5&leftbroadfracheight(2,:)>0,1,'last')))
leftbroadwavdif(2) = (hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(leftbroadfracheight(2,:)<=0.5&leftbroadfracheight(2,:)>0,1,'last'))) - hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(leftbroadfracheight(2,:)<=0.5&leftbroadfracheight(2,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(2) = (0.5 - leftbroadfracheight(2,find(leftbroadfracheight(2,:)<=0.5&leftbroadfracheight(2,:)>0,1,'last')))*(leftbroadwavdif(2)/leftbroadfracdif(2))
widthofleftbroad50height(2) = hetms2_20120216_centern - (hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(leftbroadfracheight(2,:)<=0.5&leftbroadfracheight(2,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(2))

rightbroadfracdif(2) = (rightbroadfracheight(2,find(rightbroadfracheight(2,:)<=0.5&rightbroadfracheight(2,:)>0,1,'first')-1) - rightbroadfracheight(2,find(rightbroadfracheight(2,:)<=0.5&rightbroadfracheight(2,:)>0,1,'first')))
rightbroadwavdif(2) = (hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(rightbroadfracheight(2,:)<=0.5&rightbroadfracheight(2,:)>0,1,'first'))) - hetms1_20120216(find(hetms1_20120216 >= 6213,1,'first') + (find(rightbroadfracheight(2,:)<=0.5&rightbroadfracheight(2,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(2) = (0.5 - rightbroadfracheight(2,find(rightbroadfracheight(2,:)<=0.5&rightbroadfracheight(2,:)>0,1,'first')))*(rightbroadwavdif(2)/rightbroadfracdif(2))
widthofrightbroad50height(2) = (hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern) + (find(rightbroadfracheight(2,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(2)) - hetms2_20120216_centern 

for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= 6213 & Lkast1_20120223 <= Lkast2_20120223_centern)))
	leftbroadfracheight(3,i) = Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6213,1,'first')+(i-1))/Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centerb));
end
for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= Lkast2_20120223_centern & Lkast1_20120223 <= 6913)))
	rightbroadfracheight(3,i) = Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern)+(i-1))/Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centerb));
end
leftbroadfracdif(3) = (leftbroadfracheight(3,find(leftbroadfracheight(3,:)<=0.5&leftbroadfracheight(3,:)>0,1,'last')+1) - leftbroadfracheight(3,find(leftbroadfracheight(3,:)<=0.5&leftbroadfracheight(3,:)>0,1,'last')))
leftbroadwavdif(3) = (Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(leftbroadfracheight(3,:)<=0.5&leftbroadfracheight(3,:)>0,1,'last'))) - Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(leftbroadfracheight(3,:)<=0.5&leftbroadfracheight(3,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(3) = (0.5 - leftbroadfracheight(3,find(leftbroadfracheight(3,:)<=0.5&leftbroadfracheight(3,:)>0,1,'last')))*(leftbroadwavdif(3)/leftbroadfracdif(3))
widthofleftbroad50height(3) = Lkast2_20120223_centern - (Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(leftbroadfracheight(3,:)<=0.5&leftbroadfracheight(3,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(3))

rightbroadfracdif(3) = (rightbroadfracheight(3,find(rightbroadfracheight(3,:)<=0.5&rightbroadfracheight(3,:)>0,1,'first')-1) - rightbroadfracheight(3,find(rightbroadfracheight(3,:)<=0.5&rightbroadfracheight(3,:)>0,1,'first')))
rightbroadwavdif(3) = (Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(rightbroadfracheight(3,:)<=0.5&rightbroadfracheight(3,:)>0,1,'first'))) - Lkast1_20120223(find(Lkast1_20120223 >= 6213,1,'first') + (find(rightbroadfracheight(3,:)<=0.5&rightbroadfracheight(3,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(3) = (0.5 - rightbroadfracheight(3,find(rightbroadfracheight(3,:)<=0.5&rightbroadfracheight(3,:)>0,1,'first')))*(rightbroadwavdif(3)/rightbroadfracdif(3))
widthofrightbroad50height(3) = (Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern) + (find(rightbroadfracheight(3,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(3)) - Lkast2_20120223_centern 



for i=1:length(hetms1_20120301(find(hetms1_20120301 >= 6213 & hetms1_20120301 <= hetms2_20120301_centern)))
	leftbroadfracheight(4,i) = hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6213,1,'first')+(i-1))/hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centerb));
end
for i=1:length(hetms1_20120301(find(hetms1_20120301 >= hetms2_20120301_centern & hetms1_20120301 <= 6913)))
	rightbroadfracheight(4,i) = hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern)+(i-1))/hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centerb));
end
leftbroadfracdif(4) = (leftbroadfracheight(4,find(leftbroadfracheight(4,:)<=0.5&leftbroadfracheight(4,:)>0,1,'last')+1) - leftbroadfracheight(4,find(leftbroadfracheight(4,:)<=0.5&leftbroadfracheight(4,:)>0,1,'last')))
leftbroadwavdif(4) = (hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(leftbroadfracheight(4,:)<=0.5&leftbroadfracheight(4,:)>0,1,'last'))) - hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(leftbroadfracheight(4,:)<=0.5&leftbroadfracheight(4,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(4) = (0.5 - leftbroadfracheight(4,find(leftbroadfracheight(4,:)<=0.5&leftbroadfracheight(4,:)>0,1,'last')))*(leftbroadwavdif(4)/leftbroadfracdif(4))
widthofleftbroad50height(4) = hetms2_20120301_centern - (hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(leftbroadfracheight(4,:)<=0.5&leftbroadfracheight(4,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(4))

rightbroadfracdif(4) = (rightbroadfracheight(4,find(rightbroadfracheight(4,:)<=0.5&rightbroadfracheight(4,:)>0,1,'first')-1) - rightbroadfracheight(4,find(rightbroadfracheight(4,:)<=0.5&rightbroadfracheight(4,:)>0,1,'first')))
rightbroadwavdif(4) = (hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(rightbroadfracheight(4,:)<=0.5&rightbroadfracheight(4,:)>0,1,'first'))) - hetms1_20120301(find(hetms1_20120301 >= 6213,1,'first') + (find(rightbroadfracheight(4,:)<=0.5&rightbroadfracheight(4,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(4) = (0.5 - rightbroadfracheight(4,find(rightbroadfracheight(4,:)<=0.5&rightbroadfracheight(4,:)>0,1,'first')))*(rightbroadwavdif(4)/rightbroadfracdif(4))
widthofrightbroad50height(4) = (hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern) + (find(rightbroadfracheight(4,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(4)) - hetms2_20120301_centern 


for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= 6213 & mmtbc1_20120301 <= mmtbc2_20120301_centern)))
	leftbroadfracheight(5,i) = mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6213,1,'first')+(i-1))/mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centerb));
end
for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= mmtbc2_20120301_centern & mmtbc1_20120301 <= 6913)))
	rightbroadfracheight(5,i) = mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern)+(i-1))/mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centerb));
end
leftbroadfracdif(5) = (leftbroadfracheight(5,find(leftbroadfracheight(5,:)<=0.5&leftbroadfracheight(5,:)>0,1,'last')+1) - leftbroadfracheight(5,find(leftbroadfracheight(5,:)<=0.5&leftbroadfracheight(5,:)>0,1,'last')))
leftbroadwavdif(5) = (mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(leftbroadfracheight(5,:)<=0.5&leftbroadfracheight(5,:)>0,1,'last'))) - mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(leftbroadfracheight(5,:)<=0.5&leftbroadfracheight(5,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(5) = (0.5 - leftbroadfracheight(5,find(leftbroadfracheight(5,:)<=0.5&leftbroadfracheight(5,:)>0,1,'last')))*(leftbroadwavdif(5)/leftbroadfracdif(5))
widthofleftbroad50height(5) = mmtbc2_20120301_centern - (mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(leftbroadfracheight(5,:)<=0.5&leftbroadfracheight(5,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(5))

rightbroadfracdif(5) = (rightbroadfracheight(5,find(rightbroadfracheight(5,:)<=0.5&rightbroadfracheight(5,:)>0,1,'first')-1) - rightbroadfracheight(5,find(rightbroadfracheight(5,:)<=0.5&rightbroadfracheight(5,:)>0,1,'first')))
rightbroadwavdif(5) = (mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(rightbroadfracheight(5,:)<=0.5&rightbroadfracheight(5,:)>0,1,'first'))) - mmtbc1_20120301(find(mmtbc1_20120301 >= 6213,1,'first') + (find(rightbroadfracheight(5,:)<=0.5&rightbroadfracheight(5,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(5) = (0.5 - rightbroadfracheight(5,find(rightbroadfracheight(5,:)<=0.5&rightbroadfracheight(5,:)>0,1,'first')))*(rightbroadwavdif(5)/rightbroadfracdif(5))
widthofrightbroad50height(5) = (mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern) + (find(rightbroadfracheight(5,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(5)) - mmtbc2_20120301_centern 


for i=1:length(spolb1_20120323(find(spolb1_20120323 >= 6213 & spolb1_20120323 <= spolb2_20120323_centern)))
	leftbroadfracheight(6,i) = spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6213,1,'first')+(i-1))/spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centerb));
end
for i=1:length(spolb1_20120323(find(spolb1_20120323 >= spolb2_20120323_centern & spolb1_20120323 <= 6913)))
	rightbroadfracheight(6,i) = spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern)+(i-1))/spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centerb));
end
leftbroadfracdif(6) = (leftbroadfracheight(6,find(leftbroadfracheight(6,:)<=0.5&leftbroadfracheight(6,:)>0,1,'last')+1) - leftbroadfracheight(6,find(leftbroadfracheight(6,:)<=0.5&leftbroadfracheight(6,:)>0,1,'last')))
leftbroadwavdif(6) = (spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(leftbroadfracheight(6,:)<=0.5&leftbroadfracheight(6,:)>0,1,'last'))) - spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(leftbroadfracheight(6,:)<=0.5&leftbroadfracheight(6,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(6) = (0.5 - leftbroadfracheight(6,find(leftbroadfracheight(6,:)<=0.5&leftbroadfracheight(6,:)>0,1,'last')))*(leftbroadwavdif(6)/leftbroadfracdif(6))
widthofleftbroad50height(6) = spolb2_20120323_centern - (spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(leftbroadfracheight(6,:)<=0.5&leftbroadfracheight(6,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(6))

rightbroadfracdif(6) = (rightbroadfracheight(6,find(rightbroadfracheight(6,:)<=0.5&rightbroadfracheight(6,:)>0,1,'first')-1) - rightbroadfracheight(6,find(rightbroadfracheight(6,:)<=0.5&rightbroadfracheight(6,:)>0,1,'first')))
rightbroadwavdif(6) = (spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(rightbroadfracheight(6,:)<=0.5&rightbroadfracheight(6,:)>0,1,'first'))) - spolb1_20120323(find(spolb1_20120323 >= 6213,1,'first') + (find(rightbroadfracheight(6,:)<=0.5&rightbroadfracheight(6,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(6) = (0.5 - rightbroadfracheight(6,find(rightbroadfracheight(6,:)<=0.5&rightbroadfracheight(6,:)>0,1,'first')))*(rightbroadwavdif(6)/rightbroadfracdif(6))
widthofrightbroad50height(6) = (spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern) + (find(rightbroadfracheight(6,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(6)) - spolb2_20120323_centern 


for i=1:length(spolm1_20120416 (find(spolm1_20120416  >= 6213 & spolm1_20120416  <= spolm2_20120416_centern)))
	leftbroadfracheight(7,i) = spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  >= 6213,1,'first')+(i-1))/spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centerb));
end
for i=1:length(spolm1_20120416 (find(spolm1_20120416  >= spolm2_20120416_centern & spolm1_20120416  <= 6913)))
	rightbroadfracheight(7,i) = spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern)+(i-1))/spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centerb));
end
leftbroadfracdif(7) = (leftbroadfracheight(7,find(leftbroadfracheight(7,:)<=0.5&leftbroadfracheight(7,:)>0,1,'last')+1) - leftbroadfracheight(7,find(leftbroadfracheight(7,:)<=0.5&leftbroadfracheight(7,:)>0,1,'last')))
leftbroadwavdif(7) = (spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(leftbroadfracheight(7,:)<=0.5&leftbroadfracheight(7,:)>0,1,'last'))) - spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(leftbroadfracheight(7,:)<=0.5&leftbroadfracheight(7,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(7) = (0.5 - leftbroadfracheight(7,find(leftbroadfracheight(7,:)<=0.5&leftbroadfracheight(7,:)>0,1,'last')))*(leftbroadwavdif(7)/leftbroadfracdif(7))
widthofleftbroad50height(7) = spolm2_20120416_centern - (spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(leftbroadfracheight(7,:)<=0.5&leftbroadfracheight(7,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(7))

rightbroadfracdif(7) = (rightbroadfracheight(7,find(rightbroadfracheight(7,:)<=0.5&rightbroadfracheight(7,:)>0,1,'first')-1) - rightbroadfracheight(7,find(rightbroadfracheight(7,:)<=0.5&rightbroadfracheight(7,:)>0,1,'first')))
rightbroadwavdif(7) = (spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(rightbroadfracheight(7,:)<=0.5&rightbroadfracheight(7,:)>0,1,'first'))) - spolm1_20120416(find(spolm1_20120416 >= 6213,1,'first') + (find(rightbroadfracheight(7,:)<=0.5&rightbroadfracheight(7,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(7) = (0.5 - rightbroadfracheight(7,find(rightbroadfracheight(7,:)<=0.5&rightbroadfracheight(7,:)>0,1,'first')))*(rightbroadwavdif(7)/rightbroadfracdif(7))
widthofrightbroad50height(7) = (spolm1_20120416(find(spolm1_20120416 == spolm2_20120416_centern) + (find(rightbroadfracheight(7,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(7)) - spolm2_20120416_centern 


for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= 6213 & mmtbc1_20120417 <= mmtbc2_20120417_centern)))
	leftbroadfracheight(8,i) = mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6213,1,'first')+(i-1))/mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centerb));
end
for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= mmtbc2_20120417_centern & mmtbc1_20120417 <= 6913)))
	rightbroadfracheight(8,i) = mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern)+(i-1))/mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centerb));
end
leftbroadfracdif(8) = (leftbroadfracheight(8,find(leftbroadfracheight(8,:)<=0.5&leftbroadfracheight(8,:)>0,1,'last')+1) - leftbroadfracheight(8,find(leftbroadfracheight(8,:)<=0.5&leftbroadfracheight(8,:)>0,1,'last')))
leftbroadwavdif(8) = (mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(leftbroadfracheight(8,:)<=0.5&leftbroadfracheight(8,:)>0,1,'last'))) - mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(leftbroadfracheight(8,:)<=0.5&leftbroadfracheight(8,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(8) = (0.5 - leftbroadfracheight(8,find(leftbroadfracheight(8,:)<=0.5&leftbroadfracheight(8,:)>0,1,'last')))*(leftbroadwavdif(8)/leftbroadfracdif(8))
widthofleftbroad50height(8) = mmtbc2_20120417_centern - (mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(leftbroadfracheight(8,:)<=0.5&leftbroadfracheight(8,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(8))

rightbroadfracdif(8) = (rightbroadfracheight(8,find(rightbroadfracheight(8,:)<=0.5&rightbroadfracheight(8,:)>0,1,'first')-1) - rightbroadfracheight(8,find(rightbroadfracheight(8,:)<=0.5&rightbroadfracheight(8,:)>0,1,'first')))
rightbroadwavdif(8) = (mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(rightbroadfracheight(8,:)<=0.5&rightbroadfracheight(8,:)>0,1,'first'))) - mmtbc1_20120417(find(mmtbc1_20120417 >= 6213,1,'first') + (find(rightbroadfracheight(8,:)<=0.5&rightbroadfracheight(8,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(8) = (0.5 - rightbroadfracheight(8,find(rightbroadfracheight(8,:)<=0.5&rightbroadfracheight(8,:)>0,1,'first')))*(rightbroadwavdif(8)/rightbroadfracdif(8))
widthofrightbroad50height(8) = (mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern) + (find(rightbroadfracheight(8,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(8)) - mmtbc2_20120417_centern 


for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= 6213 & Lkast1_20120428 <= Lkast2_20120428_centern)))
	leftbroadfracheight(9,i) = Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6213,1,'first')+(i-1))/Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centerb));
end
for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= Lkast2_20120428_centern & Lkast1_20120428 <= 6913)))
	rightbroadfracheight(9,i) = Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern)+(i-1))/Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centerb));
end
leftbroadfracdif(9) = (leftbroadfracheight(9,find(leftbroadfracheight(9,:)<=0.5&leftbroadfracheight(9,:)>0,1,'last')+1) - leftbroadfracheight(9,find(leftbroadfracheight(9,:)<=0.5&leftbroadfracheight(9,:)>0,1,'last')))
leftbroadwavdif(9) = (Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(leftbroadfracheight(9,:)<=0.5&leftbroadfracheight(9,:)>0,1,'last'))) - Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(leftbroadfracheight(9,:)<=0.5&leftbroadfracheight(9,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(9) = (0.5 - leftbroadfracheight(9,find(leftbroadfracheight(9,:)<=0.5&leftbroadfracheight(9,:)>0,1,'last')))*(leftbroadwavdif(9)/leftbroadfracdif(9))
widthofleftbroad50height(9) = Lkast2_20120428_centern - (Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(leftbroadfracheight(9,:)<=0.5&leftbroadfracheight(9,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(9))

rightbroadfracdif(9) = (rightbroadfracheight(9,find(rightbroadfracheight(9,:)<=0.5&rightbroadfracheight(9,:)>0,1,'first')-1) - rightbroadfracheight(9,find(rightbroadfracheight(9,:)<=0.5&rightbroadfracheight(9,:)>0,1,'first')))
rightbroadwavdif(9) = (Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(rightbroadfracheight(9,:)<=0.5&rightbroadfracheight(9,:)>0,1,'first'))) - Lkast1_20120428(find(Lkast1_20120428 >= 6213,1,'first') + (find(rightbroadfracheight(9,:)<=0.5&rightbroadfracheight(9,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(9) = (0.5 - rightbroadfracheight(9,find(rightbroadfracheight(9,:)<=0.5&rightbroadfracheight(9,:)>0,1,'first')))*(rightbroadwavdif(9)/rightbroadfracdif(9))
widthofrightbroad50height(9) = (Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern) + (find(rightbroadfracheight(9,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(9)) - Lkast2_20120428_centern 


for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= 6213 & mmtbc1_20120529 <= mmtbc2_20120529_centern)))
	leftbroadfracheight(10,i) = mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6213,1,'first')+(i-1))/mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centerb));
end
for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= mmtbc2_20120529_centern & mmtbc1_20120529 <= 6913)))
	rightbroadfracheight(10,i) = mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern)+(i-1))/mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centerb));
end
leftbroadfracdif(10) = (leftbroadfracheight(10,find(leftbroadfracheight(10,:)<=0.5&leftbroadfracheight(10,:)>0,1,'last')+1) - leftbroadfracheight(10,find(leftbroadfracheight(10,:)<=0.5&leftbroadfracheight(10,:)>0,1,'last')))
leftbroadwavdif(10) = (mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(leftbroadfracheight(10,:)<=0.5&leftbroadfracheight(10,:)>0,1,'last'))) - mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(leftbroadfracheight(10,:)<=0.5&leftbroadfracheight(10,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(10) = (0.5 - leftbroadfracheight(10,find(leftbroadfracheight(10,:)<=0.5&leftbroadfracheight(10,:)>0,1,'last')))*(leftbroadwavdif(10)/leftbroadfracdif(10))
widthofleftbroad50height(10) = mmtbc2_20120529_centern - (mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(leftbroadfracheight(10,:)<=0.5&leftbroadfracheight(10,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(10))

rightbroadfracdif(10) = (rightbroadfracheight(10,find(rightbroadfracheight(10,:)<=0.5&rightbroadfracheight(10,:)>0,1,'first')-1) - rightbroadfracheight(10,find(rightbroadfracheight(10,:)<=0.5&rightbroadfracheight(10,:)>0,1,'first')))
rightbroadwavdif(10) = (mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(rightbroadfracheight(10,:)<=0.5&rightbroadfracheight(10,:)>0,1,'first'))) - mmtbc1_20120529(find(mmtbc1_20120529 >= 6213,1,'first') + (find(rightbroadfracheight(10,:)<=0.5&rightbroadfracheight(10,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(10) = (0.5 - rightbroadfracheight(10,find(rightbroadfracheight(10,:)<=0.5&rightbroadfracheight(10,:)>0,1,'first')))*(rightbroadwavdif(10)/rightbroadfracdif(10))
widthofrightbroad50height(10) = (mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern) + (find(rightbroadfracheight(10,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(10)) - mmtbc2_20120529_centern 


for i=1:length(keckL1_20120616(find(keckL1_20120616 >= 6213 & keckL1_20120616 <= keckL2_20120616_centern)))
	leftbroadfracheight(11,i) = keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6213,1,'first')+(i-1))/keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centerb));
end
for i=1:length(keckL1_20120616(find(keckL1_20120616 >= keckL2_20120616_centern & keckL1_20120616 <= 6913)))
	rightbroadfracheight(11,i) = keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern)+(i-1))/keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centerb));
end
leftbroadfracdif(11) = (leftbroadfracheight(11,find(leftbroadfracheight(11,:)<=0.5&leftbroadfracheight(11,:)>0,1,'last')+1) - leftbroadfracheight(11,find(leftbroadfracheight(11,:)<=0.5&leftbroadfracheight(11,:)>0,1,'last')))
leftbroadwavdif(11) = (keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(leftbroadfracheight(11,:)<=0.5&leftbroadfracheight(11,:)>0,1,'last'))) - keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(leftbroadfracheight(11,:)<=0.5&leftbroadfracheight(11,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(11) = (0.5 - leftbroadfracheight(11,find(leftbroadfracheight(11,:)<=0.5&leftbroadfracheight(11,:)>0,1,'last')))*(leftbroadwavdif(11)/leftbroadfracdif(11))
widthofleftbroad50height(11) = keckL2_20120616_centern - (keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(leftbroadfracheight(11,:)<=0.5&leftbroadfracheight(11,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(11))

rightbroadfracdif(11) = (rightbroadfracheight(11,find(rightbroadfracheight(11,:)<=0.5&rightbroadfracheight(11,:)>0,1,'first')-1) - rightbroadfracheight(11,find(rightbroadfracheight(11,:)<=0.5&rightbroadfracheight(11,:)>0,1,'first')))
rightbroadwavdif(11) = (keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(rightbroadfracheight(11,:)<=0.5&rightbroadfracheight(11,:)>0,1,'first'))) - keckL1_20120616(find(keckL1_20120616 >= 6213,1,'first') + (find(rightbroadfracheight(11,:)<=0.5&rightbroadfracheight(11,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(11) = (0.5 - rightbroadfracheight(11,find(rightbroadfracheight(11,:)<=0.5&rightbroadfracheight(11,:)>0,1,'first')))*(rightbroadwavdif(11)/rightbroadfracdif(11))
widthofrightbroad50height(11) = (keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern) + (find(rightbroadfracheight(11,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(11)) - keckL2_20120616_centern 


for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= 6213 & mmtbc1_20120701 <= mmtbc2_20120701_centern)))
	leftbroadfracheight(12,i) = mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6213,1,'first')+(i-1))/mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centerb));
end
for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= mmtbc2_20120701_centern & mmtbc1_20120701 <= 6913)))
	rightbroadfracheight(12,i) = mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern)+(i-1))/mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centerb));
end
leftbroadfracdif(12) = (leftbroadfracheight(12,find(leftbroadfracheight(12,:)<=0.5&leftbroadfracheight(12,:)>0,1,'last')+1) - leftbroadfracheight(12,find(leftbroadfracheight(12,:)<=0.5&leftbroadfracheight(12,:)>0,1,'last')))
leftbroadwavdif(12) = (mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(leftbroadfracheight(12,:)<=0.5&leftbroadfracheight(12,:)>0,1,'last'))) - mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(leftbroadfracheight(12,:)<=0.5&leftbroadfracheight(12,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(12) = (0.5 - leftbroadfracheight(12,find(leftbroadfracheight(12,:)<=0.5&leftbroadfracheight(12,:)>0,1,'last')))*(leftbroadwavdif(12)/leftbroadfracdif(12))
widthofleftbroad50height(12) = mmtbc2_20120701_centern - (mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(leftbroadfracheight(12,:)<=0.5&leftbroadfracheight(12,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(12))

rightbroadfracdif(12) = (rightbroadfracheight(12,find(rightbroadfracheight(12,:)<=0.5&rightbroadfracheight(12,:)>0,1,'first')-1) - rightbroadfracheight(12,find(rightbroadfracheight(12,:)<=0.5&rightbroadfracheight(12,:)>0,1,'first')))
rightbroadwavdif(12) = (mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(rightbroadfracheight(12,:)<=0.5&rightbroadfracheight(12,:)>0,1,'first'))) - mmtbc1_20120701(find(mmtbc1_20120701 >= 6213,1,'first') + (find(rightbroadfracheight(12,:)<=0.5&rightbroadfracheight(12,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(12) = (0.5 - rightbroadfracheight(12,find(rightbroadfracheight(12,:)<=0.5&rightbroadfracheight(12,:)>0,1,'first')))*(rightbroadwavdif(12)/rightbroadfracdif(12))
widthofrightbroad50height(12) = (mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern) + (find(rightbroadfracheight(12,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(12)) - mmtbc2_20120701_centern 


for i=1:length(keckD1_20121115(find(keckD1_20121115 >= 6213 & keckD1_20121115 <= keckD2_20121115_centern)))
	leftbroadfracheight(13,i) = keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6213,1,'first')+(i-1))/keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centerb));
end
for i=1:length(keckD1_20121115(find(keckD1_20121115 >= keckD2_20121115_centern & keckD1_20121115 <= 6913)))
	rightbroadfracheight(13,i) = keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern)+(i-1))/keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centerb));
end
leftbroadfracdif(13) = (leftbroadfracheight(13,find(leftbroadfracheight(13,:)<=0.5&leftbroadfracheight(13,:)>0,1,'last')+1) - leftbroadfracheight(13,find(leftbroadfracheight(13,:)<=0.5&leftbroadfracheight(13,:)>0,1,'last')))
leftbroadwavdif(13) = (keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(leftbroadfracheight(13,:)<=0.5&leftbroadfracheight(13,:)>0,1,'last'))) - keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(leftbroadfracheight(13,:)<=0.5&leftbroadfracheight(13,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(13) = (0.5 - leftbroadfracheight(13,find(leftbroadfracheight(13,:)<=0.5&leftbroadfracheight(13,:)>0,1,'last')))*(leftbroadwavdif(13)/leftbroadfracdif(13))
widthofleftbroad50height(13) = keckD2_20121115_centern - (keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(leftbroadfracheight(13,:)<=0.5&leftbroadfracheight(13,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(13))

rightbroadfracdif(13) = (rightbroadfracheight(13,find(rightbroadfracheight(13,:)<=0.5&rightbroadfracheight(13,:)>0,1,'first')-1) - rightbroadfracheight(13,find(rightbroadfracheight(13,:)<=0.5&rightbroadfracheight(13,:)>0,1,'first')))
rightbroadwavdif(13) = (keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(rightbroadfracheight(13,:)<=0.5&rightbroadfracheight(13,:)>0,1,'first'))) - keckD1_20121115(find(keckD1_20121115 >= 6213,1,'first') + (find(rightbroadfracheight(13,:)<=0.5&rightbroadfracheight(13,:)>0,1,'first')-1)))
rightbroadfracinterpoladjustment(13) = (0.5 - rightbroadfracheight(13,find(rightbroadfracheight(13,:)<=0.5&rightbroadfracheight(13,:)>0,1,'first')))*(rightbroadwavdif(13)/rightbroadfracdif(13))
widthofrightbroad50height(13) = (keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern) + (find(rightbroadfracheight(13,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(13)) - keckD2_20121115_centern 


for i=1:length(keckD1_20150521(find(keckD1_20150521 >= 6213 & keckD1_20150521 <= keckD2_20150521_centern)))
	leftbroadfracheight(14,i) = keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6213,1,'first')+(i-1))/keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centerb));
end
for i=1:length(keckD1_20150521(find(keckD1_20150521 >= keckD2_20150521_centern & keckD1_20150521 <= 6913)))
	rightbroadfracheight(14,i) = keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern)+(i-1))/keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centerb));
end
leftbroadfracdif(14) = (leftbroadfracheight(14,find(leftbroadfracheight(14,:)<=0.5&leftbroadfracheight(14,:)>0,1,'last')+1) - leftbroadfracheight(14,find(leftbroadfracheight(14,:)<=0.5&leftbroadfracheight(14,:)>0,1,'last')))
leftbroadwavdif(14) = (keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(leftbroadfracheight(14,:)<=0.5&leftbroadfracheight(14,:)>0,1,'last'))) - keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(leftbroadfracheight(14,:)<=0.5&leftbroadfracheight(14,:)>0,1,'last')-1)))
leftbroadfracinterpoladjustment(14) = (0.5 - leftbroadfracheight(14,find(leftbroadfracheight(14,:)<=0.5&leftbroadfracheight(14,:)>0,1,'last')))*(leftbroadwavdif(14)/leftbroadfracdif(14))
widthofleftbroad50height(14) = keckD2_20150521_centern - (keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(leftbroadfracheight(14,:)<=0.5&leftbroadfracheight(14,:)>0,1,'last')-1))+leftbroadfracinterpoladjustment(14))

%rightbroadfracdif(14) = (rightbroadfracheight(14,find(rightbroadfracheight(14,:)<=0.5&rightbroadfracheight(14,:)>0,1,'first')-1) - rightbroadfracheight(14,find(rightbroadfracheight(14,:)<=0.5&rightbroadfracheight(14,:)>0,1,'first')))
%rightbroadwavdif(14) = (keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(rightbroadfracheight(14,:)<=0.5&rightbroadfracheight(14,:)>0,1,'first'))) - keckD1_20150521(find(keckD1_20150521 >= 6213,1,'first') + (find(rightbroadfracheight(14,:)<=0.5&rightbroadfracheight(14,:)>0,1,'first')-1)))
%rightbroadfracinterpoladjustment(14) = (0.5 - rightbroadfracheight(14,find(rightbroadfracheight(14,:)<=0.5&rightbroadfracheight(14,:)>0,1,'first')))*(rightbroadwavdif(14)/rightbroadfracdif(14))
%widthofrightbroad50height(14) = (keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern) + (find(rightbroadfracheight(14,:)<=0.5,1,'first')-1))+rightbroadfracinterpoladjustment(14)) - keckD2_20150521_centern 

widthofrightbroad50height(14) = 0;


10^-5 .* c.*widthofrightbroad50height(8)./lambdaHalpha
10^-5 .* c.*widthofleftbroad50height(8)./lambdaHalpha

mR_20120417+ redshiftdistancemodulus



for i=1:length(hetms1_20120207(find(hetms1_20120207 >= 6213 & hetms1_20120207 <= hetms2_20120207_centern)))-1
	hetms1_20120207_leftiteratedEW(i) = trapz(hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern)-i:find(hetms1_20120207 == hetms2_20120207_centern)),hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern)-i:find(hetms1_20120207 == hetms2_20120207_centern)));
end
for i=1:length(hetms1_20120207(find(hetms1_20120207 >= hetms2_20120207_centern & hetms1_20120207 <= 6913)))-1
	hetms1_20120207_rightiteratedEW(i) = trapz(hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern):find(hetms1_20120207 == hetms2_20120207_centern)+i),hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern):find(hetms1_20120207 == hetms2_20120207_centern)+i));
end
for i=1:100
	leftEW(1,i) = hetms2_20120207_centern - hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern)-find(hetms1_20120207_leftiteratedEW/leftEWhigh(1)>= 0.01*i,1,'first'));
	rightEW(1,i) = hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern)+find(hetms1_20120207_rightiteratedEW/rightEWhigh(1)>= 0.01*i,1,'first')) - hetms2_20120207_centern;
end


for i=1:length(hetms1_20120216(find(hetms1_20120216 >= 6213 & hetms1_20120216 <= hetms2_20120216_centern)))-1
	hetms1_20120216_leftiteratedEW(i) = trapz(hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern)-i:find(hetms1_20120216 == hetms2_20120216_centern)),hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern)-i:find(hetms1_20120216 == hetms2_20120216_centern)));
end
for i=1:length(hetms1_20120216(find(hetms1_20120216 >= hetms2_20120216_centern & hetms1_20120216 <= 6913)))-1
	hetms1_20120216_rightiteratedEW(i) = trapz(hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern):find(hetms1_20120216 == hetms2_20120216_centern)+i),hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern):find(hetms1_20120216 == hetms2_20120216_centern)+i));
end
for i=1:100
	leftEW(2,i) = hetms2_20120216_centern - hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern)-find(hetms1_20120216_leftiteratedEW/leftEWhigh(2)>= 0.01*i,1,'first'));
	rightEW(2,i) = hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern)+find(hetms1_20120216_rightiteratedEW/rightEWhigh(2)>= 0.01*i,1,'first')) - hetms2_20120216_centern;
end








for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= 6213 & Lkast1_20120223 <= Lkast2_20120223_centern)))-1
	Lkast1_20120223_leftiteratedEW(i) = trapz(Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern)-i:find(Lkast1_20120223 == Lkast2_20120223_centern)),Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern)-i:find(Lkast1_20120223 == Lkast2_20120223_centern)));
end
for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= Lkast2_20120223_centern & Lkast1_20120223 <= 6913)))-1
	Lkast1_20120223_rightiteratedEW(i) = trapz(Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern):find(Lkast1_20120223 == Lkast2_20120223_centern)+i),Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern):find(Lkast1_20120223 == Lkast2_20120223_centern)+i));
end
for i=1:100
	leftEW(3,i) = Lkast2_20120223_centern - Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern)-find(Lkast1_20120223_leftiteratedEW/leftEWhigh(3)>= 0.01*i,1,'first'));
	rightEW(3,i) = Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern)+find(Lkast1_20120223_rightiteratedEW/rightEWhigh(3)>= 0.01*i,1,'first')) - Lkast2_20120223_centern;
end


for i=1:length(hetms1_20120301(find(hetms1_20120301 >= 6213 & hetms1_20120301 <= hetms2_20120301_centern)))-1
	hetms1_20120301_leftiteratedEW(i) = trapz(hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern)-i:find(hetms1_20120301 == hetms2_20120301_centern)),hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern)-i:find(hetms1_20120301 == hetms2_20120301_centern)));
end
for i=1:length(hetms1_20120301(find(hetms1_20120301 >= hetms2_20120301_centern & hetms1_20120301 <= 6913)))-1
	hetms1_20120301_rightiteratedEW(i) = trapz(hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern):find(hetms1_20120301 == hetms2_20120301_centern)+i),hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern):find(hetms1_20120301 == hetms2_20120301_centern)+i));
end
for i=1:100
	leftEW(4,i) = hetms2_20120301_centern - hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern)-find(hetms1_20120301_leftiteratedEW/leftEWhigh(4)>= 0.01*i,1,'first'));
	rightEW(4,i) = hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern)+find(hetms1_20120301_rightiteratedEW/rightEWhigh(4)>= 0.01*i,1,'first')) - hetms2_20120301_centern;
end


for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= 6213 & mmtbc1_20120301 <= mmtbc2_20120301_centern)))-1
	mmtbc1_20120301_leftiteratedEW(i) = trapz(mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern)-i:find(mmtbc1_20120301 == mmtbc2_20120301_centern)),mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern)-i:find(mmtbc1_20120301 == mmtbc2_20120301_centern)));
end
for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= mmtbc2_20120301_centern & mmtbc1_20120301 <= 6913)))-1
	mmtbc1_20120301_rightiteratedEW(i) = trapz(mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern):find(mmtbc1_20120301 == mmtbc2_20120301_centern)+i),mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern):find(mmtbc1_20120301 == mmtbc2_20120301_centern)+i));
end
for i=1:100
	leftEW(5,i) = mmtbc2_20120301_centern - mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern)-find(mmtbc1_20120301_leftiteratedEW/leftEWhigh(5)>= 0.01*i,1,'first'));
	rightEW(5,i) = mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern)+find(mmtbc1_20120301_rightiteratedEW/rightEWhigh(5)>= 0.01*i,1,'first')) - mmtbc2_20120301_centern;
end



for i=1:length(spolb1_20120323(find(spolb1_20120323 >= 6213 & spolb1_20120323 <= spolb2_20120323_centern)))-1
	spolb1_20120323_leftiteratedEW(i) = trapz(spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern)-i:find(spolb1_20120323 == spolb2_20120323_centern)),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern)-i:find(spolb1_20120323 == spolb2_20120323_centern)));
end
for i=1:length(spolb1_20120323(find(spolb1_20120323 >= spolb2_20120323_centern & spolb1_20120323 <= 6913)))-1
	spolb1_20120323_rightiteratedEW(i) = trapz(spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern):find(spolb1_20120323 == spolb2_20120323_centern)+i),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern):find(spolb1_20120323 == spolb2_20120323_centern)+i));
end
for i=1:100
	leftEW(6,i) = spolb2_20120323_centern - spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern)-find(spolb1_20120323_leftiteratedEW/leftEWhigh(6)>= 0.01*i,1,'first'));
	rightEW(6,i) = spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern)+find(spolb1_20120323_rightiteratedEW/rightEWhigh(6)>= 0.01*i,1,'first')) - spolb2_20120323_centern;
end

for i=1:length(spolm1_20120416(find(spolm1_20120416 >= 6213 & spolm1_20120416 <= spolm2_20120416_centern)))-1
	spolm1_20120416_leftiteratedEW(i) = trapz(spolm1_20120416(find(spolm1_20120416 == spolm2_20120416_centern)-i:find(spolm1_20120416 == spolm2_20120416_centern)),spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 == spolm2_20120416_centern)-i:find(spolm1_20120416 == spolm2_20120416_centern)));
end
for i=1:length(spolm1_20120416(find(spolm1_20120416 >= spolm2_20120416_centern & spolm1_20120416 <= 6913)))-1
	spolm1_20120416_rightiteratedEW(i) = trapz(spolm1_20120416(find(spolm1_20120416 == spolm2_20120416_centern):find(spolm1_20120416 == spolm2_20120416_centern)+i),spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 == spolm2_20120416_centern):find(spolm1_20120416 == spolm2_20120416_centern)+i));
end
for i=1:100
	leftEW(7,i) = spolm2_20120416_centern - spolm1_20120416(find(spolm1_20120416 == spolm2_20120416_centern)-find(spolm1_20120416_leftiteratedEW/leftEWhigh(7)>= 0.01*i,1,'first'));
	rightEW(7,i) = spolm1_20120416(find(spolm1_20120416 == spolm2_20120416_centern)+find(spolm1_20120416_rightiteratedEW/rightEWhigh(7)>= 0.01*i,1,'first')) - spolm2_20120416_centern;
end

for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= 6213 & mmtbc1_20120417 <= mmtbc2_20120417_centern)))-1
	mmtbc1_20120417_leftiteratedEW(i) = trapz(mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern)-i:find(mmtbc1_20120417 == mmtbc2_20120417_centern)),mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern)-i:find(mmtbc1_20120417 == mmtbc2_20120417_centern)));
end
for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= mmtbc2_20120417_centern & mmtbc1_20120417 <= 6913)))-1
	mmtbc1_20120417_rightiteratedEW(i) = trapz(mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern):find(mmtbc1_20120417 == mmtbc2_20120417_centern)+i),mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern):find(mmtbc1_20120417 == mmtbc2_20120417_centern)+i));
end
for i=1:100
	leftEW(8,i) = mmtbc2_20120417_centern - mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern)-find(mmtbc1_20120417_leftiteratedEW/leftEWhigh(8)>= 0.01*i,1,'first'));
	rightEW(8,i) = mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern)+find(mmtbc1_20120417_rightiteratedEW/rightEWhigh(8)>= 0.01*i,1,'first')) - mmtbc2_20120417_centern;
end

for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= 6213 & Lkast1_20120428 <= Lkast2_20120428_centern)))-1
	Lkast1_20120428_leftiteratedEW(i) = trapz(Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern)-i:find(Lkast1_20120428 == Lkast2_20120428_centern)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern)-i:find(Lkast1_20120428 == Lkast2_20120428_centern)));
end
for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= Lkast2_20120428_centern & Lkast1_20120428 <= 6913)))-1
	Lkast1_20120428_rightiteratedEW(i) = trapz(Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern):find(Lkast1_20120428 == Lkast2_20120428_centern)+i),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern):find(Lkast1_20120428 == Lkast2_20120428_centern)+i));
end
for i=1:100
	leftEW(9,i) = Lkast2_20120428_centern - Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern)-find(Lkast1_20120428_leftiteratedEW/leftEWhigh(9)>= 0.01*i,1,'first'));
	rightEW(9,i) = Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern)+find(Lkast1_20120428_rightiteratedEW/rightEWhigh(9)>= 0.01*i,1,'first')) - Lkast2_20120428_centern;
end

for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= 6213 & mmtbc1_20120529 <= mmtbc2_20120529_centern)))-1
	mmtbc1_20120529_leftiteratedEW(i) = trapz(mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern)-i:find(mmtbc1_20120529 == mmtbc2_20120529_centern)),mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern)-i:find(mmtbc1_20120529 == mmtbc2_20120529_centern)));
end
for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= mmtbc2_20120529_centern & mmtbc1_20120529 <= 6913)))-1
	mmtbc1_20120529_rightiteratedEW(i) = trapz(mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern):find(mmtbc1_20120529 == mmtbc2_20120529_centern)+i),mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern):find(mmtbc1_20120529 == mmtbc2_20120529_centern)+i));
end
for i=1:100
	leftEW(10,i) = mmtbc2_20120529_centern - mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern)-find(mmtbc1_20120529_leftiteratedEW/leftEWhigh(10)>= 0.01*i,1,'first'));
	rightEW(10,i) = mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern)+find(mmtbc1_20120529_rightiteratedEW/rightEWhigh(10)>= 0.01*i,1,'first')) - mmtbc2_20120529_centern;
end

for i=1:length(keckL1_20120616(find(keckL1_20120616 >= 6213 & keckL1_20120616 <= keckL2_20120616_centern)))-1
	keckL1_20120616_leftiteratedEW(i) = trapz(keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern)-i:find(keckL1_20120616 == keckL2_20120616_centern)),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern)-i:find(keckL1_20120616 == keckL2_20120616_centern)));
end
for i=1:length(keckL1_20120616(find(keckL1_20120616 >= keckL2_20120616_centern & keckL1_20120616 <= 6913)))-1
	keckL1_20120616_rightiteratedEW(i) = trapz(keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern):find(keckL1_20120616 == keckL2_20120616_centern)+i),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern):find(keckL1_20120616 == keckL2_20120616_centern)+i));
end
for i=1:100
	leftEW(11,i) = keckL2_20120616_centern - keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern)-find(keckL1_20120616_leftiteratedEW/leftEWhigh(11)>= 0.01*i,1,'first'));
	rightEW(11,i) = keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern)+find(keckL1_20120616_rightiteratedEW/rightEWhigh(11)>= 0.01*i,1,'first')) - keckL2_20120616_centern;
end

for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= 6213 & mmtbc1_20120701 <= mmtbc2_20120701_centern)))-1
	mmtbc1_20120701_leftiteratedEW(i) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern)-i:find(mmtbc1_20120701 == mmtbc2_20120701_centern)),mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern)-i:find(mmtbc1_20120701 == mmtbc2_20120701_centern)));
end
for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= mmtbc2_20120701_centern & mmtbc1_20120701 <= 6913)))-1
	mmtbc1_20120701_rightiteratedEW(i) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern):find(mmtbc1_20120701 == mmtbc2_20120701_centern)+i),mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern):find(mmtbc1_20120701 == mmtbc2_20120701_centern)+i));
end
for i=1:100
	leftEW(12,i) = mmtbc2_20120701_centern - mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern)-find(mmtbc1_20120701_leftiteratedEW/leftEWhigh(12)>= 0.01*i,1,'first'));
	rightEW(12,i) = mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern)+find(mmtbc1_20120701_rightiteratedEW/rightEWhigh(12)>= 0.01*i,1,'first')) - mmtbc2_20120701_centern;
end


for i=1:length(keckD1_20121115(find(keckD1_20121115 >= 6213 & keckD1_20121115 <= keckD2_20121115_centern)))-1
	keckD1_20121115_leftiteratedEW(i) = trapz(keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern)-i:find(keckD1_20121115 == keckD2_20121115_centern)),keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern)-i:find(keckD1_20121115 == keckD2_20121115_centern)));
end
for i=1:length(keckD1_20121115(find(keckD1_20121115 >= keckD2_20121115_centern & keckD1_20121115 <= 6913)))-1
	keckD1_20121115_rightiteratedEW(i) = trapz(keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern):find(keckD1_20121115 == keckD2_20121115_centern)+i),keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern):find(keckD1_20121115 == keckD2_20121115_centern)+i));
end
for i=1:100
	leftEW(13,i) = keckD2_20121115_centern - keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern)-find(keckD1_20121115_leftiteratedEW/leftEWhigh(13)>= 0.01*i,1,'first'));
	rightEW(13,i) = keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern)+find(keckD1_20121115_rightiteratedEW/rightEWhigh(13)>= 0.01*i,1,'first')) - keckD2_20121115_centern;
end

for i=1:length(keckD1_20150521(find(keckD1_20150521 >= 6213 & keckD1_20150521 <= keckD2_20150521_centern)))-1
	keckD1_20150521_leftiteratedEW(i) = trapz(keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern)-i:find(keckD1_20150521 == keckD2_20150521_centern)),keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern)-i:find(keckD1_20150521 == keckD2_20150521_centern)));
end
for i=1:length(keckD1_20150521(find(keckD1_20150521 >= keckD2_20150521_centern & keckD1_20150521 <= 6913)))-1
	keckD1_20150521_rightiteratedEW(i) = trapz(keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern):find(keckD1_20150521 == keckD2_20150521_centern)+i),keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern):find(keckD1_20150521 == keckD2_20150521_centern)+i));
end
for i=1:100
	leftEW(14,i) = keckD2_20150521_centern - keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern)-find(keckD1_20150521_leftiteratedEW/leftEWhigh(14)>= 0.01*i,1,'first'));
	rightEW(14,i) = keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern)+find(keckD1_20150521_rightiteratedEW/rightEWhigh(14)>= 0.01*i,1,'first')) - keckD2_20150521_centern;
end

sortedreldate = sort(reldate);











%check EW same for tight region





%count number of elements between edge and center of line
%find EW of each possible length between edge and center in each direction






hetms2_20120207interprecontfitscaled = hetms2_20120207_halphacontfitnormsubinterp.*halphafithetms2_20120207(hetms1_20120207)+halphafithetms2_20120207(hetms1_20120207);
hetms2_20120216interprecontfitscaled = hetms2_20120216_halphacontfitnormsubinterp.*halphafithetms2_20120216(hetms1_20120216)+halphafithetms2_20120216(hetms1_20120216);
Lkast2_20120223interprecontfitscaled = Lkast2_20120223_halphacontfitnormsubinterp.*halphafitLkast2_20120223(Lkast1_20120223)+halphafitLkast2_20120223(Lkast1_20120223);
hetms2_20120301interprecontfitscaled = hetms2_20120301_halphacontfitnormsubinterp.*halphafithetms2_20120301(hetms1_20120301)+halphafithetms2_20120301(hetms1_20120301);
mmtbc2_20120301interprecontfitscaled = mmtbc2_20120301_halphacontfitnormsubinterp.*halphafitmmtbc2_20120301(mmtbc1_20120301)+halphafitmmtbc2_20120301(mmtbc1_20120301);
spolb2_20120323interprecontfitscaled = spolb2_20120323_halphacontfitnormsubinterp.*halphafitspolb2_20120323(spolb1_20120323)+halphafitspolb2_20120323(spolb1_20120323);
spolm2_20120416interprecontfitscaled = spolm2_20120416_halphacontfitnormsubinterp.*halphafitspolm2_20120416(spolm1_20120416)+halphafitspolm2_20120416(spolm1_20120416);
mmtbc2_20120417interprecontfitscaled = mmtbc2_20120417_halphacontfitnormsubinterp.*halphafitmmtbc2_20120417(mmtbc1_20120417)+halphafitmmtbc2_20120417(mmtbc1_20120417);
Lkast2_20120428interprecontfitscaled = Lkast2_20120428_halphacontfitnormsubinterp.*halphafitLkast2_20120428(Lkast1_20120428)+halphafitLkast2_20120428(Lkast1_20120428);
mmtbc2_20120529interprecontfitscaled = mmtbc2_20120529_halphacontfitnormsubinterp.*halphafitmmtbc2_20120529(mmtbc1_20120529)+halphafitmmtbc2_20120529(mmtbc1_20120529);
keckL2_20120616interprecontfitscaled = keckL2_20120616_halphacontfitnormsubinterp.*halphafitkeckL2_20120616(keckL1_20120616)+halphafitkeckL2_20120616(keckL1_20120616);
mmtbc2_20120701interprecontfitscaled = mmtbc2_20120701_halphacontfitnormsubinterp.*halphafitmmtbc2_20120701(mmtbc1_20120701)+halphafitmmtbc2_20120701(mmtbc1_20120701);
keckD2_20121115interprecontfitscaled = keckD2_20121115_halphacontfitnormsubinterp.*halphafitkeckD2_20121115(keckD1_20121115)+halphafitkeckD2_20121115(keckD1_20121115);
keckD2_20150521interprecontfitscaled = keckD2_20150521_halphacontfitnormsubinterp.*halphafitkeckD2_20150521(keckD1_20150521)+halphafitkeckD2_20150521(keckD1_20150521);






hetms2_20120207interprecontfitscaledfirst = hetms2_20120207interprecontfitscaled(find(hetms1_20120207>6125&hetms1_20120207<7100))
hetms2_20120216interprecontfitscaledfirst = hetms2_20120216interprecontfitscaled(find(hetms1_20120216>6125&hetms1_20120216<7100))
Lkast2_20120223interprecontfitscaledfirst = Lkast2_20120223interprecontfitscaled(find(Lkast1_20120223>6125&Lkast1_20120223<7100))
hetms2_20120301interprecontfitscaledfirst = hetms2_20120301interprecontfitscaled(find(hetms1_20120301>6125&hetms1_20120301<7100))
mmtbc2_20120301interprecontfitscaledfirst = mmtbc2_20120301interprecontfitscaled(find(mmtbc1_20120301>6125&mmtbc1_20120301<7100))
spolb2_20120323interprecontfitscaledfirst = spolb2_20120323interprecontfitscaled(find(spolb1_20120323>6125&spolb1_20120323<7100))
spolm2_20120416interprecontfitscaledfirst = spolm2_20120416interprecontfitscaled(find(spolm1_20120416>6125&spolm1_20120416<7100))
mmtbc2_20120417interprecontfitscaledfirst = mmtbc2_20120417interprecontfitscaled(find(mmtbc1_20120417>6125&mmtbc1_20120417<7100))
Lkast2_20120428interprecontfitscaledfirst = Lkast2_20120428interprecontfitscaled(find(Lkast1_20120428>6125&Lkast1_20120428<7100))
mmtbc2_20120529interprecontfitscaledfirst = mmtbc2_20120529interprecontfitscaled(find(mmtbc1_20120529>6125&mmtbc1_20120529<7100))
keckL2_20120616interprecontfitscaledfirst = keckL2_20120616interprecontfitscaled(find(keckL1_20120616>6125&keckL1_20120616<7100))
mmtbc2_20120701interprecontfitscaledfirst = mmtbc2_20120701interprecontfitscaled(find(mmtbc1_20120701>6125&mmtbc1_20120701<7100))
keckD2_20121115interprecontfitscaledfirst = keckD2_20121115interprecontfitscaled(find(keckD1_20121115>6125&keckD1_20121115<7100))
keckD2_20150521interprecontfitscaledfirst = keckD2_20150521interprecontfitscaled(find(keckD1_20150521>6125&keckD1_20150521<7100))


hetms2_20120207interprecontfitscaledfirst(1)
hetms2_20120216interprecontfitscaledfirst(1)
Lkast2_20120223interprecontfitscaledfirst(1)
hetms2_20120301interprecontfitscaledfirst(1)
mmtbc2_20120301interprecontfitscaledfirst(1)
spolb2_20120323interprecontfitscaledfirst(1)
spolm2_20120416interprecontfitscaledfirst(1)
mmtbc2_20120417interprecontfitscaledfirst(1)
Lkast2_20120428interprecontfitscaledfirst(1)
mmtbc2_20120529interprecontfitscaledfirst(1)
keckL2_20120616interprecontfitscaledfirst(1)
mmtbc2_20120701interprecontfitscaledfirst(1)
keckD2_20121115interprecontfitscaledfirst(1)
keckD2_20150521interprecontfitscaledfirst(1)











clf
hold all
plot(hetms1_20120207(find(hetms1_20120207>6100 & hetms1_20120207 < 7025))/10^3,hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6100 & hetms1_20120207 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120207(find(hetms1_20120207>6100 & hetms1_20120207 < 7025))/10^3,hetms2_20120207_halphacontnorm(find(hetms1_20120207>6100 & hetms1_20120207 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(hetms2_20120207_centern/10^3,hetms2_20120207_halphacontfitnormsubinterp(hetms1_20120207==hetms2_20120207_centern))
htext = text(6.2,0.6,'hetms1\_20120207 day 7','Color', 'black','FontSize',22)
saveas(plotting, ['leftright1.eps'], 'epsc');
eval(['!epstopdf leftright1.eps']);


clf
hold all
plot(hetms1_20120216(find(hetms1_20120216>6100 & hetms1_20120216 < 7025))/10^3,hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6100 & hetms1_20120216 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120216(find(hetms1_20120216>6100 & hetms1_20120216 < 7025))/10^3,hetms2_20120216_halphacontnorm(find(hetms1_20120216>6100 & hetms1_20120216 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(hetms2_20120216_centern/10^3,hetms2_20120216_halphacontfitnormsubinterp(hetms1_20120216==hetms2_20120216_centern))
scatter((hetms2_20120216_centern+rightEW(2,70))/10^3,hetms2_20120216_halphacontfitnormsubinterp(hetms1_20120216==(hetms2_20120216_centern+rightEW(2,70))))
scatter((hetms2_20120216_centern-leftEW(2,70))/10^3,hetms2_20120216_halphacontfitnormsubinterp(hetms1_20120216==(hetms2_20120216_centern-leftEW(2,70))))
htext = text(6.2,0.6,'hetms1\_20120216 day 16','Color', 'black','FontSize',22)
saveas(plotting, ['leftright2.eps'], 'epsc');
eval(['!epstopdf leftright2.eps']);


clf
hold all
plot( Lkast1_20120223(find( Lkast1_20120223>6100 &  Lkast1_20120223 < 7025))/10^3, Lkast2_20120223_halphacontfitnormsubinterp(find( Lkast1_20120223>6100 &  Lkast1_20120223 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot( Lkast1_20120223(find( Lkast1_20120223>6100 &  Lkast1_20120223 < 7025))/10^3, Lkast2_20120223_halphacontnorm(find( Lkast1_20120223>6100 &  Lkast1_20120223 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(Lkast2_20120223_centern/10^3,Lkast2_20120223_halphacontfitnormsubinterp(Lkast1_20120223==Lkast2_20120223_centern))
scatter((Lkast2_20120223_centern+rightEW(3,60))/10^3,Lkast2_20120223_halphacontfitnormsubinterp(Lkast1_20120223==(Lkast2_20120223_centern+rightEW(3,60))))
scatter((Lkast2_20120223_centern-leftEW(3,60))/10^3,Lkast2_20120223_halphacontfitnormsubinterp(Lkast1_20120223==(Lkast2_20120223_centern-leftEW(3,60))))
htext = text(6.2,0.6,'Lkast1\_20120223 day 23','Color', 'black','FontSize',22)
saveas(plotting, ['leftright3.eps'], 'epsc');
eval(['!epstopdf leftright3.eps']);



clf
hold all
plot(hetms1_20120301(find(hetms1_20120301>6100 & hetms1_20120301 < 7025))/10^3,hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6100 & hetms1_20120301 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120301(find(hetms1_20120301>6100 & hetms1_20120301 < 7025))/10^3,hetms2_20120301_halphacontnorm(find(hetms1_20120301>6100 & hetms1_20120301 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.1 7.1],[1 1])
line([6.563 6.563],[0 1])
scatter(hetms2_20120301_centern/10^3,hetms2_20120301_halphacontfitnormsubinterp(hetms1_20120301==hetms2_20120301_centern))
scatter((hetms2_20120301_centern+rightEW(4,90))/10^3,hetms2_20120301_halphacontfitnormsubinterp(hetms1_20120301==(hetms2_20120301_centern+rightEW(4,90))))
scatter((hetms2_20120301_centern-leftEW(4,90))/10^3,hetms2_20120301_halphacontfitnormsubinterp(hetms1_20120301==(hetms2_20120301_centern-leftEW(4,90))))
htext = text(6.2,0.6,'hetms1\_20120301 day 30','Color', 'black','FontSize',22)
saveas(plotting, ['leftright4.eps'], 'epsc');
eval(['!epstopdf leftright4.eps']);


clf
hold all
plot(mmtbc1_20120301(find(mmtbc1_20120301>6100 & mmtbc1_20120301 < 7025))/10^3,mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6100 & mmtbc1_20120301 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>6100 & mmtbc1_20120301 < 7025))/10^3,mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>6100 & mmtbc1_20120301 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(mmtbc2_20120301_centern/10^3,mmtbc2_20120301_halphacontfitnormsubinterp(mmtbc1_20120301==mmtbc2_20120301_centern))
scatter((mmtbc2_20120301_centern+rightEW(5,90))/10^3,mmtbc2_20120301_halphacontfitnormsubinterp(mmtbc1_20120301==(mmtbc2_20120301_centern+rightEW(5,90))))
scatter((mmtbc2_20120301_centern-leftEW(5,90))/10^3,mmtbc2_20120301_halphacontfitnormsubinterp(mmtbc1_20120301==(mmtbc2_20120301_centern-leftEW(5,90))))
htext = text(6.2,0.6,'mmtbc1\_20120301 day 30','Color', 'black','FontSize',22)
saveas(plotting, ['leftright5.eps'], 'epsc');
eval(['!epstopdf leftright5.eps']);


clf
hold all
plot(spolb1_20120323(find(spolb1_20120323>6100 & spolb1_20120323 < 7025))/10^3,spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6100 & spolb1_20120323 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(spolb1_20120323(find(spolb1_20120323>6100 & spolb1_20120323 < 7025))/10^3,spolb2_20120323_halphacontnorm(find(spolb1_20120323>6100 & spolb1_20120323 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(spolb2_20120323_centern/10^3,spolb2_20120323_halphacontfitnormsubinterp(spolb1_20120323==spolb2_20120323_centern))
scatter((spolb2_20120323_centern+rightEW(6,90))/10^3,spolb2_20120323_halphacontfitnormsubinterp(spolb1_20120323==(spolb2_20120323_centern+rightEW(6,90))))
scatter((spolb2_20120323_centern-leftEW(6,90))/10^3,spolb2_20120323_halphacontfitnormsubinterp(spolb1_20120323==(spolb2_20120323_centern-leftEW(6,90))))
htext = text(6.2,0.6,'spolb1\_20120323 day 52','Color', 'black','FontSize',22)
saveas(plotting, ['leftright6.eps'], 'epsc');
eval(['!epstopdf leftright6.eps']);

clf
hold all
plot(spolm1_20120416(find(spolm1_20120416>6100 & spolm1_20120416 < 7025))/10^3,spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6100 & spolm1_20120416 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(spolm1_20120416(find(spolm1_20120416>6100 & spolm1_20120416 < 7025))/10^3,spolm2_20120416_halphacontnorm(find(spolm1_20120416>6100 & spolm1_20120416 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(spolm2_20120416_centern/10^3,spolm2_20120416_halphacontfitnormsubinterp(spolm1_20120416==spolm2_20120416_centern))
scatter((spolm2_20120416_centern+rightEW(7,90))/10^3,spolm2_20120416_halphacontfitnormsubinterp(spolm1_20120416==(spolm2_20120416_centern+rightEW(7,90))))
scatter((spolm2_20120416_centern-leftEW(7,90))/10^3,spolm2_20120416_halphacontfitnormsubinterp(spolm1_20120416==(spolm2_20120416_centern-leftEW(7,90))))
htext = text(6.2,0.6,'spolm1\_20120416 day 76','Color', 'black','FontSize',22)
saveas(plotting, ['leftright7.eps'], 'epsc');
eval(['!epstopdf leftright7.eps']);


clf
hold all
plot(mmtbc1_20120417(find(mmtbc1_20120417>6100 & mmtbc1_20120417 < 7025))/10^3,mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6100 & mmtbc1_20120417 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120417(find(mmtbc1_20120417>6100 & mmtbc1_20120417 < 7025))/10^3,mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>6100 & mmtbc1_20120417 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(mmtbc2_20120417_centern/10^3,mmtbc2_20120417_halphacontfitnormsubinterp(mmtbc1_20120417==mmtbc2_20120417_centern))
scatter((mmtbc2_20120417_centern+rightEW(8,90))/10^3,mmtbc2_20120417_halphacontfitnormsubinterp(mmtbc1_20120417==(mmtbc2_20120417_centern+rightEW(8,90))))
scatter((mmtbc2_20120417_centern-leftEW(8,90))/10^3,mmtbc2_20120417_halphacontfitnormsubinterp(mmtbc1_20120417==(mmtbc2_20120417_centern-leftEW(8,90))))
htext = text(6.2,0.6,'mmtbc1\_2012041 day 77','Color', 'black','FontSize',22)
saveas(plotting, ['leftright8.eps'], 'epsc');
eval(['!epstopdf leftright8.eps']);


clf
hold all
plot(Lkast1_20120428(find(Lkast1_20120428>6100 & Lkast1_20120428 < 7025))/10^3,Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6100 & Lkast1_20120428 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(Lkast1_20120428(find(Lkast1_20120428>6100 & Lkast1_20120428 < 7025))/10^3,Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>6100 & Lkast1_20120428 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(Lkast2_20120428_centern/10^3,Lkast2_20120428_halphacontfitnormsubinterp(Lkast1_20120428==Lkast2_20120428_centern))
scatter((Lkast2_20120428_centern+rightEW(9,90))/10^3,Lkast2_20120428_halphacontfitnormsubinterp(Lkast1_20120428==(Lkast2_20120428_centern+rightEW(9,90))))
scatter((Lkast2_20120428_centern-leftEW(9,90))/10^3,Lkast2_20120428_halphacontfitnormsubinterp(Lkast1_20120428==(Lkast2_20120428_centern-leftEW(9,90))))
htext = text(6.2,0.6,'Lkast1\_20120428 day 88','Color', 'black','FontSize',22)
saveas(plotting, ['leftright9.eps'], 'epsc');
eval(['!epstopdf leftright9.eps']);

clf
hold all
plot(mmtbc1_20120529(find(mmtbc1_20120529>6100 & mmtbc1_20120529 < 7025))/10^3,mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6100 & mmtbc1_20120529 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120529(find(mmtbc1_20120529>6100 & mmtbc1_20120529 < 7025))/10^3,mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>6100 & mmtbc1_20120529 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(mmtbc2_20120529_centern/10^3,mmtbc2_20120529_halphacontfitnormsubinterp(mmtbc1_20120529==mmtbc2_20120529_centern))
scatter((mmtbc2_20120529_centern+rightEW(10,90))/10^3,mmtbc2_20120529_halphacontfitnormsubinterp(mmtbc1_20120529==(mmtbc2_20120529_centern+rightEW(10,90))))
scatter((mmtbc2_20120529_centern-leftEW(10,90))/10^3,mmtbc2_20120529_halphacontfitnormsubinterp(mmtbc1_20120529==(mmtbc2_20120529_centern-leftEW(10,90))))
htext = text(6.2,0.6,'mmtbc1\_20120529 day 119','Color', 'black','FontSize',22)
saveas(plotting, ['leftright10.eps'], 'epsc');
eval(['!epstopdf leftright10.eps']);

clf
hold all
plot(keckL1_20120616(find(keckL1_20120616>6100 & keckL1_20120616 < 7025))/10^3,keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6100 & keckL1_20120616 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckL1_20120616(find(keckL1_20120616>6100 & keckL1_20120616 < 7025))/10^3,keckL2_20120616_halphacontnorm(find(keckL1_20120616>6100 & keckL1_20120616 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(keckL2_20120616_centern/10^3,keckL2_20120616_halphacontfitnormsubinterp(keckL1_20120616==keckL2_20120616_centern))
scatter((keckL2_20120616_centern+rightEW(11,90))/10^3,keckL2_20120616_halphacontfitnormsubinterp(keckL1_20120616==(keckL2_20120616_centern+rightEW(11,90))))
scatter((keckL2_20120616_centern-leftEW(11,90))/10^3,keckL2_20120616_halphacontfitnormsubinterp(keckL1_20120616==(keckL2_20120616_centern-leftEW(11,90))))
htext = text(6.2,0.6,'keckL1\_20120616 day 137','Color', 'black','FontSize',22)
saveas(plotting, ['leftright11.eps'], 'epsc');
eval(['!epstopdf leftright11.eps']);

clf
hold all
plot(mmtbc1_20120701(find(mmtbc1_20120701>6100 & mmtbc1_20120701 < 7025))/10^3,mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6100 & mmtbc1_20120701 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120701(find(mmtbc1_20120701>6100 & mmtbc1_20120701 < 7025))/10^3,mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>6100 & mmtbc1_20120701 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(mmtbc2_20120701_centern/10^3,mmtbc2_20120701_halphacontfitnormsubinterp(mmtbc1_20120701==mmtbc2_20120701_centern))
scatter((mmtbc2_20120701_centern+rightEW(12,90))/10^3,mmtbc2_20120701_halphacontfitnormsubinterp(mmtbc1_20120701==(mmtbc2_20120701_centern+rightEW(12,90))))
scatter((mmtbc2_20120701_centern-leftEW(12,90))/10^3,mmtbc2_20120701_halphacontfitnormsubinterp(mmtbc1_20120701==(mmtbc2_20120701_centern-leftEW(12,90))))
htext = text(6.2,0.6,'mmtbc1\_20120701 day 152','Color', 'black','FontSize',22)
saveas(plotting, ['leftright12.eps'], 'epsc');
eval(['!epstopdf leftright12.eps']);

clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>6100 & keckD1_20121115 < 7025))/10^3,keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6100 & keckD1_20121115 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20121115(find(keckD1_20121115>6100 & keckD1_20121115 < 7025))/10^3,keckD2_20121115_halphacontnorm(find(keckD1_20121115>6100 & keckD1_20121115 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(keckD2_20121115_centern/10^3,keckD2_20121115_halphacontfitnormsubinterp(keckD1_20121115==keckD2_20121115_centern))
scatter((keckD2_20121115_centern+rightEW(13,90))/10^3,keckD2_20121115_halphacontfitnormsubinterp(keckD1_20121115==(keckD2_20121115_centern+rightEW(13,90))))
scatter((keckD2_20121115_centern-leftEW(13,90))/10^3,keckD2_20121115_halphacontfitnormsubinterp(keckD1_20121115==(keckD2_20121115_centern-leftEW(13,90))))
htext = text(6.2,0.6,'keckD1\_20121115 day 289','Color', 'black','FontSize',22)
saveas(plotting, ['leftright13.eps'], 'epsc');
eval(['!epstopdf leftright13.eps']);

clf
hold all
plot(keckD1_20150521(find(keckD1_20150521>6100 & keckD1_20150521 < 7025))/10^3,keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6100 & keckD1_20150521 < 7025)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20150521(find(keckD1_20150521>6100 & keckD1_20150521 < 7025))/10^3,keckD2_20150521_halphacontnorm(find(keckD1_20150521>6100 & keckD1_20150521 < 7025)),'--','LineWidth',2,'Color',[0 0 0])
line([6.1 7.1],[0 0])
line([6.563 6.563],[0 1])
scatter(keckD2_20150521_centern/10^3,keckD2_20150521_halphacontfitnormsubinterp(keckD1_20150521==keckD2_20150521_centern))
scatter((keckD2_20150521_centern+rightEW(14,90))/10^3,keckD2_20150521_halphacontfitnormsubinterp(keckD1_20150521==(keckD2_20150521_centern+rightEW(14,90))))
scatter((keckD2_20150521_centern-leftEW(14,90))/10^3,keckD2_20150521_halphacontfitnormsubinterp(keckD1_20150521==(keckD2_20150521_centern-leftEW(14,90))))
htext = text(6.2,0.6,'keckD1\_20150521 day 1206','Color', 'black','FontSize',22)
saveas(plotting, ['leftright14.eps'], 'epsc');
eval(['!epstopdf leftright14.eps']);


delete('combinedleftrightplots.pdf')
append_pdfs('combinedleftrightplots.pdf','leftright1.pdf','leftright2.pdf','leftright3.pdf','leftright4.pdf','leftright5.pdf','leftright6.pdf','leftright7.pdf','leftright8.pdf','leftright9.pdf','leftright10.pdf','leftright11.pdf','leftright12.pdf','leftright13.pdf','leftright14.pdf')


%need reldateredrem5 so pasting this code earlier here:

%find dates and names of the spectra red

%reldateredrem5 


%sum the spectra over the red bandpass
%red bandpass 6580+-1380





%convert magnitudes to fluxes

%interpolate fluxes to the dates that correspond to the spectra

%multiply the flux calculation by the ratio of the fluxes










%halpha 6562.81

mmtbc2_20120301_interp = mmtbc2_20120301_halphacontfitnormsubinterp;
mmtbc2_20120417_interp = mmtbc2_20120417_halphacontfitnormsubinterp;
mmtbc2_20120529_interp = mmtbc2_20120529_halphacontfitnormsubinterp;
mmtbc2_20120701_interp = mmtbc2_20120701_halphacontfitnormsubinterp;
keckD2_20121115_interp = keckD2_20121115_halphacontfitnormsubinterp;
spolb2_20120323_interp = spolb2_20120323_halphacontfitnormsubinterp;
spolm2_20120416_interp = spolm2_20120416_halphacontfitnormsubinterp;
Lkast2_20120223_interp = Lkast2_20120223_halphacontfitnormsubinterp;
Lkast2_20120428_interp = Lkast2_20120428_halphacontfitnormsubinterp;
keckL2_20120616_interp = keckL2_20120616_halphacontfitnormsubinterp;
keckD2_20150521_interp = keckD2_20150521_halphacontfitnormsubinterp;



%start of weird lower limits stuff
esthalphafithighrangemmtbc1_20120301 = mmtbc1_20120301(find(mmtbc1_20120301>6700,5,'first'))
esthalphafithighrangespolm1_20120416 = spolm1_20120416(find(spolm1_20120416>6775,5,'first'))
esthalphafithighrangemmtbc1_20120417 = mmtbc1_20120417(find(mmtbc1_20120417>6700,5,'first'))
esthalphafithighrangemmtbc1_20120529 = mmtbc1_20120529(find(mmtbc1_20120529>6700,5,'first'))
esthalphafithighrangemmtbc1_20120701 = mmtbc1_20120701(find(mmtbc1_20120701>6700,5,'first'))
esthalphafithighrangemmtbc2_20120301 = mmtbc2_20120301(find(mmtbc1_20120301>6700,5,'first'))
esthalphafithighrangespolm2_20120416 = spolm2_20120416(find(spolm1_20120416>6775,5,'first'))
esthalphafithighrangemmtbc2_20120417 = mmtbc2_20120417(find(mmtbc1_20120417>6700,5,'first'))
esthalphafithighrangemmtbc2_20120529 = mmtbc2_20120529(find(mmtbc1_20120529>6700,5,'first'))
esthalphafithighrangemmtbc2_20120701 = mmtbc2_20120701(find(mmtbc1_20120701>6700,5,'first'))



esthalphafitmmtbc2_20120301 = fit(cat(1,halphafitlowrangemmtbc1_20120301,esthalphafithighrangemmtbc1_20120301),cat(1,halphafitlowrangemmtbc2_20120301,esthalphafithighrangemmtbc2_20120301),'poly1','Robust','Bisquare');
esthalphafitspolm2_20120416 = fit(cat(1,halphafitlowrangespolm1_20120416,esthalphafithighrangespolm1_20120416),cat(1,halphafitlowrangespolm2_20120416,esthalphafithighrangespolm2_20120416),'poly1','Robust','Bisquare');
esthalphafitmmtbc2_20120417 = fit(cat(1,halphafitlowrangemmtbc1_20120417,esthalphafithighrangemmtbc1_20120417),cat(1,halphafitlowrangemmtbc2_20120417,esthalphafithighrangemmtbc2_20120417),'poly1','Robust','Bisquare');
esthalphafitmmtbc2_20120529 = fit(cat(1,halphafitlowrangemmtbc1_20120529,esthalphafithighrangemmtbc1_20120529),cat(1,halphafitlowrangemmtbc2_20120529,esthalphafithighrangemmtbc2_20120529),'poly1','Robust','Bisquare');
esthalphafitmmtbc2_20120701 = fit(cat(1,halphafitlowrangemmtbc1_20120701,esthalphafithighrangemmtbc1_20120701),cat(1,halphafitlowrangemmtbc2_20120701,esthalphafithighrangemmtbc2_20120701),'poly1','Robust','Bisquare');

estmmtbc2_20120301_halphacontfitnormsub = (mmtbc2_20120301 - esthalphafitmmtbc2_20120301(mmtbc1_20120301))./esthalphafitmmtbc2_20120301(mmtbc1_20120301);
estspolm2_20120416_halphacontfitnormsub = (spolm2_20120416 - esthalphafitspolm2_20120416(spolm1_20120416))./esthalphafitspolm2_20120416(spolm1_20120416);
estmmtbc2_20120417_halphacontfitnormsub = (mmtbc2_20120417 - esthalphafitmmtbc2_20120417(mmtbc1_20120417))./esthalphafitmmtbc2_20120417(mmtbc1_20120417);
estmmtbc2_20120529_halphacontfitnormsub = (mmtbc2_20120529 - esthalphafitmmtbc2_20120529(mmtbc1_20120529))./esthalphafitmmtbc2_20120529(mmtbc1_20120529);
estmmtbc2_20120701_halphacontfitnormsub = (mmtbc2_20120701 - esthalphafitmmtbc2_20120701(mmtbc1_20120701))./esthalphafitmmtbc2_20120701(mmtbc1_20120701);


estmmtbc2_20120301_halphacontfitnormsubinterp = estmmtbc2_20120301_halphacontfitnormsub;
estspolm2_20120416_halphacontfitnormsubinterp = estspolm2_20120416_halphacontfitnormsub;
estmmtbc2_20120417_halphacontfitnormsubinterp = estmmtbc2_20120417_halphacontfitnormsub;
estmmtbc2_20120529_halphacontfitnormsubinterp = estmmtbc2_20120529_halphacontfitnormsub;
estmmtbc2_20120701_halphacontfitnormsubinterp = estmmtbc2_20120701_halphacontfitnormsub;

clf
plot(mmtbc1_20120301,estmmtbc2_20120301_halphacontfitnormsubinterp)

estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first')) = interp1([find(mmtbc1_20120301>6543,1,'first') find(mmtbc1_20120301 >= 6551,1,'first')] , [estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6543,1,'first')) estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120301>6543,1,'first'),find(mmtbc1_20120301 >= 6551,1,'first'),length(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first'))));
estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first')) = interp1([find(mmtbc1_20120301>6557,1,'first') find(mmtbc1_20120301 >= 6570,1,'first')] , [estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6557,1,'first')) estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120301>6557,1,'first'),find(mmtbc1_20120301 >= 6570,1,'first'),length(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first'))));
estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first')) = interp1([find(mmtbc1_20120301>6579,1,'first') find(mmtbc1_20120301 >= 6587,1,'first')] , [estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6579,1,'first')) estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120301>6579,1,'first'),find(mmtbc1_20120301 >= 6587,1,'first'),length(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first'))));
estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6700,1,'first'):find(mmtbc1_20120301 >= 6777,1,'first')) = interp1([find(mmtbc1_20120301>6700,1,'first') find(mmtbc1_20120301 >= 6777,1,'first')] , [estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6700,1,'first')) estmmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6777,1,'first'))] , linspace(find(mmtbc1_20120301>6700,1,'first'),find(mmtbc1_20120301 >= 6777,1,'first'),length(find(mmtbc1_20120301>6700,1,'first'):find(mmtbc1_20120301 >= 6777,1,'first'))));

estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first')) = interp1([find(spolm1_20120416>6543,1,'first') find(spolm1_20120416 >= 6551,1,'first')] , [estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6543,1,'first')) estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6551,1,'first'))] , linspace(find(spolm1_20120416>6543,1,'first'),find(spolm1_20120416 >= 6551,1,'first'),length(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first'))));
estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6551,1,'first'):find(spolm1_20120416 >= 6570,1,'first')) = interp1([find(spolm1_20120416>6551,1,'first') find(spolm1_20120416 >= 6570,1,'first')] , [estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6551,1,'first')) estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6570,1,'first'))] , linspace(find(spolm1_20120416>6551,1,'first'),find(spolm1_20120416 >= 6570,1,'first'),length(find(spolm1_20120416>6551,1,'first'):find(spolm1_20120416 >= 6570,1,'first'))));
estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first')) = interp1([find(spolm1_20120416>6579,1,'first') find(spolm1_20120416 >= 6587,1,'first')] , [estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6579,1,'first')) estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6587,1,'first'))] , linspace(find(spolm1_20120416>6579,1,'first'),find(spolm1_20120416 >= 6587,1,'first'),length(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first'))));
estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6700,1,'first'):find(spolm1_20120416 >= 6735,1,'first')) = interp1([find(spolm1_20120416>6700,1,'first') find(spolm1_20120416 >= 6735,1,'first')] , [estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6700,1,'first')) estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6735,1,'first'))] , linspace(find(spolm1_20120416>6700,1,'first'),find(spolm1_20120416 >= 6735,1,'first'),length(find(spolm1_20120416>6700,1,'first'):find(spolm1_20120416 >= 6735,1,'first'))));
estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6733,1,'first'):find(spolm1_20120416 >= 6817,1,'first')) = interp1([find(spolm1_20120416>6733,1,'first') find(spolm1_20120416 >= 6817,1,'first')] , [estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6733,1,'first')) estspolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6817,1,'first'))] , linspace(find(spolm1_20120416>6733,1,'first'),find(spolm1_20120416 >= 6817,1,'first'),length(find(spolm1_20120416>6733,1,'first'):find(spolm1_20120416 >= 6817,1,'first'))));


estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first')) = interp1([find(mmtbc1_20120417>6543,1,'first') find(mmtbc1_20120417 >= 6551,1,'first')] , [estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6543,1,'first')) estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120417>6543,1,'first'),find(mmtbc1_20120417 >= 6551,1,'first'),length(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first'))));
estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first')) = interp1([find(mmtbc1_20120417>6553,1,'first') find(mmtbc1_20120417 >= 6577,1,'first')] , [estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6553,1,'first')) estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6577,1,'first'))] , linspace(find(mmtbc1_20120417>6553,1,'first'),find(mmtbc1_20120417 >= 6577,1,'first'),length(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first'))));
estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first')) = interp1([find(mmtbc1_20120417>6577,1,'first') find(mmtbc1_20120417 >= 6597,1,'first')] , [estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6577,1,'first')) estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6597,1,'first'))] , linspace(find(mmtbc1_20120417>6577,1,'first'),find(mmtbc1_20120417 >= 6597,1,'first'),length(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first'))));
estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6705,1,'first'):find(mmtbc1_20120417 >= 6735,1,'first')) = interp1([find(mmtbc1_20120417>6705,1,'first') find(mmtbc1_20120417 >= 6735,1,'first')] , [estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6705,1,'first')) estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6735,1,'first'))] , linspace(find(mmtbc1_20120417>6705,1,'first'),find(mmtbc1_20120417 >= 6735,1,'first'),length(find(mmtbc1_20120417>6705,1,'first'):find(mmtbc1_20120417 >= 6735,1,'first'))));
estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6737,1,'first'):find(mmtbc1_20120417 >= 6786,1,'first')) = interp1([find(mmtbc1_20120417>6737,1,'first') find(mmtbc1_20120417 >= 6786,1,'first')] , [estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6737,1,'first')) estmmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6786,1,'first'))] , linspace(find(mmtbc1_20120417>6737,1,'first'),find(mmtbc1_20120417 >= 6786,1,'first'),length(find(mmtbc1_20120417>6737,1,'first'):find(mmtbc1_20120417 >= 6786,1,'first'))));


estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first')) = interp1([find(mmtbc1_20120529>6543,1,'first') find(mmtbc1_20120529 >= 6551,1,'first')] , [estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6543,1,'first')) estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120529>6543,1,'first'),find(mmtbc1_20120529 >= 6551,1,'first'),length(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first'))));
estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first')) = interp1([find(mmtbc1_20120529>6557,1,'first') find(mmtbc1_20120529 >= 6570,1,'first')] , [estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6557,1,'first')) estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120529>6557,1,'first'),find(mmtbc1_20120529 >= 6570,1,'first'),length(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first'))));
estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first')) = interp1([find(mmtbc1_20120529>6579,1,'first') find(mmtbc1_20120529 >= 6587,1,'first')] , [estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6579,1,'first')) estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120529>6579,1,'first'),find(mmtbc1_20120529 >= 6587,1,'first'),length(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first'))));
estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6700,1,'first'):find(mmtbc1_20120529 >= 6739,1,'first')) = interp1([find(mmtbc1_20120529>6700,1,'first') find(mmtbc1_20120529 >= 6739,1,'first')] , [estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6700,1,'first')) estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6739,1,'first'))] , linspace(find(mmtbc1_20120529>6700,1,'first'),find(mmtbc1_20120529 >= 6739,1,'first'),length(find(mmtbc1_20120529>6700,1,'first'):find(mmtbc1_20120529 >= 6739,1,'first'))));
estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6737,1,'first'):find(mmtbc1_20120529 >= 6769,1,'first')) = interp1([find(mmtbc1_20120529>6737,1,'first') find(mmtbc1_20120529 >= 6769,1,'first')] , [estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6737,1,'first')) estmmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6769,1,'first'))] , linspace(find(mmtbc1_20120529>6737,1,'first'),find(mmtbc1_20120529 >= 6769,1,'first'),length(find(mmtbc1_20120529>6737,1,'first'):find(mmtbc1_20120529 >= 6769,1,'first'))));


estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first')) = interp1([find(mmtbc1_20120701>6543,1,'first') find(mmtbc1_20120701 >= 6551,1,'first')] , [estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6543,1,'first')) estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120701>6543,1,'first'),find(mmtbc1_20120701 >= 6551,1,'first'),length(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first'))));
estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6553,1,'first'):find(mmtbc1_20120701 >= 6577,1,'first')) = interp1([find(mmtbc1_20120701>6553,1,'first') find(mmtbc1_20120701 >= 6577,1,'first')] , [estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6553,1,'first')) estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6577,1,'first'))] , linspace(find(mmtbc1_20120701>6553,1,'first'),find(mmtbc1_20120701 >= 6577,1,'first'),length(find(mmtbc1_20120701>6553,1,'first'):find(mmtbc1_20120701 >= 6577,1,'first'))));
estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6577,1,'first'):find(mmtbc1_20120701 >= 6597,1,'first')) = interp1([find(mmtbc1_20120701>6577,1,'first') find(mmtbc1_20120701 >= 6597,1,'first')] , [estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6577,1,'first')) estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6597,1,'first'))] , linspace(find(mmtbc1_20120701>6577,1,'first'),find(mmtbc1_20120701 >= 6597,1,'first'),length(find(mmtbc1_20120701>6577,1,'first'):find(mmtbc1_20120701 >= 6597,1,'first'))));
estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6700,1,'first'):find(mmtbc1_20120701 >= 6735,1,'first')) = interp1([find(mmtbc1_20120701>6700,1,'first') find(mmtbc1_20120701 >= 6735,1,'first')] , [estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6700,1,'first')) estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6735,1,'first'))] , linspace(find(mmtbc1_20120701>6700,1,'first'),find(mmtbc1_20120701 >= 6735,1,'first'),length(find(mmtbc1_20120701>6700,1,'first'):find(mmtbc1_20120701 >= 6735,1,'first'))));
estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6731,1,'first'):find(mmtbc1_20120701 >= 6817,1,'first')) = interp1([find(mmtbc1_20120701>6731,1,'first') find(mmtbc1_20120701 >= 6817,1,'first')] , [estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6731,1,'first')) estmmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6817,1,'first'))] , linspace(find(mmtbc1_20120701>6731,1,'first'),find(mmtbc1_20120701 >= 6817,1,'first'),length(find(mmtbc1_20120701>6731,1,'first'):find(mmtbc1_20120701 >= 6817,1,'first'))));






%in case this plot test is needed,
%clf
%hold all
%plot(mmtbc1_20120301(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662))/10^3,mmtbc2_20120301_interpsub(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
%plot(mmtbc1_20120301(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662))/10^3,-1+mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662)),'--','LineWidth',2,'Color',[0 0 0])




%do the remaining EW measurements here:
%1 best guess
mmtbc2_20120301_interp = mmtbc2_20120301_halphacontfitnormsubinterp;
bestestEWhigh(1) = trapz(mmtbc1_20120301(find(mmtbc1_20120301 > 6213 & mmtbc1_20120301 < 6913)),mmtbc2_20120301_interp(find(mmtbc1_20120301 > 6213 & mmtbc1_20120301 < 6913))) 
bestestNEWerr(1) = 5*std(mmtbc2_20120301_interp(find(mmtbc1_20120301 > 6000 & mmtbc1_20120301 < 6300)));
bestestdEWhigh(1) = bestestNEWerr(1) * bestestEWhigh(1);
clf
hold all
plot(mmtbc1_20120301(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262))/10^3,mmtbc2_20120301_interp(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262))/10^3,mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

%1 lower limit
estmmtbc2_20120301_interp = estmmtbc2_20120301_halphacontfitnormsubinterp;
estEWhigh(1) = trapz(mmtbc1_20120301(find(mmtbc1_20120301 > 6213 & mmtbc1_20120301 < 6913)),estmmtbc2_20120301_interp(find(mmtbc1_20120301 > 6213 & mmtbc1_20120301 < 6913))) 
estNEWerr(1) = 5*std(estmmtbc2_20120301_interp(find(mmtbc1_20120301 > 6000 & mmtbc1_20120301 < 6300)));
estdEWhigh(1) = estNEWerr(1) * estEWhigh(1);
clf
hold all
plot(mmtbc1_20120301(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262))/10^3,estmmtbc2_20120301_interp(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262))/10^3,mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>5862 & mmtbc1_20120301 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)


%2 best guess
spolm2_20120416_interp = spolm2_20120416_halphacontfitnormsubinterp;
bestestEWhigh(2) = trapz(spolm1_20120416(find(spolm1_20120416 > 6213 & spolm1_20120416 < 6913)),spolm2_20120416_interp(find(spolm1_20120416 > 6213 & spolm1_20120416 < 6913))) 
bestestNEWerr(2) = 5*std(spolm2_20120416_interp(find(spolm1_20120416 > 6000 & spolm1_20120416 < 6300)));
bestestdEWhigh(2) = bestestNEWerr(2) * bestestEWhigh(2);
clf
hold all
plot(spolm1_20120416(find(spolm1_20120416>5862 & spolm1_20120416 < 7262))/10^3,spolm2_20120416_interp(find(spolm1_20120416>5862 & spolm1_20120416 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(spolm1_20120416(find(spolm1_20120416>5862 & spolm1_20120416 < 7262))/10^3,spolm2_20120416_halphacontnorm(find(spolm1_20120416>5862 & spolm1_20120416 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

%2 lower limit
estspolm2_20120416_interp = estspolm2_20120416_halphacontfitnormsubinterp;
estEWhigh(2) = trapz(spolm1_20120416(find(spolm1_20120416 > 6213 & spolm1_20120416 < 6913)),estspolm2_20120416_interp(find(spolm1_20120416 > 6213 & spolm1_20120416 < 6913))) 
estNEWerr(2) = 5*std(estspolm2_20120416_interp(find(spolm1_20120416 > 6000 & spolm1_20120416 < 6300)));
estdEWhigh(2) = estNEWerr(2) * estEWhigh(2);
clf
hold all
plot(spolm1_20120416(find(spolm1_20120416>5862 & spolm1_20120416 < 7262))/10^3,estspolm2_20120416_interp(find(spolm1_20120416>5862 & spolm1_20120416 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(spolm1_20120416(find(spolm1_20120416>5862 & spolm1_20120416 < 7262))/10^3,spolm2_20120416_halphacontnorm(find(spolm1_20120416>5862 & spolm1_20120416 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)



%3 best guess
mmtbc2_20120417_interp = mmtbc2_20120417_halphacontfitnormsubinterp;
bestestEWhigh(3) = trapz(mmtbc1_20120417(find(mmtbc1_20120417 > 6213 & mmtbc1_20120417 < 6913)),mmtbc2_20120417_interp(find(mmtbc1_20120417 > 6213 & mmtbc1_20120417 < 6913))) 
bestestNEWerr(3) = 5*std(mmtbc2_20120417_interp(find(mmtbc1_20120417 > 6000 & mmtbc1_20120417 < 6300)));
bestestdEWhigh(3) = bestestNEWerr(3) * bestestEWhigh(3);
clf
hold all
plot(mmtbc1_20120417(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262))/10^3,mmtbc2_20120417_interp(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120417(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262))/10^3,mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

%3 lower limit
estmmtbc2_20120417_interp = estmmtbc2_20120417_halphacontfitnormsubinterp;
estEWhigh(3) = trapz(mmtbc1_20120417(find(mmtbc1_20120417 > 6213 & mmtbc1_20120417 < 6913)),estmmtbc2_20120417_interp(find(mmtbc1_20120417 > 6213 & mmtbc1_20120417 < 6913))) 
estNEWerr(3) = 5*std(estmmtbc2_20120417_interp(find(mmtbc1_20120417 > 6000 & mmtbc1_20120417 < 6300)));
estdEWhigh(3) = estNEWerr(3) * estEWhigh(3);
clf
hold all
plot(mmtbc1_20120417(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262))/10^3,estmmtbc2_20120417_interp(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120417(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262))/10^3,mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>5862 & mmtbc1_20120417 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)



%4 best guess
mmtbc2_20120529_interp = mmtbc2_20120529_halphacontfitnormsubinterp;
bestestEWhigh(4) = trapz(mmtbc1_20120529(find(mmtbc1_20120529 > 6213 & mmtbc1_20120529 < 6913)),mmtbc2_20120529_interp(find(mmtbc1_20120529 > 6213 & mmtbc1_20120529 < 6913))) 
bestestNEWerr(4) = 5*std(mmtbc2_20120529_interp(find(mmtbc1_20120529 > 6000 & mmtbc1_20120529 < 6300)));
bestestdEWhigh(4) = bestestNEWerr(4) * bestestEWhigh(4);
clf
hold all
plot(mmtbc1_20120529(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262))/10^3,mmtbc2_20120529_interp(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120529(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262))/10^3,mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

%4 lower limit
estmmtbc2_20120529_interp = estmmtbc2_20120529_halphacontfitnormsubinterp;
estEWhigh(4) = trapz(mmtbc1_20120529(find(mmtbc1_20120529 > 6213 & mmtbc1_20120529 < 6913)),estmmtbc2_20120529_interp(find(mmtbc1_20120529 > 6213 & mmtbc1_20120529 < 6913))) 
estNEWerr(4) = 5*std(estmmtbc2_20120529_interp(find(mmtbc1_20120529 > 6000 & mmtbc1_20120529 < 6300)));
estdEWhigh(4) = estNEWerr(4) * estEWhigh(4);
clf
hold all
plot(mmtbc1_20120529(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262))/10^3,estmmtbc2_20120529_interp(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120529(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262))/10^3,mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>5862 & mmtbc1_20120529 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)




%5 best guess
mmtbc2_20120701_interp = mmtbc2_20120701_halphacontfitnormsubinterp;
bestestEWhigh(5) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 > 6213 & mmtbc1_20120701 < 6913)),mmtbc2_20120701_interp(find(mmtbc1_20120701 > 6213 & mmtbc1_20120701 < 6913))) 
bestestNEWerr(5) = 5*std(mmtbc2_20120701_interp(find(mmtbc1_20120701 > 6000 & mmtbc1_20120701 < 6300)));
bestestdEWhigh(5) = bestestNEWerr(5) * bestestEWhigh(5);
clf
hold all
plot(mmtbc1_20120701(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262))/10^3,mmtbc2_20120701_interp(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120701(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262))/10^3,mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

%5 lower limit
estmmtbc2_20120701_interp = estmmtbc2_20120701_halphacontfitnormsubinterp;
estEWhigh(5) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 > 6213 & mmtbc1_20120701 < 6913)),estmmtbc2_20120701_interp(find(mmtbc1_20120701 > 6213 & mmtbc1_20120701 < 6913))) 
estNEWerr(5) = 5*std(estmmtbc2_20120701_interp(find(mmtbc1_20120701 > 6000 & mmtbc1_20120701 < 6300)));
estdEWhigh(5) = estNEWerr(5) * estEWhigh(5);
clf
hold all
plot(mmtbc1_20120701(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262))/10^3,estmmtbc2_20120701_interp(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120701(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262))/10^3,mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>5862 & mmtbc1_20120701 < 7262)),'--','LineWidth',2,'Color',[0 0 0])
line([5.8 7],[0 0],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)














































hetms2_20120207_interp = hetms2_20120207_halphacontfitnormsubinterp;
%hetms2_20120207_interp(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6551,1,'first')) = interp1([find(hetms1_20120207>6543,1,'first') find(hetms1_20120207 >= 6551,1,'first')] , [hetms2_20120207_interp(find(hetms1_20120207>6543,1,'first')) hetms2_20120207_interp(find(hetms1_20120207 >= 6551,1,'first'))] , linspace(find(hetms1_20120207>6543,1,'first'),find(hetms1_20120207 >= 6551,1,'first'),length(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6551,1,'first'))));
%hetms2_20120207_interp(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6593,1,'first')) = interp1([find(hetms1_20120207>6543,1,'first') find(hetms1_20120207 >= 6593,1,'first')] , [hetms2_20120207_interp(find(hetms1_20120207>6543,1,'first')) hetms2_20120207_interp(find(hetms1_20120207 >= 6593,1,'first'))] , linspace(find(hetms1_20120207>6543,1,'first'),find(hetms1_20120207 >= 6593,1,'first'),length(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6593,1,'first'))));
%hetms2_20120207_interp(find(hetms1_20120207>6577,1,'first'):find(hetms1_20120207 >= 6593,1,'first')) = interp1([find(hetms1_20120207>6577,1,'first') find(hetms1_20120207 >= 6593,1,'first')] , [hetms2_20120207_interp(find(hetms1_20120207>6577,1,'first')) hetms2_20120207_interp(find(hetms1_20120207 >= 6593,1,'first'))] , linspace(find(hetms1_20120207>6577,1,'first'),find(hetms1_20120207 >= 6593,1,'first'),length(find(hetms1_20120207>6577,1,'first'):find(hetms1_20120207 >= 6593,1,'first'))));
%EWhigh(1) = trapz(hetms1_20120207(find(hetms1_20120207 > 6213 & hetms1_20120207 < 6913)),hetms2_20120207_interp(find(hetms1_20120207 > 6213 & hetms1_20120207 < 6913))) 
%EWhigh(1) = leftEWhigh(1) + rightEWhigh(1);
%NEWerr(1) = 5*std(hetms2_20120207_interp(find(hetms1_20120207 > 6000 & hetms1_20120207 < 6300)));
%dEWhigh(1) = NEWerr(1) * EWhigh(1);
%Fluxhigh(1)  = EWhigh(1) * halphanormhetms2_20120207 * 1;
%dFluxhigh(1) = dEWhigh(1) * halphanormhetms2_20120207 * 1;
hetms2_20120207_interpsub = -hetms2_20120207_interp + hetms2_20120207_halphacontfitnormsub;
hetms2_20120207_interpsub = -hetms2_20120207_interp + hetms2_20120207_halphacontfitnormsub;
EWlow(1) = trapz(hetms1_20120207(find(hetms1_20120207 > 6543 & hetms1_20120207 < 6593)),hetms2_20120207_interpsub(find(hetms1_20120207 > 6543 & hetms1_20120207 < 6593)));
NEWerr(1) = 1/2 * 5*std(hetms2_20120207_interp(find(hetms1_20120207 > 6000 & hetms1_20120207 < 6300)));
dEWlow(1) = NEWerr(1) * EWlow(1);
Fluxlow(1)  = EWlow(1) * halphanormhetms2_20120207 * 1;
dFluxlow(1) = dEWlow(1) * halphanormhetms2_20120207 * 1;

clf
hold all
plot(hetms1_20120207(find(hetms1_20120207>6462 & hetms1_20120207 < 6662))/10^3,hetms2_20120207_interp(find(hetms1_20120207>6462 & hetms1_20120207 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120207(find(hetms1_20120207>6462 & hetms1_20120207 < 6662))/10^3,hetms2_20120207_halphacontfitnormsub(find(hetms1_20120207>6462 & hetms1_20120207 < 6662)),'--','LineWidth',2,'Color',[0 0 0])


clf
hold all
plot(hetms1_20120207(find(hetms1_20120207>6462 & hetms1_20120207 < 6662))/10^3,hetms2_20120207_interpsub(find(hetms1_20120207>6462 & hetms1_20120207 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120207(find(hetms1_20120207>6462 & hetms1_20120207 < 6662))/10^3,-1+hetms2_20120207_halphacontnorm(find(hetms1_20120207>6462 & hetms1_20120207 < 6662)),'--','LineWidth',2,'Color',[0 0 0])



%test


sum(hetms2_20120216(find(hetms1_20120216>5890&hetms1_20120216<7270)))       *(hetms1_20120216(2)-hetms1_20120216(1))/(halphanormhetms2_20120216)




hetms2_20120216_interp = hetms2_20120216_halphacontfitnormsubinterp;
%hetms2_20120216_interp(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6551,1,'first')) = interp1([find(hetms1_20120216>6543,1,'first') find(hetms1_20120216 >= 6551,1,'first')] , [hetms2_20120216_interp(find(hetms1_20120216>6543,1,'first')) hetms2_20120216_interp(find(hetms1_20120216 >= 6551,1,'first'))] , linspace(find(hetms1_20120216>6543,1,'first'),find(hetms1_20120216 >= 6551,1,'first'),length(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6551,1,'first'))));
%hetms2_20120216_interp(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6593,1,'first')) = interp1([find(hetms1_20120216>6543,1,'first') find(hetms1_20120216 >= 6593,1,'first')] , [hetms2_20120216_interp(find(hetms1_20120216>6543,1,'first')) hetms2_20120216_interp(find(hetms1_20120216 >= 6593,1,'first'))] , linspace(find(hetms1_20120216>6543,1,'first'),find(hetms1_20120216 >= 6593,1,'first'),length(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6593,1,'first'))));
%hetms2_20120216_interp(find(hetms1_20120216>6577,1,'first'):find(hetms1_20120216 >= 6593,1,'first')) = interp1([find(hetms1_20120216>6577,1,'first') find(hetms1_20120216 >= 6593,1,'first')] , [hetms2_20120216_interp(find(hetms1_20120216>6577,1,'first')) hetms2_20120216_interp(find(hetms1_20120216 >= 6593,1,'first'))] , linspace(find(hetms1_20120216>6577,1,'first'),find(hetms1_20120216 >= 6593,1,'first'),length(find(hetms1_20120216>6577,1,'first'):find(hetms1_20120216 >= 6593,1,'first'))));
EWhigh(1) = trapz(hetms1_20120216(find(hetms1_20120216 > 6213 & hetms1_20120216 < 6913)),hetms2_20120216_interp(find(hetms1_20120216 > 6213 & hetms1_20120216 < 6913))) 
NEWerr(1) = 5*std(hetms2_20120216_interp(find(hetms1_20120216 > 6000 & hetms1_20120216 < 6300)));
dEWhigh(1) = NEWerr(1) * EWhigh(1);
Fluxhigh(1)  = EWhigh(1) * halphanormhetms2_20120216 * 1;
dFluxhigh(1) = dEWhigh(1) * halphanormhetms2_20120216 * 1;;
hetms2_20120216_interpsub = -hetms2_20120216_interp + hetms2_20120216_halphacontfitnormsub;
hetms2_20120216_interpsub = -hetms2_20120216_interp + hetms2_20120216_halphacontfitnormsub;
EWlow(2) = trapz(hetms1_20120216(find(hetms1_20120216 > 6543 & hetms1_20120216 < 6593)),hetms2_20120216_interpsub(find(hetms1_20120216 > 6543 & hetms1_20120216 < 6593)));
NEWerr(2) = 1/2 * 5*std(hetms2_20120216_interp(find(hetms1_20120216 > 6000 & hetms1_20120216 < 6300)));
dEWlow(2) = NEWerr(2) * EWlow(2);
Fluxlow(2)  = EWlow(2) * halphanormhetms2_20120216 * 1;
dFluxlow(2) = dEWlow(2) * halphanormhetms2_20120216 * 1;

clf
hold all
plot(hetms1_20120216(find(hetms1_20120216>6462 & hetms1_20120216 < 6662))/10^3,hetms2_20120216_interp(find(hetms1_20120216>6462 & hetms1_20120216 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120216(find(hetms1_20120216>6462 & hetms1_20120216 < 6662))/10^3,hetms2_20120216_halphacontnorm(find(hetms1_20120216>6462 & hetms1_20120216 < 6662)),'--','LineWidth',2,'Color',[0 0 0])

clf
hold all
plot(hetms1_20120216(find(hetms1_20120216>6462 & hetms1_20120216 < 6662))/10^3,hetms2_20120216_interpsub(find(hetms1_20120216>6462 & hetms1_20120216 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120216(find(hetms1_20120216>6462 & hetms1_20120216 < 6662))/10^3,-1+hetms2_20120216_halphacontnorm(find(hetms1_20120216>6462 & hetms1_20120216 < 6662)),'--','LineWidth',2,'Color',[0 0 0])




hetms2_20120301_interp = hetms2_20120301_halphacontfitnormsubinterp;
%hetms2_20120301_interp(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6551,1,'first')) = interp1([find(hetms1_20120301>6543,1,'first') find(hetms1_20120301 >= 6551,1,'first')] , [hetms2_20120301_interp(find(hetms1_20120301>6543,1,'first')) hetms2_20120301_interp(find(hetms1_20120301 >= 6551,1,'first'))] , linspace(find(hetms1_20120301>6543,1,'first'),find(hetms1_20120301 >= 6551,1,'first'),length(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6551,1,'first'))));
%hetms2_20120301_interp(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6593,1,'first')) = interp1([find(hetms1_20120301>6543,1,'first') find(hetms1_20120301 >= 6593,1,'first')] , [hetms2_20120301_interp(find(hetms1_20120301>6543,1,'first')) hetms2_20120301_interp(find(hetms1_20120301 >= 6593,1,'first'))] , linspace(find(hetms1_20120301>6543,1,'first'),find(hetms1_20120301 >= 6593,1,'first'),length(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6593,1,'first'))));
%hetms2_20120301_interp(find(hetms1_20120301>6577,1,'first'):find(hetms1_20120301 >= 6593,1,'first')) = interp1([find(hetms1_20120301>6577,1,'first') find(hetms1_20120301 >= 6593,1,'first')] , [hetms2_20120301_interp(find(hetms1_20120301>6577,1,'first')) hetms2_20120301_interp(find(hetms1_20120301 >= 6593,1,'first'))] , linspace(find(hetms1_20120301>6577,1,'first'),find(hetms1_20120301 >= 6593,1,'first'),length(find(hetms1_20120301>6577,1,'first'):find(hetms1_20120301 >= 6593,1,'first'))));
EWhigh(3) = trapz(hetms1_20120301(find(hetms1_20120301 > 6213 & hetms1_20120301 < 6913)),hetms2_20120301_interp(find(hetms1_20120301 > 6213 & hetms1_20120301 < 6913)))
NEWerr(3) = 5*std(hetms2_20120301_interp(find(hetms1_20120301 > 6000 & hetms1_20120301 < 6300)));
dEWhigh(3) = NEWerr(3) * EWhigh(3);
Fluxhigh(3)  = EWhigh(3) * halphanormhetms2_20120301 * 1;
dFluxhigh(3) = dEWhigh(3) * halphanormhetms2_20120301 * 1;;
hetms2_20120301_interpsub = -hetms2_20120301_interp + hetms2_20120301_halphacontfitnormsub;
hetms2_20120301_interpsub = -hetms2_20120301_interp + hetms2_20120301_halphacontfitnormsub;
EWlow(4) = trapz(hetms1_20120301(find(hetms1_20120301 > 6543 & hetms1_20120301 < 6593)),hetms2_20120301_interpsub(find(hetms1_20120301 > 6543 & hetms1_20120301 < 6593)));
NEWerr(4) = 1/2 * 5*std(hetms2_20120301_interp(find(hetms1_20120301 > 6000 & hetms1_20120301 < 6300)));
dEWlow(4) = NEWerr(4) * EWlow(4);
Fluxlow(4)  = EWlow(4) * halphanormhetms2_20120301 * 1;
dFluxlow(4) = dEWlow(4) * halphanormhetms2_20120301 * 1;


clf
hold all
plot(hetms1_20120301(find(hetms1_20120301>6162 & hetms1_20120301 < 6962))/10^3,hetms2_20120301_interp(find(hetms1_20120301>6162 & hetms1_20120301 < 6962)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120301(find(hetms1_20120301>6162 & hetms1_20120301 < 6962))/10^3,hetms2_20120301_halphacontnorm(find(hetms1_20120301>6162 & hetms1_20120301 < 6962)),'--','LineWidth',2,'Color',[0 0 0])
%line([6000*10^-10 7000*10^-10],[0 0])
line([6000*10^-3 7000*10^-3],[0 0],'LineStyle','--','Color',[0.5 0.5 1],'LineWidth',3)

clf
hold all
plot(hetms1_20120301(find(hetms1_20120301>6462 & hetms1_20120301 < 6662))/10^3,hetms2_20120301_interpsub(find(hetms1_20120301>6462 & hetms1_20120301 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120301(find(hetms1_20120301>6462 & hetms1_20120301 < 6662))/10^3,-1+hetms2_20120301_halphacontnorm(find(hetms1_20120301>6462 & hetms1_20120301 < 6662)),'--','LineWidth',2,'Color',[0 0 0])















%mmtbc2_20120301_interp(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first')) = interp1([find(mmtbc1_20120301>6543,1,'first') find(mmtbc1_20120301 >= 6551,1,'first')] , [mmtbc2_20120301_interp(find(mmtbc1_20120301>6543,1,'first')) mmtbc2_20120301_interp(find(mmtbc1_20120301 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120301>6543,1,'first'),find(mmtbc1_20120301 >= 6551,1,'first'),length(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first'))));
%mmtbc2_20120301_interp(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first')) = interp1([find(mmtbc1_20120301>6557,1,'first') find(mmtbc1_20120301 >= 6570,1,'first')] , [mmtbc2_20120301_interp(find(mmtbc1_20120301>6557,1,'first')) mmtbc2_20120301_interp(find(mmtbc1_20120301 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120301>6557,1,'first'),find(mmtbc1_20120301 >= 6570,1,'first'),length(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first'))));
%mmtbc2_20120301_interp(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first')) = interp1([find(mmtbc1_20120301>6579,1,'first') find(mmtbc1_20120301 >= 6587,1,'first')] , [mmtbc2_20120301_interp(find(mmtbc1_20120301>6579,1,'first')) mmtbc2_20120301_interp(find(mmtbc1_20120301 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120301>6579,1,'first'),find(mmtbc1_20120301 >= 6587,1,'first'),length(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first'))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
%spolm2_20120416_interp(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first')) = interp1([find(spolm1_20120416>6543,1,'first') find(spolm1_20120416 >= 6551,1,'first')] , [spolm2_20120416_interp(find(spolm1_20120416>6543,1,'first')) spolm2_20120416_interp(find(spolm1_20120416 >= 6551,1,'first'))] , linspace(find(spolm1_20120416>6543,1,'first'),find(spolm1_20120416 >= 6551,1,'first'),length(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first'))));
%spolm2_20120416_interp(find(spolm1_20120416>6557,1,'first'):find(spolm1_20120416 >= 6570,1,'first')) = interp1([find(spolm1_20120416>6557,1,'first') find(spolm1_20120416 >= 6570,1,'first')] , [spolm2_20120416_interp(find(spolm1_20120416>6557,1,'first')) spolm2_20120416_interp(find(spolm1_20120416 >= 6570,1,'first'))] , linspace(find(spolm1_20120416>6557,1,'first'),find(spolm1_20120416 >= 6570,1,'first'),length(find(spolm1_20120416>6557,1,'first'):find(spolm1_20120416 >= 6570,1,'first'))));
%spolm2_20120416_interp(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first')) = interp1([find(spolm1_20120416>6579,1,'first') find(spolm1_20120416 >= 6587,1,'first')] , [spolm2_20120416_interp(find(spolm1_20120416>6579,1,'first')) spolm2_20120416_interp(find(spolm1_20120416 >= 6587,1,'first'))] , linspace(find(spolm1_20120416>6579,1,'first'),find(spolm1_20120416 >= 6587,1,'first'),length(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first'))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
%mmtbc2_20120529_interp(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first')) = interp1([find(mmtbc1_20120529>6543,1,'first') find(mmtbc1_20120529 >= 6551,1,'first')] , [mmtbc2_20120529_interp(find(mmtbc1_20120529>6543,1,'first')) mmtbc2_20120529_interp(find(mmtbc1_20120529 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120529>6543,1,'first'),find(mmtbc1_20120529 >= 6551,1,'first'),length(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first'))));
%mmtbc2_20120529_interp(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first')) = interp1([find(mmtbc1_20120529>6557,1,'first') find(mmtbc1_20120529 >= 6570,1,'first')] , [mmtbc2_20120529_interp(find(mmtbc1_20120529>6557,1,'first')) mmtbc2_20120529_interp(find(mmtbc1_20120529 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120529>6557,1,'first'),find(mmtbc1_20120529 >= 6570,1,'first'),length(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first'))));
%mmtbc2_20120529_interp(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first')) = interp1([find(mmtbc1_20120529>6579,1,'first') find(mmtbc1_20120529 >= 6587,1,'first')] , [mmtbc2_20120529_interp(find(mmtbc1_20120529>6579,1,'first')) mmtbc2_20120529_interp(find(mmtbc1_20120529 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120529>6579,1,'first'),find(mmtbc1_20120529 >= 6587,1,'first'),length(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first'))));
%            
%			 
%mmtbc2_20120701_interp(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first')) = interp1([find(mmtbc1_20120701>6543,1,'first') find(mmtbc1_20120701 >= 6551,1,'first')] , [mmtbc2_20120701_interp(find(mmtbc1_20120701>6543,1,'first')) mmtbc2_20120701_interp(find(mmtbc1_20120701 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120701>6543,1,'first'),find(mmtbc1_20120701 >= 6551,1,'first'),length(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first'))));
%mmtbc2_20120701_interp(find(mmtbc1_20120701>6557,1,'first'):find(mmtbc1_20120701 >= 6578,1,'first')) = interp1([find(mmtbc1_20120701>6557,1,'first') find(mmtbc1_20120701 >= 6578,1,'first')] , [mmtbc2_20120701_interp(find(mmtbc1_20120701>6557,1,'first')) mmtbc2_20120701_interp(find(mmtbc1_20120701 >= 6578,1,'first'))] , linspace(find(mmtbc1_20120701>6557,1,'first'),find(mmtbc1_20120701 >= 6578,1,'first'),length(find(mmtbc1_20120701>6557,1,'first'):find(mmtbc1_20120701 >= 6578,1,'first'))));
%mmtbc2_20120701_interp(find(mmtbc1_20120701>6578,1,'first'):find(mmtbc1_20120701 >= 6592,1,'first')) = interp1([find(mmtbc1_20120701>6578,1,'first') find(mmtbc1_20120701 >= 6592,1,'first')] , [mmtbc2_20120701_interp(find(mmtbc1_20120701>6578,1,'first')) mmtbc2_20120701_interp(find(mmtbc1_20120701 >= 6592,1,'first'))] , linspace(find(mmtbc1_20120701>6578,1,'first'),find(mmtbc1_20120701 >= 6592,1,'first'),length(find(mmtbc1_20120701>6578,1,'first'):find(mmtbc1_20120701 >= 6592,1,'first'))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
%keckD2_20121115_interp(find(keckD1_20121115>6543,1,'first'):find(keckD1_20121115 >= 6551,1,'first')) = interp1([find(keckD1_20121115>6543,1,'first') find(keckD1_20121115 >= 6551,1,'first')] , [keckD2_20121115_interp(find(keckD1_20121115>6543,1,'first')) keckD2_20121115_interp(find(keckD1_20121115 >= 6551,1,'first'))] , linspace(find(keckD1_20121115>6543,1,'first'),find(keckD1_20121115 >= 6551,1,'first'),length(find(keckD1_20121115>6543,1,'first'):find(keckD1_20121115 >= 6551,1,'first'))));
%keckD2_20121115_interp(find(keckD1_20121115>6557,1,'first'):find(keckD1_20121115 >= 6570,1,'first')) = interp1([find(keckD1_20121115>6557,1,'first') find(keckD1_20121115 >= 6570,1,'first')] , [keckD2_20121115_interp(find(keckD1_20121115>6557,1,'first')) keckD2_20121115_interp(find(keckD1_20121115 >= 6570,1,'first'))] , linspace(find(keckD1_20121115>6557,1,'first'),find(keckD1_20121115 >= 6570,1,'first'),length(find(keckD1_20121115>6557,1,'first'):find(keckD1_20121115 >= 6570,1,'first'))));
%keckD2_20121115_interp(find(keckD1_20121115>6579,1,'first'):find(keckD1_20121115 >= 6587,1,'first')) = interp1([find(keckD1_20121115>6579,1,'first') find(keckD1_20121115 >= 6587,1,'first')] , [keckD2_20121115_interp(find(keckD1_20121115>6579,1,'first')) keckD2_20121115_interp(find(keckD1_20121115 >= 6587,1,'first'))] , linspace(find(keckD1_20121115>6579,1,'first'),find(keckD1_20121115 >= 6587,1,'first'),length(find(keckD1_20121115>6579,1,'first'):find(keckD1_20121115 >= 6587,1,'first'))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
%spolb2_20120323_interp(find(spolb1_20120323>6543,1,'first'):find(spolb1_20120323 >= 6551,1,'first')) = interp1([find(spolb1_20120323>6543,1,'first') find(spolb1_20120323 >= 6551,1,'first')] , [spolb2_20120323_interp(find(spolb1_20120323>6543,1,'first')) spolb2_20120323_interp(find(spolb1_20120323 >= 6551,1,'first'))] , linspace(find(spolb1_20120323>6543,1,'first'),find(spolb1_20120323 >= 6551,1,'first'),length(find(spolb1_20120323>6543,1,'first'):find(spolb1_20120323 >= 6551,1,'first'))));
%spolb2_20120323_interp(find(spolb1_20120323>6553,1,'first'):find(spolb1_20120323 >= 6577,1,'first')) = interp1([find(spolb1_20120323>6553,1,'first') find(spolb1_20120323 >= 6577,1,'first')] , [spolb2_20120323_interp(find(spolb1_20120323>6553,1,'first')) spolb2_20120323_interp(find(spolb1_20120323 >= 6577,1,'first'))] , linspace(find(spolb1_20120323>6553,1,'first'),find(spolb1_20120323 >= 6577,1,'first'),length(find(spolb1_20120323>6553,1,'first'):find(spolb1_20120323 >= 6577,1,'first'))));
%spolb2_20120323_interp(find(spolb1_20120323>6577,1,'first'):find(spolb1_20120323 >= 6597,1,'first')) = interp1([find(spolb1_20120323>6577,1,'first') find(spolb1_20120323 >= 6597,1,'first')] , [spolb2_20120323_interp(find(spolb1_20120323>6577,1,'first')) spolb2_20120323_interp(find(spolb1_20120323 >= 6597,1,'first'))] , linspace(find(spolb1_20120323>6577,1,'first'),find(spolb1_20120323 >= 6597,1,'first'),length(find(spolb1_20120323>6577,1,'first'):find(spolb1_20120323 >= 6597,1,'first'))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
%mmtbc2_20120417_interp(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first')) = interp1([find(mmtbc1_20120417>6543,1,'first') find(mmtbc1_20120417 >= 6551,1,'first')] , [mmtbc2_20120417_interp(find(mmtbc1_20120417>6543,1,'first')) mmtbc2_20120417_interp(find(mmtbc1_20120417 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120417>6543,1,'first'),find(mmtbc1_20120417 >= 6551,1,'first'),length(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first'))));
%mmtbc2_20120417_interp(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first')) = interp1([find(mmtbc1_20120417>6553,1,'first') find(mmtbc1_20120417 >= 6577,1,'first')] , [mmtbc2_20120417_interp(find(mmtbc1_20120417>6553,1,'first')) mmtbc2_20120417_interp(find(mmtbc1_20120417 >= 6577,1,'first'))] , linspace(find(mmtbc1_20120417>6553,1,'first'),find(mmtbc1_20120417 >= 6577,1,'first'),length(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first'))));
%mmtbc2_20120417_interp(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first')) = interp1([find(mmtbc1_20120417>6577,1,'first') find(mmtbc1_20120417 >= 6597,1,'first')] , [mmtbc2_20120417_interp(find(mmtbc1_20120417>6577,1,'first')) mmtbc2_20120417_interp(find(mmtbc1_20120417 >= 6597,1,'first'))] , linspace(find(mmtbc1_20120417>6577,1,'first'),find(mmtbc1_20120417 >= 6597,1,'first'),length(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first'))));
%			   
%Lkast2_20120223_interp(find(Lkast1_20120223>6543,1,'first'):find(Lkast1_20120223 >= 6551,1,'first')) = interp1([find(Lkast1_20120223>6543,1,'first') find(Lkast1_20120223 >= 6551,1,'first')] , [Lkast2_20120223_interp(find(Lkast1_20120223>6543,1,'first')) Lkast2_20120223_interp(find(Lkast1_20120223 >= 6551,1,'first'))] , linspace(find(Lkast1_20120223>6543,1,'first'),find(Lkast1_20120223 >= 6551,1,'first'),length(find(Lkast1_20120223>6543,1,'first'):find(Lkast1_20120223 >= 6551,1,'first'))));
%Lkast2_20120223_interp(find(Lkast1_20120223>6554,1,'first'):find(Lkast1_20120223 >= 6574,1,'first')) = interp1([find(Lkast1_20120223>6554,1,'first') find(Lkast1_20120223 >= 6574,1,'first')] , [Lkast2_20120223_interp(find(Lkast1_20120223>6554,1,'first')) Lkast2_20120223_interp(find(Lkast1_20120223 >= 6574,1,'first'))] , linspace(find(Lkast1_20120223>6554,1,'first'),find(Lkast1_20120223 >= 6574,1,'first'),length(find(Lkast1_20120223>6554,1,'first'):find(Lkast1_20120223 >= 6574,1,'first'))));
%Lkast2_20120223_interp(find(Lkast1_20120223>6576,1,'first'):find(Lkast1_20120223 >= 6590,1,'first')) = interp1([find(Lkast1_20120223>6576,1,'first') find(Lkast1_20120223 >= 6590,1,'first')] , [Lkast2_20120223_interp(find(Lkast1_20120223>6576,1,'first')) Lkast2_20120223_interp(find(Lkast1_20120223 >= 6590,1,'first'))] , linspace(find(Lkast1_20120223>6576,1,'first'),find(Lkast1_20120223 >= 6590,1,'first'),length(find(Lkast1_20120223>6576,1,'first'):find(Lkast1_20120223 >= 6590,1,'first'))));                  
%					
%Lkast2_20120428_interp(find(Lkast1_20120428>6543,1,'first'):find(Lkast1_20120428 >= 6551,1,'first')) = interp1([find(Lkast1_20120428>6543,1,'first') find(Lkast1_20120428 >= 6551,1,'first')] , [Lkast2_20120428_interp(find(Lkast1_20120428>6543,1,'first')) Lkast2_20120428_interp(find(Lkast1_20120428 >= 6551,1,'first'))] , linspace(find(Lkast1_20120428>6543,1,'first'),find(Lkast1_20120428 >= 6551,1,'first'),length(find(Lkast1_20120428>6543,1,'first'):find(Lkast1_20120428 >= 6551,1,'first'))));
%Lkast2_20120428_interp(find(Lkast1_20120428>6552,1,'first'):find(Lkast1_20120428 >= 6572,1,'first')) = interp1([find(Lkast1_20120428>6552,1,'first') find(Lkast1_20120428 >= 6572,1,'first')] , [Lkast2_20120428_interp(find(Lkast1_20120428>6552,1,'first')) Lkast2_20120428_interp(find(Lkast1_20120428 >= 6572,1,'first'))] , linspace(find(Lkast1_20120428>6552,1,'first'),find(Lkast1_20120428 >= 6572,1,'first'),length(find(Lkast1_20120428>6552,1,'first'):find(Lkast1_20120428 >= 6572,1,'first'))));
%Lkast2_20120428_interp(find(Lkast1_20120428>6572,1,'first'):find(Lkast1_20120428 >= 6593,1,'first')) = interp1([find(Lkast1_20120428>6572,1,'first') find(Lkast1_20120428 >= 6593,1,'first')] , [Lkast2_20120428_interp(find(Lkast1_20120428>6572,1,'first')) Lkast2_20120428_interp(find(Lkast1_20120428 >= 6593,1,'first'))] , linspace(find(Lkast1_20120428>6572,1,'first'),find(Lkast1_20120428 >= 6593,1,'first'),length(find(Lkast1_20120428>6572,1,'first'):find(Lkast1_20120428 >= 6593,1,'first'))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
%keckL2_20120616_interp(find(keckL1_20120616>6543,1,'first'):find(keckL1_20120616 >= 6551,1,'first')) = interp1([find(keckL1_20120616>6543,1,'first') find(keckL1_20120616 >= 6551,1,'first')] , [keckL2_20120616_interp(find(keckL1_20120616>6543,1,'first')) keckL2_20120616_interp(find(keckL1_20120616 >= 6551,1,'first'))] , linspace(find(keckL1_20120616>6543,1,'first'),find(keckL1_20120616 >= 6551,1,'first'),length(find(keckL1_20120616>6543,1,'first'):find(keckL1_20120616 >= 6551,1,'first'))));
%keckL2_20120616_interp(find(keckL1_20120616>6557,1,'first'):find(keckL1_20120616 >= 6570,1,'first')) = interp1([find(keckL1_20120616>6557,1,'first') find(keckL1_20120616 >= 6570,1,'first')] , [keckL2_20120616_interp(find(keckL1_20120616>6557,1,'first')) keckL2_20120616_interp(find(keckL1_20120616 >= 6570,1,'first'))] , linspace(find(keckL1_20120616>6557,1,'first'),find(keckL1_20120616 >= 6570,1,'first'),length(find(keckL1_20120616>6557,1,'first'):find(keckL1_20120616 >= 6570,1,'first'))));
%keckL2_20120616_interp(find(keckL1_20120616>6579,1,'first'):find(keckL1_20120616 >= 6589,1,'first')) = interp1([find(keckL1_20120616>6579,1,'first') find(keckL1_20120616 >= 6589,1,'first')] , [keckL2_20120616_interp(find(keckL1_20120616>6579,1,'first')) keckL2_20120616_interp(find(keckL1_20120616 >= 6589,1,'first'))] , linspace(find(keckL1_20120616>6579,1,'first'),find(keckL1_20120616 >= 6589,1,'first'),length(find(keckL1_20120616>6579,1,'first'):find(keckL1_20120616 >= 6589,1,'first'))));
%
%keckD2_20150521_interp(find(keckD1_20150521>6543,1,'first'):find(keckD1_20150521 >= 6551,1,'first')) = interp1([find(keckD1_20150521>6543,1,'first') find(keckD1_20150521 >= 6551,1,'first')] , [keckD2_20150521_interp(find(keckD1_20150521>6543,1,'first')) keckD2_20150521_interp(find(keckD1_20150521 >= 6551,1,'first'))] , linspace(find(keckD1_20150521>6543,1,'first'),find(keckD1_20150521 >= 6551,1,'first'),length(find(keckD1_20150521>6543,1,'first'):find(keckD1_20150521 >= 6551,1,'first'))));
%keckD2_20150521_interp(find(keckD1_20150521>6557,1,'first'):find(keckD1_20150521 >= 6570,1,'first')) = interp1([find(keckD1_20150521>6557,1,'first') find(keckD1_20150521 >= 6570,1,'first')] , [keckD2_20150521_interp(find(keckD1_20150521>6557,1,'first')) keckD2_20150521_interp(find(keckD1_20150521 >= 6570,1,'first'))] , linspace(find(keckD1_20150521>6557,1,'first'),find(keckD1_20150521 >= 6570,1,'first'),length(find(keckD1_20150521>6557,1,'first'):find(keckD1_20150521 >= 6570,1,'first'))));
%keckD2_20150521_interp(find(keckD1_20150521>6579,1,'first'):find(keckD1_20150521 >= 6587,1,'first')) = interp1([find(keckD1_20150521>6579,1,'first') find(keckD1_20150521 >= 6587,1,'first')] , [keckD2_20150521_interp(find(keckD1_20150521>6579,1,'first')) keckD2_20150521_interp(find(keckD1_20150521 >= 6587,1,'first'))] , linspace(find(keckD1_20150521>6579,1,'first'),find(keckD1_20150521 >= 6587,1,'first'),length(find(keckD1_20150521>6579,1,'first'):find(keckD1_20150521 >= 6587,1,'first'))));
                     
%clf
%hold all
%plot(keckD1_20150521(find(keckD1_20150521>6462 & keckD1_20150521 < 6662))/10^3,keckD2_20150521_interp(find(keckD1_20150521>6462 & keckD1_20150521 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
%plot(keckD1_20150521(find(keckD1_20150521>6462 & keckD1_20150521 < 6662))/10^3,keckD2_20150521_halphacontnorm(find(keckD1_20150521>6462 & keckD1_20150521 < 6662)),'--','LineWidth',2,'Color',[0 0 0])
%
%clf
%hold all
%plot(keckD1_20150521(find(keckD1_20150521>6462 & keckD1_20150521 < 6662))/10^3,keckD2_20150521_interpsub(find(keckD1_20150521>6462 & keckD1_20150521 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
%plot(keckD1_20150521(find(keckD1_20150521>6462 & keckD1_20150521 < 6662))/10^3,keckD2_20150521_halphacontnorm(find(keckD1_20150521>6462 & keckD1_20150521 < 6662)),'--','LineWidth',2,'Color',[0 0 0])





clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,-1+keckD2_20121115_interp(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 0 0])

%clf
%hold all
%plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,-1+keckD2_20121115_interpsub(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 1 0])
%plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 0 0])



%CHECK THE RANGE USED FOR THE NEWEST KECK 2015 TO MAKE SURE IT ACTUALLY IS THE LINE ZZZ



EWhigh(2)  = trapz(Lkast1_20120223(find(Lkast1_20120223 > 6213 & Lkast1_20120223 < 6913)),Lkast2_20120223_interp(find(Lkast1_20120223 > 6213 & Lkast1_20120223 < 6913)))
EWhigh(4)  = trapz(spolb1_20120323(find(spolb1_20120323 > 6213 & spolb1_20120323 < 6913)),spolb2_20120323_interp(find(spolb1_20120323 > 6213 & spolb1_20120323 < 6913)))
EWhigh(5)  = trapz(spolm1_20120416(find(spolm1_20120416 > 6213 & spolm1_20120416 < 6913)),spolm2_20120416_interp(find(spolm1_20120416 > 6213 & spolm1_20120416 < 6913)))
EWhigh(6)  = trapz(Lkast1_20120428(find(Lkast1_20120428 > 6213 & Lkast1_20120428 < 6913)),Lkast2_20120428_interp(find(Lkast1_20120428 > 6213 & Lkast1_20120428 < 6913)))
EWhigh(7)  = trapz(keckL1_20120616(find(keckL1_20120616 > 6213 & keckL1_20120616 < 6913)),keckL2_20120616_interp(find(keckL1_20120616 > 6213 & keckL1_20120616 < 6913)))
%EWhigh(9)  = trapz(mmtbc1_20120701(find(mmtbc1_20120701 > 6213 & mmtbc1_20120701 < 6913)),mmtbc2_20120701_interp(find(mmtbc1_20120701 > 6213 & mmtbc1_20120701 < 6913)))
EWhigh(8) = trapz(keckD1_20121115(find(keckD1_20121115 > 6213 & keckD1_20121115 < 6913)),keckD2_20121115_interp(find(keckD1_20121115 > 6213 & keckD1_20121115 < 6913)))
EWhigh(9) = trapz(keckD1_20150521(find(keckD1_20150521 > 6213 & keckD1_20150521 < 6913)),keckD2_20150521_interp(find(keckD1_20150521 > 6213 & keckD1_20150521 < 6913)))
NEWerr(2) = 5*std(Lkast2_20120223_interp(find(Lkast1_20120223 > 6000 & Lkast1_20120223 < 6300)));
NEWerr(4) = 5*std(spolb2_20120323_interp(find(spolb1_20120323 > 6000 & spolb1_20120323 < 6300)));
NEWerr(5) = 5*std(spolm2_20120416_interp(find(spolm1_20120416 > 6000 & spolm1_20120416 < 6300)));
NEWerr(6) = 5*std(Lkast2_20120428_interp(find(Lkast1_20120428 > 6000 & Lkast1_20120428 < 6300)));
NEWerr(7) = 5*std(keckL2_20120616_interp(find(keckL1_20120616 > 6000 & keckL1_20120616 < 6300)));
%NEWerr(9) = 5*std(mmtbc2_20120701_interp(find(mmtbc1_20120701 > 6000 & mmtbc1_20120701 < 6300)));
NEWerr(8) = 5*std(keckD2_20121115_interp(find(keckD1_20121115 > 6000 & keckD1_20121115 < 6300)));
NEWerr(9) = 5*std(keckD2_20150521_interp(find(keckD1_20150521 > 6000 & keckD1_20150521 < 6300)));
dEWhigh(2) = NEWerr(2)  * EWhigh(2) ;
dEWhigh(4) = NEWerr(4)  * EWhigh(4) ;
dEWhigh(5) = NEWerr(5)  * EWhigh(5) ;
dEWhigh(6) = NEWerr(6)  * EWhigh(6) ;
dEWhigh(7) = NEWerr(7)  * EWhigh(7) ;
%dEWhigh(9) = NEWerr(9)  * EWhigh(9) ;
dEWhigh(8)= NEWerr(8) * EWhigh(8);
dEWhigh(9)= NEWerr(9) * EWhigh(9);
%Fluxhigh(3)  = EWhigh(3) * halphanormLkast2_20120223 * FR_20120223 / meanR_20120223;
%Fluxhigh(5)  = EWhigh(5) * halphanormspolb2_20120323 * FR_20120323 / meanR_20120323;
%Fluxhigh(3)  = EWhigh(3) * halphanormspolm2_20120416 * FR_20120416 / meanR_20120416;
Fluxhigh(2)  = EWhigh(2) * halphanormLkast2_20120223 * 10^-15;
Fluxhigh(4)  = EWhigh(4) * halphanormspolb2_20120323 * 1;
Fluxhigh(5)  = EWhigh(5) * halphanormspolm2_20120416 * 1;
Fluxhigh(6)  = EWhigh(6) * halphanormLkast2_20120428 * 10^-15;
Fluxhigh(7)  = EWhigh(7) * halphanormkeckL2_20120616 * 10^-15;
%Fluxhigh(9)  = EWhigh(9) * halphanormmmtbc2_20120701 * 1 ;
Fluxhigh(8)  = EWhigh(8) * halphanormkeckD2_20121115 * 1;
Fluxhigh(9)  = EWhigh(9) * halphanormkeckD2_20150521 * 1;
%dFluxhigh(3) = dEWhigh(3) * halphanormLkast2_20120223 * FR_20120223 / meanR_20120223;
%dFluxhigh(5) = dEWhigh(5) * halphanormspolb2_20120323 * FR_20120323 / meanR_20120323;
%dFluxhigh(3) = dEWhigh(3) * halphanormspolm2_20120416 * FR_20120416 / meanR_20120416;
dFluxhigh(2) = dEWhigh(2) * halphanormLkast2_20120223 * 10^-15;
dFluxhigh(4) = dEWhigh(4) * halphanormspolb2_20120323 * 1;
dFluxhigh(5) = dEWhigh(5) * halphanormspolm2_20120416 * 1;
dFluxhigh(6) = dEWhigh(6) * halphanormLkast2_20120428 * 10^-15;;
dFluxhigh(7) = dEWhigh(7) * halphanormkeckL2_20120616 * 10^-15;;
%dFluxhigh(9) = dEWhigh(9) * halphanormmmtbc2_20120701 * 1 ;;
dFluxhigh(8) = dEWhigh(8) * halphanormkeckD2_20121115 * 1;;
dFluxhigh(9) = dEWhigh(9) * halphanormkeckD2_20150521 * 1;;


reldatered = [ reldate(13) reldate(1) reldate(14) reldate(3:4) reldate(6) reldate(8) reldate(10:11)];


compareEW(1) = leftEWhigh(2)+ rightEWhigh(2) ;
compareEW(2) = leftEWhigh(3)+ rightEWhigh(3) ;
compareEW(3) = leftEWhigh(4)+ rightEWhigh(4) ;
compareEW(4) = leftEWhigh(6)+ rightEWhigh(6) ;
compareEW(5) = leftEWhigh(7)+ rightEWhigh(7) ;
compareEW(6) = leftEWhigh(9)+ rightEWhigh(9) ;
compareEW(7) = leftEWhigh(11)+rightEWhigh(11);
compareEW(8) = leftEWhigh(13)+rightEWhigh(13);
compareEW(9) = leftEWhigh(14)+rightEWhigh(14);
compareEW

















mmtbc2_20120301_interpsub = -mmtbc2_20120301_interp + mmtbc2_20120301_halphacontfitnormsub;
mmtbc2_20120417_interpsub = -mmtbc2_20120417_interp + mmtbc2_20120417_halphacontfitnormsub;
mmtbc2_20120529_interpsub = -mmtbc2_20120529_interp + mmtbc2_20120529_halphacontfitnormsub;
mmtbc2_20120701_interpsub = -mmtbc2_20120701_interp + mmtbc2_20120701_halphacontfitnormsub;
keckD2_20121115_interpsub = -keckD2_20121115_interp + keckD2_20121115_halphacontfitnormsub;
spolb2_20120323_interpsub = -spolb2_20120323_interp + spolb2_20120323_halphacontfitnormsub;
spolm2_20120416_interpsub = -spolm2_20120416_interp + spolm2_20120416_halphacontfitnormsub;
Lkast2_20120223_interpsub = -Lkast2_20120223_interp + Lkast2_20120223_halphacontfitnormsub;
Lkast2_20120428_interpsub = -Lkast2_20120428_interp + Lkast2_20120428_halphacontfitnormsub;
keckL2_20120616_interpsub = -keckL2_20120616_interp + keckL2_20120616_halphacontfitnormsub;
keckD2_20150521_interpsub = -keckD2_20150521_interp + keckD2_20150521_halphacontfitnormsub;
EWlow(3) = trapz(Lkast1_20120223(find(Lkast1_20120223 > 6554 & Lkast1_20120223 < 6574)),Lkast2_20120223_interpsub(find(Lkast1_20120223 > 6554 & Lkast1_20120223 < 6574)));
EWlow(5) = trapz(spolb1_20120323(find(spolb1_20120323 > 6553 & spolb1_20120323 < 6577)),spolb2_20120323_interpsub(find(spolb1_20120323 > 6553 & spolb1_20120323 < 6577)));
EWlow(6) = trapz(spolm1_20120416(find(spolm1_20120416 > 6553 & spolm1_20120416 < 6577)),spolm2_20120416_interpsub(find(spolm1_20120416 > 6553 & spolm1_20120416 < 6577)));
EWlow(7) = trapz(Lkast1_20120428(find(Lkast1_20120428 > 6552 & Lkast1_20120428 < 6572)),Lkast2_20120428_interpsub(find(Lkast1_20120428 > 6552 & Lkast1_20120428 < 6572)));
EWlow(8) = trapz(keckL1_20120616(find(keckL1_20120616 > 6557 & keckL1_20120616 < 6570)),keckL2_20120616_interpsub(find(keckL1_20120616 > 6557 & keckL1_20120616 < 6570)));
EWlow(9) = trapz(mmtbc1_20120701(find(mmtbc1_20120701 > 6557 & mmtbc1_20120701 < 6578)),mmtbc2_20120701_interpsub(find(mmtbc1_20120701 > 6557 & mmtbc1_20120701 < 6578)));
EWlow(10) = trapz(keckD1_20121115(find(keckD1_20121115 > 6557 & keckD1_20121115 < 6570)),keckD2_20121115_interpsub(find(keckD1_20121115 > 6557 & keckD1_20121115 < 6570)));
EWlow(11) = trapz(keckD1_20150521(find(keckD1_20150521 > 6557 & keckD1_20150521 < 6570)),keckD2_20150521_interpsub(find(keckD1_20150521 > 6557 & keckD1_20150521 < 6570)));
NEWerr(3) = 1/2 * 5*std(Lkast2_20120223_interp(find(Lkast1_20120223 > 6000 & Lkast1_20120223 < 6300)));
NEWerr(5) = 1/2 * 5*std(spolb2_20120323_interp(find(spolb1_20120323 > 6000 & spolb1_20120323 < 6300)));
NEWerr(6) = 1/2 * 5*std(spolm2_20120416_interp(find(spolm1_20120416 > 6000 & spolm1_20120416 < 6300)));
NEWerr(7) = 1/2 * 5*std(Lkast2_20120428_interp(find(Lkast1_20120428 > 6000 & Lkast1_20120428 < 6300)));
NEWerr(8) = 1/2 * 5*std(keckL2_20120616_interp(find(keckL1_20120616 > 6000 & keckL1_20120616 < 6300)));
NEWerr(9) = 1/2 * 5*std(mmtbc2_20120701_interp(find(mmtbc1_20120701 > 6000 & mmtbc1_20120701 < 6300)));
NEWerr(10) = 1/2 * 5*std(keckD2_20121115_interp(find(keckD1_20121115 > 6000 & keckD1_20121115 < 6300)));
NEWerr(11) = 1/2 * 5*std(keckD2_20150521_interp(find(keckD1_20150521 > 6000 & keckD1_20150521 < 6300)));
dEWlow(3)  = NEWerr(3)  * EWlow(3) ;
dEWlow(5)  = NEWerr(5)  * EWlow(5) ;
dEWlow(6)  = NEWerr(6)  * EWlow(6) ;
dEWlow(7)  = NEWerr(7)  * EWlow(7) ;
dEWlow(8)  = NEWerr(8)  * EWlow(8) ;
dEWlow(9)  = NEWerr(9)  * EWlow(9) ;
dEWlow(10) = NEWerr(10) * EWlow(10);
dEWlow(11) = NEWerr(11) * EWlow(11);
%Fluxlow(3)  = EWlow(3) * halphanormLkast2_20120223 * FR_20120223 / meanR_20120223;
%Fluxlow(5)  = EWlow(5) * halphanormspolb2_20120323 * FR_20120323 / meanR_20120323;
%Fluxlow(3)  = EWlow(3) * halphanormspolm2_20120416 * FR_20120416 / meanR_20120416;
Fluxlow(3)   = EWlow(3)  * halphanormLkast2_20120223 * 10^-15;
Fluxlow(5)   = EWlow(5)  * halphanormspolb2_20120323 * 1;
Fluxlow(6)   = EWlow(6)  * halphanormspolm2_20120416 * 1;
Fluxlow(7)   = EWlow(7)  * halphanormLkast2_20120428 * 10^-15;
Fluxlow(8)   = EWlow(8)  * halphanormkeckL2_20120616 * 10^-15;
Fluxlow(9)   = EWlow(9)  * halphanormmmtbc2_20120701 * 1 ;
Fluxlow(10)  = EWlow(10) * halphanormkeckD2_20121115 * 1;
Fluxlow(11)  = EWlow(11) * halphanormkeckD2_20150521 * 1;
%dFluxlow(3) = dEWlow(3) * halphanormLkast2_20120223 * FR_20120223 / meanR_20120223;
%dFluxlow(5) = dEWlow(5) * halphanormspolb2_20120323 * FR_20120323 / meanR_20120323;
%dFluxlow(3) = dEWlow(3) * halphanormspolm2_20120416 * FR_20120416 / meanR_20120416;
dFluxlow(3)  = dEWlow(3)  * halphanormLkast2_20120223 * 10^-15;
dFluxlow(5)  = dEWlow(5)  * halphanormspolb2_20120323 * 1;
dFluxlow(6)  = dEWlow(6)  * halphanormspolm2_20120416 * 1;
dFluxlow(7)  = dEWlow(7)  * halphanormLkast2_20120428 * 10^-15;
dFluxlow(8)  = dEWlow(8)  * halphanormkeckL2_20120616 * 10^-15;
dFluxlow(9)  = dEWlow(9)  * halphanormmmtbc2_20120701 * 1 ;
dFluxlow(10) = dEWlow(10) * halphanormkeckD2_20121115 * 1;
dFluxlow(11) = dEWlow(11) * halphanormkeckD2_20150521 * 1;
Fluxlowhalpha(1) = halphanormmmtbc2_20120301 * trapz(mmtbc1_20120301(find(mmtbc1_20120301 > 6555 & mmtbc1_20120301 < 6569)),mmtbc2_20120301_interpsub(find(mmtbc1_20120301 > 6555 & mmtbc1_20120301 < 6569)));
Fluxlowhalpha(2) = halphanormmmtbc2_20120417 * trapz(mmtbc1_20120417(find(mmtbc1_20120417 > 6555 & mmtbc1_20120417 <6569)),mmtbc2_20120417_interpsub(find(mmtbc1_20120417 > 6555 & mmtbc1_20120417 < 6569)));
Fluxlowhalpha(3) = halphanormmmtbc2_20120529 * trapz(mmtbc1_20120529(find(mmtbc1_20120529 > 6555 & mmtbc1_20120529 <6569)),mmtbc2_20120529_interpsub(find(mmtbc1_20120529 > 6555 & mmtbc1_20120529 < 6569)));
dFluxlowhalpha(1) = Fluxlowhalpha(1) * 5*std(mmtbc2_20120301_interp(find(mmtbc1_20120301 > 6000 & mmtbc1_20120301 < 6300)));
dFluxlowhalpha(2) = Fluxlowhalpha(2) * 5*std(mmtbc2_20120417_interp(find(mmtbc1_20120417 > 6000 & mmtbc1_20120417 < 6300)));
dFluxlowhalpha(3) = Fluxlowhalpha(3) * 5*std(mmtbc2_20120529_interp(find(mmtbc1_20120529 > 6000 & mmtbc1_20120529 < 6300)));




clf
hold all
plot(mmtbc1_20120301(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662))/10^3,mmtbc2_20120301_interpsub(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662))/10^3,mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>6462 & mmtbc1_20120301 < 6662)),'--','LineWidth',2,'Color',[0 0 0])




clf
hold all
plot(keckD1_20150521(find(keckD1_20150521>6462 & keckD1_20150521 < 6662))/10^3,keckD2_20150521_interpsub(find(keckD1_20150521>6462 & keckD1_20150521 < 6662)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20150521(find(keckD1_20150521>6462 & keckD1_20150521 < 6662))/10^3,keckD2_20150521_halphacontnorm(find(keckD1_20150521>6462 & keckD1_20150521 < 6662)),'--','LineWidth',2,'Color',[0 0 0])












OIIIHbetaratio(1) = Fluxlowhbeta(1)/OIII2(12);
OIIIHbetaratio(2) = Fluxlowhbeta(2)/OIII2(13);
OIIIHbetaratio(3) = Fluxlowhbeta(3)/OIII2(1);
OIIIHbetaratio(4) = Fluxlowhbeta(4)/OIII2(14);
OIIIHbetaratio(5) = Fluxlowhbeta(5)/OIII2(6);
OIIIHbetaratio(6) = Fluxlowhbeta(6)/OIII2(9);
OIIIHbetaratio(7) = Fluxlowhbeta(7)/OIII2(10);
OIIIHbetaratio(8) = Fluxlowhbeta(8)/OIII2(11);
OIIIHbetaratiodate(1) = 7;
OIIIHbetaratiodate(2) = 16;
OIIIHbetaratiodate(3) = 23;
OIIIHbetaratiodate(4) = 30;
OIIIHbetaratiodate(5) = 88;
OIIIHbetaratiodate(6) = 137;
OIIIHbetaratiodate(7) = 289;
OIIIHbetaratiodate(8) = 1206;
errOIIIHbetaratio(1) = sqrt(OIIIHbetaratio(1)^2 * ((errOIII2(12)/OIII2(12) )^2 +  (dFluxlowhbeta(1) /Fluxlowhbeta(1)      )^2));
errOIIIHbetaratio(2) = sqrt(OIIIHbetaratio(2)^2 * ((errOIII2(13)/OIII2(13) )^2 +  (dFluxlowhbeta(2) /Fluxlowhbeta(2)      )^2));
errOIIIHbetaratio(3) = sqrt(OIIIHbetaratio(3)^2 * ((errOIII2(1) /OIII2(1)  )^2 +  (dFluxlowhbeta(3) /Fluxlowhbeta(3)      )^2));
errOIIIHbetaratio(4) = sqrt(OIIIHbetaratio(4)^2 * ((errOIII2(14)/OIII2(14) )^2 +  (dFluxlowhbeta(4) /Fluxlowhbeta(4)      )^2));
errOIIIHbetaratio(5) = sqrt(OIIIHbetaratio(5)^2 * ((errOIII2(6) /OIII2(6)  )^2 +  (dFluxlowhbeta(5) /Fluxlowhbeta(5)  )^2));
errOIIIHbetaratio(6) = sqrt(OIIIHbetaratio(6)^2 * ((errOIII2(9) /OIII2(9)  )^2 +  (dFluxlowhbeta(6) /Fluxlowhbeta(6)  )^2));
errOIIIHbetaratio(7) = sqrt(OIIIHbetaratio(7)^2 * ((errOIII2(10)/OIII2(10) )^2 +  (dFluxlowhbeta(7) /Fluxlowhbeta(7)      )^2));
errOIIIHbetaratio(8) = sqrt(OIIIHbetaratio(8)^2 * ((errOIII2(11)/OIII2(11) )^2 +  (dFluxlowhbeta(8) /Fluxlowhbeta(8)      )^2));



clf
errorbar(OIIIHbetaratiodate,OIIIHbetaratio,errOIIIHbetaratio)
%NIIHalpharatio(1)  = Fluxlow(1)/NII2(12);
%NIIHalpharatio(2)  = Fluxlow(2)/NII2(13);
NIIHalpharatio(1)  = Fluxlow(3)/NII2(1);
NIIHalpharatio(2)  = Fluxlowhalpha(1)/NII2(2);
%NIIHalpharatio(3)  = Fluxlow(6)/NII2(14);
NIIHalpharatio(3)  = Fluxlowhalpha(2)/NII2(5);
NIIHalpharatio(4)  = Fluxlow(7)/NII2(6);
NIIHalpharatio(5)  = Fluxlowhalpha(3)/NII2(7);
NIIHalpharatio(6)  = Fluxlow(8)/NII2(8);
NIIHalpharatio(7) = Fluxlow(9)/NII2(9);
NIIHalpharatio(8) = Fluxlow(10)/NII2(10);
NIIHalpharatio(9) = Fluxlow(11)/NII2(11);
%NIIHalpharatiodate(1) = 7;
%NIIHalpharatiodate(2) = 16;
NIIHalpharatiodate(1) = 23;
NIIHalpharatiodate(2) = 30;
%NIIHalpharatiodate(5) = 30;
NIIHalpharatiodate(3) = 77;
NIIHalpharatiodate(4) = 88;
NIIHalpharatiodate(5) = 119;
NIIHalpharatiodate(6) = 137;
NIIHalpharatiodate(7) = 152;
NIIHalpharatiodate(8) = 289;
NIIHalpharatiodate(9) = 1206;


%errNIIHalpharatio(1)  = sqrt(NIIHalpharatio(1) ^2 * ((errNII2(12)/NII2(12))^2 +  (dFluxlow(1)   /Fluxlow(1)            )^2));
%errNIIHalpharatio(2)  = sqrt(NIIHalpharatio(2) ^2 * ((errNII2(13)/NII2(13))^2 +  (dFluxlow(2)   /Fluxlow(2)            )^2));
errNIIHalpharatio(1)  = sqrt(NIIHalpharatio(1) ^2 * ((errNII2(1) /NII2(1) )^2 +  (dFluxlow(3)   /Fluxlow(3)            )^2));
errNIIHalpharatio(2)  = sqrt(NIIHalpharatio(2) ^2 * ((errNII2(2) /NII2(2) )^2 +  (dFluxlowhalpha(1) /Fluxlowhalpha(1)  )^2));
%errNIIHalpharatio(5)  = sqrt(NIIHalpharatio(5) ^2 * ((errNII2(14)/NII2(14))^2 +  (dFluxlow(6)   /Fluxlow(6)            )^2));
errNIIHalpharatio(3)  = sqrt(NIIHalpharatio(3) ^2 * ((errNII2(5) /NII2(5) )^2 +  (dFluxlowhalpha(2) /Fluxlowhalpha(2)  )^2));
errNIIHalpharatio(4)  = sqrt(NIIHalpharatio(4) ^2 * ((errNII2(6) /NII2(6) )^2 +  (dFluxlow(7)   /Fluxlow(7)            )^2));
errNIIHalpharatio(5)  = sqrt(NIIHalpharatio(5) ^2 * ((errNII2(7) /NII2(7) )^2 +  (dFluxlowhalpha(3) /Fluxlowhalpha(3)  )^2));
errNIIHalpharatio(6)  = sqrt(NIIHalpharatio(6) ^2 * ((errNII2(8) /NII2(8) )^2 +  (dFluxlow(8)   /Fluxlow(8)            )^2));
errNIIHalpharatio(7)  = sqrt(NIIHalpharatio(7)^2 * ((errNII2(9) /NII2(9) )^2 +  (dFluxlow(9)   /Fluxlow(9)            )^2));
errNIIHalpharatio(8)  = sqrt(NIIHalpharatio(8)^2 * ((errNII2(10)/NII2(10))^2 +  (dFluxlow(10)   /Fluxlow(10)            )^2));
errNIIHalpharatio(9)  = sqrt(NIIHalpharatio(9)^2 * ((errNII2(11)/NII2(11))^2 +  (dFluxlow(11)   /Fluxlow(11)            )^2));



%SII2(12)=0;
%SII2(13)=0;
%SII2(14)=0;
%errSII2(12)=0;
%errSII2(13)=0;
%errSII2(14)=0;

SIIboth = SII2+SII1;
errSIIboth = sqrt(errSII2.^2 + errSII1.^2);


%SIIHalpharatio(1)  = Fluxlow(1)/(SII2(12)+SII1(12));
%SIIHalpharatio(2)  = Fluxlow(2)/(SII2(13)+SII1(13));
SIIHalpharatio(1)  = Fluxlow(3)/(SII2(1)+SII1(1));
SIIHalpharatio(2)  = Fluxlowhalpha(1)/(SII2(2)+SII1(2));
%SIIHalpharatio(5)  = Fluxlow(6)/(SII2(14)+SII1(14));
SIIHalpharatio(3)  = Fluxlowhalpha(2)/(SII2(5)+SII1(5));
SIIHalpharatio(4)  = Fluxlow(7)/(SII2(6)+SII1(6));
SIIHalpharatio(5)  = Fluxlowhalpha(3)/(SII2(7)+SII1(7));
SIIHalpharatio(6)  = Fluxlow(8) /(SII2(8)+SII1(8));
SIIHalpharatio(7) = Fluxlow(9) /(SII2(9)+SII1(9));
SIIHalpharatio(8) = Fluxlow(10)/(SII2(10)+SII1(10));
SIIHalpharatio(9) = Fluxlow(11)/(SII2(11)+SII1(11));
%SIIHalpharatiodate(1)  = 7;
%SIIHalpharatiodate(2)  = 16;
SIIHalpharatiodate(1)  = 23;
SIIHalpharatiodate(2)  = 30;
%SIIHalpharatiodate(5)  = 30;
SIIHalpharatiodate(3)  = 77;
SIIHalpharatiodate(4)  = 88;
SIIHalpharatiodate(5)  = 119;
SIIHalpharatiodate(6)  = 137;
SIIHalpharatiodate(7) = 152;
SIIHalpharatiodate(8) = 289;
SIIHalpharatiodate(9) = 1206;
%errSIIHalpharatio(1)  = sqrt(SIIHalpharatio(1) ^2 * ((errSIIboth(12)/SIIboth(12))^2 +  (dFluxlow(1)   /Fluxlow(1)            )^2));
%errSIIHalpharatio(2)  = sqrt(SIIHalpharatio(2) ^2 * ((errSIIboth(13)/SIIboth(13))^2 +  (dFluxlow(1)   /Fluxlow(1)            )^2));
errSIIHalpharatio(1)  = sqrt(SIIHalpharatio(1) ^2 * ((errSIIboth(1) /SIIboth(1) )^2 +  (dFluxlow(3)   /Fluxlow(3)            )^2));
errSIIHalpharatio(2)  = sqrt(SIIHalpharatio(2) ^2 * ((errSIIboth(2) /SIIboth(2) )^2 +  (dFluxlowhalpha(1) /Fluxlowhalpha(1)  )^2));
%errSIIHalpharatio(5)  = sqrt(SIIHalpharatio(5) ^2 * ((errSIIboth(14)/SIIboth(14))^2 +  (dFluxlow(1)   /Fluxlow(1)            )^2));
errSIIHalpharatio(3)  = sqrt(SIIHalpharatio(3) ^2 * ((errSIIboth(5) /SIIboth(5) )^2 +  (dFluxlowhalpha(2) /Fluxlowhalpha(2)  )^2));
errSIIHalpharatio(4)  = sqrt(SIIHalpharatio(4) ^2 * ((errSIIboth(6) /SIIboth(6) )^2 +  (dFluxlow(7)   /Fluxlow(7)            )^2));
errSIIHalpharatio(5)  = sqrt(SIIHalpharatio(5) ^2 * ((errSIIboth(7) /SIIboth(7) )^2 +  (dFluxlowhalpha(3) /Fluxlowhalpha(3)  )^2));
errSIIHalpharatio(6)  = sqrt(SIIHalpharatio(6) ^2 * ((errSIIboth(8) /SIIboth(8) )^2 +  (dFluxlow(8)    /Fluxlow(8)             )^2));
errSIIHalpharatio(7)  = sqrt(SIIHalpharatio(7)^2 * ((errSIIboth(9) /SIIboth(9) )^2 +  (dFluxlow(9)    /Fluxlow(9)             )^2));
errSIIHalpharatio(8)  = sqrt(SIIHalpharatio(8)^2 * ((errSIIboth(10)/SIIboth(10))^2 +  (dFluxlow(10)   /Fluxlow(10)            )^2));
errSIIHalpharatio(9)  = sqrt(SIIHalpharatio(9)^2 * ((errSIIboth(11)/SIIboth(11))^2 +  (dFluxlow(11)   /Fluxlow(11)            )^2));





SII1SII2ratio(1) = SII1(1)/SII2(1);
SII1SII2ratio(2) = SII1(2)/SII2(2);
SII1SII2ratio(3) = SII1(5)/SII2(5);
SII1SII2ratio(4) = SII1(6)/SII2(6);
SII1SII2ratio(5) = SII1(7)/SII2(7);
SII1SII2ratio(6) = SII1(8)/SII2(8);
SII1SII2ratio(7) = SII1(9)/SII2(9);
SII1SII2ratio(8) = SII1(10)/SII2(10);
SII1SII2ratio(9) = SII1(11)/SII2(11);
SII1SII2ratiodate(1) = 23;
SII1SII2ratiodate(2) = 30;
SII1SII2ratiodate(3) = 77;
SII1SII2ratiodate(4) = 88;
SII1SII2ratiodate(5) = 119;
SII1SII2ratiodate(6) = 137;
SII1SII2ratiodate(7) = 152;
SII1SII2ratiodate(8) = 289;
SII1SII2ratiodate(9) = 1206;

errSII1SII2ratio(1) = sqrt(SII1SII2ratio(1)^2 * ((errSII1(1) /SII1(1) )^2 +  (errSII2(1) /SII2(1) )^2));
errSII1SII2ratio(2) = sqrt(SII1SII2ratio(2)^2 * ((errSII1(2) /SII1(2) )^2 +  (errSII2(2) /SII2(2) )^2));
errSII1SII2ratio(3) = sqrt(SII1SII2ratio(3)^2 * ((errSII1(5) /SII1(5) )^2 +  (errSII2(5) /SII2(5) )^2));
errSII1SII2ratio(4) = sqrt(SII1SII2ratio(4)^2 * ((errSII1(6) /SII1(6) )^2 +  (errSII2(6) /SII2(6) )^2));
errSII1SII2ratio(5) = sqrt(SII1SII2ratio(5)^2 * ((errSII1(7) /SII1(7) )^2 +  (errSII2(7) /SII2(7) )^2));
errSII1SII2ratio(6) = sqrt(SII1SII2ratio(6)^2 * ((errSII1(8) /SII1(8) )^2 +  (errSII2(8) /SII2(8) )^2));
errSII1SII2ratio(7) = sqrt(SII1SII2ratio(7)^2 * ((errSII1(9) /SII1(9) )^2 +  (errSII2(9) /SII2(9) )^2));
errSII1SII2ratio(8) = sqrt(SII1SII2ratio(8)^2 * ((errSII1(10)/SII1(10))^2 +  (errSII2(10)/SII2(10))^2));
errSII1SII2ratio(9) = sqrt(SII1SII2ratio(9)^2 * ((errSII1(11)/SII1(11))^2 +  (errSII2(11)/SII2(11))^2));






%TDE light curve 
TDEt0 = LCdates(3) + (LCdates(4)-LCdates(3))/2;
TDEt1 = LCdates(6)-TDEt0;
TDEdates = linspace(1,100,100);
TDEmags = -19.5 - 2.5 .*log10((TDEdates./TDEt1).^(-5/3))
TDEdatesoffset = TDEdates + TDEt0;

TDEmagsearly = -19.5 - 2.5 .*log10((TDEdates./TDEt1).^(-2.6));
TDEdatesoffsetearly = TDEdates + TDEt0;

TDEmagslate = -19.5 - 2.5 .*log10((TDEdates./TDEt1).^(-5/12));
TDEdatesoffsetlate = TDEdates + TDEt0;

%other forms of equation
%-19.5 - 2.5 *(-5/3) * log10(TDEdates/TDEt1)
%-19.5 + 25/6 * log10(TDEdates/TDEt1)






%clf
%plot(SII1SII2ratiodate,SII1SII2ratio)
%saveas(plotting, ['SII2toSII1.eps'], 'epsc');
%eval(['!epstopdf SII2toSII1.eps']);


%SPOL


pbok1 = qbok1;
pbok2 = sqrt(qbok2.^2+ubok2.^2);
p2 = sqrt(q2.^2+u2.^2);




%determine polarization in the  continuum


%testmeanq = mean(qbok2(find(qbok1>=testq(1)&qbok1<=testq(2))))
%testmeanu = mean(ubok2(find(ubok1>=testu(1)&ubok1<=testu(2))))
%testmeanp = sqrt(testmeanq^2+testmeanu^2)
%testq = binedgeqbok1(find(binedgeqbok1>=6000 & binedgeqbok1<= 6250))
%testu = binedgeubok1(find(binedgeubok1>=6000 & binedgeubok1<= 6250))


%binmeanpbok( find(binedgeqbok1 == testq(2)) )
%sqrt(binmeanqbok( find(binedgeqbok1 == testq(2)) )^2+binmeanubok( find(binedgeqbok1 == testq(2)) )^2)
%
%binmeanqbok( find(binedgeqbok1 == testq(1)) )
%mean(qbok2(find((qbok1 >= testq(1)) & (qbok1 <= testq(2) ))))
%binmeanubok( find(binedgeubok1 == testu(1)) )
%mean(ubok2(find((ubok1 >= testu(1)) & (ubok1 <= testu(2) ))))
%
%mean(qbok2(find((qbok1 >= 6000) & (qbok1 <= 6250 ))))
%mean(ubok2(find((ubok1 >= 6000) & (ubok1 <= 6250 ))))
%
%sqrt((mean(qbok2(find((qbok1 >= 6000) & (qbok1 <= 6250 )))))^2 + (mean(ubok2(find((ubok1 >= 6000) & (ubok1 <= 6250 )))))^2)

sigQ6bokfromdata = sqrt(sum(qsigbok2(find((qsigbok1 >= 6100) & (qsigbok1 <= 6200 ))).^2))./length(qsigbok2(find((qsigbok1 >= 6100) & (qsigbok1 <= 6200 ))))
sigU6bokfromdata = sqrt(sum(usigbok2(find((usigbok1 >= 6100) & (usigbok1 <= 6200 ))).^2))./length(usigbok2(find((usigbok1 >= 6100) & (usigbok1 <= 6200 ))))
sigP6bokfromdata = sqrt(sum(psigbok2(find((psigbok1 >= 6100) & (psigbok1 <= 6200 ))).^2))./length(psigbok2(find((psigbok1 >= 6100) & (psigbok1 <= 6200 ))))
sigQ5bokfromdata = sqrt(sum(qsigbok2(find((qsigbok1 >= 5400) & (qsigbok1 <= 5500 ))).^2))./length(qsigbok2(find((qsigbok1 >= 5400) & (qsigbok1 <= 5500 ))))
sigU5bokfromdata = sqrt(sum(usigbok2(find((usigbok1 >= 5400) & (usigbok1 <= 5500 ))).^2))./length(usigbok2(find((usigbok1 >= 5400) & (usigbok1 <= 5500 ))))
sigP5bokfromdata = sqrt(sum(psigbok2(find((psigbok1 >= 5400) & (psigbok1 <= 5500 ))).^2))./length(psigbok2(find((psigbok1 >= 5400) & (psigbok1 <= 5500 ))))

sigQ6mmtfromdata = sqrt(sum(qsigmmt2(find((qsigmmt1 >= 6100) & (qsigmmt1 <= 6200 ))).^2))./length(qsigmmt2(find((qsigmmt1 >= 6100) & (qsigmmt1 <= 6200 ))))
sigU6mmtfromdata = sqrt(sum(usigmmt2(find((usigmmt1 >= 6100) & (usigmmt1 <= 6200 ))).^2))./length(usigmmt2(find((usigmmt1 >= 6100) & (usigmmt1 <= 6200 ))))
sigP6mmtfromdata = sqrt(sum(psigmmt2(find((psigmmt1 >= 6100) & (psigmmt1 <= 6200 ))).^2))./length(psigmmt2(find((psigmmt1 >= 6100) & (psigmmt1 <= 6200 ))))
sigQ5mmtfromdata = sqrt(sum(qsigmmt2(find((qsigmmt1 >= 5400) & (qsigmmt1 <= 5500 ))).^2))./length(qsigmmt2(find((qsigmmt1 >= 5400) & (qsigmmt1 <= 5500 ))))
sigU5mmtfromdata = sqrt(sum(usigmmt2(find((usigmmt1 >= 5400) & (usigmmt1 <= 5500 ))).^2))./length(usigmmt2(find((usigmmt1 >= 5400) & (usigmmt1 <= 5500 ))))
sigP5mmtfromdata = sqrt(sum(psigmmt2(find((psigmmt1 >= 5400) & (psigmmt1 <= 5500 ))).^2))./length(psigmmt2(find((psigmmt1 >= 5400) & (psigmmt1 <= 5500 ))))


sigQ6bok = std(qbok2(find((qbok1 >= 6100) & (qbok1 <= 6200 ))))
sigU6bok = std(ubok2(find((ubok1 >= 6100) & (ubok1 <= 6200 ))))
Q6bok = mean(qbok2(find((qbok1 >= 6100) & (qbok1 <= 6200 ))))
U6bok = mean(ubok2(find((ubok1 >= 6100) & (ubok1 <= 6200 ))))
%P6bok = sqrt(Q6bok^2 + U6bok^2)
P6bok = sqrt((Q6bok^2 + U6bok^2) - 0.5*(sigQ6bokfromdata^2 + sigU6bokfromdata^2) )
sigP6bok = sqrt( ((Q6bok/P6bok)^2)*(sigQ6bok)^2 + ((U6bok/P6bok)^2)*(sigU6bok)^2 )

sigQ5bok = std(qbok2(find((qbok1 >= 5400) & (qbok1 <= 5500 ))))
sigU5bok = std(ubok2(find((ubok1 >= 5400) & (ubok1 <= 5500 ))))
Q5bok = mean(qbok2(find((qbok1 >= 5400) & (qbok1 <= 5500 ))))
U5bok = mean(ubok2(find((ubok1 >= 5400) & (ubok1 <= 5500 ))))
%P5bok = sqrt(Q5bok^2 + U5bok^2)
P5bok = sqrt((Q5bok^2 + U5bok^2) - 0.5*(sigQ5bokfromdata^2 + sigU5bokfromdata^2) )
sigP5bok = sqrt( ((Q5bok/P5bok)^2)*(sigQ5bok)^2 + ((U5bok/P5bok)^2)*(sigU5bok)^2 )

sigQ6 = std(q2(find((q1 >= 6100) & (q1 <= 6200 ))))
sigU6 = std(u2(find((u1 >= 6100) & (u1 <= 6200 ))))
Q6 = mean(q2(find((q1 >= 6100) & (q1 <= 6200 ))))
U6 = mean(u2(find((u1 >= 6100) & (u1 <= 6200 ))))
%P6 = sqrt(Q6^2 + U6^2)
P6 = sqrt((Q6^2 + U6^2) - 0.5*(sigQ6mmtfromdata^2 + sigU6mmtfromdata^2) )
sigP6 = sqrt( ((Q6/P6)^2)*(sigQ6)^2 + ((U6/P6)^2)*(sigU6)^2 )

sigQ5 = std(q2(find((q1 >= 5400) & (q1 <= 5500 ))))
sigU5 = std(u2(find((u1 >= 5400) & (u1 <= 5500 ))))
Q5 = mean(q2(find((q1 >= 5400) & (q1 <= 5500 ))))
U5 = mean(u2(find((u1 >= 5400) & (u1 <= 5500 ))))
%P5 = sqrt(Q5^2 + U5^2)
P5 = sqrt((Q5^2 + U5^2) - 0.5*(sigQ5mmtfromdata^2 + sigU5mmtfromdata^2) )
sigP5 = sqrt( ((Q5/P5)^2)*(sigQ5)^2 + ((U5/P5)^2)*(sigU5)^2 )


q4to7 = mean(q2(find((q1 >= 4100) & (q1 <= 7000 ))))
u4to7 = mean(u2(find((u1 >= 4100) & (u1 <= 7000 ))))
stdq4to7 = std(q2(find((q1 >= 4100) & (q1 <= 7000 ))))
stdu4to7 = std(u2(find((u1 >= 4100) & (u1 <= 7000 ))))

qbok4to7 = mean(qbok2(find((qbok1 >= 4100) & (qbok1 <= 7000 ))))
ubok4to7 = mean(ubok2(find((ubok1 >= 4100) & (ubok1 <= 7000 ))))
stdqbok4to7 = std(qbok2(find((qbok1 >= 4100) & (qbok1 <= 7000 ))))
stdubok4to7 = std(ubok2(find((ubok1 >= 4100) & (ubok1 <= 7000 ))))


theta4to7 = (atan(u4to7/q4to7)*180/pi+180)/2
thetabok4to7 = (atan(ubok4to7/qbok4to7)*180/pi+180)/2

dthdQ = -90/pi * u4to7 / (q4to7^2) / (1+(u4to7^2)/(q4to7^2))
dthdU = 90/pi / q4to7 / (1+(u4to7^2)/(q4to7^2))
dthdQbok = -90/pi * ubok4to7 / (qbok4to7^2) / (1+(ubok4to7^2)/(qbok4to7^2))
dthdUbok = 90/pi / qbok4to7 / (1+(ubok4to7^2)/(qbok4to7^2))



stdtheta4to7 = sqrt( ((dthdQ)^2)*(stdq4to7^2) + ((dthdU)^2)*(stdu4to7^2) )
stdthetabok4t07 = sqrt( ((dthdQbok)^2)*(stdq4to7^2) + ((dthdUbok)^2)*(stdu4to7^2) )




binedgeq1 = linspace(min(q1),max(q1),100);
[nq1,binq1] = histc(q1,binedgeq1);

for i =1:100
	flagbinmembersq = (binq1==i);
	binmembersq = q2(flagbinmembersq);
	binmeanq(i) = mean(binmembersq);
end

binedgeu1 = linspace(min(u1),max(u1),100);
[nu1,binu1] = histc(u1,binedgeu1);

for i =1:100
	flagbinmembersu = (binu1==i);
	binmembersu = u2(flagbinmembersu);
	binmeanu(i) = mean(binmembersu);
end

binedgep1 = binedgeq1;
binedget1 = binedgeq1;
binmeanp = sqrt(binmeanq.^2+binmeanu.^2);

binmeant = atan(binmeanu./binmeanq)*180/pi;
for i=1:length(binmeant)
	if(binmeanq(i) < 0)
		if(binmeanu(i) < 0)
			binmeant(i)=binmeant(i)+180;
		else
			binmeant(i)=binmeant(i)+180;
		end
	else
		if(binmeanu(i) < 0)
			binmeant(i)=binmeant(i)+360;
		else
			binmeant(i)=binmeant(i);
		end
	end
end
binmeant = binmeant./2;





%binedgep1 = linspace(min(p1),max(p1),100);
%[np1,binp1] = histc(p1,binedgep1);
%
%for i =1:100
%	flagbinmembersp = (binp1==i);
%	binmembersp = p2(flagbinmembersp);
%	binmeanp(i) = mean(binmembersp);
%end
%
%binedget1 = linspace(min(t1),max(t1),100);
%[nt1,bint1] = histc(t1,binedget1);
%
%for i =1:100
%	flagbinmemberst = (bint1==i);
%	binmemberst = t2(flagbinmemberst);
%	binmeant(i) = mean(binmemberst);
%end


binedgeqbok1 = linspace(min(qbok1),max(qbok1),100);
[nqbok1,binqbok1] = histc(qbok1,binedgeqbok1);

for i =1:100
	flagbinmembersqbok = (binqbok1==i);
	binmembersqbok = qbok2(flagbinmembersqbok);
	binmeanqbok(i) = mean(binmembersqbok);
end

binedgeubok1 = linspace(min(ubok1),max(ubok1),100);
[nubok1,binubok1] = histc(ubok1,binedgeubok1);

for i =1:100
	flagbinmembersubok = (binubok1==i);
	binmembersubok = ubok2(flagbinmembersubok);
	binmeanubok(i) = mean(binmembersubok);
end

binedgepbok1 = binedgeqbok1;
binedgetbok1 = binedgeqbok1;
binmeanpbok = sqrt(binmeanqbok.^2+binmeanubok.^2);

tbok1 = qbok1;
binmeantbok = atan(binmeanubok./binmeanqbok)*180/pi;
for i=1:length(binmeantbok)
	if(binmeanqbok(i) < 0)
		if(binmeanubok(i) < 0)
			binmeantbok(i)=binmeantbok(i)+180;
		else
			binmeantbok(i)=binmeantbok(i)+180;
		end
	else
		if(binmeanubok(i) < 0)
			binmeantbok(i)=binmeantbok(i)+360;
		else
			binmeantbok(i)=binmeantbok(i);
		end
	end
end
binmeantbok = binmeantbok./2;

%SPOLPlotter(q1',spolm2_20120416',q2',u2',qsigmmt2',usigmmt2','20120416',reldate(4),'SN2012ab','MMT','ISP',0.7)
%SPOLPlotter(qbok1(find(spolb1_20120323<7425))',spolb2_20120323(find(spolb1_20120323<7425))',qbok2(find(spolb1_20120323<7425))',ubok2(find(spolb1_20120323<7425))',qsigbok2(find(spolb1_20120323<7425))',usigbok2(find(spolb1_20120323<7425))','20120323',reldate(3),'SN2012ab','Bok','ISP',0.7)


%spolb2_20120323
%spolm2_20120416


%binedgepbok1 = linspace(min(pbok1),max(pbok1),100);
%[npbok1,binpbok1] = histc(pbok1,binedgepbok1);
%
%for i =1:100
%	flagbinmemberspbok = (binpbok1==i);
%	binmemberspbok = pbok2(flagbinmemberspbok);
%	binmeanpbok(i) = mean(binmemberspbok);
%end
%
%
%binedgetbok1 = linspace(min(tbok1),max(tbok1),100);
%[ntbok1,bintbok1] = histc(tbok1,binedgetbok1);
%
%for i =1:100
%	flagbinmemberstbok = (bintbok1==i);
%	binmemberstbok = tbok2(flagbinmemberstbok);
%	binmeantbok(i) = mean(binmemberstbok);
%end

%%%galaxy subtraction test



%Lkast2_20120223 = fluxvalLkast2_20120223
%mmtbc2_20120301 = fluxvalmmtbc2_20120301
%spolb2_20120323 = fluxvalspolb2_20120323
%spolm2_20120416 = fluxvalspolm2_20120416
%mmtbc2_20120417 = fluxvalmmtbc2_20120417
%Lkast2_20120428 = fluxvalLkast2_20120428
%mmtbc2_20120529 = fluxvalmmtbc2_20120529
%keckL2_20120616 = fluxvalkeckL2_20120616
%mmtbc2_20120701 = fluxvalmmtbc2_20120701
%keckD2_20121115 = fluxvalkeckD2_20121115
%
%
%
%
%
%clf
%hold all
%semilogy(Lkast1_20120223,fluxvalLkast2_20120223)
%semilogy(mmtbc1_20120301,fluxvalmmtbc2_20120301)
%semilogy(spolb1_20120323,fluxvalspolb2_20120323)
%semilogy(spolm1_20120416,fluxvalspolm2_20120416)
%semilogy(mmtbc1_20120417,fluxvalmmtbc2_20120417)
%semilogy(Lkast1_20120428,fluxvalLkast2_20120428)
%semilogy(mmtbc1_20120529,fluxvalmmtbc2_20120529)
%semilogy(keckL1_20120616,fluxvalkeckL2_20120616)
%semilogy(mmtbc1_20120701,fluxvalmmtbc2_20120701)
%semilogy(keckD1_20121115,fluxvalkeckD2_20121115)
%semilogy(keckD1_20150521,SIIaverage*keckD2_20150521)
%axis([[3000 9000],[1*10^-18 2*10^-15]])
%box on
%
%saveas(plotting, ['BackgroundGalaxy.eps'], 'epsc');
%eval(['!epstopdf BackgroundGalaxy.eps']);


%clf
%hold all
%semilogy(Lkast1_20120223,fluxvalLkast2_20120223)
%semilogy(mmtbc1_20120301,fluxvalmmtbc2_20120301)
%semilogy(spolb1_20120323,fluxvalspolb2_20120323)
%semilogy(spolm1_20120416,fluxvalspolm2_20120416)
%semilogy(mmtbc1_20120417,fluxvalmmtbc2_20120417)
%semilogy(Lkast1_20120428,fluxvalLkast2_20120428)
%semilogy(mmtbc1_20120529,fluxvalmmtbc2_20120529)
%semilogy(keckL1_20120616,fluxvalkeckL2_20120616)
%semilogy(mmtbc1_20120701,fluxvalmmtbc2_20120701)
%semilogy(keckD1_20121115,fluxvalkeckD2_20121115)
%semilogy(keckD1_20150521,10.9*keckD2_20150521)
%axis([[3000 9000],[1*10^-18 2*10^-15]])
%box on
%
%saveas(plotting, ['BackgroundGalaxyblue.eps'], 'epsc');
%eval(['!epstopdf BackgroundGalaxyblue.eps']);



%ratio calcs

roverbratio = rightEWhigh./leftEWhigh 
roverbratioerr = roverbratio  .* sqrt((rightdEWhigh./rightEWhigh).^2 + (leftdEWhigh./leftEWhigh).^2)


%old blackbody fit stuff not good anymore

%%%[bbodyfit11 , wavetemp11  ,bestT(1 ,1), bestalpha(1 ,1)] = blackbodyfit(hetms1_20120207,hetms2_20120207_contscaled,3000,6400)
%%%[bbodyfit12 , wavetemp12  ,bestT(1 ,2), bestalpha(1 ,2)] = blackbodyfit(hetms1_20120207,hetms2_20120207_contscaled,7000,9000)
%%%[bbodyfit21 , wavetemp21  ,bestT(2 ,1), bestalpha(2 ,1)] = blackbodyfit(hetms1_20120216,hetms2_20120216_contscaled,3000,6400)
%%%[bbodyfit22 , wavetemp22  ,bestT(2 ,2), bestalpha(2 ,2)] = blackbodyfit(hetms1_20120216,hetms2_20120216_contscaled,7000,9000)
%%%[bbodyfit31 , wavetemp31  ,bestT(3 ,1), bestalpha(3 ,1)] = blackbodyfit(Lkast1_20120223,Lkast2_20120223_contscaled,3000,6400)
%%%[bbodyfit32 , wavetemp32  ,bestT(3 ,2), bestalpha(3 ,2)] = blackbodyfit(Lkast1_20120223,Lkast2_20120223_contscaled,7000,9000)
%%%[bbodyfit41 , wavetemp41  ,bestT(4 ,1), bestalpha(4 ,1)] = blackbodyfit(mmtbc1_20120301,mmtbc2_20120301_contscaled,3000,6400)
%%%%[bbodyfit42 , wavetemp42  ,bestT(4 ,2), bestalpha(4 ,2)] = blackbodyfit(mmtbc1_20120301,mmtbc2_20120301_contscaled,7000,9000)
%%%[bbodyfit51 , wavetemp51  ,bestT(5 ,1), bestalpha(5 ,1)] = blackbodyfit(hetms1_20120301,hetms2_20120301_contscaled,3000,6400)
%%%[bbodyfit52 , wavetemp52  ,bestT(5 ,2), bestalpha(5 ,2)] = blackbodyfit(hetms1_20120301,hetms2_20120301_contscaled,7000,9000)
%%%[bbodyfit61 , wavetemp61  ,bestT(6 ,1), bestalpha(6 ,1)] = blackbodyfit(spolb1_20120323,spolb2_20120323_contscaled,3000,6400)
%%%%[bbodyfit62 , wavetemp62  ,bestT(6 ,2), bestalpha(6 ,2)] = blackbodyfit(spolb1_20120323,spolb2_20120323_contscaled,7000,9000)
%%%[bbodyfit71 , wavetemp71  ,bestT(7 ,1), bestalpha(7 ,1)] = blackbodyfit(spolm1_20120416,spolm2_20120416_contscaled,3000,6400)
%%%%[bbodyfit72 , wavetemp72  ,bestT(7 ,2), bestalpha(7 ,2)] = blackbodyfit(spolm1_20120416,spolm2_20120416_contscaled,7000,9000)
%%%[bbodyfit81 , wavetemp81  ,bestT(8 ,1), bestalpha(8 ,1)] = blackbodyfit(mmtbc1_20120417,mmtbc2_20120417_contscaled,3000,6400)
%%%%[bbodyfit82 , wavetemp82  ,bestT(8 ,2), bestalpha(8 ,2)] = blackbodyfit(mmtbc1_20120417,mmtbc2_20120417_contscaled,7000,9000)
%%%[bbodyfit91 , wavetemp91  ,bestT(9 ,1), bestalpha(9 ,1)] = blackbodyfit(Lkast1_20120428,Lkast2_20120428_contscaled,3000,6400)
%%%[bbodyfit92 , wavetemp92  ,bestT(9 ,2), bestalpha(9 ,2)] = blackbodyfit(Lkast1_20120428,Lkast2_20120428_contscaled,7000,9000)
%%%[bbodyfit101, wavetemp101 ,bestT(10,1), bestalpha(10,1)] = blackbodyfit(mmtbc1_20120529,mmtbc2_20120529_contscaled,3000,6400)
%%%%[bbodyfit102, wavetemp102 ,bestT(10,2), bestalpha(10,2)] = blackbodyfit(mmtbc1_20120529,mmtbc2_20120529_contscaled,7000,9000)
%%%[bbodyfit111, wavetemp111 ,bestT(11,1), bestalpha(11,1)] = blackbodyfit(keckL1_20120616,keckL2_20120616_contscaled,3000,6400)
%%%[bbodyfit112, wavetemp112 ,bestT(11,2), bestalpha(11,2)] = blackbodyfit(keckL1_20120616,keckL2_20120616_contscaled,7000,9000)
%%%[bbodyfit121, wavetemp121 ,bestT(12,1), bestalpha(12,1)] = blackbodyfit(mmtbc1_20120701,mmtbc2_20120701_contscaled,3000,6400)
%%%%[bbodyfit122, wavetemp122 ,bestT(12,2), bestalpha(12,2)] = blackbodyfit(mmtbc1_20120701,mmtbc2_20120701_contscaled,7000,9000)
%%%[bbodyfit131, wavetemp131 ,bestT(13,1), bestalpha(13,1)] = blackbodyfit(keckD1_20121115,keckD2_20121115_contscaled,3000,6400)
%%%[bbodyfit132, wavetemp132 ,bestT(13,2), bestalpha(13,2)] = blackbodyfit(keckD1_20121115,keckD2_20121115_contscaled,7000,9000)
%%%[bbodyfit141, wavetemp141 ,bestT(14,1), bestalpha(14,1)] = blackbodyfit(keckD1_20150521,keckD2_20150521_contscaled,3000,6400)
%%%[bbodyfit142, wavetemp142 ,bestT(14,2), bestalpha(14,2)] = blackbodyfit(keckD1_20150521,keckD2_20150521_contscaled,7000,9000)
%%%
%%%
%%%
%%%	
%%%%%Blackbody plot1
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*hetms1_20120207,hetms2_20120207_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp11,squeeze(bbodyfit11),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp12,squeeze(bbodyfit12),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(1,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody1.eps'], 'epsc');
%%%eval(['!epstopdf blackbody1.eps']);
%%%
%%%%%Blackbody plot2
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*hetms1_20120216,hetms2_20120216_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp21,squeeze(bbodyfit21),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp22,squeeze(bbodyfit22),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(2,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody2.eps'], 'epsc');
%%%eval(['!epstopdf blackbody2.eps']);
%%%
%%%%%Blackbody plot3
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*Lkast1_20120223,Lkast2_20120223_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp31,squeeze(bbodyfit31),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp32,squeeze(bbodyfit32),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(3,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody3.eps'], 'epsc');
%%%eval(['!epstopdf blackbody3.eps']);
%%%
%%%%%Blackbody plot4
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*mmtbc1_20120301,mmtbc2_20120301_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp41,squeeze(bbodyfit41),'LineWidth',2,'Color',[0 0 0])
%%%%semilogy(wavetemp42,squeeze(bbodyfit42),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(4,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')	
%%%saveas(plotting, ['blackbody4.eps'], 'epsc');
%%%eval(['!epstopdf blackbody4.eps']);
%%%
%%%%%Blackbody plot5
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*hetms1_20120301,hetms2_20120301_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp51,squeeze(bbodyfit51),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp52,squeeze(bbodyfit52),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(5,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody5.eps'], 'epsc');
%%%eval(['!epstopdf blackbody5.eps']);
%%%
%%%%%Blackbody plot6
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*spolb1_20120323,spolb2_20120323_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%%semilogy(wavetemp62,squeeze(bbodyfit62),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp61,squeeze(bbodyfit61),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(6,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody6.eps'], 'epsc');
%%%eval(['!epstopdf blackbody6.eps']);
%%%
%%%%%Blackbody plot7
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*spolm1_20120416,spolm2_20120416_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp71,squeeze(bbodyfit71),'LineWidth',2,'Color',[0 0 0])
%%%%semilogy(wavetemp72,squeeze(bbodyfit72),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(7,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody7.eps'], 'epsc');
%%%eval(['!epstopdf blackbody7.eps']);
%%%
%%%%%Blackbody plot8
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*mmtbc1_20120417,mmtbc2_20120417_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%%semilogy(wavetemp82,squeeze(bbodyfit82),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp81,squeeze(bbodyfit81),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(8,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody8.eps'], 'epsc');
%%%eval(['!epstopdf blackbody8.eps']);
%%%
%%%%%Blackbody plot9
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*Lkast1_20120428,Lkast2_20120428_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp91,squeeze(bbodyfit91),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp92,squeeze(bbodyfit92),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(9,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody9.eps'], 'epsc');
%%%eval(['!epstopdf blackbody9.eps']);
%%%
%%%%%Blackbody plot10
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*mmtbc1_20120529,mmtbc2_20120529_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp101,squeeze(bbodyfit101),'LineWidth',2,'Color',[0 0 0])
%%%%semilogy(wavetemp102,squeeze(bbodyfit102),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(10,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody10.eps'], 'epsc');
%%%eval(['!epstopdf blackbody10.eps']);
%%%
%%%%%Blackbody plot11
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*keckL1_20120616,keckL2_20120616_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp111,squeeze(bbodyfit111),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp112,squeeze(bbodyfit112),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(11,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody11.eps'], 'epsc');
%%%eval(['!epstopdf blackbody11.eps']);
%%%
%%%%%Blackbody plot12
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*mmtbc1_20120701,mmtbc2_20120701_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp121,squeeze(bbodyfit121),'LineWidth',2,'Color',[0 0 0])
%%%%semilogy(wavetemp122,squeeze(bbodyfit122),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(12,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody12.eps'], 'epsc');
%%%eval(['!epstopdf blackbody12.eps']);
%%%
%%%%%Blackbody plot13
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*keckD1_20121115,keckD2_20121115_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp131,squeeze(bbodyfit131),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp132,squeeze(bbodyfit132),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(13,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody13.eps'], 'epsc');
%%%eval(['!epstopdf blackbody13.eps']);
%%%
%%%%%Blackbody plot14
%%%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
%%%set(gcf,'color','w');
%%%clf
%%%semilogy(10^-8.*keckD1_20150521,keckD2_20150521_contscaled,'LineWidth',2,'Color',[1 0 0])
%%%hold on
%%%semilogy(wavetemp141,squeeze(bbodyfit141),'LineWidth',2,'Color',[0 0 0])
%%%semilogy(wavetemp142,squeeze(bbodyfit142),'LineWidth',2,'Color',[0 0 0])
%%%htext = text(7750*10^-8,1,num2str(bestT(14,:)),'interpreter','latex','FontName','CMU Serif');
%%%set(htext, 'Color', 'black')	
%%%set(htext, 'FontSize',26)
%%%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
%%%xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%%%axis([[3000*10^-8 9150*10^-8] [0.01 5]])
%%%ax1 = gca;
%%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%%ylabel(ax2,'','FontSize',22)
%%%xlabel(ax2,'')
%%%set(ax2,'xtick',[],'YTick',[])
%%%set(ax1,'FontSize',22)
%%%set(ax2,'FontSize',22)
%%%set(ax1,'XMinorTick','on','YMinorTick','on')
%%%saveas(plotting, ['blackbody14.eps'], 'epsc');
%%%eval(['!epstopdf blackbody14.eps']);
%%%




%%%scale keck 289 spectrum to other days for overplotting purposes, not subtract it from the others.


hetms2_20120207_contscaled_galscale = keckD2_20150521_contscaled.*median(hetms2_20120207_contscaled(find(hetms1_20120207>5950 & hetms1_20120207<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
hetms2_20120216_contscaled_galscale = keckD2_20150521_contscaled.*median(hetms2_20120216_contscaled(find(hetms1_20120216>5950 & hetms1_20120216<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
Lkast2_20120223_contscaled_galscale = keckD2_20150521_contscaled.*median(Lkast2_20120223_contscaled(find(Lkast1_20120223>5950 & Lkast1_20120223<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
hetms2_20120301_contscaled_galscale = keckD2_20150521_contscaled.*median(hetms2_20120301_contscaled(find(hetms1_20120301>5950 & hetms1_20120301<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
mmtbc2_20120301_contscaled_galscale = keckD2_20150521_contscaled.*median(mmtbc2_20120301_contscaled(find(mmtbc1_20120301>5950 & mmtbc1_20120301<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
spolb2_20120323_contscaled_galscale = keckD2_20150521_contscaled.*median(spolb2_20120323_contscaled(find(spolb1_20120323>5950 & spolb1_20120323<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
spolm2_20120416_contscaled_galscale = keckD2_20150521_contscaled.*median(spolm2_20120416_contscaled(find(spolm1_20120416>5950 & spolm1_20120416<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
mmtbc2_20120417_contscaled_galscale = keckD2_20150521_contscaled.*median(mmtbc2_20120417_contscaled(find(mmtbc1_20120417>5950 & mmtbc1_20120417<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
Lkast2_20120428_contscaled_galscale = keckD2_20150521_contscaled.*median(Lkast2_20120428_contscaled(find(Lkast1_20120428>5950 & Lkast1_20120428<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
mmtbc2_20120529_contscaled_galscale = keckD2_20150521_contscaled.*median(mmtbc2_20120529_contscaled(find(mmtbc1_20120529>5950 & mmtbc1_20120529<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
keckL2_20120616_contscaled_galscale = keckD2_20150521_contscaled.*median(keckL2_20120616_contscaled(find(keckL1_20120616>5950 & keckL1_20120616<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
mmtbc2_20120701_contscaled_galscale = keckD2_20150521_contscaled.*median(mmtbc2_20120701_contscaled(find(mmtbc1_20120701>5950 & mmtbc1_20120701<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
keckD2_20121115_contscaled_galscale = keckD2_20150521_contscaled.*median(keckD2_20121115_contscaled(find(keckD1_20121115>5950 & keckD1_20121115<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));
keckD2_20150521_contscaled_galscale = keckD2_20150521_contscaled.*median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)))./median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)));


%halphaSDSS

halphafitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly5','Robust','Bisquare');
SDSS2_20080213_halphacontfitnormsub = (SDSS2_20080213' - halphafitSDSS2_20080213(SDSS1_20080213))./halphafitSDSS2_20080213(SDSS1_20080213);
halphanormSDSS2_20080213 = mean(halphafitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>6363)&(SDSS1_20080213<6763))));
EWlowSDSS(1) = trapz(SDSS1_20080213(find(SDSS1_20080213 > 6558 & SDSS1_20080213 < 6573))',SDSS2_20080213_halphacontfitnormsub(find(SDSS1_20080213 > 6558 & SDSS1_20080213 < 6573)));
NEWerrSDSS(1) = 1/2 * 5*std(SDSS2_20080213_halphacontfitnormsub(find(SDSS1_20080213 > 6000 & SDSS1_20080213 < 6300)));
dEWlowSDSS(1) = NEWerrSDSS(1) * EWlowSDSS(1);
FluxlowSDSS(1)  = EWlowSDSS(1) * halphanormSDSS2_20080213 * 10^-17;
dFluxlowSDSS(1) = dEWlowSDSS(1) * halphanormSDSS2_20080213 * 10^-17;

clf
plot(SDSS1_20080213,SDSS2_20080213_halphacontfitnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6558,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6573,1,'first'))),SDSS2_20080213_halphacontfitnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6558,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6573,1,'first'))));
xlim([6513,6613])

%hbetaSDSS


hbetafitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<4500)|(SDSS1_20080213>5600)|(SDSS1_20080213>4750&SDSS1_20080213<5200));
hbetanormSDSS_20080213 = mean(hbetafitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>4761)&(SDSS1_20080213<4961))));
SDSS2_20080213_hbetacontfitnormsub = (SDSS2_20080213' - hbetafitSDSS2_20080213(SDSS1_20080213))./hbetafitSDSS2_20080213(SDSS1_20080213)+0.2;
FluxlowhbetaSDSS(1) = 10^-17 *      hbetanormSDSS_20080213 * trapz(SDSS1_20080213(find(SDSS1_20080213 > 4861 & SDSS1_20080213 < 4864)),SDSS2_20080213_hbetacontfitnormsub(find(SDSS1_20080213 > 4861 & SDSS1_20080213 < 4864)));
dFluxlowhbetaSDSS(1) = FluxlowhbetaSDSS(1) * 1/2 * 5*std(SDSS2_20080213_hbetacontfitnormsub(find(SDSS1_20080213 > 5100 & SDSS1_20080213 < 5300)));


clf
plot(SDSS1_20080213',SDSS2_20080213_hbetacontfitnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<4861,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>4864,1,'first'))),SDSS2_20080213_hbetacontfitnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<4861,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>4864,1,'first'))));
xlim([4841,5050])

%%%other lines

OIII1fitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<4929)|(SDSS1_20080213>4989)|(SDSS1_20080213>4949&SDSS1_20080213<4969));
OIII1norm_20080213 = mean(OIII1fitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>4949)&(SDSS1_20080213<4969))));
SDSS2_20080213_OIII1contnorm = SDSS2_20080213/OIII1norm_20080213;
SDSS2_20080213_OIII1contnormsub = SDSS2_20080213_OIII1contnorm - 1;
OIII1SDSS(1) =  10^-17 * OIII1norm_20080213 * trapz(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<4957,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>4965,1,'first'))),SDSS2_20080213_OIII1contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<4957,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>4965,1,'first'))));
errOIII1SDSS(1)= OIII1(1) * 1/2*5*std(SDSS2_20080213_OIII1contnormsub(SDSS1_20080213>4970 & SDSS1_20080213 < 4990));

clf
plot(SDSS1_20080213',SDSS2_20080213_OIII1contnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<4957,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>4965,1,'first'))),SDSS2_20080213_OIII1contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<4957,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>4965,1,'first'))));
xlim([4809,5109])




OIII2fitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<4977)|(SDSS1_20080213>5037)|(SDSS1_20080213>4997&SDSS1_20080213<5013));
OIII2norm_20080213 = mean(OIII2fitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>4997)&(SDSS1_20080213<5013))));
SDSS2_20080213_OIII2contnorm = SDSS2_20080213/OIII2norm_20080213;
SDSS2_20080213_OIII2contnormsub = SDSS2_20080213_OIII2contnorm - 1;
OIII2SDSS(1) =  10^-17 * OIII2norm_20080213 * trapz(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<5003,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>5013,1,'first'))),SDSS2_20080213_OIII2contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<5003,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>5013,1,'first'))));
errOIII2SDSS(1)= OIII2SDSS(1) * 1/2*5*std(SDSS2_20080213_OIII2contnormsub(SDSS1_20080213>5030 & SDSS1_20080213 < 5050));

clf
plot(SDSS1_20080213',SDSS2_20080213_OIII2contnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<5003,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>5013,1,'first'))),SDSS2_20080213_OIII2contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<5003,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>5013,1,'first'))));
xlim([4809,5109])


%NII 6548

NII1fitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<5533)|(SDSS1_20080213>6598)|(SDSS1_20080213>6543&SDSS1_20080213<6553));
NII1norm_20080213 = mean(NII1fitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>6543)&(SDSS1_20080213<6553))));
SDSS2_20080213_NII1contnorm = SDSS2_20080213/NII1norm_20080213;
SDSS2_20080213_NII1contnormsub = SDSS2_20080213_NII1contnorm - 1;
NII1SDSS(1) =  10^-17 * NII1norm_20080213 * trapz(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6547,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6552,1,'first'))),SDSS2_20080213_NII1contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6547,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6552,1,'first'))));
errNII1SDSS(1)= NII1SDSS(1) * 1/2*5*std(SDSS2_20080213_NII1contnormsub(SDSS1_20080213>5030 & SDSS1_20080213 < 5050));


clf
plot(SDSS1_20080213',SDSS2_20080213_NII1contnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6547,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6552,1,'first'))),SDSS2_20080213_NII1contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6547,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6552,1,'first'))));
xlim([6540 6600])




%NII6583 
NII2fitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<6573)|(SDSS1_20080213>6598)|(SDSS1_20080213>6578&SDSS1_20080213<6588));
NII2norm_20080213 = mean(NII2fitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>6578)&(SDSS1_20080213<6588))));
SDSS2_20080213_NII2contnorm = SDSS2_20080213/NII2norm_20080213;
SDSS2_20080213_NII2contnormsub = SDSS2_20080213_NII2contnorm - 1;
NII2SDSS(1) =  10^-17 * NII2norm_20080213 * trapz(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6578,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6591,1,'first'))),SDSS2_20080213_NII2contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6578,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6591,1,'first'))));
errNII2SDSS(1)= NII2SDSS(1) * 1/2*5*std(SDSS2_20080213_NII2contnormsub(SDSS1_20080213>6680 & SDSS1_20080213 < 6700));

clf
plot(SDSS1_20080213',SDSS2_20080213_NII2contnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6578,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6591,1,'first'))),SDSS2_20080213_NII2contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6578,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6591,1,'first'))));
xlim([6540 6600])


%SII6717
SII1fitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<6662)|(SDSS1_20080213>6767)|(SDSS1_20080213>6697&SDSS1_20080213<6740));
SII1norm_20080213 = mean(SII1fitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>6697)&(SDSS1_20080213<6740))));
SDSS2_20080213_SII1contnorm = SDSS2_20080213/SII1norm_20080213;
SDSS2_20080213_SII1contnormsub = SDSS2_20080213_SII1contnorm - 1;
SII1SDSS(1) =  10^-17 * SII1norm_20080213 * trapz(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6713,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6724,1,'first'))),SDSS2_20080213_SII1contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6713,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6724,1,'first'))));
errSII1SDSS(1)= SII1SDSS(1) * 1/2*5*std(SDSS2_20080213_SII1contnormsub(SDSS1_20080213>6680 & SDSS1_20080213 < 6700));

clf
plot(SDSS1_20080213',SDSS2_20080213_SII1contnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6713,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6724,1,'first'))),SDSS2_20080213_SII1contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6713,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6724,1,'first'))));
xlim([6700 6750])

%SII6731
SII2fitSDSS2_20080213 = fit(SDSS1_20080213',SDSS2_20080213','poly3','Robust','Bisquare','Exclude',(SDSS1_20080213<6662)|(SDSS1_20080213>6767)|(SDSS1_20080213>6697&SDSS1_20080213<6740));
SII2norm_20080213 = mean(SII2fitSDSS2_20080213(SDSS1_20080213((SDSS1_20080213>6697)&(SDSS1_20080213<6740))));
SDSS2_20080213_SII2contnorm = SDSS2_20080213/SII2norm_20080213;
SDSS2_20080213_SII2contnormsub = SDSS2_20080213_SII2contnorm - 1;
SII2SDSS(1) =  10^-17 * SII2norm_20080213 * trapz(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6727,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6738,1,'first'))),SDSS2_20080213_SII2contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6727,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6738,1,'first'))));
errSII2SDSS(1)= SII2SDSS(1) * 1/2*5*std(SDSS2_20080213_SII2contnormsub(SDSS1_20080213>6680 & SDSS1_20080213 < 6700));

clf
plot(SDSS1_20080213',SDSS2_20080213_SII2contnormsub)
hold all
area(SDSS1_20080213(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6727,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6738,1,'first'))),SDSS2_20080213_SII2contnormsub(SDSS1_20080213>=SDSS1_20080213(find(SDSS1_20080213<6727,1,'last')) & SDSS1_20080213<=SDSS1_20080213(find(SDSS1_20080213>6738,1,'first'))));
xlim([6700 6750])

FluxlowhbetaSDSS(1)
FluxlowSDSS(1) 
OIII1SDSS(1)
OIII2SDSS(1)
NII1SDSS(1)
NII2SDSS(1)
SII1SDSS(1)
SII2SDSS(1)




SDSSHN = FluxlowSDSS(1)/NII2SDSS(1)
SDSSHSS = FluxlowSDSS(1)/(SII1SDSS(1)+SII2SDSS(1))
SDSSHO = FluxlowhbetaSDSS(1)/OIII2SDSS(1)
SDSSSS = SII1SDSS(1)/SII2SDSS(1)



%SPOLPLOTTER TEST

SPOLPlotter(q1',spolm2_20120416',q2',u2',qsigmmt2',usigmmt2','20120416',reldate(4),'SN2012ab','MMT','ISP',0.71)
SPOLPlotter(qbok1(find(spolb1_20120323<7425))',spolb2_20120323(find(spolb1_20120323<7425))',qbok2(find(spolb1_20120323<7425))',ubok2(find(spolb1_20120323<7425))',qsigbok2(find(spolb1_20120323<7425))',usigbok2(find(spolb1_20120323<7425))','20120323',reldate(3),'SN2012ab','Bok','ISP',0.71)





























































































%semilogy(fitkeckD2_20150521,keckD1_20150521,keckD2_20150521)



%%%plots




%make plot of red vs blue fluxes (half height, using narrow flux) (all)

clf
hold all
plt1 = plot(sortedreldate([2:13]),widthofleft50height ([2:13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]),widthofright50height([2:13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,150,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,140,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Equivalent Width($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 210]])
box on
saveas(plotting, ['bvsr50allnarrow.eps'], 'epsc');
eval(['!epstopdf bvsr50allnarrow.eps']);


%make plot of red vs blue fluxes (half height, using broad flux) (all)

clf
hold all
plt1 = plot(sortedreldate([2:13]),widthofleftbroad50height ([2:13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]),widthofrightbroad50height([2:13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,150,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,140,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Equivalent Width($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 210]])
box on
saveas(plotting, ['bvsr50allbroad.eps'], 'epsc');
eval(['!epstopdf bvsr50allbroad.eps']);






%make plot of red vs blue fluxes (half height, using narrow flux) (red removed)

clf
hold all
plt1 = plot(sortedreldate([2:4, 6, 9, 11, 13]),widthofleft50height ([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:4, 6, 9, 11, 13]),widthofright50height([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,70,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,45,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Half Width at Half Maximum($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 210]])
box on
saveas(plotting, ['bvsr50allnarrowrr.eps'], 'epsc');
eval(['!epstopdf bvsr50allnarrowrr.eps']);


%make plot of red vs blue fluxes (half height, using broad flux) (red removed)

clf
hold all
plt1 = plot(sortedreldate([2:4, 6, 9, 11, 13]),widthofleftbroad50height ([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:4, 6, 9, 11, 13]),widthofrightbroad50height([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,210,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,125,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Half Width at Half Maximum($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 310]])
box on
saveas(plotting, ['bvsr50allbroadrr.eps'], 'epsc');
eval(['!epstopdf bvsr50allbroadrr.eps']);









%make plot of red vs blue fluxes (total)

clf
hold all
plt1 = plot(sortedreldate([2:13]),leftEWhigh ([2:13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]),rightEWhigh([2:13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,210,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,125,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Equivalent Width($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 310]])
box on
saveas(plotting, ['bvsrtotal.eps'], 'epsc');
eval(['!epstopdf bvsrtotal.eps']);




%make plot of red vs blue fluxes (total) without red cut off objects

clf
hold all
plt1 = plot(sortedreldate([2:4, 6, 9, 11, 13]),leftEWhigh ([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:4, 6, 9, 11, 13]),rightEWhigh([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,210,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,125,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Equivalent Width($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 310]])
box on
saveas(plotting, ['bvsrtotalred.eps'], 'epsc');
eval(['!epstopdf bvsrtotalred.eps']);







%make plot of red vs blue fluxes in ratio

clf
hold all
plt1 = plot(sortedreldate([2:13]),rightEWhigh([2:13]),'LineWidth',5,'Color',[0 0 0])


%hL = legend([plt1 plt2],'','Location','Southeast')
htext = text(200,210,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)

ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Ratio of Red/Blue Flux','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 3]])
box on
saveas(plotting, ['bvsrratio.eps'], 'epsc');
eval(['!epstopdf bvsrratio.eps']);






%make plot of red vs blue fluxes in ratio with red bad fit removed

clf
hold all
%plt1 = plot(sortedreldate([2:4, 6, 9, 11, 13]),roverbratio([2:4, 6, 9, 11, 13]),'LineWidth',5,'Color',[0 0 0])
errbarplot = errorbar(sortedreldate([2:4, 6, 9, 11, 13]),roverbratio([2:4, 6, 9, 11, 13]),roverbratioerr([2:4, 6, 9, 11, 13]),'.','Color','k','MarkerSize',75)
%set(errbarplot,'MarkerSize',2);

%hL = legend([plt1 plt2],'','Location','Southeast')
htext = text(100,1.110,'Red side stronger','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',44)
htext = text(100,0.890,'Blue side stronger','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',44)
line([-5 1000],[1 1],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

ax1 = gca;
set(ax1,'FontSize',44)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',44,'FontName','CMU Serif Roman')
ylabel('Ratio of Red/Blue Flux','interpreter','latex','FontSize',44,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 3]])
box on
saveas(plotting, ['bvsrratiored.eps'], 'epsc');
eval(['!epstopdf bvsrratiored.eps']);















clf
hold all
plt1 = plot(sortedreldate([2:13]),widthofleft10height([2:13]),'LineWidth',5,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]),widthofright10height([2:13]),'LineWidth',5,'Color',[1 0 0])

%hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
htext = text(200,175,'Redshifted component','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(200,115,'Blueshifted component','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('EW of 15\% Peak Flux($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 310]])
box on
saveas(plotting, ['bvsr50.eps'], 'epsc');
eval(['!epstopdf bvsr50.eps']);



























%make plot of red vs blue fluxes (enclosed)

clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],90),leftEWhigh ([2:13])*5,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],90),rightEWhigh([2:13])*5,[1 0 0],'filled')

plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],90),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],90),'LineWidth',3,'Color',[1 0 0])

hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Width of 90\% Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['bluevsred.eps'], 'epsc');
eval(['!epstopdf bluevsred.eps']);



clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],90),leftEWhigh ([2:13])*5,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],90),rightEWhigh([2:13])*5,[1 0 0],'filled')

plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],90),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],90),'LineWidth',3,'Color',[1 0 0])

hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Width of 90\% Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosed90.eps'], 'epsc');
eval(['!epstopdf enclosed90.eps']);





clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],75),leftEWhigh ([2:13])*5,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],75),rightEWhigh([2:13])*5,[1 0 0],'filled')

plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],75),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],75),'LineWidth',3,'Color',[1 0 0])

hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Width of 75\% Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosed75.eps'], 'epsc');
eval(['!epstopdf enclosed75.eps']);



clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],50),leftEWhigh ([2:13])*5,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],50),rightEWhigh([2:13])*5,[1 0 0],'filled')

plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],50),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],50),'LineWidth',3,'Color',[1 0 0])

hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Width of 50\% Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosed50.eps'], 'epsc');
eval(['!epstopdf enclosed50.eps']);





clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],25),leftEWhigh ([2:13])*5,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],25),rightEWhigh([2:13])*5,[1 0 0],'filled')

plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],25),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],25),'LineWidth',3,'Color',[1 0 0])

hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Width of 25\% Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosed25.eps'], 'epsc');
eval(['!epstopdf enclosed25.eps']);





clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],90),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],90),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],90),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],90),'LineWidth',3,'Color',[1 0 0])

scatter(sortedreldate([2:13]), leftEW ([2:13],75),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],75),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt3 = plot(sortedreldate([2:13]), leftEW ([2:13],75),'--','LineWidth',3,'Color',[0 0 1])
plt4 = plot(sortedreldate([2:13]), rightEW([2:13],75),'--','LineWidth',3,'Color',[1 0 0])

scatter(sortedreldate([2:13]), leftEW ([2:13],50),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],50),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt5 = plot(sortedreldate([2:13]), leftEW ([2:13],50),':','LineWidth',3,'Color',[0 0 1])
plt6 = plot(sortedreldate([2:13]), rightEW([2:13],50),':','LineWidth',3,'Color',[1 0 0])

scatter(sortedreldate([2:13]), leftEW ([2:13],25),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],25),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt7 = plot(sortedreldate([2:13]), leftEW ([2:13],25),'-.','LineWidth',3,'Color',[0 0 1])
plt8 = plot(sortedreldate([2:13]), rightEW([2:13],25),'-.','LineWidth',3,'Color',[1 0 0])


hL = legend([plt1 plt3 plt5 plt7 plt2 plt4 plt6 plt8],'Blueshifted 90%','Blueshifted 75%','Blueshifted 50%','Blueshifted 25%','Redshifted 90%','Redshifted 75%','Redshifted 50%','Redshifted 25%','Location','Southeast')
set(hL,'Fontsize',26)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Equivalent Width of Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosedall.eps'], 'epsc');
eval(['!epstopdf enclosedall.eps']);











clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],20),leftEWhigh ([2:13])*5,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],20),rightEWhigh([2:13])*5,[1 0 0],'filled')

plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],20),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],20),'LineWidth',3,'Color',[1 0 0])

hL = legend([plt1 plt2],'Blueshifted','Redshifted','Location','Southeast')
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Width of 20\% Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosed20.eps'], 'epsc');
eval(['!epstopdf enclosed20.eps']);





clf
hold all
scatter(sortedreldate([2:13]), leftEW ([2:13],90),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],90),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt1 = plot(sortedreldate([2:13]), leftEW ([2:13],90),'LineWidth',3,'Color',[0 0 1])
plt2 = plot(sortedreldate([2:13]), rightEW([2:13],90),'LineWidth',3,'Color',[1 0 0])

scatter(sortedreldate([2:13]), leftEW ([2:13],50),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],50),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt5 = plot(sortedreldate([2:13]), leftEW ([2:13],50),':','LineWidth',3,'Color',[0 0 1])
plt6 = plot(sortedreldate([2:13]), rightEW([2:13],50),':','LineWidth',3,'Color',[1 0 0])

scatter(sortedreldate([2:13]), leftEW ([2:13],20),leftEWhigh ([2:13])*3,[0 0 1],'filled')
scatter(sortedreldate([2:13]), rightEW([2:13],20),rightEWhigh([2:13])*3,[1 0 0],'filled')
plt7 = plot(sortedreldate([2:13]), leftEW ([2:13],20),'-.','LineWidth',3,'Color',[0 0 1])
plt8 = plot(sortedreldate([2:13]), rightEW([2:13],20),'-.','LineWidth',3,'Color',[1 0 0])


hL = legend([plt1 plt5 plt7 plt2 plt6 plt8],'Blueshifted 90%','Blueshifted 50%','Blueshifted 20%','Redshifted 90%','Redshifted 50%','Redshifted 20%','Location','Southeast')
set(hL,'Fontsize',26)
ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Equivalent Width of Enclosed Flux ($\AA$)','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 300],[0 220]])
box on
saveas(plotting, ['enclosedall3.eps'], 'epsc');
eval(['!epstopdf enclosedall3.eps']);













mean(ROTSEabsmag(4:26))



absmagest(1)  = absmagestRhetms2_20120207;
absmagest(2)  = absmagestRhetms2_20120216;
absmagest(3)  = absmagestRhetms2_20120301;
absmagest(4)  = absmagestRLkast2_20120223;
absmagest(5)  = absmagestRmmtbc2_20120301;
absmagest(6)  = absmagestRspolb2_20120323;
absmagest(7)  = absmagestRspolm2_20120416;
absmagest(8)  = absmagestRmmtbc2_20120417;
absmagest(9)  = absmagestRLkast2_20120428;
absmagest(10) = absmagestRmmtbc2_20120529;
absmagest(11) = absmagestRkeckL2_20120616;
absmagest(12) = absmagestRmmtbc2_20120701;
absmagest(13) = absmagestRkeckD2_20121115;
absmagest(14) = absmagestRkeckD2_20150521;


%plot(TDEdatesoffset+35,TDEmags-3.4,'-','Color',[0.5 0.5 0.5],'LineWidth',3)

%%%light curve plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
plot(TDEdatesoffset+35,TDEmags-3.4,'-','Color',[0.5 0.5 0.5],'LineWidth',3)
%plot(TDEdatesoffset+18,TDEmagsearly-3.4,'-','Color',[0.5 0.5 0.5],'LineWidth',3)
%plot(TDEdatesoffset+20,TDEmagslate-0.4,'-','Color',[0.5 0.5 0.5],'LineWidth',3)
scatter(ROTSELC(1,:)-(discoverydatejd+jdtomjd),ROTSEabsmag,100,'k','filled')
scatter(ROTSELC(1,isnan(ROTSELC(3,:)))-(discoverydatejd+jdtomjd),ROTSEabslim(isnan(ROTSELC(3,:))),100,'kv','LineWidth',3)
errorbar(ROTSELC(1,:)-(discoverydatejd+jdtomjd),ROTSEabsmag,ROTSEerror,'.','Color','k')
plot(LC1999emmjd-LC1999emmjd(1),LC1999emabsmag,'b')
scatter(LC1999emmjd-LC1999emmjd(1),LC1999emabsmag,'b','filled')
plot(LC1998Smjd-LC1998Smjd(1),LC1998Sabsmag,'r')
scatter(LC1998Smjd-LC1998Smjd(1),LC1998Sabsmag,'r','filled')
plot(LC2003hfmjd-LC2003hfmjd(1),LC2003hfabsmag,'Color',[0 0.6 0])
scatter(LC2003hfmjd-LC2003hfmjd(1),LC2003hfabsmag,50,[0 0.6 0],'filled')
%scatter(sortedreldate(10:13),absmagest(10:13),75,'*','k')
set(gca,'box','on')
line([7 7],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([16 16],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([23 23],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([30 30],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([52 52],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([76 76],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([77 77],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([88 88],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([119 119],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([137 137],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([152 152],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([289 289],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
htext = text(5,-19.75,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',22)
htext = text(10,-16.4,'SN 1999em (II-P)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'blue')
set(htext, 'FontSize',22)
htext = text(64,-17.4,'SN 1998S (IIn)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'red')
set(htext, 'FontSize',22)
htext = text(30,-18,'SN 2003hf (II-L)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0.6 0])
set(htext, 'FontSize',22)
htext = text(81,-17.7,'TDE Decline $t^{-\frac{5}{3}}$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.5 0.5 0.5])
set(htext, 'FontSize',22)
%htext = text(74,-18.6,'TDE Late Decline $t^{-\frac{5}{12}}$','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'Color',[0.5 0.5 0.5])
%set(htext, 'FontSize',22)
%htext = text(43,-16.5,'TDE Early Decline $t^{-2.6}$','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'Color',[0.5 0.5 0.5])
%set(htext, 'FontSize',22)
xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('Absolute Magnitude (unfiltered, calibrated as $R$ band)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[-5 100] [-20 -15]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
set(ax1,'xtick',linspace(0,300,16),'YTick',linspace(-20,-15,6))

atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
%set(gca,'TickLength',atick); 

set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
set(ax2,'xtick',get(ax1,'xtick'),'xticklabel',get(ax1,'xticklabel'))
ylabel(ax2,'')
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
annotation('textarrow',[0.19 0.215],[0.17 0.17],'String','Spectra','FontSize',22)

export_fig LC2012ab.pdf -pdf


saveas(plotting, ['LC2012ab.eps'], 'epsc');
eval(['!epstopdf LC2012ab.eps']);




%logversion

%%%light curve plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
scatter(ROTSELC(1,:)-(discoverydatejd+jdtomjd),ROTSEabsmag,100,'k','filled')
scatter(ROTSELC(1,isnan(ROTSELC(3,:)))-(discoverydatejd+jdtomjd),ROTSEabslim(isnan(ROTSELC(3,:))),100,'kv','LineWidth',3)
errorbar(ROTSELC(1,:)-(discoverydatejd+jdtomjd),ROTSEabsmag,ROTSEerror,'.','Color','k')
plot(LC1999emmjd-LC1999emmjd(1),LC1999emabsmag,'b')
scatter(LC1999emmjd-LC1999emmjd(1),LC1999emabsmag,'b','filled')
plot(LC1998Smjd-LC1998Smjd(1),LC1998Sabsmag,'r')
scatter(LC1998Smjd-LC1998Smjd(1),LC1998Sabsmag,'r','filled')
plot(LC2003hfmjd-LC2003hfmjd(1),LC2003hfabsmag,'Color',[0 0.6 0])
scatter(LC2003hfmjd-LC2003hfmjd(1),LC2003hfabsmag,50,[0 0.6 0],'filled')
scatter(sortedreldate(10:13),absmagest(10:13),75,'*','k')
line([7 7],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([16 16],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([23 23],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([30 30],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([52 52],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([76 76],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([77 77],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([88 88],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([119 119],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([137 137],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([152 152],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
line([289 289],[-15.5 -15.25],'LineStyle','--','Color',[0 0 0],'LineWidth',2)
htext = text(3,-19.75,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',22)
htext = text(3,-16.4,'SN 1999em (II-P)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'blue')
set(htext, 'FontSize',22)
htext = text(84,-17.4,'SN 1998S (IIn)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'red')
set(htext, 'FontSize',22)
htext = text(30,-18,'SN 2003hf (II-L)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0.6 0])
set(htext, 'FontSize',22)
xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('Absolute Magnitude (unfiltered)','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
axis([[-10 300] [-20 -15]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
%set(ax1,'xtick',linspace(0,300,16),'YTick',linspace(-20,-15,6))
set(ax1,'XScale','log');
xlim([0.9 300])

atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
%set(gca,'TickLength',atick); 

%XMinorTickDistance = 5;
%xg = [0:XMinorTickDistance:120];
%xg = repmat(xg,2,1);
%yg = [-15 -15-atick(1)];
%yg = repmat(yg',1,size(xg,2));
%XMinorTick = plot(xg,yg,'LineWidth',1,'LineStyle','-','Marker','none','Color',[0 0 0]);


set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
set(ax2,'xtick',get(ax1,'xtick'),'xticklabel',get(ax1,'xticklabel'))
%ax3 = axes('Position',get(ax1,'Position'),'YAxisLocation','left','XAxisLocation','top','Color','none');
%set(ax3,'xtick',[],'ytick',[])
ylabel(ax2,'')
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
annotation('textarrow',[0.35 0.4],[0.17 0.17],'String','Spectra','FontSize',22)

export_fig a.pdf -pdf


saveas(plotting, ['logLC2012ab.eps'], 'epsc');
eval(['!epstopdf logLC2012ab.eps']);



















































set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);


0.8902,0.1020,0.1100
0.2,0.6275,0.1725
0.1216,0.4706,0.7059
1,0.4980,0

0.0000 0.7255 0.0902
0.0000 0.0000 1.0000
1.0000 0.0000 0.0000
0.0000 0.3922 0.0039


%%nebular plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2 1]);


clf
errorbar(NIIHalpharatiodate,NIIHalpharatio,errNIIHalpharatio,'LineWidth',3,'Color',[0.0000 0.7255 0.0902])
hold all                                                                            
errorbar(SIIHalpharatiodate,SIIHalpharatio,errSIIHalpharatio,'LineWidth',3,'Color',[0.0000 0.0000 1.0000])
errorbar(OIIIHbetaratiodate,OIIIHbetaratio,errOIIIHbetaratio,'LineWidth',3,'Color',[1.0000 0.0000 0.0000])
errorbar(SII1SII2ratiodate,SII1SII2ratio,errSII1SII2ratio,'LineWidth',3,'Color',   [0.0000 0 0])
scatter(5, SDSSHN,800,[0.0000 0.7255 0.0902],'s','filled')
scatter(5, SDSSHSS,800,[0.0000 0.0000 1.0000],'s','filled')
scatter(5, SDSSHO,800,[1.0000 0.0000 0.0000],'s','filled')
scatter(5, SDSSSS,800,[0.0000 0 0],'s','filled')

annotation('textarrow',[0.21 0.15],[0.56 0.50],'String',' ','FontSize',22)
htext = text(8,4.25,'SDSS','interpreter','latex')
set(htext, 'Color', [0 0 0])
set(htext, 'FontSize',30)
htext = text(6,3.9,'Pre-explosion','interpreter','latex')
set(htext, 'Color', [0 0 0])
set(htext, 'FontSize',30)
htext = text(30,6.5,'Narrow H$\alpha$/[N II] $\lambda$ 6583','interpreter','latex')
set(htext, 'Color', [0.0000 0.7255 0.0902])
set(htext, 'FontSize',30)
htext = text(30,6,'Narrow H$\alpha$/([S II] $\lambda$ 6717 + [S II] $\lambda$ 6731)','interpreter','latex')
set(htext, 'Color', [0.0000 0.0000 1.0000])
set(htext, 'FontSize',30)
htext = text(30,5.5,'Narrow H$\beta$/[O III] $\lambda$ 5007','interpreter','latex')
set(htext, 'Color', [1.0000 0.0000 0.0000])
set(htext, 'FontSize',30)
htext = text(30,5,'[S II] $\lambda$ 6717/[S II] $\lambda$ 6731 ','interpreter','latex')
set(htext, 'Color', [0.0000 0 0])
set(htext, 'FontSize',30)
ax1 = gca;
set(ax1,'FontSize',38)
xlabel('Days Relative to Discovery Date','interpreter','latex','FontSize',40)
ylabel('Ratio of Line Fluxes','interpreter','latex','FontSize',40)
set(gca,'XMinorTick','on','YMinorTick','on')
set(gca,'XScale','log');
axis([[5 1300],[0 7]])
saveas(plotting, ['Nebular.eps'], 'epsc');
eval(['!epstopdf Nebular.eps']);


%%%All Full Spectra in a Semi-Log Plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf
semilogy(hetms1_20120207,hetms2_20120207_contscaled*4*1.4,'LineWidth',2,'Color',[0 0 1])
hold on
semilogy(hetms1_20120216,hetms2_20120216_contscaled*2*1.4,'LineWidth',2,'Color',[0 1 0])
semilogy(Lkast1_20120223,Lkast2_20120223_contscaled*2*1.4,'LineWidth',2,'Color',[0.5 0.5 0.5])
semilogy(hetms1_20120301,hetms2_20120301_contscaled*1.2,'LineWidth',2,'Color',[1 0 0])
semilogy(mmtbc1_20120301,mmtbc2_20120301_contscaled*0.5^1*1.,'LineWidth',2,'Color',[0 0 0])
semilogy(spolb1_20120323,spolb2_20120323_contscaled*0.5^2*1.3,'LineWidth',2,'Color',[1 0.4980 0])
semilogy(spolm1_20120416,spolm2_20120416_contscaled*0.5^3*1.5,'LineWidth',2,'Color',[0 0.65 0.65])
semilogy(mmtbc1_20120417,mmtbc2_20120417_contscaled*0.5^4*4,'LineWidth',2,'Color',[0.7 0.7 0])
semilogy(Lkast1_20120428,Lkast2_20120428_contscaled*0.5^5*3,'LineWidth',2,'Color',[0.5 0.5 1])
semilogy(mmtbc1_20120529,mmtbc2_20120529_contscaled*0.5^6*6,'LineWidth',2,'Color',[0.65 0.20 0.65])
semilogy(keckL1_20120616,keckL2_20120616_contscaled*0.5^7*3.5,'LineWidth',2,'Color',[0 0.5 0])
semilogy(mmtbc1_20120701,mmtbc2_20120701_contscaled*0.5^8*3,'LineWidth',2,'Color',[0.931 0.463 0.316])
semilogy(keckD1_20121115,keckD2_20121115_contscaled*0.5^9*4.5,'LineWidth',2,'Color',[0.1688 0.1192 0.4776])
semilogy(keckD1_20150521,keckD2_20150521_contscaled*0.5^10*3.5,'LineWidth',2,'Color',[0.4 0 0])
semilogy(SDSS1_20080213,SDSS2_20080213./max(SDSS2_20080213)*10^-3*1.9,'LineWidth',1,'Color',[0.7 0.7 0.7])
line([4101 4101],[7 9],'LineStyle','-','Color',[0 0 0])
line([4340 4340],[7 9],'LineStyle','-','Color',[0 0 0])
line([4861 4861],[6 7.3],'LineStyle','-','Color',[0 0 0])
line([4959 4959],[6 7.3],'LineStyle','-','Color',[0 0 0])
line([5007 5007],[6 7.3],'LineStyle','-','Color',[0 0 0])
line([5876 5876],[7.1 8.5],'LineStyle','-','Color',[0 0 0])
line([5896 5896],[2.8 3.5],'LineStyle','-','Color',[0 0 0])
line([6548 6548],[6 7.6],'LineStyle','-','Color',[0 0 0])
line([6598 6598],[3 3.7],'LineStyle','-','Color',[0 0 0])
line([6583 6583],[6 7.6],'LineStyle','-','Color',[0 0 0])
line([6717 6717],[3.5 5],'LineStyle','-','Color',[0 0 0])
line([6731 6731],[3.5 5],'LineStyle','-','Color',[0 0 0])
htext = text(4101,9,'H\delta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4340,9,'H\gamma','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4861,8.3,'H\beta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4983,7.3,'[OIII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5876,8.5,'HeI\lambda5876','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5896,3.5,'NaID','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(6565.5,7.6,'[NII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(6562.81,3.6,'H\alpha','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(6724,5,'[SII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(6754,2.2,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(6900,100*0.9*0.5^3*0.22,'day 7','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',18)
htext = text(6900,20*0.9*0.5^3*0.62,'day 16','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 1 0])
set(htext, 'FontSize',18)
htext = text(6900,5*0.9*0.5^0*0.175,'day 23','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.5 0.5 0.5])
set(htext, 'FontSize',18)
htext = text(6900,5*0.9*0.5^1*0.2,'day 30','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^0*0.30,'day 30','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^2*0.63,'day 52','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1 0.4980 0])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^3*0.72,'day 76','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0.65 0.65])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^4*0.9,'day 77','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.7 0.7 0])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^5*1.15,'day 88','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.5 0.5 1])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^6,'day 119','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.65 0.2 0.65])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^7*0.9,'day 137','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0.5 0])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^8*0.85,'day 152','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.931 0.463 0.316])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^9*0.65,'day 289','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.1688 0.1192 0.4776])
set(htext, 'FontSize',18)
htext = text(6900,0.9*0.5^10*0.6,'day 1206','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.4 0 0])
set(htext, 'FontSize',18)
htext = text(7750,5,'SN 2012ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)

htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])


xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')

%xlabel(['Rest Wavelength (',char(197),')'],'interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%xlabel('Rest Wavelength (\AA)','interpreter','latex','FontSize',22,'FontName','CMU Serif Roman')
%ylabel('F_\lambda (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[3400 9100] [0.00019 35]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

saveas(plotting, ['FullSpectrum.eps'], 'epsc');
eval(['!epstopdf FullSpectrum.eps']);


0.0000 0.0000 1.0000
1.0000 0.0000 0.0000
0.0000 0.7255 0.0902
0.9961 0.5373 0.0000
0.0039 1.0000 0.9961
0.0039 0.0000 0.4039
0.5843 0.0000 0.2275
0.0000 0.6824 0.4941
1.0000 0.8588 0.4000
0.0000 0.4902 0.7098
1.0000 0.0000 0.9647
0.4667 0.3020 0.0000
0.4941 0.1765 0.8235
0.5647 0.9843 0.5725
0.0000 0.3922 0.0039
0.4196 0.4078 0.5098






%gal scale comparison plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf

%semilogy(smooth(keckD1_20150521,3),smooth(hetms2_20120207_contscaled_galscale,3)*4*1.4,		':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%hold on
%semilogy(smooth(keckD1_20150521,3),smooth(hetms2_20120216_contscaled_galscale,3)*2*1.4,		':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(Lkast2_20120223_contscaled_galscale,3)*2*1.4,		':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(hetms2_20120301_contscaled_galscale,3)*1.2,		':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(mmtbc2_20120301_contscaled_galscale,3)*0.5^1*1.,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(spolb2_20120323_contscaled_galscale,3)*0.5^2*1.3,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(spolm2_20120416_contscaled_galscale,3)*0.5^3*1.5,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(mmtbc2_20120417_contscaled_galscale,3)*0.5^4*4,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(Lkast2_20120428_contscaled_galscale,3)*0.5^5*3,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
%semilogy(smooth(keckD1_20150521,3),smooth(mmtbc2_20120529_contscaled_galscale,3)*0.5^6*6,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
semilogy(smooth(keckD1_20150521,3),smooth(keckL2_20120616_contscaled_galscale,3)*0.5^7*3.5,	':','LineWidth',2,'Color',[ 0.60 0.60 0.60])
hold on
%semilogy(smooth(keckD1_20150521,3),smooth(mmtbc2_20120701_contscaled_galscale,3)*0.5^8*3,	':','LineWidth',2,'Color',[ 0.65 0.65 0.65])
semilogy(smooth(keckD1_20150521,3),smooth(keckD2_20121115_contscaled_galscale,3)*0.5^9*4.5,	':','LineWidth',2,'Color',[ 0.60 0.60 0.60])
semilogy(smooth(keckD1_20150521,3),smooth(keckD2_20150521_contscaled_galscale,3)*0.5^10*3.5,':','LineWidth',2,'Color',[ 0.60 0.60 0.60])
 
semilogy(hetms1_20120207,hetms2_20120207_contscaled*4*1.4,'LineWidth',2,'Color',              [0.0000 0.7255 0.0902])                                                                                   
semilogy(hetms1_20120216,hetms2_20120216_contscaled*2*1.4,'LineWidth',2,'Color',              [0.0000 0.0000 1.0000])
semilogy(Lkast1_20120223,Lkast2_20120223_contscaled*2*1.4,'LineWidth',2,'Color',              [1.0000 0.0000 0.0000])
semilogy(hetms1_20120301,hetms2_20120301_contscaled*1.2,'LineWidth',2,'Color',                [0.0000 0.3922 0.0039])
semilogy(mmtbc1_20120301,mmtbc2_20120301_contscaled*0.5^1*1.,'LineWidth',2,'Color',           [0.4941 0.1765 0.8235])
semilogy(spolb1_20120323,spolb2_20120323_contscaled*0.5^2*1.3,'LineWidth',2,'Color',          [0.9961 0.5373 0.0000])
semilogy(spolm1_20120416,spolm2_20120416_contscaled*0.5^3*1.5,'LineWidth',2,'Color',          [0.0000 0.6824 0.4941])
semilogy(mmtbc1_20120417,mmtbc2_20120417_contscaled*0.5^4*4,'LineWidth',2,'Color',            [0.0000 0.4627 1.0000])
semilogy(Lkast1_20120428,Lkast2_20120428_contscaled*0.5^5*3,'LineWidth',2,'Color',            [0.5843 0.0000 0.2275])
semilogy(mmtbc1_20120529,mmtbc2_20120529_contscaled*0.5^6*6,'LineWidth',2,'Color',            [0.4706 0.5098 0.1922])
semilogy(keckL1_20120616,keckL2_20120616_contscaled*0.5^7*3.5,'LineWidth',2,'Color',          [0.0000 0.4902 0.7098])
semilogy(mmtbc1_20120701,mmtbc2_20120701_contscaled*0.5^8*3,'LineWidth',2,'Color',            [1.0000 0.0000 0.9647])
semilogy(keckD1_20121115,keckD2_20121115_contscaled*0.5^9*4.5,'LineWidth',2,'Color',          [0.4667 0.3020 0.0000])
semilogy(keckD1_20150521,keckD2_20150521_contscaled*0.5^10*3.5,'LineWidth',2,'Color',         [0.0039 0.0000 0.4039])
semilogy(SDSS1_20080213,SDSS2_20080213./max(SDSS2_20080213)*10^-3*1.8,'LineWidth',1,'Color',  [0.5686 0.8157 0.7961])



%line([5950 6200],[0.00025 0.00025],'LineStyle','-','Color',[0 0 0])
line([4101 4101],[7 9],'LineStyle','-','Color',[0 0 0])
line([4340 4340],[7 9],'LineStyle','-','Color',[0 0 0])
line([4861 4861],[6 7.3],'LineStyle','-','Color',[0 0 0])
line([4959 4959],[6 7.3],'LineStyle','-','Color',[0 0 0])
line([5007 5007],[6 7.3],'LineStyle','-','Color',[0 0 0])
line([5876 5876],[2.8 3.5],'LineStyle','-','Color',[0 0 0])
line([5896 5896],[2.8 3.5],'LineStyle','-','Color',[0 0 0])
line([6548 6548],[6.2 7.6],'LineStyle','-','Color',[0 0 0])
line([6562.81 6562.81],[3 3.7],'LineStyle','-','Color',[0 0 0])
line([6583 6583],[6.2 7.6],'LineStyle','-','Color',[0 0 0])
line([6717 6717],[3.5 5],'LineStyle','-','Color',[0 0 0])
line([6731 6731],[3.5 5],'LineStyle','-','Color',[0 0 0])
htext = text(4101,9,'H$\delta$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(4340,9,'H$\gamma$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(4861,8.3,'H$\beta$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(4983,7.3,'[OIII]','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(5846,3.5,'He I  $\lambda5876$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(5926,3.5,'NaID','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(6565.5,7.7,'[NII]','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(6562.81,3.6,'H$\alpha$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(6724,5,'[SII]','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',20)
htext = text(6754,2.2,'$\bigoplus$','interpreter','latex','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(6900,100*0.9*0.5^3*0.22,'day 7','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.7255 0.0902])
set(htext, 'FontSize',20)
htext = text(6900,20*0.9*0.5^3*0.62,'day 16','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.0000 1.0000])
set(htext, 'FontSize',20)
htext = text(6900,5*0.9*0.5^0*0.175,'day 23','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1.0000 0.0000 0.0000])
set(htext, 'FontSize',20)
htext = text(6900,5*0.9*0.5^1*0.2,'day 30','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.3922 0.0039])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^0*0.30,'day 30','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.4941 0.1765 0.8235])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^2*0.63,'day 52','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.9961 0.5373 0.0000])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^3*0.72,'day 76','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.6824 0.4941])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^4*0.9,'day 77','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.4627 1.0000])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^5*1.15,'day 88','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.5843 0.0000 0.2275])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^6,'day 119','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.4706 0.5098 0.1922])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^7*0.9,'day 137','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.4902 0.7098])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^8*0.85,'day 152','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1.0000 0.0000 0.9647])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^9*0.70,'day 289','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.4667 0.3020 0.0000])
set(htext, 'FontSize',20)
htext = text(6900,0.9*0.5^10*0.6,'day 1206','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0039 0.0000 0.4039])
set(htext, 'FontSize',20)
htext = text(7750,5,'SN 2012ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(3450,10^-3*1.1,'SDSS day -1448 (before SN)','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', [0.5686 0.8157 0.7961])	
set(htext, 'FontSize',20)

htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])


xlabel('Rest Wavelength ($\rm{\AA}$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')

%xlabel(['Rest Wavelength (',char(197),')'],'interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%xlabel('Rest Wavelength (\AA)','interpreter','latex','FontSize',22,'FontName','CMU Serif Roman')
%ylabel('F_\lambda (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled) + Constant','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[3400 9150] [0.00019 35]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

%saveas(plotting, ['FullSpectrumgalscale.eps'], 'epsc');
%eval(['!epstopdf FullSpectrumgalscale.eps']);

export_fig FullSpectrumgalscale.pdf -pdf












%%old gaussian stuff
%
%template1 = velHalpha_20120616(find(keckL1_20120616>6125&keckL1_20120616<7100))./10^3;
%template2 = 0.95*keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100))/max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100)));
%intvel = 3.5;
%broadvel = 17;
%%create gaussians for overplotting
%normint = 2.8*normpdf(template1,0.85,intvel/2.3548);
%normbroad = 3.1*normpdf(template1,0.85,broadvel/2.3548);


%new gaussian stuff
gauss_x = velHalpha_20120616(find(keckL1_20120616>6125&keckL1_20120616<7100))./10^3;
template1 = velHalpha_20120616(find(keckL1_20120616>6125&keckL1_20120616<7100))./10^3;
template2 = 0.95*keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100))/max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100)));




clear gauss_int gauss_broad gauss_sum gauss_sum_chisquared scalingfactor_int xloc_int velocity_int scalingfactor_broad xloc_broad velocity_broad
numiterations = 10;

scalingfactor_int = linspace(3,4,numiterations);
xloc_int = linspace(0.75,1.25,numiterations);
velocity_int = linspace(3,5,numiterations);
scalingfactor_broad = linspace(2.5,3.5,numiterations);
xloc_broad = linspace(2,5,numiterations);
velocity_broad = linspace(17.5,22.5,numiterations);

gauss_int = zeros(size(gauss_x,1),numiterations,numiterations,numiterations);
gauss_broad = zeros(size(gauss_x,1),numiterations,numiterations,numiterations);
gauss_sum = zeros(size(gauss_x,1),numiterations,numiterations,numiterations,numiterations,numiterations,numiterations);
gauss_sum_chisquared = zeros(numiterations,numiterations,numiterations,numiterations,numiterations,numiterations);


%make a grid of broad and intermediate gaussians
for i=1:numiterations
i
	for j=1:numiterations
		for k=1:numiterations
			gauss_int(:,i,j,k) = scalingfactor_int(i) * normpdf(gauss_x ,xloc_int(j),velocity_int(k)/2.3548);
		end
	end
end

for ii=1:numiterations
ii
	for jj=1:numiterations
		for kk=1:numiterations
			gauss_broad(:,ii,jj,kk) = scalingfactor_broad(ii) * normpdf(gauss_x ,xloc_broad(jj),velocity_broad(kk)/2.3548);
		end
	end
end

for i=1:numiterations
i
	for j=1:numiterations
		for k=1:numiterations
			for ii=1:numiterations
				for jj=1:numiterations
					for kk=1:numiterations
						gauss_sum(:,i,j,k,ii,jj,kk) = gauss_int(:,i,j,k)+gauss_broad(:,ii,jj,kk);
						gauss_sum_chisquared(i,j,k,ii,jj,kk) = sum(((template2-gauss_sum(:,i,j,k,ii,jj,kk)).^2)./(gauss_sum(:,i,j,k,ii,jj,kk)));
					end
				end
			end
		end
	end
end



%gauss_sum(:,i,j,k) = gauss_int(:,i,j,k)+gauss_broad(:,i,j,k);
%gauss_sum_chiquared(i,j,k) = sum(((template2-gauss_sum(:,i,j,k)).^2)./(gauss_sum(:,i,j,k)));


%find the best fit chi^2 of the various gaussians

[mini minj mink minii minjj minkk] = ind2sub(size(gauss_sum_chisquared),find(min(min(min(min(min(min(gauss_sum_chisquared))))))==gauss_sum_chisquared));

int_scale = scalingfactor_int(mini)
int_loc = xloc_int(minj)
int_vel = velocity_int(mink)
broad_scale =  scalingfactor_broad(minii)
broad_loc = xloc_broad(minjj)
broad_vel = velocity_broad(minkk)



clf
hold all
plot(gauss_x,squeeze(squeeze(squeeze(squeeze(squeeze(gauss_sum(:,mini,minj,mink,minii,minjj,minkk)))))))
plot(template1,template2)





%%%Shape Triple Compare Plot
gauss_x = velHalpha_20120616(find(keckL1_20120616>6125&keckL1_20120616<7100))./10^3;
template1 = velHalpha_20120616(find(keckL1_20120616>6125&keckL1_20120616<7100))./10^3;
template2 = 0.95*keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100))/max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100)));
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf
fill([template1' 20 -20 -20],[4+template2' 4 4 4+template2(1)],[0.75 0.75 0.75],'EdgeColor',[1 1 1]);
hold on 
fill([template1' 20 -20 -20],[3+template2' 3 3 3+template2(1)],[0.75 0.75 0.75],'EdgeColor',[1 1 1]);
fill([template1' 20 -20 -20],[2+template2' 2 2 2+template2(1)],[0.75 0.75 0.75],'EdgeColor',[1 1 1]);
fill([template1' 20 -20 -20],[1+template2' 1 1 1+template2(1)],[0.75 0.75 0.75],'EdgeColor',[1 1 1]);
fill([template1' 20 -20 -20],[0+template2' 0 0 0+template2(1)],[0.75 0.75 0.75],'EdgeColor',[1 1 1]);
plot(velHalpha_20120207(find(hetms1_20120207>6125&hetms1_20120207<7100))./10^3,  4+0.95*hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6125&hetms1_20120207<7100))/max(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6125&hetms1_20120207<7100))),'LineWidth',2,'Color',[0 0 1])                                                                                                                                                                                                                       
plot(velHalpha_20120216(find(hetms1_20120216>6125&hetms1_20120216<7100))./10^3,  4+0.95*hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6125&hetms1_20120216<7100))/max(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6125&hetms1_20120216<7100))),'LineWidth',2,'Color',[0.15 0.65 0.15])
plot(velHalpha_20120223(find(Lkast1_20120223>6125&Lkast1_20120223<7100))./10^3,  4+0.95*Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6125&Lkast1_20120223<7100))/max(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6125&Lkast1_20120223<7100))),'LineWidth',2,'Color',[1 0 0])
plot(velHalpha_20120301_2(find(hetms1_20120301>6125&hetms1_20120301<7100))./10^3,3+0.95*hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6125&hetms1_20120301<7100))/max(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6125&hetms1_20120301<7100))),'LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20120301(find(mmtbc1_20120301>6125&mmtbc1_20120301<7100))./10^3,  3+0.95*mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6125&mmtbc1_20120301<7100))/max(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6125&mmtbc1_20120301<7100))),'LineWidth',2,'Color',[0.15 0.65 0.15])
plot(velHalpha_20120323(find(spolb1_20120323>6125&spolb1_20120323<7100))./10^3,  3+0.95*spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6125&spolb1_20120323<7100))/max(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6125&spolb1_20120323<7100))),'LineWidth',2,'Color',[1 0 0])
plot(velHalpha_20120416(find(spolm1_20120416>6125&spolm1_20120416<7100))./10^3,  2+0.95*spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6125&spolm1_20120416<7100))/max(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6125&spolm1_20120416<7100))),'LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20120417(find(mmtbc1_20120417>6125&mmtbc1_20120417<7100))./10^3,  2+0.95*mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6125&mmtbc1_20120417<7100))/max(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6125&mmtbc1_20120417<7100))),'LineWidth',2,'Color',[0.15 0.65 0.15])
plot(velHalpha_20120428(find(Lkast1_20120428>6125&Lkast1_20120428<7100))./10^3,  2+0.95*Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6125&Lkast1_20120428<7100))/max(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6125&Lkast1_20120428<7100))),'LineWidth',2,'Color',[1 0 0])
plot(velHalpha_20120529(find(mmtbc1_20120529>6125&mmtbc1_20120529<7100))./10^3,  1+0.95*mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6125&mmtbc1_20120529<7100))/max(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6125&mmtbc1_20120529<7100))),'LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20120616(find(keckL1_20120616>6125&keckL1_20120616<7100))./10^3,  1+0.95*keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100))/max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6125&keckL1_20120616<7100))),'LineWidth',2,'Color',[0.15 0.65 0.15])
plot(velHalpha_20120701(find(mmtbc1_20120701>6125&mmtbc1_20120701<7100))./10^3,  1+0.95*mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6125&mmtbc1_20120701<7100))/max(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6125&mmtbc1_20120701<7100))),'LineWidth',2,'Color',[1 0 0])
plot(velHalpha_20121115(find(keckD1_20121115>6125&keckD1_20121115<7100))./10^3,    0.95*keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6125&keckD1_20121115<7100))/max(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6125&keckD1_20121115<7100))),'LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20150521(find(keckD1_20150521>6125&keckD1_20150521<7100))./10^3,    0.95*keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6125&keckD1_20150521<7100))/max(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6125&keckD1_20150521<7100))),'LineWidth',2,'Color',[0.15 0.65 0.15])
plot(gauss_x,squeeze(squeeze(squeeze(gauss_int(:,mini,minj,mink))))+1,':','LineWidth',2,'Color',[0 0 0]);
plot(gauss_x,squeeze(squeeze(squeeze(gauss_broad(:,minii,minjj,minkk))))+1,'--','LineWidth',2,'Color',[0 0 0]);

plot(gauss_x,squeeze(squeeze(squeeze(squeeze(squeeze(squeeze(gauss_sum(:,mini,minj,mink,minii,minjj,minkk)))))))+1,'-.','LineWidth',4,'Color',[0 0 0]);

line([0 0],[-1 8],'LineStyle','--','Color',[0 0 0])                                                                                                                                                                                                                                                 
line([-30 30],[0 0],'LineStyle','--','Color',[0 0 0])
line([-30 30],[1 1],'LineStyle','--','Color',[0 0 0])
line([-30 30],[2 2],'LineStyle','--','Color',[0 0 0])
line([-30 30],[3 3],'LineStyle','--','Color',[0 0 0])
line([-30 30],[4 4],'LineStyle','--','Color',[0 0 0])
%line([4101 4101],[7 9],'LineStyle','-','Color',[0 0 0])
%line([4340 4340],[7 9],'LineStyle','-','Color',[0 0 0])
%line([4861 4861],[6 7.3],'LineStyle','-','Color',[0 0 0])
%line([4959 4959],[6 7.3],'LineStyle','-','Color',[0 0 0])
%line([5007 5007],[6 7.3],'LineStyle','-','Color',[0 0 0])
%line([5876 5876],[7.1 8.5],'LineStyle','-','Color',[0 0 0])
%line([5896 5896],[2.8 3.5],'LineStyle','-','Color',[0 0 0])
%line([6548 6548],[6 7.6],'LineStyle','-','Color',[0 0 0])
%line([6598 6598],[3 3.7],'LineStyle','-','Color',[0 0 0])
%line([6583 6583],[6 7.6],'LineStyle','-','Color',[0 0 0])
%line([6717 6717],[3.5 5],'LineStyle','-','Color',[0 0 0])
%line([6731 6731],[3.5 5],'LineStyle','-','Color',[0 0 0])
%htext = text(4101,9,'H\delta','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(4340,9,'H\gamma','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(4861,8.3,'H\beta','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(4983,7.3,'[OIII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(5876,8.5,'HeI\lambda5876','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(5896,3.5,'NaID','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(6565.5,7.6,'[NII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(6562.81,3.6,'H\alpha','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(6724,5,'[SII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
%htext = text(6754,2.2,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',12)
htext = text(10,4.75,'day 7','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',22)
htext = text(13,4.75,'day 16','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.15 0.65 0.15])
set(htext, 'FontSize',22)
htext = text(16,4.75,'day 23','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',22)
htext = text(10,3.75,'day 30','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',22)
htext = text(13,3.75,'day 30','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.15 0.65 0.15])
set(htext, 'FontSize',22)
htext = text(16,3.75,'day 52','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',22)
htext = text(10,2.75,'day 76','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',22)
htext = text(13,2.75,'day 77','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.15 0.65 0.15])
set(htext, 'FontSize',22)
htext = text(16,2.75,'day 88','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',22)
htext = text(10,1.75,'day 119','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',22)
htext = text(13,1.75,'day 137','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.15 0.65 0.15])
set(htext, 'FontSize',22)
htext = text(16,1.75,'day 152','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',22)
htext = text(13,0.75,'day 289','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',22)
htext = text(16,0.75,'day 1206','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.15 0.65 0.15])
set(htext, 'FontSize',22)
htext = text(-19,4.75,'SN 2012ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)

htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])


xlabel('Doppler velocity (10^3 km/s)','FontSize',28)

%xlabel(['Rest Wavelength (',char(197),')'],'interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%xlabel('Rest Wavelength (\AA)','interpreter','latex','FontSize',22,'FontName','CMU Serif Roman')
%ylabel('F_\lambda (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled) + Constant','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[-20 20] [-0.5 5.1]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

saveas(plotting, ['ShapeTripleComparewith2Gauss.eps'], 'epsc');
eval(['!epstopdf ShapeTripleComparewith2Gauss.eps']);

































%%%Testing various halphas

clf
hold all
plot(velHalpha_20120223(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763))/10^3,8*(-1+Lkast2_20120223_halphacontnorm(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763))),'--','LineWidth',2,'Color',[0 1 0])
plot(velHalpha_20120301(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763))/10^3,8*(-1+mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763))),'LineWidth',2,'Color',[0 0 0])
plot(velHalpha_20120323(find(spolb1_20120323>4761 & spolb1_20120323 < 6763))/10^3,5*(-1+spolb2_20120323_halphacontnorm(find(spolb1_20120323>4761 & spolb1_20120323 < 6763))),'--','LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20120416(find(spolm1_20120416>4761 & spolm1_20120416 < 6763))/10^3,2*(-1+spolm2_20120416_halphacontnorm(find(spolm1_20120416>4761 & spolm1_20120416 < 6763))),'--','LineWidth',2,'Color',[0 1 1])
plot(velHalpha_20120417(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763))/10^3,2*(-1+mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763))),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(velHalpha_20120428(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763))/10^3,2*(-1+Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763))),'--','LineWidth',2,'Color',[0 .66 0])
plot(velHalpha_20120529(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763))/10^3,2*(-1+mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763))),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(velHalpha_20120616(find(keckL1_20120616>4761 & keckL1_20120616 < 6763))/10^3,(-1+keckL2_20120616_halphacontnorm(find(keckL1_20120616>4761 & keckL1_20120616 < 6763))),'LineWidth',2,'Color',[1 0 1])
plot(velHalpha_20120701(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763))/10^3,(-1+mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763))),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(velHalpha_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 6763))/10^3,(-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>4761 & keckD1_20121115 < 6763))),'LineWidth',2,'Color',[1 0 0])


clf
hold all
plot(velHalpha_20120223(find(Lkast1_20120223>6163 & Lkast1_20120223 < 6963))/10^3,8*(-1+Lkast2_20120223_halphacontnorm(find(Lkast1_20120223>6163 & Lkast1_20120223 < 6963))),'--','LineWidth',2,'Color',[0 1 0])
plot(velHalpha_20120301(find(mmtbc1_20120301>6163 & mmtbc1_20120301 < 6963))/10^3,8*(-1+mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>6163 & mmtbc1_20120301 < 6963))),'LineWidth',2,'Color',[0 0 0])
saveas(plotting, ['ha12.eps'], 'epsc');
eval(['!epstopdf ha12.eps']);

clf
hold all
plot(velHalpha_20120301(find(mmtbc1_20120301>6163 & mmtbc1_20120301 < 6963))/10^3,8*(-1+mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>6163 & mmtbc1_20120301 < 6963))),'LineWidth',2,'Color',[0 0 0])
plot(velHalpha_20120323(find(spolb1_20120323>6163 & spolb1_20120323 < 6963))/10^3,5*(-1+spolb2_20120323_halphacontnorm(find(spolb1_20120323>6163 & spolb1_20120323 < 6963))),'--','LineWidth',2,'Color',[0 0 1])
saveas(plotting, ['ha23.eps'], 'epsc');
eval(['!epstopdf ha23.eps']);

clf
hold all
plot(velHalpha_20120323(find(spolb1_20120323>6163 & spolb1_20120323 < 6963))/10^3,5*(-1+spolb2_20120323_halphacontnorm(find(spolb1_20120323>6163 & spolb1_20120323 < 6963))),'--','LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20120416(find(spolm1_20120416>6163 & spolm1_20120416 < 6963))/10^3,2*(-1+spolm2_20120416_halphacontnorm(find(spolm1_20120416>6163 & spolm1_20120416 < 6963))),'--','LineWidth',2,'Color',[0 1 1])
saveas(plotting, ['ha34.eps'], 'epsc');
eval(['!epstopdf ha34.eps']);

clf
hold all
plot(velHalpha_20120416(find(spolm1_20120416>6163 & spolm1_20120416 < 6963))/10^3,2*(-1+spolm2_20120416_halphacontnorm(find(spolm1_20120416>6163 & spolm1_20120416 < 6963))),'--','LineWidth',2,'Color',[0 1 1])
plot(velHalpha_20120417(find(mmtbc1_20120417>6163 & mmtbc1_20120417 < 6963))/10^3,2*(-1+mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>6163 & mmtbc1_20120417 < 6963))),'LineWidth',2,'Color',[0.3 0.3 0.3])
saveas(plotting, ['ha45.eps'], 'epsc');
eval(['!epstopdf ha45.eps']);

clf
hold all
plot(velHalpha_20120417(find(mmtbc1_20120417>6163 & mmtbc1_20120417 < 6963))/10^3,2*(-1+mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>6163 & mmtbc1_20120417 < 6963))),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(velHalpha_20120428(find(Lkast1_20120428>6163 & Lkast1_20120428 < 6963))/10^3,2*(-1+Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>6163 & Lkast1_20120428 < 6963))),'--','LineWidth',2,'Color',[0 .66 0])
saveas(plotting, ['ha56.eps'], 'epsc');
eval(['!epstopdf ha56.eps']);

clf
hold all
plot(velHalpha_20120428(find(Lkast1_20120428>6163 & Lkast1_20120428 < 6963))/10^3,2*(-1+Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>6163 & Lkast1_20120428 < 6963))),'--','LineWidth',2,'Color',[0 .66 0])
plot(velHalpha_20120529(find(mmtbc1_20120529>6163 & mmtbc1_20120529 < 6963))/10^3,2*(-1+mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>6163 & mmtbc1_20120529 < 6963))),'LineWidth',2,'Color',[0.6 0.6 0.6])
saveas(plotting, ['ha67.eps'], 'epsc');
eval(['!epstopdf ha67.eps']);

clf
hold all
plot(velHalpha_20120529(find(mmtbc1_20120529>6163 & mmtbc1_20120529 < 6963))/10^3,2*(-1+mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>6163 & mmtbc1_20120529 < 6963))),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(velHalpha_20120616(find(keckL1_20120616>6163 & keckL1_20120616 < 6963))/10^3,(-1+keckL2_20120616_halphacontnorm(find(keckL1_20120616>6163 & keckL1_20120616 < 6963))),'LineWidth',2,'Color',[1 0 1])
saveas(plotting, ['ha78.eps'], 'epsc');
eval(['!epstopdf ha78.eps']);

clf
hold all
plot(velHalpha_20120616(find(keckL1_20120616>6163 & keckL1_20120616 < 6963))/10^3,(-1+keckL2_20120616_halphacontnorm(find(keckL1_20120616>6163 & keckL1_20120616 < 6963))),'LineWidth',2,'Color',[1 0 1])
plot(velHalpha_20120701(find(mmtbc1_20120701>6163 & mmtbc1_20120701 < 6963))/10^3,(-1+mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>6163 & mmtbc1_20120701 < 6963))),'LineWidth',2,'Color',[0.9 0.9 0.9])
saveas(plotting, ['ha89.eps'], 'epsc');
eval(['!epstopdf ha89.eps']);

clf
hold all
plot(velHalpha_20120701(find(mmtbc1_20120701>6163 & mmtbc1_20120701 < 6963))/10^3,(-1+mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>6163 & mmtbc1_20120701 < 6963))),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(velHalpha_20121115(find(keckD1_20121115>6163 & keckD1_20121115 < 6963))/10^3,(-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>6163 & keckD1_20121115 < 6963))),'LineWidth',2,'Color',[1 0 0])
saveas(plotting, ['ha910.eps'], 'epsc');
eval(['!epstopdf ha910.eps']);



%%%Halpha unaltered 
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
clf
hold all
%plot(velHalpha_20120223(find(Lkast1_20120223>6163 & Lkast1_20120223 < 6963))/10^3,8*(-1+Lkast2_20120223_halphacontnorm(find(Lkast1_20120223>6163 & Lkast1_20120223 < 6963))),'--','LineWidth',2,'Color',[0 1 0])
plot(smooth(velHalpha_20120301(find(mmtbc1_20120301>6163 & mmtbc1_20120301 < 6963))/10^3,5),smooth(8*(-1+mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>6163 & mmtbc1_20120301 < 6963))),5),'LineWidth',2,'Color',[0 0 1])
plot(velHalpha_20120323(find(spolb1_20120323>6163 & spolb1_20120323 < 6963))/10^3,5*(-1+spolb2_20120323_halphacontnorm(find(spolb1_20120323>6163 & spolb1_20120323 < 6963))),'--','LineWidth',2,'Color',[0 1 1])
plot(velHalpha_20120416(find(spolm1_20120416>6163 & spolm1_20120416 < 6963))/10^3,2*(-1+spolm2_20120416_halphacontnorm(find(spolm1_20120416>6163 & spolm1_20120416 < 6963))),'--','LineWidth',2,'Color',[0 0 0])
%plot(velHalpha_20120417(find(mmtbc1_20120417>6163 & mmtbc1_20120417 < 6963))/10^3,2*(-1+mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>6163 & mmtbc1_20120417 < 6963))),'LineWidth',2,'Color',[0.3 0.3 0.3])
%plot(velHalpha_20120428(find(Lkast1_20120428>6163 & Lkast1_20120428 < 6963))/10^3,2*(-1+Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>6163 & Lkast1_20120428 < 6963))),'--','LineWidth',2,'Color',[0 .66 0])
plot(velHalpha_20120529(find(mmtbc1_20120529>6163 & mmtbc1_20120529 < 6963))/10^3,2.4*(-1+mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>6163 & mmtbc1_20120529 < 6963))),'LineWidth',2,'Color',[1 0 1])
%plot(velHalpha_20120616(find(keckL1_20120616>6163 & keckL1_20120616 < 6963))/10^3,(-1+keckL2_20120616_halphacontnorm(find(keckL1_20120616>6163 & keckL1_20120616 < 6963))),'LineWidth',2,'Color',[1 0 1])
%plot(velHalpha_20120701(find(mmtbc1_20120701>6163 & mmtbc1_20120701 < 6963))/10^3,(-1+mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>6163 & mmtbc1_20120701 < 6963))),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(velHalpha_20121115(find(keckD1_20121115>6163 & keckD1_20121115 < 6963))/10^3,(-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>6163 & keckD1_20121115 < 6963))),'LineWidth',2,'Color',[1 0 0])
xlabel('Doppler velocity (10^3 km/s)','FontSize',28)
ylabel('Normalized Flux','FontSize',28)
%title('', 'FontSize', 25)
axis([[-15 15] [-0.5 4]])
%htext = text(4.3,3.8,'day 23 - -','interpreter','latex')
%set(htext, 'Color',[0 1 0])
%set(htext, 'FontSize',26)
htext = text(4.3,3.6,'day 30---','interpreter','latex')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',26)
htext = text(4.3,3.4,'day 52 - -','interpreter','latex')
set(htext, 'Color',[0 1 1])
set(htext, 'FontSize',26)
htext = text(4.3,3.2,'day 76 - -','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',26)
%htext = text(4.3,3.0,'day 77---','interpreter','latex')
%set(htext, 'Color',[0.3 0.3 0.3])
%set(htext, 'FontSize',26)
%htext = text(4.3,2.8,'day 88 - -','interpreter','latex')
%set(htext, 'Color',[0 0.66 0])
%set(htext, 'FontSize',26)
htext = text(4.3,2.6,'day 119---','interpreter','latex')
set(htext, 'Color',[1 0 1])
set(htext, 'FontSize',26)
%htext = text(4.3,2.4,'day 137---','interpreter','latex')
%set(htext, 'Color',[1 0 1])
%set(htext, 'FontSize',26)
%htext = text(4.3,2.2,'day 152---','interpreter','latex')
%set(htext, 'Color',[0.9 0.9 0.9])
%set(htext, 'FontSize',26)
htext = text(4.3,2.0,'day 289---','interpreter','latex')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',26)
htext = text(-0.025,0.5,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',28)
htext = text(10,3,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',28)
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)

saveas(plotting, ['HalphaVary.eps'], 'epsc');
eval(['!epstopdf HalphaVary.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);




%gaussian fits to make new plot

hetms2_20120207_halphacontfitnormsubinterp = hetms2_20120207_halphacontfitnormsub;
hetms2_20120216_halphacontfitnormsubinterp = hetms2_20120216_halphacontfitnormsub;
Lkast2_20120223_halphacontfitnormsubinterp = Lkast2_20120223_halphacontfitnormsub;
mmtbc2_20120301_halphacontfitnormsubinterp = mmtbc2_20120301_halphacontfitnormsub;
hetms2_20120301_halphacontfitnormsubinterp = hetms2_20120301_halphacontfitnormsub;
spolb2_20120323_halphacontfitnormsubinterp = spolb2_20120323_halphacontfitnormsub;
spolm2_20120416_halphacontfitnormsubinterp = spolm2_20120416_halphacontfitnormsub;
mmtbc2_20120417_halphacontfitnormsubinterp = mmtbc2_20120417_halphacontfitnormsub;
Lkast2_20120428_halphacontfitnormsubinterp = Lkast2_20120428_halphacontfitnormsub;
mmtbc2_20120529_halphacontfitnormsubinterp = mmtbc2_20120529_halphacontfitnormsub;
keckL2_20120616_halphacontfitnormsubinterp = keckL2_20120616_halphacontfitnormsub;
mmtbc2_20120701_halphacontfitnormsubinterp = mmtbc2_20120701_halphacontfitnormsub;
keckD2_20121115_halphacontfitnormsubinterp = keckD2_20121115_halphacontfitnormsub;
keckD2_20150521_halphacontfitnormsubinterp = keckD2_20150521_halphacontfitnormsub;


%hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6551,1,'first')) = interp1([find(hetms1_20120207>6543,1,'first') find(hetms1_20120207 >= 6551,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6551,1,'first'))] , linspace(find(hetms1_20120207>6543,1,'first'),find(hetms1_20120207 >= 6551,1,'first'),length(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6551,1,'first'))));
hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6593,1,'first')) = interp1([find(hetms1_20120207>6543,1,'first') find(hetms1_20120207 >= 6593,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6543,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6593,1,'first'))] , linspace(find(hetms1_20120207>6543,1,'first'),find(hetms1_20120207 >= 6593,1,'first'),length(find(hetms1_20120207>6543,1,'first'):find(hetms1_20120207 >= 6593,1,'first'))));
%hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6577,1,'first'):find(hetms1_20120207 >= 6593,1,'first')) = interp1([find(hetms1_20120207>6577,1,'first') find(hetms1_20120207 >= 6593,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6577,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6593,1,'first'))] , linspace(find(hetms1_20120207>6577,1,'first'),find(hetms1_20120207 >= 6593,1,'first'),length(find(hetms1_20120207>6577,1,'first'):find(hetms1_20120207 >= 6593,1,'first'))));
hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6700,1,'first'):find(hetms1_20120207 >= 6748,1,'first')) = interp1([find(hetms1_20120207>6700,1,'first') find(hetms1_20120207 >= 6748,1,'first')] , [hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6700,1,'first')) hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6748,1,'first'))] , linspace(find(hetms1_20120207>6700,1,'first'),find(hetms1_20120207 >= 6748,1,'first'),length(find(hetms1_20120207>6700,1,'first'):find(hetms1_20120207 >= 6748,1,'first'))));


%hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6551,1,'first')) = interp1([find(hetms1_20120216>6543,1,'first') find(hetms1_20120216 >= 6551,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6551,1,'first'))] , linspace(find(hetms1_20120216>6543,1,'first'),find(hetms1_20120216 >= 6551,1,'first'),length(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6551,1,'first'))));
hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6593,1,'first')) = interp1([find(hetms1_20120216>6543,1,'first') find(hetms1_20120216 >= 6593,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6543,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6593,1,'first'))] , linspace(find(hetms1_20120216>6543,1,'first'),find(hetms1_20120216 >= 6593,1,'first'),length(find(hetms1_20120216>6543,1,'first'):find(hetms1_20120216 >= 6593,1,'first'))));
%hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6577,1,'first'):find(hetms1_20120216 >= 6593,1,'first')) = interp1([find(hetms1_20120216>6577,1,'first') find(hetms1_20120216 >= 6593,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6577,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6593,1,'first'))] , linspace(find(hetms1_20120216>6577,1,'first'),find(hetms1_20120216 >= 6593,1,'first'),length(find(hetms1_20120216>6577,1,'first'):find(hetms1_20120216 >= 6593,1,'first'))));
hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6700,1,'first'):find(hetms1_20120216 >= 6748,1,'first')) = interp1([find(hetms1_20120216>6700,1,'first') find(hetms1_20120216 >= 6748,1,'first')] , [hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6700,1,'first')) hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6748,1,'first'))] , linspace(find(hetms1_20120216>6700,1,'first'),find(hetms1_20120216 >= 6748,1,'first'),length(find(hetms1_20120216>6700,1,'first'):find(hetms1_20120216 >= 6748,1,'first'))));


%hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6551,1,'first')) = interp1([find(hetms1_20120301>6543,1,'first') find(hetms1_20120301 >= 6551,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6551,1,'first'))] , linspace(find(hetms1_20120301>6543,1,'first'),find(hetms1_20120301 >= 6551,1,'first'),length(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6551,1,'first'))));
hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6593,1,'first')) = interp1([find(hetms1_20120301>6543,1,'first') find(hetms1_20120301 >= 6593,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6543,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6593,1,'first'))] , linspace(find(hetms1_20120301>6543,1,'first'),find(hetms1_20120301 >= 6593,1,'first'),length(find(hetms1_20120301>6543,1,'first'):find(hetms1_20120301 >= 6593,1,'first'))));
%hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6577,1,'first'):find(hetms1_20120301 >= 6593,1,'first')) = interp1([find(hetms1_20120301>6577,1,'first') find(hetms1_20120301 >= 6593,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6577,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6593,1,'first'))] , linspace(find(hetms1_20120301>6577,1,'first'),find(hetms1_20120301 >= 6593,1,'first'),length(find(hetms1_20120301>6577,1,'first'):find(hetms1_20120301 >= 6593,1,'first'))));
hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6700,1,'first'):find(hetms1_20120301 >= 6748,1,'first')) = interp1([find(hetms1_20120301>6700,1,'first') find(hetms1_20120301 >= 6748,1,'first')] , [hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6700,1,'first')) hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6748,1,'first'))] , linspace(find(hetms1_20120301>6700,1,'first'),find(hetms1_20120301 >= 6748,1,'first'),length(find(hetms1_20120301>6700,1,'first'):find(hetms1_20120301 >= 6748,1,'first'))));

mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first')) = interp1([find(mmtbc1_20120301>6543,1,'first') find(mmtbc1_20120301 >= 6551,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6543,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120301>6543,1,'first'),find(mmtbc1_20120301 >= 6551,1,'first'),length(find(mmtbc1_20120301>6543,1,'first'):find(mmtbc1_20120301 >= 6551,1,'first'))));
mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first')) = interp1([find(mmtbc1_20120301>6557,1,'first') find(mmtbc1_20120301 >= 6570,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6557,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120301>6557,1,'first'),find(mmtbc1_20120301 >= 6570,1,'first'),length(find(mmtbc1_20120301>6557,1,'first'):find(mmtbc1_20120301 >= 6570,1,'first'))));
mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first')) = interp1([find(mmtbc1_20120301>6579,1,'first') find(mmtbc1_20120301 >= 6587,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6579,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120301>6579,1,'first'),find(mmtbc1_20120301 >= 6587,1,'first'),length(find(mmtbc1_20120301>6579,1,'first'):find(mmtbc1_20120301 >= 6587,1,'first'))));
mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6700,1,'first'):find(mmtbc1_20120301 >= 6748,1,'first')) = interp1([find(mmtbc1_20120301>6700,1,'first') find(mmtbc1_20120301 >= 6748,1,'first')] , [mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6700,1,'first')) mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6748,1,'first'))] , linspace(find(mmtbc1_20120301>6700,1,'first'),find(mmtbc1_20120301 >= 6748,1,'first'),length(find(mmtbc1_20120301>6700,1,'first'):find(mmtbc1_20120301 >= 6748,1,'first'))));

spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first')) = interp1([find(spolm1_20120416>6543,1,'first') find(spolm1_20120416 >= 6551,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6543,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6551,1,'first'))] , linspace(find(spolm1_20120416>6543,1,'first'),find(spolm1_20120416 >= 6551,1,'first'),length(find(spolm1_20120416>6543,1,'first'):find(spolm1_20120416 >= 6551,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6557,1,'first'):find(spolm1_20120416 >= 6570,1,'first')) = interp1([find(spolm1_20120416>6557,1,'first') find(spolm1_20120416 >= 6570,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6557,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6570,1,'first'))] , linspace(find(spolm1_20120416>6557,1,'first'),find(spolm1_20120416 >= 6570,1,'first'),length(find(spolm1_20120416>6557,1,'first'):find(spolm1_20120416 >= 6570,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first')) = interp1([find(spolm1_20120416>6579,1,'first') find(spolm1_20120416 >= 6587,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6579,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6587,1,'first'))] , linspace(find(spolm1_20120416>6579,1,'first'),find(spolm1_20120416 >= 6587,1,'first'),length(find(spolm1_20120416>6579,1,'first'):find(spolm1_20120416 >= 6587,1,'first'))));
spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6700,1,'first'):find(spolm1_20120416 >= 6748,1,'first')) = interp1([find(spolm1_20120416>6700,1,'first') find(spolm1_20120416 >= 6748,1,'first')] , [spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6700,1,'first')) spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416 >= 6748,1,'first'))] , linspace(find(spolm1_20120416>6700,1,'first'),find(spolm1_20120416 >= 6748,1,'first'),length(find(spolm1_20120416>6700,1,'first'):find(spolm1_20120416 >= 6748,1,'first'))));



mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first')) = interp1([find(mmtbc1_20120529>6543,1,'first') find(mmtbc1_20120529 >= 6551,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6543,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120529>6543,1,'first'),find(mmtbc1_20120529 >= 6551,1,'first'),length(find(mmtbc1_20120529>6543,1,'first'):find(mmtbc1_20120529 >= 6551,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first')) = interp1([find(mmtbc1_20120529>6557,1,'first') find(mmtbc1_20120529 >= 6570,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6557,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6570,1,'first'))] , linspace(find(mmtbc1_20120529>6557,1,'first'),find(mmtbc1_20120529 >= 6570,1,'first'),length(find(mmtbc1_20120529>6557,1,'first'):find(mmtbc1_20120529 >= 6570,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first')) = interp1([find(mmtbc1_20120529>6579,1,'first') find(mmtbc1_20120529 >= 6587,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6579,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6587,1,'first'))] , linspace(find(mmtbc1_20120529>6579,1,'first'),find(mmtbc1_20120529 >= 6587,1,'first'),length(find(mmtbc1_20120529>6579,1,'first'):find(mmtbc1_20120529 >= 6587,1,'first'))));
mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6700,1,'first'):find(mmtbc1_20120529 >= 6748,1,'first')) = interp1([find(mmtbc1_20120529>6700,1,'first') find(mmtbc1_20120529 >= 6748,1,'first')] , [mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6700,1,'first')) mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6748,1,'first'))] , linspace(find(mmtbc1_20120529>6700,1,'first'),find(mmtbc1_20120529 >= 6748,1,'first'),length(find(mmtbc1_20120529>6700,1,'first'):find(mmtbc1_20120529 >= 6748,1,'first'))));


mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first')) = interp1([find(mmtbc1_20120701>6543,1,'first') find(mmtbc1_20120701 >= 6551,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6543,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120701>6543,1,'first'),find(mmtbc1_20120701 >= 6551,1,'first'),length(find(mmtbc1_20120701>6543,1,'first'):find(mmtbc1_20120701 >= 6551,1,'first'))));
mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6557,1,'first'):find(mmtbc1_20120701 >= 6578,1,'first')) = interp1([find(mmtbc1_20120701>6557,1,'first') find(mmtbc1_20120701 >= 6578,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6557,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6578,1,'first'))] , linspace(find(mmtbc1_20120701>6557,1,'first'),find(mmtbc1_20120701 >= 6578,1,'first'),length(find(mmtbc1_20120701>6557,1,'first'):find(mmtbc1_20120701 >= 6578,1,'first'))));
mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6578,1,'first'):find(mmtbc1_20120701 >= 6592,1,'first')) = interp1([find(mmtbc1_20120701>6578,1,'first') find(mmtbc1_20120701 >= 6592,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6578,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6592,1,'first'))] , linspace(find(mmtbc1_20120701>6578,1,'first'),find(mmtbc1_20120701 >= 6592,1,'first'),length(find(mmtbc1_20120701>6578,1,'first'):find(mmtbc1_20120701 >= 6592,1,'first'))));
mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6700,1,'first'):find(mmtbc1_20120701 >= 6748,1,'first')) = interp1([find(mmtbc1_20120701>6700,1,'first') find(mmtbc1_20120701 >= 6748,1,'first')] , [mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6700,1,'first')) mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6748,1,'first'))] , linspace(find(mmtbc1_20120701>6700,1,'first'),find(mmtbc1_20120701 >= 6748,1,'first'),length(find(mmtbc1_20120701>6700,1,'first'):find(mmtbc1_20120701 >= 6748,1,'first'))));

keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6543,1,'first'):find(keckD1_20121115 >= 6551,1,'first')) = interp1([find(keckD1_20121115>6543,1,'first') find(keckD1_20121115 >= 6551,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6543,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6551,1,'first'))] , linspace(find(keckD1_20121115>6543,1,'first'),find(keckD1_20121115 >= 6551,1,'first'),length(find(keckD1_20121115>6543,1,'first'):find(keckD1_20121115 >= 6551,1,'first'))));
keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6557,1,'first'):find(keckD1_20121115 >= 6570,1,'first')) = interp1([find(keckD1_20121115>6557,1,'first') find(keckD1_20121115 >= 6570,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6557,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6570,1,'first'))] , linspace(find(keckD1_20121115>6557,1,'first'),find(keckD1_20121115 >= 6570,1,'first'),length(find(keckD1_20121115>6557,1,'first'):find(keckD1_20121115 >= 6570,1,'first'))));
keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6579,1,'first'):find(keckD1_20121115 >= 6587,1,'first')) = interp1([find(keckD1_20121115>6579,1,'first') find(keckD1_20121115 >= 6587,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6579,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6587,1,'first'))] , linspace(find(keckD1_20121115>6579,1,'first'),find(keckD1_20121115 >= 6587,1,'first'),length(find(keckD1_20121115>6579,1,'first'):find(keckD1_20121115 >= 6587,1,'first'))));
keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6700,1,'first'):find(keckD1_20121115 >= 6748,1,'first')) = interp1([find(keckD1_20121115>6700,1,'first') find(keckD1_20121115 >= 6748,1,'first')] , [keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6700,1,'first')) keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6748,1,'first'))] , linspace(find(keckD1_20121115>6700,1,'first'),find(keckD1_20121115 >= 6748,1,'first'),length(find(keckD1_20121115>6700,1,'first'):find(keckD1_20121115 >= 6748,1,'first'))));

spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6543,1,'first'):find(spolb1_20120323 >= 6551,1,'first')) = interp1([find(spolb1_20120323>6543,1,'first') find(spolb1_20120323 >= 6551,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6543,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6551,1,'first'))] , linspace(find(spolb1_20120323>6543,1,'first'),find(spolb1_20120323 >= 6551,1,'first'),length(find(spolb1_20120323>6543,1,'first'):find(spolb1_20120323 >= 6551,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6553,1,'first'):find(spolb1_20120323 >= 6577,1,'first')) = interp1([find(spolb1_20120323>6553,1,'first') find(spolb1_20120323 >= 6577,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6553,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6577,1,'first'))] , linspace(find(spolb1_20120323>6553,1,'first'),find(spolb1_20120323 >= 6577,1,'first'),length(find(spolb1_20120323>6553,1,'first'):find(spolb1_20120323 >= 6577,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6577,1,'first'):find(spolb1_20120323 >= 6597,1,'first')) = interp1([find(spolb1_20120323>6577,1,'first') find(spolb1_20120323 >= 6597,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6577,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6597,1,'first'))] , linspace(find(spolb1_20120323>6577,1,'first'),find(spolb1_20120323 >= 6597,1,'first'),length(find(spolb1_20120323>6577,1,'first'):find(spolb1_20120323 >= 6597,1,'first'))));
spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6700,1,'first'):find(spolb1_20120323 >= 6748,1,'first')) = interp1([find(spolb1_20120323>6700,1,'first') find(spolb1_20120323 >= 6748,1,'first')] , [spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6700,1,'first')) spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6748,1,'first'))] , linspace(find(spolb1_20120323>6700,1,'first'),find(spolb1_20120323 >= 6748,1,'first'),length(find(spolb1_20120323>6700,1,'first'):find(spolb1_20120323 >= 6748,1,'first'))));

mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first')) = interp1([find(mmtbc1_20120417>6543,1,'first') find(mmtbc1_20120417 >= 6551,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6543,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6551,1,'first'))] , linspace(find(mmtbc1_20120417>6543,1,'first'),find(mmtbc1_20120417 >= 6551,1,'first'),length(find(mmtbc1_20120417>6543,1,'first'):find(mmtbc1_20120417 >= 6551,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first')) = interp1([find(mmtbc1_20120417>6553,1,'first') find(mmtbc1_20120417 >= 6577,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6553,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6577,1,'first'))] , linspace(find(mmtbc1_20120417>6553,1,'first'),find(mmtbc1_20120417 >= 6577,1,'first'),length(find(mmtbc1_20120417>6553,1,'first'):find(mmtbc1_20120417 >= 6577,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first')) = interp1([find(mmtbc1_20120417>6577,1,'first') find(mmtbc1_20120417 >= 6597,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6577,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6597,1,'first'))] , linspace(find(mmtbc1_20120417>6577,1,'first'),find(mmtbc1_20120417 >= 6597,1,'first'),length(find(mmtbc1_20120417>6577,1,'first'):find(mmtbc1_20120417 >= 6597,1,'first'))));
mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6700,1,'first'):find(mmtbc1_20120417 >= 6748,1,'first')) = interp1([find(mmtbc1_20120417>6700,1,'first') find(mmtbc1_20120417 >= 6748,1,'first')] , [mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6700,1,'first')) mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6748,1,'first'))] , linspace(find(mmtbc1_20120417>6700,1,'first'),find(mmtbc1_20120417 >= 6748,1,'first'),length(find(mmtbc1_20120417>6700,1,'first'):find(mmtbc1_20120417 >= 6748,1,'first'))));

Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6543,1,'first'):find(Lkast1_20120223 >= 6551,1,'first')) = interp1([find(Lkast1_20120223>6543,1,'first') find(Lkast1_20120223 >= 6551,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6543,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6551,1,'first'))] , linspace(find(Lkast1_20120223>6543,1,'first'),find(Lkast1_20120223 >= 6551,1,'first'),length(find(Lkast1_20120223>6543,1,'first'):find(Lkast1_20120223 >= 6551,1,'first'))));
Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6554,1,'first'):find(Lkast1_20120223 >= 6574,1,'first')) = interp1([find(Lkast1_20120223>6554,1,'first') find(Lkast1_20120223 >= 6574,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6554,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6574,1,'first'))] , linspace(find(Lkast1_20120223>6554,1,'first'),find(Lkast1_20120223 >= 6574,1,'first'),length(find(Lkast1_20120223>6554,1,'first'):find(Lkast1_20120223 >= 6574,1,'first'))));
Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6576,1,'first'):find(Lkast1_20120223 >= 6590,1,'first')) = interp1([find(Lkast1_20120223>6576,1,'first') find(Lkast1_20120223 >= 6590,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6576,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6590,1,'first'))] , linspace(find(Lkast1_20120223>6576,1,'first'),find(Lkast1_20120223 >= 6590,1,'first'),length(find(Lkast1_20120223>6576,1,'first'):find(Lkast1_20120223 >= 6590,1,'first'))));                  
Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6700,1,'first'):find(Lkast1_20120223 >= 6748,1,'first')) = interp1([find(Lkast1_20120223>6700,1,'first') find(Lkast1_20120223 >= 6748,1,'first')] , [Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6700,1,'first')) Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6748,1,'first'))] , linspace(find(Lkast1_20120223>6700,1,'first'),find(Lkast1_20120223 >= 6748,1,'first'),length(find(Lkast1_20120223>6700,1,'first'):find(Lkast1_20120223 >= 6748,1,'first'))));

Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6543,1,'first'):find(Lkast1_20120428 >= 6551,1,'first')) = interp1([find(Lkast1_20120428>6543,1,'first') find(Lkast1_20120428 >= 6551,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6543,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6551,1,'first'))] , linspace(find(Lkast1_20120428>6543,1,'first'),find(Lkast1_20120428 >= 6551,1,'first'),length(find(Lkast1_20120428>6543,1,'first'):find(Lkast1_20120428 >= 6551,1,'first'))));
Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6552,1,'first'):find(Lkast1_20120428 >= 6572,1,'first')) = interp1([find(Lkast1_20120428>6552,1,'first') find(Lkast1_20120428 >= 6572,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6552,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6572,1,'first'))] , linspace(find(Lkast1_20120428>6552,1,'first'),find(Lkast1_20120428 >= 6572,1,'first'),length(find(Lkast1_20120428>6552,1,'first'):find(Lkast1_20120428 >= 6572,1,'first'))));
Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6572,1,'first'):find(Lkast1_20120428 >= 6593,1,'first')) = interp1([find(Lkast1_20120428>6572,1,'first') find(Lkast1_20120428 >= 6593,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6572,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6593,1,'first'))] , linspace(find(Lkast1_20120428>6572,1,'first'),find(Lkast1_20120428 >= 6593,1,'first'),length(find(Lkast1_20120428>6572,1,'first'):find(Lkast1_20120428 >= 6593,1,'first'))));
Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6700,1,'first'):find(Lkast1_20120428 >= 6748,1,'first')) = interp1([find(Lkast1_20120428>6700,1,'first') find(Lkast1_20120428 >= 6748,1,'first')] , [Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6700,1,'first')) Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6748,1,'first'))] , linspace(find(Lkast1_20120428>6700,1,'first'),find(Lkast1_20120428 >= 6748,1,'first'),length(find(Lkast1_20120428>6700,1,'first'):find(Lkast1_20120428 >= 6748,1,'first'))));

keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6543,1,'first'):find(keckL1_20120616 >= 6551,1,'first')) = interp1([find(keckL1_20120616>6543,1,'first') find(keckL1_20120616 >= 6551,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6543,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6551,1,'first'))] , linspace(find(keckL1_20120616>6543,1,'first'),find(keckL1_20120616 >= 6551,1,'first'),length(find(keckL1_20120616>6543,1,'first'):find(keckL1_20120616 >= 6551,1,'first'))));
keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6557,1,'first'):find(keckL1_20120616 >= 6570,1,'first')) = interp1([find(keckL1_20120616>6557,1,'first') find(keckL1_20120616 >= 6570,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6557,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6570,1,'first'))] , linspace(find(keckL1_20120616>6557,1,'first'),find(keckL1_20120616 >= 6570,1,'first'),length(find(keckL1_20120616>6557,1,'first'):find(keckL1_20120616 >= 6570,1,'first'))));
keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6579,1,'first'):find(keckL1_20120616 >= 6589,1,'first')) = interp1([find(keckL1_20120616>6579,1,'first') find(keckL1_20120616 >= 6589,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6579,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6589,1,'first'))] , linspace(find(keckL1_20120616>6579,1,'first'),find(keckL1_20120616 >= 6589,1,'first'),length(find(keckL1_20120616>6579,1,'first'):find(keckL1_20120616 >= 6589,1,'first'))));
keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6700,1,'first'):find(keckL1_20120616 >= 6748,1,'first')) = interp1([find(keckL1_20120616>6700,1,'first') find(keckL1_20120616 >= 6748,1,'first')] , [keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6700,1,'first')) keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6748,1,'first'))] , linspace(find(keckL1_20120616>6700,1,'first'),find(keckL1_20120616 >= 6748,1,'first'),length(find(keckL1_20120616>6700,1,'first'):find(keckL1_20120616 >= 6748,1,'first'))));

keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6543,1,'first'):find(keckD1_20150521 >= 6551,1,'first')) = interp1([find(keckD1_20150521>6543,1,'first') find(keckD1_20150521 >= 6551,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6543,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6551,1,'first'))] , linspace(find(keckD1_20150521>6543,1,'first'),find(keckD1_20150521 >= 6551,1,'first'),length(find(keckD1_20150521>6543,1,'first'):find(keckD1_20150521 >= 6551,1,'first'))));
keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6557,1,'first'):find(keckD1_20150521 >= 6570,1,'first')) = interp1([find(keckD1_20150521>6557,1,'first') find(keckD1_20150521 >= 6570,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6557,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6570,1,'first'))] , linspace(find(keckD1_20150521>6557,1,'first'),find(keckD1_20150521 >= 6570,1,'first'),length(find(keckD1_20150521>6557,1,'first'):find(keckD1_20150521 >= 6570,1,'first'))));
keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6579,1,'first'):find(keckD1_20150521 >= 6587,1,'first')) = interp1([find(keckD1_20150521>6579,1,'first') find(keckD1_20150521 >= 6587,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6579,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6587,1,'first'))] , linspace(find(keckD1_20150521>6579,1,'first'),find(keckD1_20150521 >= 6587,1,'first'),length(find(keckD1_20150521>6579,1,'first'):find(keckD1_20150521 >= 6587,1,'first'))));
keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6700,1,'first'):find(keckD1_20150521 >= 6748,1,'first')) = interp1([find(keckD1_20150521>6700,1,'first') find(keckD1_20150521 >= 6748,1,'first')] , [keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6700,1,'first')) keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6748,1,'first'))] , linspace(find(keckD1_20150521>6700,1,'first'),find(keckD1_20150521 >= 6748,1,'first'),length(find(keckD1_20150521>6700,1,'first'):find(keckD1_20150521 >= 6748,1,'first'))));




clf
hold all
plot(hetms1_20120207(find(hetms1_20120207>6262 & hetms1_20120207 < 6862))/10^3,hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6262 & hetms1_20120207 < 6862)),'--','LineWidth',2,'Color',[0 1 0])
plot(hetms1_20120207(find(hetms1_20120207>6262 & hetms1_20120207 < 6862))/10^3,hetms2_20120207_halphacontnorm(find(hetms1_20120207>6262 & hetms1_20120207 < 6862)),'--','LineWidth',2,'Color',[0 0 0])






clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,keckD2_20121115_halphacontnorm(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 0 0])

clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,keckD2_20121115_interpsub(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 1 0])
plot(keckD1_20121115(find(keckD1_20121115>6262 & keckD1_20121115 < 6862))/10^3,-1+keckD2_20121115_halphacontnorm(find(keckD1_20121115>6262 & keckD1_20121115 < 6862)),'--','LineWidth',2,'Color',[0 0 0])












%%%still remove SII lines



hetms2_20120207_centern = hetms1_20120207(hetms2_20120207_halphacontfitnormsubinterp==max(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6462.8 & hetms1_20120207<6662.8))))
hetms2_20120216_centern = hetms1_20120216(hetms2_20120216_halphacontfitnormsubinterp==max(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6462.8 & hetms1_20120216<6662.8))))
Lkast2_20120223_centern = Lkast1_20120223(Lkast2_20120223_halphacontfitnormsubinterp==max(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6462.8 & Lkast1_20120223<6662.8))))
mmtbc2_20120301_centern = mmtbc1_20120301(mmtbc2_20120301_halphacontfitnormsubinterp==max(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6462.8 & mmtbc1_20120301<6662.8))))
hetms2_20120301_centern = hetms1_20120301(hetms2_20120301_halphacontfitnormsubinterp==max(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6462.8 & hetms1_20120301<6662.8))))
spolb2_20120323_centern = spolb1_20120323(spolb2_20120323_halphacontfitnormsubinterp==max(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6462.8 & spolb1_20120323<6662.8))))
spolm2_20120416_centern = spolm1_20120416(spolm2_20120416_halphacontfitnormsubinterp==max(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6462.8 & spolm1_20120416<6662.8))))
mmtbc2_20120417_centern = mmtbc1_20120417(mmtbc2_20120417_halphacontfitnormsubinterp==max(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6462.8 & mmtbc1_20120417<6662.8))))
Lkast2_20120428_centern = Lkast1_20120428(Lkast2_20120428_halphacontfitnormsubinterp==max(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6462.8 & Lkast1_20120428<6662.8))))
mmtbc2_20120529_centern = mmtbc1_20120529(mmtbc2_20120529_halphacontfitnormsubinterp==max(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6462.8 & mmtbc1_20120529<6662.8))))
keckL2_20120616_centern = keckL1_20120616(keckL2_20120616_halphacontfitnormsubinterp==max(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6462.8 & keckL1_20120616<6662.8))))
mmtbc2_20120701_centern = mmtbc1_20120701(mmtbc2_20120701_halphacontfitnormsubinterp==max(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6462.8 & mmtbc1_20120701<6662.8))))
keckD2_20121115_centern = keckD1_20121115(keckD2_20121115_halphacontfitnormsubinterp==max(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6462.8 & keckD1_20121115<6662.8))))
keckD2_20150521_centern = keckD1_20150521(keckD2_20150521_halphacontfitnormsubinterp==max(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6462.8 & keckD1_20150521<6662.8))))



hetms2_20120207_halphacontfitnormsubinterpleftcopy = hetms2_20120207_halphacontfitnormsubinterp;
hetms2_20120216_halphacontfitnormsubinterpleftcopy = hetms2_20120216_halphacontfitnormsubinterp;
Lkast2_20120223_halphacontfitnormsubinterpleftcopy = Lkast2_20120223_halphacontfitnormsubinterp;
mmtbc2_20120301_halphacontfitnormsubinterpleftcopy = mmtbc2_20120301_halphacontfitnormsubinterp;
hetms2_20120301_halphacontfitnormsubinterpleftcopy = hetms2_20120301_halphacontfitnormsubinterp;
spolb2_20120323_halphacontfitnormsubinterpleftcopy = spolb2_20120323_halphacontfitnormsubinterp;
spolm2_20120416_halphacontfitnormsubinterpleftcopy = spolm2_20120416_halphacontfitnormsubinterp;
mmtbc2_20120417_halphacontfitnormsubinterpleftcopy = mmtbc2_20120417_halphacontfitnormsubinterp;
Lkast2_20120428_halphacontfitnormsubinterpleftcopy = Lkast2_20120428_halphacontfitnormsubinterp;
mmtbc2_20120529_halphacontfitnormsubinterpleftcopy = mmtbc2_20120529_halphacontfitnormsubinterp;
keckL2_20120616_halphacontfitnormsubinterpleftcopy = keckL2_20120616_halphacontfitnormsubinterp;
mmtbc2_20120701_halphacontfitnormsubinterpleftcopy = mmtbc2_20120701_halphacontfitnormsubinterp;
keckD2_20121115_halphacontfitnormsubinterpleftcopy = keckD2_20121115_halphacontfitnormsubinterp;
keckD2_20150521_halphacontfitnormsubinterpleftcopy = keckD2_20150521_halphacontfitnormsubinterp;

hetms2_20120207_halphacontfitnormsubinterprightcopy = hetms2_20120207_halphacontfitnormsubinterp;
hetms2_20120216_halphacontfitnormsubinterprightcopy = hetms2_20120216_halphacontfitnormsubinterp;
Lkast2_20120223_halphacontfitnormsubinterprightcopy = Lkast2_20120223_halphacontfitnormsubinterp;
mmtbc2_20120301_halphacontfitnormsubinterprightcopy = mmtbc2_20120301_halphacontfitnormsubinterp;
hetms2_20120301_halphacontfitnormsubinterprightcopy = hetms2_20120301_halphacontfitnormsubinterp;
spolb2_20120323_halphacontfitnormsubinterprightcopy = spolb2_20120323_halphacontfitnormsubinterp;
spolm2_20120416_halphacontfitnormsubinterprightcopy = spolm2_20120416_halphacontfitnormsubinterp;
mmtbc2_20120417_halphacontfitnormsubinterprightcopy = mmtbc2_20120417_halphacontfitnormsubinterp;
Lkast2_20120428_halphacontfitnormsubinterprightcopy = Lkast2_20120428_halphacontfitnormsubinterp;
mmtbc2_20120529_halphacontfitnormsubinterprightcopy = mmtbc2_20120529_halphacontfitnormsubinterp;
keckL2_20120616_halphacontfitnormsubinterprightcopy = keckL2_20120616_halphacontfitnormsubinterp;
mmtbc2_20120701_halphacontfitnormsubinterprightcopy = mmtbc2_20120701_halphacontfitnormsubinterp;
keckD2_20121115_halphacontfitnormsubinterprightcopy = keckD2_20121115_halphacontfitnormsubinterp;
keckD2_20150521_halphacontfitnormsubinterprightcopy = keckD2_20150521_halphacontfitnormsubinterp;





hetms2_20120207_halphacontfitnormsubinterpleftcopy(find(hetms1_20120207>hetms2_20120207_centern & hetms1_20120207<hetms2_20120207_centern+500)) = flipud(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207<hetms2_20120207_centern & hetms1_20120207>hetms2_20120207_centern-500)));
hetms2_20120216_halphacontfitnormsubinterpleftcopy(find(hetms1_20120216>hetms2_20120216_centern & hetms1_20120216<hetms2_20120216_centern+500)) = flipud(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216<hetms2_20120216_centern & hetms1_20120216>hetms2_20120216_centern-500)));
Lkast2_20120223_halphacontfitnormsubinterpleftcopy(find(Lkast1_20120223>Lkast2_20120223_centern & Lkast1_20120223<Lkast2_20120223_centern+500)) = flipud(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223<Lkast2_20120223_centern & Lkast1_20120223>Lkast2_20120223_centern-500)));
mmtbc2_20120301_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120301>mmtbc2_20120301_centern & mmtbc1_20120301<mmtbc2_20120301_centern+250)) = flipud(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301<mmtbc2_20120301_centern & mmtbc1_20120301>mmtbc2_20120301_centern-250)));
hetms2_20120301_halphacontfitnormsubinterpleftcopy(find(hetms1_20120301>hetms2_20120301_centern & hetms1_20120301<hetms2_20120301_centern+500)) = flipud(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301<hetms2_20120301_centern & hetms1_20120301>hetms2_20120301_centern-500)));
spolb2_20120323_halphacontfitnormsubinterpleftcopy(find(spolb1_20120323>spolb2_20120323_centern & spolb1_20120323<spolb2_20120323_centern+500)) = flipud(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323<spolb2_20120323_centern & spolb1_20120323>spolb2_20120323_centern-500)));
spolm2_20120416_halphacontfitnormsubinterpleftcopy(find(spolm1_20120416>spolm2_20120416_centern & spolm1_20120416<spolm2_20120416_centern+500)) = flipud(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416<spolm2_20120416_centern & spolm1_20120416>spolm2_20120416_centern-500)));
mmtbc2_20120417_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120417>mmtbc2_20120417_centern & mmtbc1_20120417<mmtbc2_20120417_centern+250)) = flipud(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417<mmtbc2_20120417_centern & mmtbc1_20120417>mmtbc2_20120417_centern-250)));
Lkast2_20120428_halphacontfitnormsubinterpleftcopy(find(Lkast1_20120428>Lkast2_20120428_centern & Lkast1_20120428<Lkast2_20120428_centern+500)) = flipud(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428<Lkast2_20120428_centern & Lkast1_20120428>Lkast2_20120428_centern-500)));
mmtbc2_20120529_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120529>mmtbc2_20120529_centern & mmtbc1_20120529<mmtbc2_20120529_centern+250)) = flipud(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529<mmtbc2_20120529_centern & mmtbc1_20120529>mmtbc2_20120529_centern-250)));
keckL2_20120616_halphacontfitnormsubinterpleftcopy(find(keckL1_20120616>keckL2_20120616_centern & keckL1_20120616<keckL2_20120616_centern+500)) = flipud(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616<keckL2_20120616_centern & keckL1_20120616>keckL2_20120616_centern-500)));
mmtbc2_20120701_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120701>mmtbc2_20120701_centern & mmtbc1_20120701<mmtbc2_20120701_centern+500)) = flipud(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701<mmtbc2_20120701_centern & mmtbc1_20120701>mmtbc2_20120701_centern-500)));
keckD2_20121115_halphacontfitnormsubinterpleftcopy(find(keckD1_20121115>keckD2_20121115_centern & keckD1_20121115<keckD2_20121115_centern+500)) = flipud(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115<keckD2_20121115_centern & keckD1_20121115>keckD2_20121115_centern-500)));
keckD2_20150521_halphacontfitnormsubinterpleftcopy(find(keckD1_20150521>keckD2_20150521_centern & keckD1_20150521<keckD2_20150521_centern+500)) = flipud(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521<keckD2_20150521_centern & keckD1_20150521>keckD2_20150521_centern-500)));





hetms2_20120207_halphacontfitnormsubinterprightcopy(find(hetms1_20120207<hetms2_20120207_centern & hetms1_20120207>hetms2_20120207_centern-500)) = flipud(hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>hetms2_20120207_centern & hetms1_20120207<hetms2_20120207_centern+500)));
hetms2_20120216_halphacontfitnormsubinterprightcopy(find(hetms1_20120216<hetms2_20120216_centern & hetms1_20120216>hetms2_20120216_centern-500)) = flipud(hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>hetms2_20120216_centern & hetms1_20120216<hetms2_20120216_centern+500)));
Lkast2_20120223_halphacontfitnormsubinterprightcopy(find(Lkast1_20120223<Lkast2_20120223_centern & Lkast1_20120223>Lkast2_20120223_centern-500)) = flipud(Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>Lkast2_20120223_centern & Lkast1_20120223<Lkast2_20120223_centern+500)));
mmtbc2_20120301_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120301<mmtbc2_20120301_centern & mmtbc1_20120301>mmtbc2_20120301_centern-250)) = flipud(mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>mmtbc2_20120301_centern & mmtbc1_20120301<mmtbc2_20120301_centern+250)));
hetms2_20120301_halphacontfitnormsubinterprightcopy(find(hetms1_20120301<hetms2_20120301_centern & hetms1_20120301>hetms2_20120301_centern-500)) = flipud(hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>hetms2_20120301_centern & hetms1_20120301<hetms2_20120301_centern+500)));
spolb2_20120323_halphacontfitnormsubinterprightcopy(find(spolb1_20120323<spolb2_20120323_centern & spolb1_20120323>spolb2_20120323_centern-500)) = flipud(spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>spolb2_20120323_centern & spolb1_20120323<spolb2_20120323_centern+500)));
spolm2_20120416_halphacontfitnormsubinterprightcopy(find(spolm1_20120416<spolm2_20120416_centern & spolm1_20120416>spolm2_20120416_centern-500)) = flipud(spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>spolm2_20120416_centern & spolm1_20120416<spolm2_20120416_centern+500)));
mmtbc2_20120417_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120417<mmtbc2_20120417_centern & mmtbc1_20120417>mmtbc2_20120417_centern-250)) = flipud(mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>mmtbc2_20120417_centern & mmtbc1_20120417<mmtbc2_20120417_centern+250)));
Lkast2_20120428_halphacontfitnormsubinterprightcopy(find(Lkast1_20120428<Lkast2_20120428_centern & Lkast1_20120428>Lkast2_20120428_centern-500)) = flipud(Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>Lkast2_20120428_centern & Lkast1_20120428<Lkast2_20120428_centern+500)));
mmtbc2_20120529_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120529<mmtbc2_20120529_centern & mmtbc1_20120529>mmtbc2_20120529_centern-250)) = flipud(mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>mmtbc2_20120529_centern & mmtbc1_20120529<mmtbc2_20120529_centern+250)));
keckL2_20120616_halphacontfitnormsubinterprightcopy(find(keckL1_20120616<keckL2_20120616_centern & keckL1_20120616>keckL2_20120616_centern-500)) = flipud(keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>keckL2_20120616_centern & keckL1_20120616<keckL2_20120616_centern+500)));
mmtbc2_20120701_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120701<mmtbc2_20120701_centern & mmtbc1_20120701>mmtbc2_20120701_centern-250)) = flipud(mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>mmtbc2_20120701_centern & mmtbc1_20120701<mmtbc2_20120701_centern+250)));
keckD2_20121115_halphacontfitnormsubinterprightcopy(find(keckD1_20121115<keckD2_20121115_centern & keckD1_20121115>keckD2_20121115_centern-500)) = flipud(keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>keckD2_20121115_centern & keckD1_20121115<keckD2_20121115_centern+500)));
keckD2_20150521_halphacontfitnormsubinterprightcopy(find(keckD1_20150521<keckD2_20150521_centern & keckD1_20150521>keckD2_20150521_centern-500)) = flipud(keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>keckD2_20150521_centern & keckD1_20150521<keckD2_20150521_centern+500)));





hetms2_20120207_broadleftgaussfit = fit(velHalpha_20120207(find(hetms1_20120207>hetms2_20120207_centern-300 & hetms1_20120207<hetms2_20120207_centern+300)),hetms2_20120207_halphacontfitnormsubinterpleftcopy(find(hetms1_20120207>hetms2_20120207_centern-300 & hetms1_20120207<hetms2_20120207_centern+300)),'gauss1')
hetms2_20120216_broadleftgaussfit = fit(velHalpha_20120216(find(hetms1_20120216>hetms2_20120216_centern-300 & hetms1_20120216<hetms2_20120216_centern+300)),hetms2_20120216_halphacontfitnormsubinterpleftcopy(find(hetms1_20120216>hetms2_20120216_centern-300 & hetms1_20120216<hetms2_20120216_centern+300)),'gauss1')
Lkast2_20120223_broadleftgaussfit = fit(velHalpha_20120223(find(Lkast1_20120223>Lkast2_20120223_centern-300 & Lkast1_20120223<Lkast2_20120223_centern+300)),Lkast2_20120223_halphacontfitnormsubinterpleftcopy(find(Lkast1_20120223>Lkast2_20120223_centern-300 & Lkast1_20120223<Lkast2_20120223_centern+300)),'gauss1')
mmtbc2_20120301_broadleftgaussfit = fit(velHalpha_20120301(find(mmtbc1_20120301>mmtbc2_20120301_centern-300 & mmtbc1_20120301<mmtbc2_20120301_centern+300)),mmtbc2_20120301_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120301>mmtbc2_20120301_centern-300 & mmtbc1_20120301<mmtbc2_20120301_centern+300)),'gauss1')
hetms2_20120301_broadleftgaussfit = fit(velHalpha_20120301_2(find(hetms1_20120301>hetms2_20120301_centern-300 & hetms1_20120301<hetms2_20120301_centern+300)),hetms2_20120301_halphacontfitnormsubinterpleftcopy(find(hetms1_20120301>hetms2_20120301_centern-300 & hetms1_20120301<hetms2_20120301_centern+300)),'gauss1')
spolb2_20120323_broadleftgaussfit = fit(velHalpha_20120323(find(spolb1_20120323>spolb2_20120323_centern-300 & spolb1_20120323<spolb2_20120323_centern+300)),spolb2_20120323_halphacontfitnormsubinterpleftcopy(find(spolb1_20120323>spolb2_20120323_centern-300 & spolb1_20120323<spolb2_20120323_centern+300)),'gauss1')
spolm2_20120416_broadleftgaussfit = fit(velHalpha_20120416(find(spolm1_20120416>spolm2_20120416_centern-300 & spolm1_20120416<spolm2_20120416_centern+300)),spolm2_20120416_halphacontfitnormsubinterpleftcopy(find(spolm1_20120416>spolm2_20120416_centern-300 & spolm1_20120416<spolm2_20120416_centern+300)),'gauss1')
mmtbc2_20120417_broadleftgaussfit = fit(velHalpha_20120417(find(mmtbc1_20120417>mmtbc2_20120417_centern-300 & mmtbc1_20120417<mmtbc2_20120417_centern+300)),mmtbc2_20120417_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120417>mmtbc2_20120417_centern-300 & mmtbc1_20120417<mmtbc2_20120417_centern+300)),'gauss1')
Lkast2_20120428_broadleftgaussfit = fit(velHalpha_20120428(find(Lkast1_20120428>Lkast2_20120428_centern-300 & Lkast1_20120428<Lkast2_20120428_centern+300)),Lkast2_20120428_halphacontfitnormsubinterpleftcopy(find(Lkast1_20120428>Lkast2_20120428_centern-300 & Lkast1_20120428<Lkast2_20120428_centern+300)),'gauss1')
mmtbc2_20120529_broadleftgaussfit = fit(velHalpha_20120529(find(mmtbc1_20120529>mmtbc2_20120529_centern-300 & mmtbc1_20120529<mmtbc2_20120529_centern+300)),mmtbc2_20120529_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120529>mmtbc2_20120529_centern-300 & mmtbc1_20120529<mmtbc2_20120529_centern+300)),'gauss1')
keckL2_20120616_broadleftgaussfit = fit(velHalpha_20120616(find(keckL1_20120616>keckL2_20120616_centern-300 & keckL1_20120616<keckL2_20120616_centern+300)),keckL2_20120616_halphacontfitnormsubinterpleftcopy(find(keckL1_20120616>keckL2_20120616_centern-300 & keckL1_20120616<keckL2_20120616_centern+300)),'gauss1')
mmtbc2_20120701_broadleftgaussfit = fit(velHalpha_20120701(find(mmtbc1_20120701>mmtbc2_20120701_centern-300 & mmtbc1_20120701<mmtbc2_20120701_centern+300)),mmtbc2_20120701_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120701>mmtbc2_20120701_centern-300 & mmtbc1_20120701<mmtbc2_20120701_centern+300)),'gauss1')
keckD2_20121115_broadleftgaussfit = fit(velHalpha_20121115(find(keckD1_20121115>keckD2_20121115_centern-300 & keckD1_20121115<keckD2_20121115_centern+300)),keckD2_20121115_halphacontfitnormsubinterpleftcopy(find(keckD1_20121115>keckD2_20121115_centern-300 & keckD1_20121115<keckD2_20121115_centern+300)),'gauss1')
keckD2_20150521_broadleftgaussfit = fit(velHalpha_20150521(find(keckD1_20150521>keckD2_20150521_centern-300 & keckD1_20150521<keckD2_20150521_centern+300)),keckD2_20150521_halphacontfitnormsubinterpleftcopy(find(keckD1_20150521>keckD2_20150521_centern-300 & keckD1_20150521<keckD2_20150521_centern+300)),'gauss1')



hetms2_20120207_broadrightgaussfit = fit(velHalpha_20120207(find(hetms1_20120207>hetms2_20120207_centern-300 & hetms1_20120207<hetms2_20120207_centern+300)),hetms2_20120207_halphacontfitnormsubinterprightcopy(find(hetms1_20120207>hetms2_20120207_centern-300 & hetms1_20120207<hetms2_20120207_centern+300)),'gauss1')
hetms2_20120216_broadrightgaussfit = fit(velHalpha_20120216(find(hetms1_20120216>hetms2_20120216_centern-300 & hetms1_20120216<hetms2_20120216_centern+300)),hetms2_20120216_halphacontfitnormsubinterprightcopy(find(hetms1_20120216>hetms2_20120216_centern-300 & hetms1_20120216<hetms2_20120216_centern+300)),'gauss1')
Lkast2_20120223_broadrightgaussfit = fit(velHalpha_20120223(find(Lkast1_20120223>Lkast2_20120223_centern-300 & Lkast1_20120223<Lkast2_20120223_centern+300)),Lkast2_20120223_halphacontfitnormsubinterprightcopy(find(Lkast1_20120223>Lkast2_20120223_centern-300 & Lkast1_20120223<Lkast2_20120223_centern+300)),'gauss1')
mmtbc2_20120301_broadrightgaussfit = fit(velHalpha_20120301(find(mmtbc1_20120301>mmtbc2_20120301_centern-300 & mmtbc1_20120301<mmtbc2_20120301_centern+300)),mmtbc2_20120301_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120301>mmtbc2_20120301_centern-300 & mmtbc1_20120301<mmtbc2_20120301_centern+300)),'gauss1')
hetms2_20120301_broadrightgaussfit = fit(velHalpha_20120301_2(find(hetms1_20120301>hetms2_20120301_centern-300 & hetms1_20120301<hetms2_20120301_centern+300)),hetms2_20120301_halphacontfitnormsubinterprightcopy(find(hetms1_20120301>hetms2_20120301_centern-300 & hetms1_20120301<hetms2_20120301_centern+300)),'gauss1')
spolb2_20120323_broadrightgaussfit = fit(velHalpha_20120323(find(spolb1_20120323>spolb2_20120323_centern-300 & spolb1_20120323<spolb2_20120323_centern+300)),spolb2_20120323_halphacontfitnormsubinterprightcopy(find(spolb1_20120323>spolb2_20120323_centern-300 & spolb1_20120323<spolb2_20120323_centern+300)),'gauss1')
spolm2_20120416_broadrightgaussfit = fit(velHalpha_20120416(find(spolm1_20120416>spolm2_20120416_centern-300 & spolm1_20120416<spolm2_20120416_centern+300)),spolm2_20120416_halphacontfitnormsubinterprightcopy(find(spolm1_20120416>spolm2_20120416_centern-300 & spolm1_20120416<spolm2_20120416_centern+300)),'gauss1')
mmtbc2_20120417_broadrightgaussfit = fit(velHalpha_20120417(find(mmtbc1_20120417>mmtbc2_20120417_centern-300 & mmtbc1_20120417<mmtbc2_20120417_centern+300)),mmtbc2_20120417_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120417>mmtbc2_20120417_centern-300 & mmtbc1_20120417<mmtbc2_20120417_centern+300)),'gauss1')
Lkast2_20120428_broadrightgaussfit = fit(velHalpha_20120428(find(Lkast1_20120428>Lkast2_20120428_centern-300 & Lkast1_20120428<Lkast2_20120428_centern+300)),Lkast2_20120428_halphacontfitnormsubinterprightcopy(find(Lkast1_20120428>Lkast2_20120428_centern-300 & Lkast1_20120428<Lkast2_20120428_centern+300)),'gauss1')
mmtbc2_20120529_broadrightgaussfit = fit(velHalpha_20120529(find(mmtbc1_20120529>mmtbc2_20120529_centern-300 & mmtbc1_20120529<mmtbc2_20120529_centern+300)),mmtbc2_20120529_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120529>mmtbc2_20120529_centern-300 & mmtbc1_20120529<mmtbc2_20120529_centern+300)),'gauss1')
keckL2_20120616_broadrightgaussfit = fit(velHalpha_20120616(find(keckL1_20120616>keckL2_20120616_centern-300 & keckL1_20120616<keckL2_20120616_centern+300)),keckL2_20120616_halphacontfitnormsubinterprightcopy(find(keckL1_20120616>keckL2_20120616_centern-300 & keckL1_20120616<keckL2_20120616_centern+300)),'gauss1')
mmtbc2_20120701_broadrightgaussfit = fit(velHalpha_20120701(find(mmtbc1_20120701>mmtbc2_20120701_centern-300 & mmtbc1_20120701<mmtbc2_20120701_centern+300)),mmtbc2_20120701_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120701>mmtbc2_20120701_centern-300 & mmtbc1_20120701<mmtbc2_20120701_centern+300)),'gauss1')
keckD2_20121115_broadrightgaussfit = fit(velHalpha_20121115(find(keckD1_20121115>keckD2_20121115_centern-300 & keckD1_20121115<keckD2_20121115_centern+300)),keckD2_20121115_halphacontfitnormsubinterprightcopy(find(keckD1_20121115>keckD2_20121115_centern-300 & keckD1_20121115<keckD2_20121115_centern+300)),'gauss1')
keckD2_20150521_broadrightgaussfit = fit(velHalpha_20150521(find(keckD1_20150521>keckD2_20150521_centern-300 & keckD1_20150521<keckD2_20150521_centern+300)),keckD2_20150521_halphacontfitnormsubinterprightcopy(find(keckD1_20150521>keckD2_20150521_centern-300 & keckD1_20150521<keckD2_20150521_centern+300)),'gauss1')

%inspect both



clf
hold on
plot(hetms2_20120207_broadrightgaussfit,velHalpha_20120207(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)),hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)))
plot(velHalpha_20120207(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)),hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)))

clf
hold on
plot(hetms2_20120216_broadrightgaussfit,velHalpha_20120216(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)),hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)))
plot(velHalpha_20120216(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)),hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)))

clf
hold on
plot(Lkast2_20120223_broadrightgaussfit,velHalpha_20120223(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)),Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)))
plot(velHalpha_20120223(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)),Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)))

clf
hold on
plot(mmtbc2_20120301_broadrightgaussfit,velHalpha_20120301(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)),mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)))
plot(velHalpha_20120301(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)),mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)))

clf
hold on
plot(hetms2_20120301_broadrightgaussfit,velHalpha_20120301_2(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)),hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)))
plot(velHalpha_20120301_2(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)),hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)))

clf
hold on
plot(spolb2_20120323_broadrightgaussfit,velHalpha_20120323(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)))
plot(velHalpha_20120323(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)))

clf
hold on
plot(spolm2_20120416_broadrightgaussfit,velHalpha_20120416(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)),spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)))
plot(velHalpha_20120416(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)),spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)))

clf
hold on
plot(mmtbc2_20120417_broadrightgaussfit,velHalpha_20120417(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)),mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)))
plot(velHalpha_20120417(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)),mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)))

clf
hold on
plot(Lkast2_20120428_broadrightgaussfit,velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
plot(Lkast2_20120428_broadleftgaussfit,velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
plot(velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
saveas(plotting, ['FWHMtest3.eps'], 'epsc');
eval(['!epstopdf FWHMtest3.eps']);



clf
hold on
plot(velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsub(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
plot(velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
saveas(plotting, ['FWHMtest2.eps'], 'epsc');
eval(['!epstopdf FWHMtest2.eps']);



clf
hold on
plot(mmtbc2_20120529_broadrightgaussfit,velHalpha_20120529(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)),mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)))
plot(velHalpha_20120529(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)),mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)))

clf
hold on
plot(keckL2_20120616_broadrightgaussfit,velHalpha_20120616(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)))
plot(velHalpha_20120616(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)))

clf
hold on
plot(mmtbc2_20120701_broadrightgaussfit,velHalpha_20120701(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)),mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)))
plot(velHalpha_20120701(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)),mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)))

clf
hold on
plot(keckD2_20121115_broadrightgaussfit,velHalpha_20121115(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)),keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)))
plot(velHalpha_20121115(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)),keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)))

clf
hold on
plot(keckD2_20150521_broadrightgaussfit,velHalpha_20150521(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)),keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)))
plot(velHalpha_20150521(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)),keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)))
















%right



clf
plot(hetms2_20120207_broadrightgaussfit,velHalpha_20120207(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)),hetms2_20120207_halphacontfitnormsubinterprightcopy(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)))

clf
plot(hetms2_20120216_broadrightgaussfit,velHalpha_20120216(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)),hetms2_20120216_halphacontfitnormsubinterprightcopy(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)))

clf
plot(Lkast2_20120223_broadrightgaussfit,velHalpha_20120223(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)),Lkast2_20120223_halphacontfitnormsubinterprightcopy(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)))

clf
plot(mmtbc2_20120301_broadrightgaussfit,velHalpha_20120301(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)),mmtbc2_20120301_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)))

clf
plot(hetms2_20120301_broadrightgaussfit,velHalpha_20120301_2(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)),hetms2_20120301_halphacontfitnormsubinterprightcopy(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)))

clf
plot(spolb2_20120323_broadrightgaussfit,velHalpha_20120323(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)),spolb2_20120323_halphacontfitnormsubinterprightcopy(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)))

clf
plot(spolm2_20120416_broadrightgaussfit,velHalpha_20120416(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)),spolm2_20120416_halphacontfitnormsubinterprightcopy(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)))

clf
plot(mmtbc2_20120417_broadrightgaussfit,velHalpha_20120417(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)),mmtbc2_20120417_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)))

clf
plot(Lkast2_20120428_broadrightgaussfit,velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsubinterprightcopy(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
saveas(plotting, ['FWHMtest4.eps'], 'epsc');
eval(['!epstopdf FWHMtest4.eps']);


clf
plot(mmtbc2_20120529_broadrightgaussfit,velHalpha_20120529(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)),mmtbc2_20120529_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)))

clf
plot(keckL2_20120616_broadrightgaussfit,velHalpha_20120616(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)),keckL2_20120616_halphacontfitnormsubinterprightcopy(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)))

clf
plot(mmtbc2_20120701_broadrightgaussfit,velHalpha_20120701(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)),mmtbc2_20120701_halphacontfitnormsubinterprightcopy(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)))

clf
plot(keckD2_20121115_broadrightgaussfit,velHalpha_20121115(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)),keckD2_20121115_halphacontfitnormsubinterprightcopy(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)))

clf
plot(keckD2_20150521_broadrightgaussfit,velHalpha_20150521(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)),keckD2_20150521_halphacontfitnormsubinterprightcopy(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)))



%left

clf
plot(hetms2_20120207_broadleftgaussfit,velHalpha_20120207(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)),hetms2_20120207_halphacontfitnormsubinterpleftcopy(find(hetms1_20120207>6262.8 & hetms1_20120207<6862.8)))

clf
plot(hetms2_20120216_broadleftgaussfit,velHalpha_20120216(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)),hetms2_20120216_halphacontfitnormsubinterpleftcopy(find(hetms1_20120216>6262.8 & hetms1_20120216<6862.8)))

clf
plot(Lkast2_20120223_broadleftgaussfit,velHalpha_20120223(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)),Lkast2_20120223_halphacontfitnormsubinterpleftcopy(find(Lkast1_20120223>6262.8 & Lkast1_20120223<6862.8)))

clf
plot(mmtbc2_20120301_broadleftgaussfit,velHalpha_20120301(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)),mmtbc2_20120301_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120301>6262.8 & mmtbc1_20120301<6862.8)))

clf
plot(hetms2_20120301_broadleftgaussfit,velHalpha_20120301_2(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)),hetms2_20120301_halphacontfitnormsubinterpleftcopy(find(hetms1_20120301>6262.8 & hetms1_20120301<6862.8)))

clf
plot(spolb2_20120323_broadleftgaussfit,velHalpha_20120323(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)),spolb2_20120323_halphacontfitnormsubinterpleftcopy(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)))

clf
plot(spolm2_20120416_broadleftgaussfit,velHalpha_20120416(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)),spolm2_20120416_halphacontfitnormsubinterpleftcopy(find(spolm1_20120416>6262.8 & spolm1_20120416<6862.8)))

clf
plot(mmtbc2_20120417_broadleftgaussfit,velHalpha_20120417(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)),mmtbc2_20120417_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120417>6262.8 & mmtbc1_20120417<6862.8)))

clf
plot(Lkast2_20120428_broadleftgaussfit,velHalpha_20120428(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)),Lkast2_20120428_halphacontfitnormsubinterpleftcopy(find(Lkast1_20120428>6262.8 & Lkast1_20120428<6862.8)))
saveas(plotting, ['FWHMtest5.eps'], 'epsc');
eval(['!epstopdf FWHMtest5.eps']);

clf
plot(mmtbc2_20120529_broadleftgaussfit,velHalpha_20120529(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)),mmtbc2_20120529_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120529>6262.8 & mmtbc1_20120529<6862.8)))

clf
plot(keckL2_20120616_broadleftgaussfit,velHalpha_20120616(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)),keckL2_20120616_halphacontfitnormsubinterpleftcopy(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)))

clf
plot(mmtbc2_20120701_broadleftgaussfit,velHalpha_20120701(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)),mmtbc2_20120701_halphacontfitnormsubinterpleftcopy(find(mmtbc1_20120701>6262.8 & mmtbc1_20120701<6862.8)))

clf
plot(keckD2_20121115_broadleftgaussfit,velHalpha_20121115(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)),keckD2_20121115_halphacontfitnormsubinterpleftcopy(find(keckD1_20121115>6262.8 & keckD1_20121115<6862.8)))

clf
plot(keckD2_20150521_broadleftgaussfit,velHalpha_20150521(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)),keckD2_20150521_halphacontfitnormsubinterpleftcopy(find(keckD1_20150521>6262.8 & keckD1_20150521<6862.8)))













clf
plot(spolb2_20120323_broadrightgaussfit,velHalpha_20120323(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)),spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323>6262.8 & spolb1_20120323<6862.8)))



clf
plot(keckL2_20120616_broadrightgaussfit,velHalpha_20120616(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)),keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616>6262.8 & keckL1_20120616<6862.8)))





%%%Halpha unaltered ContFit
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
set(plotting,'Position',[0 0 0.9 1]);

clf
%plot(velHalpha_20120223(find(Lkast1_20120223>6000 & Lkast1_20120223 < 7100))/10^3,7.7*(Lkast2_20120223_halphacontfitnormsub(find(Lkast1_20120223>6000 & Lkast1_20120223 < 7100))),'--','LineWidth',3,'Color',[1 0.45 0])
plot(smooth(velHalpha_20120301(find(mmtbc1_20120301>6000 & mmtbc1_20120301 < 7100))/10^3,5),smooth(8*(mmtbc2_20120301_halphacontfitnormsub(find(mmtbc1_20120301>6000 & mmtbc1_20120301 < 7100))),5),'LineWidth',3,'Color',[1 0.45 0])
hold all
plot(velHalpha_20120207(find(hetms1_20120207>6000 & hetms1_20120207 < 7100))/10^3,20*(hetms2_20120207_halphacontfitnormsub(find(hetms1_20120207>6000 & hetms1_20120207 < 7100))),'LineWidth',3,'Color',[0.4 0.4 0.4])
plot(velHalpha_20120216(find(hetms1_20120216>6000 & hetms1_20120216 < 7100))/10^3,10*(hetms2_20120216_halphacontfitnormsub(find(hetms1_20120216>6000 & hetms1_20120216 < 7100))),'LineWidth',3,'Color',[0.5 0.5 1])

plot(velHalpha_20120323(find(spolb1_20120323>6000 & spolb1_20120323 < 7100))/10^3,6.5*(spolb2_20120323_halphacontfitnormsub(find(spolb1_20120323>6000 & spolb1_20120323 < 7100))),'--','LineWidth',3,'Color',[1 0 0])
plot(velHalpha_20120416(find(spolm1_20120416>6000 & spolm1_20120416 < 7100))/10^3,2.4*(spolm2_20120416_halphacontfitnormsub(find(spolm1_20120416>6000 & spolm1_20120416 < 7100))),'--','LineWidth',3,'Color',[0.211 0.149 0.597])
%plot(velHalpha_20120417(find(mmtbc1_20120417>6000 & mmtbc1_20120417 < 7100))/10^3,2*(mmtbc2_20120417_halphacontfitnormsub(find(mmtbc1_20120417>6000 & mmtbc1_20120417 < 7100))),'LineWidth',3,'Color',[0.3 0.3 0.3])
%plot(velHalpha_20120428(find(Lkast1_20120428>6000 & Lkast1_20120428 < 7100))/10^3,2*(Lkast2_20120428_halphacontfitnormsub(find(Lkast1_20120428>6000 & Lkast1_20120428 < 7100))),'--','LineWidth',3,'Color',[0 .66 0])
plot(velHalpha_20120529(find(mmtbc1_20120529>6000 & mmtbc1_20120529 < 7100))/10^3,2.4*(mmtbc2_20120529_halphacontfitnormsub(find(mmtbc1_20120529>6000 & mmtbc1_20120529 < 7100))),'LineWidth',3,'Color',[0 0.5 0])
%plot(velHalpha_20120616(find(keckL1_20120616>6000 & keckL1_20120616 < 7100))/10^3,(keckL2_20120616_halphacontfitnormsub(find(keckL1_20120616>6000 & keckL1_20120616 < 7100))),'LineWidth',3,'Color',[1 0 1])
%plot(velHalpha_20120701(find(mmtbc1_20120701>6000 & mmtbc1_20120701 < 7100))/10^3,(mmtbc2_20120701_halphacontfitnormsub(find(mmtbc1_20120701>6000 & mmtbc1_20120701 < 7100))),'LineWidth',3,'Color',[0.9 0.9 0.9])
plot(velHalpha_20121115(find(keckD1_20121115>6000 & keckD1_20121115 < 7100))/10^3,(1.05*keckD2_20121115_halphacontfitnormsub(find(keckD1_20121115>6000 & keckD1_20121115 < 7100))),'LineWidth',3,'Color',[0 0 0])
xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-20 20] [-0.5 4]])
%htext = text(4.3,3.8,'day 23 - -','interpreter','latex')
%set(htext, 'Color',[0 1 0])
%set(htext, 'FontSize',30)
htext = text(4.3,3.8,'day 7---','interpreter','latex')
set(htext, 'Color',[0.4 0.4 0.4])
set(htext, 'FontSize',30)
htext = text(4.3,3.6,'day 16---','interpreter','latex')
set(htext, 'Color',[0.5 0.5 1])
set(htext, 'FontSize',30)
htext = text(4.3,3.4,'day 30---','interpreter','latex')
set(htext, 'Color',[1 0.45 0])
set(htext, 'FontSize',30)
htext = text(4.3,3.2,'day 52 - -','interpreter','latex')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',30)
htext = text(4.3,3.0,'day 76 - -','interpreter','latex')
set(htext, 'Color',[0.211 0.149 0.597])
set(htext, 'FontSize',30)
%htext = text(4.3,2.8,'day 77---','interpreter','latex')
%set(htext, 'Color',[0.3 0.3 0.3])
%set(htext, 'FontSize',30)
%htext = text(4.3,2.6,'day 88 - -','interpreter','latex')
%set(htext, 'Color',[0 0.66 0])
%set(htext, 'FontSize',30)
htext = text(4.3,2.8,'day 119---','interpreter','latex')
set(htext, 'Color',[0 0.5 0])
set(htext, 'FontSize',30)
%htext = text(4.3,2.4,'day 137---','interpreter','latex')
%set(htext, 'Color',[1 0 1])
%set(htext, 'FontSize',30)
%htext = text(4.3,2.2,'day 152---','interpreter','latex')
%set(htext, 'Color',[0.9 0.9 0.9])
%set(htext, 'FontSize',30)
htext = text(4.3,2.6,'day 289---','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',30)
htext = text(-13,3.2,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-13,3.6,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

%export_fig HalphaVaryContFit.pdf -pdf

saveas(plotting, ['HalphaVaryContFit.eps'], 'epsc');
eval(['!epstopdf HalphaVaryContFit.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);



%%%just host galaxy light

%%%Halpha unaltered ContFit
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
set(plotting,'Position',[0 0 0.9 1]);

clf
plot(velHalpha_20150521(find(keckD1_20150521>6000 & keckD1_20150521 < 7100))/10^3,smooth(10*(1*keckD2_20150521_halphacontfitnormsub(find(keckD1_20150521>6000 & keckD1_20150521 < 7100)))),'LineWidth',3,'Color',[1 0.45 0])
hold all
plot(velHalpha_20121115(find(keckD1_20121115>6000 & keckD1_20121115 < 7100))/10^3,(1.05*keckD2_20121115_halphacontfitnormsub(find(keckD1_20121115>6000 & keckD1_20121115 < 7100))),'LineWidth',3,'Color',[0 0 0])
xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
line([-20 20],[0 0],'LineStyle','--','Color',[0.5 0.5 1],'LineWidth',3)
%title('', 'FontSize',25)
axis([[-20 20] [-.5 4]])

htext = text(2.3,3.0,'day 289---','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',30)
htext = text(2.3,2.8,'day 1206---','interpreter','latex')
set(htext, 'Color',[1 0.45 0])
set(htext, 'FontSize',30)
htext = text(-13,3.2,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-13,3.6,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig HalphaVaryContFitGalaxy.pdf -pdf

saveas(plotting, ['HalphaVaryContFitGalaxy.eps'], 'epsc');
eval(['!epstopdf HalphaVaryContFitGalaxy.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);














%%%plotting Halpha and Hbeta of day 289 and 137 spectra
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 1.5 1.5]);
set(plotting,'Position',[0 0 0.37 1]);

clf
set(gcf,'color','w');
semilogy(velHalpha_20150521(find(keckD1_20150521>6000 & keckD1_20150521 < 7100))/10^3,2+smooth(6*(1*keckD2_20150521_halphacontfitnormsub(find(keckD1_20150521>6000 & keckD1_20150521 < 7100)))),'LineWidth',1,'Color',[0.80 0.80 0.80])
hold all
semilogy(velHalpha_20120616(find(keckL1_20120616>5800 & keckL1_20120616 < 7200))/10^3,2+(keckL2_20120616_halphacontfitnormsub(find(keckL1_20120616>5800 & keckL1_20120616 < 7200))),'LineWidth',2,'Color',[0 0 0])

semilogy(velHalpha_20121115(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))/10^3,2+(keckD2_20121115_halphacontfitnormsub(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))),'LineWidth',2,'Color',[1 0 0])
semilogy(velHbeta_20120616(find(keckL1_20120616>4100 & keckL1_20120616 < 5500))/10^3,1+keckL2_20120616_hbetacontfitnormsub(find(keckL1_20120616>4100 & keckL1_20120616 < 5500)),'LineWidth',2,'Color',[0 0 0])
semilogy(velHbeta_20121115(find(keckD1_20121115>4100 & keckD1_20121115 < 5500))/10^3+0.45,1+keckD2_20121115_hbetacontfitnormsub(find(keckD1_20121115>4100 & keckD1_20121115 < 5500)),'LineWidth',2,'Color',[1 0 0])

xlabel('Doppler velocity (10^3 km/s)','FontSize',24,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled) + Constant','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 25)
line([-20 25],[1 1],'LineStyle','--','Color',[0.5 0.5 1],'LineWidth',3)
line([-20 25],[2 2],'LineStyle','--','Color',[0.5 0.5 1],'LineWidth',3)
axis([[-20 20] [0.8 10]])
%line([-20 20],[1 1],'LineStyle','--','Color',[0 0 0])
htext = text(-17,6,'day 137 ---','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',21)
htext = text(-17,5,'day 289 ---','interpreter','latex')
set(htext, 'Color',[1 0 0])
set(htext, 'FontSize',21)
htext = text(-17,4,'day 1206 ---','interpreter','latex')
set(htext, 'Color',[0.75 0.75 0.75])
set(htext, 'FontSize',21)
htext = text(-17,1.3,'H$\beta$','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',21)
htext = text(-17,2.5,'H$\alpha$','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',21)
htext = text(-18,7.5,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',25)
htext = text(-28.3,3,'.','interpreter','latex','Color',[0.9 0.9 0.9])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig Halphabetanew.pdf -pdf

%saveas(plotting, ['Halphabetanew.eps'], 'epsc');
%eval(['!epstopdf Halphabetanew.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);




%%%worse nonlog version of the plot
clf
semilogy(linspace(1,100,length(keckD2_20121115_contscaled)),keckD2_20121115_contscaled*12)
hold all
semilogy(linspace(1,100,length(keckD2_20121115_halphacontnorm)),keckD2_20121115_halphacontnorm)
axis([[25 65] [-inf inf]])


clf
semilogy(linspace(1,100,length(keckD2_20121115_contscaled(find(keckD1_20121115>5800 & keckD1_20121115 < 7200)))),keckD2_20121115_contscaled(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))*12)
hold all
semilogy(linspace(1,100,length(keckD2_20121115_halphacontnorm(find(keckD1_20121115>5800 & keckD1_20121115 < 7200)))),keckD2_20121115_halphacontnorm(find(keckD1_20121115>5800 & keckD1_20121115 < 7200)))
axis([[-inf inf] [-inf inf]])



clf
semilogy(velHalpha_20121115(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))/10^3,2*(keckD2_20121115_contscaled(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))),'LineWidth',2,'Color',[1 0 0])
hold all
semilogy(velHalpha_20121115(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))/10^3,2*(keckD2_20121115_halphacontnorm(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))),'LineWidth',2,'Color',[1 1 0])


%%%plotting Halpha and Hbeta of day 289 and 137 spectra
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 1.5 1.5]);
clf
hold all

plot(velHalpha_20120616(find(keckL1_20120616>5800 & keckL1_20120616 < 7200))/10^3,2*(-0.9+keckL2_20120616_halphacontnorm(find(keckL1_20120616>5800 & keckL1_20120616 < 7200))),'LineWidth',2,'Color',[0 0 0])
plot(velHalpha_20121115(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))/10^3,2*(-0.9+keckD2_20121115_halphacontnorm(find(keckD1_20121115>5800 & keckD1_20121115 < 7200))),'LineWidth',2,'Color',[1 0 0])
plot(velHbeta_20120616(find(keckL1_20120616>4100 & keckL1_20120616 < 5500))/10^3,-4+4*keckL2_20120616_hbetacontnorm(find(keckL1_20120616>4100 & keckL1_20120616 < 5500)),'LineWidth',2,'Color',[0.5 0.5 0.5])
plot(velHbeta_20121115(find(keckD1_20121115>4100 & keckD1_20121115 < 5500))/10^3+0.45,-4+4*keckD2_20121115_hbetacontnorm(find(keckD1_20121115>4100 & keckD1_20121115 < 5500)),'LineWidth',2,'Color',[0.65 0.20 0.65])
xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize', 25)
axis([[-16 16] [-1 8]])
%line([-20 20],[1 1],'LineStyle','--','Color',[0 0 0])
htext = text(4.5,7,'day 137 H$\alpha$---','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',24)
htext = text(4.5,6.7,'day 289 H$\alpha$---','interpreter','latex')
set(htext, 'Color',[0 1 1])
set(htext, 'FontSize',24)
htext = text(10,7,'day 137 H$\beta$---','interpreter','latex')
set(htext, 'Color',[0.5 0.5 0.5])
set(htext, 'FontSize',24)
htext = text(10,6.7,'day 289 H$\beta$---','interpreter','latex')
set(htext, 'Color',[0 0 1])
set(htext, 'FontSize',24)
%htext = text(-0.025,0.75,'H\alpha ')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',28)
htext = text(-14,7,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',30)
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',32)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig Halphabetanew.pdf -pdf

saveas(plotting, ['Halphabetanew.eps'], 'epsc');
eval(['!epstopdf Halphabetanew.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);



%new EW-Flux plot
reldateredrem5 = reldatered([1:4,6:length(reldatered)]);
EWhighrem5 = EWhigh([1:4,6:length(EWhigh)]);
dEWhighrem5 = dEWhigh([1:4,6:length(dEWhigh)]);


%additional estimates being included in this version:

bestestEWhigh 
bestestNEWerr 
bestestdEWhighreal = bestestdEWhigh*1.5
estEWhigh
estNEWerr
estdEWhigh




EWhighoverall = [EWhighrem5(1:3) bestestEWhigh(1:4) EWhighrem5(4) bestestEWhigh(5) EWhighrem5(5:8)]
dEWhighoverall = [dEWhighrem5(1:3) bestestdEWhighreal(1:4) dEWhighrem5(4) bestestdEWhighreal(5) dEWhighrem5(5:8)]
reldatebestest = [reldate(2) reldate(4) reldate(5) reldate(7) reldate(9)]
tempreldatesorted = sort(reldate);
reldateoverall = tempreldatesorted(2:end)
bestestdEWhighlowbar = bestestEWhigh-estEWhigh;



set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(plotting,'defaultAxesColorOrder',[[0 0 0]; [0 0 0]]);
clf
plt1 = errorbar(reldateredrem5,EWhighrem5,dEWhighrem5,'LineWidth',2,'Color',[0 0 0.5],'LineStyle','none','Marker','o','MarkerSize',13)
plt1.Color = [0 0 0.5];
hold on
plot(reldateredrem5,EWhighrem5,'MarkerFaceColor',[0 0.5 0],'Color',[0 0.5 0],'LineStyle','none','Marker','o','MarkerSize',15)
plt2 = errorbar(reldatebestest,bestestEWhigh,bestestdEWhighlowbar,bestestdEWhighreal,'LineWidth',2,'Color',[0 0 0.5],'LineStyle','none','Marker','o','MarkerSize',15)
plt2.Color = [0 0 0.5];
plot(reldatebestest,bestestEWhigh,'Marker','o','Color',[0 0.5 0],'LineStyle','none','LineWidth',3,'MarkerSize',15)
plt3 = scatter(reldatebestest,estEWhigh,125,'^','MarkerFaceColor',[0 0 0.5],'MarkerEdgeColor',[0 0 0.5])
%plt1 = errorbar(reldateoverall,EWhighoverall,dEWhighoverall,'LineWidth',3,'Color',[0 0.5 0],'LineStyle','none','Marker','^','MarkerSize',15,'MarkerFaceColor',[0 0.5 0])
set(gca,'YScale','log')
set(gca,'XScale','log')
set(gca,'box','on')
htext = text(20,400,'H$\alpha$','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',44)
axis([[10 1400] [15 600]])
xlabel(gca,'Days Relative to Discovery','interpreter','latex','FontSize',50)
ylabel(gca,'Equivalent Width (\AA)','interpreter','latex','FontSize',50)
set(gca,'FontSize',40)

export_fig C:\Users\Cbilinski\Desktop\Figures\HalphaEWFluxhigh.pdf -pdf

%saveas(plotting, ['HalphaEWFluxhigh.eps'], 'epsc');
%eval(['!epstopdf HalphaEWFluxhigh.eps']);



























reldateredrem5scale = reldateredrem5./max(reldateredrem5);
EWhighrem5scale = EWhighrem5./max(EWhighrem5);
dEWhighrem5scale = dEWhighrem5./max(EWhighrem5);













set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(plotting,'defaultAxesColorOrder',[[0 0 0]; [0 0 0]]);
clf
plt1 = errorbar(reldateredrem5scale,EWhighrem5scale,dEWhighrem5scale,'LineWidth',3,'Color',[0 0.5 0],'Marker','^','MarkerSize',15,'MarkerFaceColor',[0 0.5 0])
hold on
set(gca,'box','on')
htext = text(0.05,0.9,'H$\alpha$','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',44)
axis([[0 1.05*reldateredrem5(length(reldateredrem5)-1)/max(reldateredrem5)] [0 1.05]])
hL = legend([plt1 ],'Equivalent Width','Flux Estimate','Location','Southeast')
set(hL,'box','off')
set(hL,'FontSize',50)
xlabel(gca,'Days Relative to Discovery','interpreter','latex','FontSize',50)
ylabel(gca,'Equivalent Width (\AA)','interpreter','latex','FontSize',50)
xticks(0:50./max(reldateredrem5):round(reldateredrem5(length(reldateredrem5)-1),-2)./max(reldateredrem5))
xticklabels(0:50:round(reldateredrem5(length(reldateredrem5)-1),-2))
yticks(0:50./max(EWhighrem5):round(max(EWhighrem5),-2)/max(EWhighrem5))
yticklabels(0:50:round(max(EWhighrem5),-2))
set(gca,'FontSize',30)

export_fig C:\Users\Cbilinski\Desktop\Figures\HalphaEWFluxhigh.pdf -pdf

%saveas(plotting, ['HalphaEWFluxhigh.eps'], 'epsc');
%eval(['!epstopdf HalphaEWFluxhigh.eps']);










































%preserved old version


%new EW-Flux plot
reldateredrem5 = reldatered([1:4,6:length(reldatered)]);
Fluxhighrem5 = Fluxhigh([1:4,6:length(Fluxhigh)]);
dFluxhighrem5 = dFluxhigh([1:4,6:length(dFluxhigh)]);
EWhighrem5 = EWhigh([1:4,6:length(EWhigh)]);
dEWhighrem5 = dEWhigh([1:4,6:length(dEWhigh)]);


%new method with 50% higher UL and LL set by last date of photometry and last date of spectra.
aj(1) = 1380*FR_20120216/fluxestRhetms2_20120216;
aj(2) = 1380*FR_20120223/fluxestRLkast2_20120223;
aj(3) = 1380*FR_20120301_2/fluxestRhetms2_20120301;
aj(4) = 1380*FR_20120323/fluxestRspolb2_20120323;

Fluxhighrem5(1) = Fluxhighrem5(1) * aj(1);
Fluxhighrem5(2) = Fluxhighrem5(2) * aj(2);
Fluxhighrem5(3) = Fluxhighrem5(3) * aj(3);
Fluxhighrem5(4) = Fluxhighrem5(4) * aj(4);

dFluxhighrem5(1) = dFluxhighrem5(1) * aj(1);
dFluxhighrem5(2) = dFluxhighrem5(2) * aj(2);
dFluxhighrem5(3) = dFluxhighrem5(3) * aj(3);
dFluxhighrem5(4) = dFluxhighrem5(4) * aj(4);

%minfluxcont = Fluxhighrem5(length(Fluxhighrem5))/EWhighrem5(length(EWhighrem5));
%this minfluxcont below is the averaged flux per angstrom in the R band at the very end, meaning that each EW we measure on any other day must have at least this much flux.
minfluxcont = fluxestRkeckD2_20150521/1380;
%unfortunately the data values make no sense with that last flux, so lets try using the last comparable one;
maxfluxcont = 1380*FR_20120323;

errlow(5) = Fluxhighrem5(5) - (EWhighrem5(5)*minfluxcont);
errlow(6) = Fluxhighrem5(6) - (EWhighrem5(6)*minfluxcont);
errlow(7) = Fluxhighrem5(7) - (EWhighrem5(7)*minfluxcont);

%upper limit is 1380*lastflux/fluxest * fluxhighmeasured

errhigh(5) = (maxfluxcont/fluxestRLkast2_20120428 * Fluxhighrem5(5) - Fluxhighrem5(5));
errhigh(6) = (maxfluxcont/fluxestRkeckL2_20120616 * Fluxhighrem5(6) - Fluxhighrem5(6));
errhigh(7) = (maxfluxcont/fluxestRkeckD2_20121115 * Fluxhighrem5(7) - Fluxhighrem5(7));

dlowFluxhighrem5 = [dFluxhighrem5(1) dFluxhighrem5(2) dFluxhighrem5(3) dFluxhighrem5(4) errlow(5) errlow(6) errlow(7) dFluxhighrem5(8)*1.5]
dhighFluxhighrem5 = [dFluxhighrem5(1) dFluxhighrem5(2) dFluxhighrem5(3) dFluxhighrem5(4) errhigh(5) errhigh(6) errhigh(7) dFluxhighrem5(8)*1.5]


reldateredrem5scale = reldateredrem5./max(reldateredrem5);
Fluxhighrem5scale = Fluxhighrem5./max(Fluxhighrem5);
dFluxhighrem5scale = dFluxhighrem5./max(Fluxhighrem5);
EWhighrem5scale = EWhighrem5./max(EWhighrem5);
dEWhighrem5scale = dEWhighrem5./max(EWhighrem5);
dlowFluxhighrem5scale = dlowFluxhighrem5./max(Fluxhighrem5);
dhighFluxhighrem5scale = dhighFluxhighrem5./max(Fluxhighrem5);





set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(plotting,'defaultAxesColorOrder',[[0 0 0]; [0 0 0]]);
clf
plt1 = errorbar(reldateredrem5scale,EWhighrem5scale,dEWhighrem5scale,'LineWidth',3,'Color',[0 0.5 0],'Marker','^','MarkerSize',15,'MarkerFaceColor',[0 0.5 0])
hold on
plt2 = errorbar(reldateredrem5scale(1:4),Fluxhighrem5scale(1:4),dlowFluxhighrem5scale(1:4),dhighFluxhighrem5scale(1:4),'LineWidth',3,'Color',[0 0 1],'Marker','s','MarkerSize',15,'MarkerFaceColor',[0 0 1])
plt3 = errorbar(reldateredrem5scale(5:8),Fluxhighrem5scale(5:8),dlowFluxhighrem5scale(5:8),dhighFluxhighrem5scale(5:8),'LineStyle','--','LineWidth',1,'Color',[0 0 1],'Marker','o','MarkerSize',15,'MarkerFaceColor',[1 1 1],'MarkerEdgeColor',[0 0 1])
set(gca,'box','on')
htext = text(0.05,0.9,'H$\alpha$','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',44)
axis([[0 1.05*reldateredrem5(length(reldateredrem5)-1)/max(reldateredrem5)] [0 1.05]])
hL = legend([plt1 plt2 plt3],'Equivalent Width','Photometry-Calibrated Flux','Flux Estimate','Location','Southeast')
set(hL,'box','off')
set(hL,'FontSize',50)
xlabel(gca,'Days Relative to Discovery','interpreter','latex','FontSize',50)
ylabel(gca,'Equivalent Width (\AA)','interpreter','latex','FontSize',50)
xticks(0:50./max(reldateredrem5):round(reldateredrem5(length(reldateredrem5)-1),-2)./max(reldateredrem5))
xticklabels(0:50:round(reldateredrem5(length(reldateredrem5)-1),-2))
yticks(0:50./max(EWhighrem5):round(max(EWhighrem5),-2)/max(EWhighrem5))
yticklabels(0:50:round(max(EWhighrem5),-2))
yyaxis right
ylabel(gca,'Flux (10^{-13} erg s^{-1} cm^{-2})','FontSize',50,'FontName','CMU Serif Roman')
axis([[0 1.05*reldateredrem5(length(reldateredrem5)-1)/max(reldateredrem5)] [0 1.05]])
yticks(0:0.5*10^-13/max(Fluxhighrem5):round(max(Fluxhighrem5),13)/max(Fluxhighrem5))
yticklabels(0:0.5:round(max(Fluxhighrem5),13)*10^13)
set(gca,'FontSize',30)

export_fig C:\Users\Cbilinski\Desktop\Figures\HalphaEWFluxhigh.pdf -pdf

%saveas(plotting, ['HalphaEWFluxhigh.eps'], 'epsc');
%eval(['!epstopdf HalphaEWFluxhigh.eps']);












































%adjustment of first 4 points to photometry constraints
%aj(1) = FR_20120216/fluxestRhetms2_20120216;
%aj(2) = FR_20120223/fluxestRLkast2_20120223;
%aj(3) = FR_20120301_2/fluxestRhetms2_20120301;
%aj(4) = FR_20120323/fluxestRspolb2_20120323;
%lateaj = aj(4)/mean(aj);
%%lateaj = fluxestRLkast2_20120428/fluxestRspolb2_20120323;
%
%Fluxhighrem5scale(1) = Fluxhighrem5scale(1) * aj(1)/mean(aj);
%Fluxhighrem5scale(2) = Fluxhighrem5scale(2) * aj(2)/mean(aj);
%Fluxhighrem5scale(3) = Fluxhighrem5scale(3) * aj(3)/mean(aj);
%Fluxhighrem5scale(4) = Fluxhighrem5scale(4) * aj(4)/mean(aj);
%Fluxhighrem5scale(5:length(Fluxhighrem5scale)) = Fluxhighrem5scale(5:length(Fluxhighrem5scale)) * lateaj;
%
%dFluxhighrem5scale(1) = dFluxhighrem5scale(1) * aj(1)/mean(aj)
%dFluxhighrem5scale(2) = dFluxhighrem5scale(2) * aj(2)/mean(aj)
%dFluxhighrem5scale(3) = dFluxhighrem5scale(3) * aj(3)/mean(aj)
%dFluxhighrem5scale(4) = dFluxhighrem5scale(4) * aj(4)/mean(aj)
%dFluxhighrem5scale(5:length(dFluxhighrem5scale)) = dFluxhighrem5scale(5:length(dFluxhighrem5scale)) * lateaj;
%
%Fluxhighrem5scaleagain = Fluxhighrem5scale./max(Fluxhighrem5scale);
%dFluxhighrem5scaleagain = dFluxhighrem5scale./max(Fluxhighrem5scale);


set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(plotting,'defaultAxesColorOrder',[[0 0 0]; [0 0 0]]);
clf
plt1 = errorbar(reldateredrem5scale,EWhighrem5scale,dEWhighrem5scale,'LineWidth',3,'Color',[0 0.5 0],'Marker','^','MarkerSize',15,'MarkerFaceColor',[0 0.5 0])
hold on
plt2 = errorbar(reldateredrem5scale,Fluxhighrem5scaleagain,dFluxhighrem5scaleagain,'LineWidth',3,'Color',[0 0 1],'Marker','s','MarkerSize',15,'MarkerFaceColor',[0 0 1])
set(gca,'box','on')
htext = text(0.05,0.9,'H$\alpha$','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',44)
axis([[0 1.05*reldateredrem5(length(reldateredrem5)-1)/max(reldateredrem5)] [0 1.05]])
hL = legend([plt1 plt2],'Equivalent Width','Flux','Location','Northeast')
set(hL,'box','off')
set(hL,'FontSize',50)
xlabel(gca,'Days Relative to Discovery','interpreter','latex','FontSize',50)
ylabel(gca,'Equivalent Width (\AA)','interpreter','latex','FontSize',50)
xticks(0:50./max(reldateredrem5):round(reldateredrem5(length(reldateredrem5)-1),-2)./max(reldateredrem5))
xticklabels(0:50:round(reldateredrem5(length(reldateredrem5)-1),-2))
yticks(0:50./max(EWhighrem5):round(max(EWhighrem5),-2)/max(EWhighrem5))
yticklabels(0:50:round(max(EWhighrem5),-2))
yyaxis right
ylabel(gca,'Flux (10^{-13} erg s^{-1} cm^{-2})','FontSize',50,'FontName','CMU Serif Roman')
axis([[0 1.05*reldateredrem5(length(reldateredrem5)-1)/max(reldateredrem5)] [0 1.05]])
yticks(0:0.5/5:1/5*10^13*round(max(Fluxhighrem5scale)*max(Fluxhighrem5),13))
yticklabels(0:0.5:round(max(Fluxhighrem5scale)*max(Fluxhighrem5),13)*10^13)
set(gca,'FontSize',30)

export_fig C:\Users\Cbilinski\Desktop\Figures\HalphaEWFluxhigh.pdf -pdf

%saveas(plotting, ['HalphaEWFluxhigh.eps'], 'epsc');
%eval(['!epstopdf HalphaEWFluxhigh.eps']);































%%%old stuff



%%%
%%fit galaxy spectrum to 289 spectrum and subtract shape from other spectra

median(hetms2_20120207_contscaled(find(hetms1_20120207>5950 & hetms1_20120216<6200)))
median(hetms2_20120216_contscaled(find(hetms1_20120216>5950 & hetms1_20120216<6200)))
median(Lkast2_20120223_contscaled(find(Lkast1_20120223>5950 & Lkast1_20120223<6200)))
median(hetms2_20120301_contscaled(find(hetms1_20120301>5950 & hetms1_20120301<6200)))
median(mmtbc2_20120301_contscaled(find(mmtbc1_20120301>5950 & mmtbc1_20120301<6200)))
median(spolb2_20120323_contscaled(find(spolb1_20120323>5950 & spolb1_20120323<6200)))
median(spolm2_20120416_contscaled(find(spolm1_20120416>5950 & spolm1_20120416<6200)))
median(mmtbc2_20120417_contscaled(find(mmtbc1_20120417>5950 & mmtbc1_20120417<6200)))
median(Lkast2_20120428_contscaled(find(Lkast1_20120428>5950 & Lkast1_20120428<6200)))
median(mmtbc2_20120529_contscaled(find(mmtbc1_20120529>5950 & mmtbc1_20120529<6200)))
median(keckL2_20120616_contscaled(find(keckL1_20120616>5950 & keckL1_20120616<6200)))
median(mmtbc2_20120701_contscaled(find(mmtbc1_20120701>5950 & mmtbc1_20120701<6200)))
median(keckD2_20121115_contscaled(find(keckD1_20121115>5950 & keckD1_20121115<6200)))
median(keckD2_20150521_contscaled(find(keckD1_20150521>5950 & keckD1_20150521<6200)))














reldateredrem5 = reldatered([1:4,6:length(reldatered)]);
Fluxhighrem5 = Fluxhigh([1:4,6:length(Fluxhigh)]);
dFluxhighrem5 = dFluxhigh([1:4,6:length(dFluxhigh)]);
EWhighrem5 = EWhigh([1:4,6:length(EWhigh)]);
dEWhighrem5 = dEWhigh([1:4,6:length(dEWhigh)]);

%%%Equivalent width and Flux of Halpha Plots

set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
clf
plt1 = errorbar(reldateredrem5,Fluxhighrem5./10^(-13),dFluxhighrem5./10^(-13),'LineWidth',3,'Color',[0 0 1],'Marker','s','MarkerSize',15,'MarkerFaceColor',[0 0 1])
axis([[0 300] [0 500]])
%set(gca,'box','off')
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
hold on
plt2 = errorbar(reldateredrem5,EWhighrem5,dEWhighrem5,'Parent',ax2,'LineWidth',3,'Color',[0 0.5 0],'Marker','d','MarkerSize',15,'MarkerFaceColor',[0 0.5 0])
hL = legend([plt1 plt2],'Flux','Equivalent Width','Location','Northwest')
set(hL,'box','off')
set(ax1,'YAxisLocation','right','XAxisLocation','top','xtick',[],'YLim',[0-min(Fluxhighrem5)*0.5 max(Fluxhighrem5)*1.25/10^(-13)])
set(ax2,'YAxisLocation','left','XAxisLocation','bottom','YLim',[0-min(EWhighrem5)*0.5 max(EWhighrem5)*1.25])
set(ax1,'FontSize',30)
set(ax2,'FontSize',30)
axis([[0 300] [0 500]])
ylabel(ax1,'Flux (10^{-13} erg s^{-1} cm^{-2})','FontSize',34,'FontName','CMU Serif Roman')
xlabel(ax1,'')
xlabel(ax2,'Days Relative to Discovery','interpreter','latex','FontSize',34)
ylabel(ax2,'Equivalent Width (\AA)','interpreter','latex','FontSize',34)
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax2,'XMinorTick','on','YMinorTick','on')
htext = text(-28,200,'.','interpreter','latex','Color',[0.9 0.9 0.9])
htext = text(330,200,'.','interpreter','latex','Color',[0.9 0.9 0.9])

export_fig HalphaEQFluxhigh.pdf -pdf

%saveas(plotting, ['HalphaEQFluxhigh.eps'], 'epsc');
%eval(['!epstopdf HalphaEQFluxhigh.eps']);







%%%Equivalent width and Flux of Halpha Plots

set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
clf
plt1 = errorbar(reldatered,EWhigh,dEWhigh,'Parent',ax2,'LineWidth',3,'Color',[0 0.5 0],'Marker','d','MarkerSize',15,'MarkerFaceColor',[0 0.5 0])
ax1 = gca;
set(ax1,'box','off','color','none')
boxax = axes('Position',get(ax1,'Position'),'box','on','xtick',[],'ytick',[]);
axes(ax1)
linkaxes([ax1 boxax])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
hold on
plt2 = errorbar(reldatered,Fluxhigh./10^(-13),dFluxhigh./10^(-13),'LineWidth',3,'Color',[0 0 1],'Marker','s','MarkerSize',15,'MarkerFaceColor',[0 0 1])
hL = legend([plt1 plt2],'Equivalent Width','Flux','Location','Northwest')
set(hL,'box','off')
set(ax2,'xtick',[],'YLim',[min(Fluxhigh)-max(Fluxhigh)*0.25/10^(-13) max(Fluxhigh)*1.25/10^(-13)])
set(ax1,'YAxisLocation','left','XAxisLocation','bottom','YLim',[min(EWhigh)-max(EWhigh)*0.25 max(EWhigh)*1.25])
set(ax1,'FontSize',30)
set(ax2,'FontSize',30)
ylabel(ax2,'Flux (10^{-13} erg s^{-1} cm^{-2})','FontSize',34,'FontName','CMU Serif Roman')
xlabel(ax2,'')
xlabel(ax1,'Days Relative to Discovery','interpreter','latex','FontSize',34)
htext = text(-28,0.36,'Equivalent Width (\AA)','interpreter','latex','Color',[0 0 0],'FontSize',34)
set(htext, 'rotation', 90)
%ylabel(ax1,'Equivalent Width (\AA)','interpreter','latex','FontSize',34)

set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax2,'XMinorTick','on','YMinorTick','on')
htext = text(-28,1,'.','interpreter','latex','Color',[0.9 0.9 0.9])
htext = text(330,1,'.','interpreter','latex','Color',[0.9 0.9 0.9])

export_fig HalphaEQFluxhigh.pdf -pdf

%saveas(plotting, ['HalphaEQFluxhigh.eps'], 'epsc');
%eval(['!epstopdf HalphaEQFluxhigh.eps']);



















clf
plt1 = errorbar(reldatered,Fluxlow,dFluxlow,'LineWidth',3,'Color',[0 0 1])
set(gca,'box','off')
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
hold on
plt2 = errorbar(reldatered,EWlow,dEWlow,'Parent',ax2,'LineWidth',3,'Color',[0 0.5 0])
set(ax1,'YAxisLocation','right','XAxisLocation','top','xtick',[],'YLim',[min(Fluxlow)-max(Fluxlow)*0.25 max(Fluxlow)*1.25])
set(ax2,'YAxisLocation','left','XAxisLocation','bottom','YLim',[min(EWlow)-max(EWlow)*0.25 max(EWlow)*1.25])
set(ax1,'FontSize',16)
set(ax2,'FontSize',16)
ylabel(ax1,'Flux','interpreter','latex','FontSize',24)
xlabel(ax1,'')
xlabel(ax2,'Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel(ax2,'Equivalent Width (\AA)','interpreter','latex','FontSize',24)
legend([plt1 plt2],'Flux','Equivalent Width','Location','Northwest')

saveas(plotting, ['HalphaEQFluxlow.eps'], 'epsc');
eval(['!epstopdf HalphaEQFluxlow.eps']);







%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
%ax3 = axes('Position',get(ax1,'Position'),'YAxisLocation','left','XAxisLocation','top','Color','none');
%set(ax3,'xtick',[],'ytick',[])

saveas(plotting, ['EWhigh.eps'], 'epsc');
eval(['!epstopdf EWhigh.eps']);

clf
plot(reldatered,Fluxhigh,'LineWidth',3)
errorbar(reldatered,Fluxhigh,dFluxhigh,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Broad H$\alpha$ Line Flux ($erg cm^2 s^{-1} \AA^{-1}$)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['Fluxhigh.eps'], 'epsc');
eval(['!epstopdf Fluxhigh.eps']);

clf
plot(reldatered,EWlow,'LineWidth',3)
errorbar(reldatered,EWlow,dEWlow,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Narrow H$\alpha$ Line Equivalent Width (\AA)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['EWlow.eps'], 'epsc');
eval(['!epstopdf EWlow.eps']);

clf
plot(reldatered,Fluxlow,'LineWidth',3)
errorbar(reldatered,Fluxlow,dFluxlow,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Narrow H$\alpha$ Line Flux ($erg cm^2 s^{-1} \AA^{-1}$)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['Fluxlow.eps'], 'epsc');
eval(['!epstopdf Fluxlow.eps']);

















%%%Equivalent width and Flux of Halpha Plots
clf
plot(reldatered,EWhigh,'LineWidth',3)
errorbar(reldatered,EWhigh,dEWhigh,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Broad H$\alpha$ Line Equivalent Width (\AA)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['EWhigh.eps'], 'epsc');
eval(['!epstopdf EWhigh.eps']);

clf
plot(reldatered,Fluxhigh,'LineWidth',3)
errorbar(reldatered,Fluxhigh,dFluxhigh,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Broad H$\alpha$ Line Flux ($erg cm^2 s^{-1} \AA^{-1}$)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['Fluxhigh.eps'], 'epsc');
eval(['!epstopdf Fluxhigh.eps']);

clf
plot(reldatered,EWlow,'LineWidth',3)
errorbar(reldatered,EWlow,dEWlow,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Narrow H$\alpha$ Line Equivalent Width (\AA)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['EWlow.eps'], 'epsc');
eval(['!epstopdf EWlow.eps']);

clf
plot(reldatered,Fluxlow,'LineWidth',3)
errorbar(reldatered,Fluxlow,dFluxlow,'LineWidth',3)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',24)
ylabel('Narrow H$\alpha$ Line Flux ($erg cm^2 s^{-1} \AA^{-1}$)','interpreter','latex','FontSize',24)
%title('', 'FontSize', 25)
%axis([[-7 7] [-0.5 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
saveas(plotting, ['Fluxlow.eps'], 'epsc');
eval(['!epstopdf Fluxlow.eps']);




set(gcf,'color','w');


%~day 44 spectrum
set(gcf,'color','w');
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
set(plotting,'Position',[0 0 0.9 1]);
clf
semilogy(mmtbc1_20120301,mmtbc2_20120301_contscaled,'LineWidth',2,'Color',[0 0 0])
hold all
semilogy(spec2003hf20030928(1,:),spec2003hf20030928(3,:)./max(spec2003hf20030928(3,:))*0.5,'LineWidth',2,'Color',[0 0.5 0])
semilogy(spec1999em_day45(1,:),spec1999em_day45(2,:)./max(spec1999em_day45(2,:))*0.5^2*0.86,'LineWidth',2,'Color',[0.65 0.20 0.65])
semilogy(spolb1_20120323,spolb2_20120323_contscaled*0.5^3*0.5,'LineWidth',2,'Color',[0 0 0])
semilogy(spec2010jl20110102(1,:),spec2010jl20110102(3,:)./max(spec2010jl20110102(3,:))*0.5^4*0.85,'LineWidth',2,'Color',[0.5 0.5 1])
semilogy(Lkast1_20120428,Lkast2_20120428_contscaled*0.5^5*0.5,'LineWidth',2,'Color',[0 0 0])
semilogy(keckD1_20121115,keckD2_20121115_contscaled*0.5^6*0.55,'LineWidth',2,'Color',[0 0 0])

line([4101 4101],[1 1.2],'LineStyle','-','Color',[0 0 0])

htext = text(6850,0.5,'SN 2012ab day 30','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',18)
htext = text(6850,0.5^2*1.03,'SN 2003hf (II-L) day 44','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0.5 0])
set(htext, 'FontSize',18)
htext = text(6850,0.5^3*1.09,'SN 1999em (II-P) day 45','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.65 0.20 0.65])
set(htext, 'FontSize',18)
htext = text(6850,0.5^4*0.5,'SN 2012ab day 52','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',18)
htext = text(6850,0.5^5*0.4,'SN 2010jl (IIn) day 59','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.5 0.5 1])
set(htext, 'FontSize',18)
htext = text(6850,0.5^6*0.33,'SN 2012ab day 88','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',18)
htext = text(6850,0.5^7*0.161,'SN 2012ab day 289','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',18)
htext = text(3620,0.01,'.','interpreter','tex','FontName','CMU Serif Roman','Color',[0.9 0.9 0.9])
htext = text(6754,0.029,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(6754,0.57,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

xlabel(['Rest Wavelength (',char(197),')'],'interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('F_\lambda (Scaled) + Constant','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
axis([[4000 9000] [0.0005 1]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig tempcompspec.pdf -pdf


%saveas(plotting, ['tempcompspec.eps'], 'epsc');
%eval(['!epstopdf tempcompspec.eps']);





%SPOL Plots

%QU Plots
ang1=linspace(0,2*pi,100) 
ang2=linspace(0,2*pi,200)
ang3=linspace(0,2*pi,300)
ang4=linspace(0,2*pi,400)
circx1=0.01*cos(ang1);
circy1=0.01*sin(ang1);
circx2=0.02*cos(ang2);
circy2=0.02*sin(ang2);
circx3=0.03*cos(ang3);
circy3=0.03*sin(ang3);
circx4=0.04*cos(ang4);
circy4=0.04*sin(ang4);
cvec = linspace(1,10,length(binedgeq1));
ISPang = linspace(0,2*pi,0.70*100)
ISPcircx = 0.70 * cos(ISPang);
ISPcircy = 0.70 * sin(ISPang);



set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.80 1]);
set(plotting,'Position',[0 0 2.80 1]);
clf
subtightplot(4,2,[1 3 5 7],[0.0,0.0],0.05,0.1)
hold all
scatter(binmeanq(find(binedgep1>4100)).*100,binmeanu(find(binedgep1>4100)).*100,125,cvec(find(binedgep1>4100)),'filled','MarkerEdgeColor','k')
scatter(circx1.*100,circy1.*100,75,'.','MarkerEdgeColor','k')
scatter(circx2.*100,circy2.*100,75,'.','MarkerEdgeColor','k')
scatter(circx3.*100,circy3.*100,75,'.','MarkerEdgeColor','k')
scatter(circx4.*100,circy4.*100,75,'.','MarkerEdgeColor','k')
scatter(ISPcircx,ISPcircy,35,'*','MarkerEdgeColor','b')
htext = text(-0.6,0.10,'ISP $<$ 0.70\%','interpreter','latex')
set(htext, 'Color', 'blue')
set(htext, 'FontSize',24)
htext = text(-2.95,0.5,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
htext = text(-2.95,0.2,'Day 76','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
htext = text(-2.95,-0.1,'MMT','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
line([-4 1],[0 0],'LineStyle','-','Color',[0 0 0])
line([0 0],[-4 1],'LineStyle','-','Color',[0 0 0])
line([6598 6598],[0 100],'LineStyle','--','Color',[0 0 0])
chandle=cline(binmeanq(find(binedgep1>4100)).*100,binmeanu(find(binedgep1>4100)).*100,binmeanq(find(binedgep1>4100)).*100,cvec(find(binedgep1>4100)),'jet');
set(chandle,'linewidth',1);
axis([[-4 1] [-4 1]])
axis square
box on
xlabel('Q (\%)','FontSize',24,'interpreter','latex')
ylabel('U (\%)','FontSize',24,'interpreter','latex')
ax1 = gca;
set(ax1,'XTickMode','manual','XTick',[-4:1])
set(ax1,'YTickMode','manual','YTick',[-4:1])
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1) axpos(2)+axpos(4)*0.05 axpos(3) axpos(4)*0.95])
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',28)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'XTickMode','manual','XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)

subtightplot(4,2,[2],[0.01,0.075],0.05,0.1)
hold all
scatter(binedgep1(find(binedgep1>4100)),binmeanp(find(binedgep1>4100)).*100,75,cvec(find(binedgep1>4100)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [0 0.05.*100]])
blah1 = line([6598 6598],[0 100],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[0 100],'LineStyle','--','Color',[0 0 0])
plot(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*0.095.*100*0.5,'Color',[0.2 0.2 0.2])
filly = (spolm2_20120416/max(spolm2_20120416)*0.095.*100)
fill([spolm1_20120416' max(spolm1_20120416) min(spolm1_20120416) min(spolm1_20120416)],[(spolm2_20120416/max(spolm2_20120416)*0.095.*100*0.5)' 0 0 filly(1)],[0.925 0.925 0.925]);
%area(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*0.095.*100*0.5,'FaceColor',[0.7 0.7 0.7])
%alpha(0.25);
htext = text(6000,4.2,'Day 76','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
ylabel('P (\%)','FontSize',24,'interpreter','latex')
set(gca,'XTickLabel',[]);
chandle=cline(binedgep1(find(binedgep1>4100)),binmeanp(find(binedgep1>4100)).*100,binedgep1(find(binedgep1>4100)),cvec(find(binedgep1>4100)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
set(ax1,'Layer','top')



subtightplot(4,2,[4],[0.01,0.075],0.05,0.1)
hold all
scatter(binedget1(find(binedget1>4100)),binmeant(find(binedget1>4100)),75,cvec(find(binedget1>4100)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [100 150]])
blah1 = line([6598 6598],[0 200],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[0 200],'LineStyle','--','Color',[0 0 0])
plot(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*0.095.*100*4+100,'Color',[0.2 0.2 0.2])
filly = (spolm2_20120416/max(spolm2_20120416)*0.095.*100*4+100)
fill([spolm1_20120416' max(spolm1_20120416) min(spolm1_20120416) min(spolm1_20120416)],[(spolm2_20120416/max(spolm2_20120416)*0.095.*100*4+100)' 100 100 filly(1)],[0.925 0.925 0.925]);
%alpha(0.25);
ylabel('$\theta(^{\circ})$','FontSize',24,'interpreter','latex')
set(gca,'XTickLabel',[]);
chandle=cline(binedget1(find(binedget1>4100)),binmeant(find(binedget1>4100)),binedget1(find(binedget1>4100)),cvec(find(binedget1>4100)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
set(ax1,'Layer','top')

subtightplot(4,2,6,[0.01,0.075],0.05,0.1)
hold all
scatter(binedgeq1(find(binedgep1>4100)),binmeanq(find(binedgep1>4100)).*100,75,cvec(find(binedgep1>4100)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [-0.03.*100 0.01.*100]])
blah1 = line([6598 6598],[-4 3],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[-4 3],'LineStyle','--','Color',[0 0 0])
plot(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*0.095.*100,'Color',[0.2 0.2 0.2])
filly = (spolm2_20120416/max(spolm2_20120416)*0.095.*100)
fill([spolm1_20120416' max(spolm1_20120416) min(spolm1_20120416) min(spolm1_20120416)],[(spolm2_20120416/max(spolm2_20120416)*0.095.*100*0.4-3)' -4 -4 filly(1)],[0.925 0.925 0.925]);
%alpha(0.25);
set(gca,'XTickLabel',[]);
chandle=cline(binedgeq1(find(binedgep1>4100)),binmeanq(find(binedgep1>4100)).*100,binedgeq1(find(binedgep1>4100)),cvec(find(binedgep1>4100)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
ylabel('Q (\%)','FontSize',24,'interpreter','latex')
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'YTickMode','manual','YTick',[-2 0])
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
set(ax1,'Layer','top')

subtightplot(4,2,8,[0.01,0.075],0.05,0.1)
hold all
scatter(binedgeu1(find(binedgep1>4100)),binmeanu(find(binedgep1>4100)).*100,75,cvec(find(binedgep1>4100)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [-0.04.*100 0.01.*100]])
blah1 = line([6598 6598],[-4 3],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[-4 3],'LineStyle','--','Color',[0 0 0])
plot(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*0.095.*100,'Color',[0.2 0.2 0.2])
filly = (spolm2_20120416/max(spolm2_20120416)*0.095.*100)
fill([spolm1_20120416' max(spolm1_20120416) min(spolm1_20120416) min(spolm1_20120416)],[(spolm2_20120416/max(spolm2_20120416)*0.095.*100*0.5-4)' -4 -4 filly(1)],[0.925 0.925 0.925]);
%alpha(0.25);
ylabel('U (\%)','FontSize',24,'interpreter','latex')
%set(gca,'XTickLabel',[]);
chandle=cline(binedgeu1(find(binedgep1>4100)),binmeanu(find(binedgep1>4100)).*100,binedgeu1(find(binedgep1>4100)),cvec(find(binedgep1>4100)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'YTickMode','manual','YTick',[-2 0])
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
xlabel(ax1,'Rest Wavelength ($\AA$) ','interpreter','LaTex','FontSize',24);
set(ax1,'Layer','top')


saveas(plotting, ['QU.eps'], 'epsc');
eval(['!epstopdf QU.eps']);



%for bok now


set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.8 1]);
set(plotting,'Position',[0 0 2.80 1]);
clf
subtightplot(4,2,[1 3 5 7],[0.0,0.0],0.05,0.1)
hold all
scatter(binmeanqbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,binmeanubok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,125,cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'filled','MarkerEdgeColor','k')
scatter(circx1.*100,circy1.*100,75,'.','MarkerEdgeColor','k')
scatter(circx2.*100,circy2.*100,75,'.','MarkerEdgeColor','k')
scatter(circx3.*100,circy3.*100,75,'.','MarkerEdgeColor','k')
scatter(circx4.*100,circy4.*100,75,'.','MarkerEdgeColor','k')
scatter(ISPcircx,ISPcircy,35,'*','MarkerEdgeColor','b')
htext = text(-0.6,0.10,'ISP $<$ 0.70\%','interpreter','latex')
set(htext, 'Color', 'blue')
set(htext, 'FontSize',24)
htext = text(-1.90,0.5,'SN 2012ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
htext = text(-1.90,0.2,'Day 52','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
htext = text(-1.90,-0.1,'Bok','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
line([-3 2],[0 0],'LineStyle','-','Color',[0 0 0])
line([0 0],[-4 1],'LineStyle','-','Color',[0 0 0])
line([6598 6598],[0 100],'LineStyle','--','Color',[0 0 0])
chandle=cline(binmeanqbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,binmeanubok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,binmeanqbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'jet');
set(chandle,'linewidth',1);
axis([[-3 2] [-4 1]])
axis square
box on
xlabel('Q (\%)','FontSize',24,'interpreter','latex')
ylabel('U (\%)','FontSize',24,'interpreter','latex')
ax1 = gca;
set(ax1,'XTickMode','manual','XTick',[-3:2])
set(ax1,'YTickMode','manual','YTick',[-4:1])
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1) axpos(2)+axpos(4)*0.05 axpos(3) axpos(4)*0.95])
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',28)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'XTickMode','manual','XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)

subtightplot(4,2,[2],[0.01,0.075],0.05,0.1)
hold all
scatter(binedgepbok1(find(binedgepbok1>4100 & binedgepbok1<7000)),binmeanpbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,75,cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [0 0.05.*100]])
blah1 = line([6598 6598],[0 100],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[0 100],'LineStyle','--','Color',[0 0 0])
plot(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*0.095.*100*0.5,'Color',[0.2 0.2 0.2])
filly = (spolb2_20120323/max(spolb2_20120323)*0.095.*100)
fill([spolb1_20120323' max(spolb1_20120323) min(spolb1_20120323) min(spolb1_20120323)],[(spolb2_20120323/max(spolb2_20120323)*0.095.*100*0.5)' 0 0 filly(1)],[0.925 0.925 0.925]);
%area(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*0.095.*100*0.5,'FaceColor',[0.7 0.7 0.7])
%alpha(0.25);
htext = text(6000,4.2,'Day 52','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',24)
ylabel('P (\%)','FontSize',24,'interpreter','latex')
set(gca,'XTickLabel',[]);
chandle=cline(binedgepbok1(find(binedgepbok1>4100 & binedgepbok1<7000)),binmeanpbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,binedgepbok1(find(binedgepbok1>4100 & binedgepbok1<7000)),cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
set(ax1,'Layer','top')



subtightplot(4,2,[4],[0.01,0.075],0.05,0.1)
hold all
scatter(binedgetbok1(find(binedgetbok1>4100 & binedgetbok1<7000)),binmeantbok(find(binedgetbok1>4100 & binedgetbok1<7000)),75,cvec(find(binedgetbok1>4100 & binedgetbok1<7000)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [100 150]])
blah1 = line([6598 6598],[0 200],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[0 200],'LineStyle','--','Color',[0 0 0])
plot(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*0.095.*100*4+100,'Color',[0.2 0.2 0.2])
filly = (spolb2_20120323/max(spolb2_20120323)*0.095.*100*4+100)
fill([spolb1_20120323' max(spolb1_20120323) min(spolb1_20120323) min(spolb1_20120323)],[(spolb2_20120323/max(spolb2_20120323)*0.095.*100*4+100)' 100 100 filly(1)],[0.925 0.925 0.925]);
%alpha(0.25);
ylabel('$\theta(^{\circ})$','FontSize',24,'interpreter','latex')
set(gca,'XTickLabel',[]);
chandle=cline(binedgetbok1(find(binedgetbok1>4100 & binedgetbok1<7000)),binmeantbok(find(binedgetbok1>4100 & binedgetbok1<7000)),binedgetbok1(find(binedgetbok1>4100 & binedgetbok1<7000)),cvec(find(binedgetbok1>4100 & binedgetbok1<7000)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
set(ax1,'Layer','top')

subtightplot(4,2,6,[0.01,0.075],0.05,0.1)
hold all
scatter(binedgeqbok1(find(binedgepbok1>4100 & binedgepbok1<7000)),binmeanqbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,75,cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'filled','^','MarkerEdgeColor','k')
axis([[4100 7000] [-0.03.*100 0.01.*100]])
blah1 = line([6598 6598],[-4 3],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[-4 3],'LineStyle','--','Color',[0 0 0])
plot(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*0.095.*100,'Color',[0.2 0.2 0.2])
filly = (spolb2_20120323/max(spolb2_20120323)*0.095.*100)
fill([spolb1_20120323' max(spolb1_20120323) min(spolb1_20120323) min(spolb1_20120323)],[(spolb2_20120323/max(spolb2_20120323)*0.095.*100*0.4-3)' -4 -4 filly(1)],[0.925 0.925 0.925]);
%alpha(0.25);
set(gca,'XTickLabel',[]);
chandle=cline(binedgeqbok1(find(binedgepbok1>4100 & binedgepbok1<7000)),binmeanqbok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,binedgeqbok1(find(binedgepbok1>4100 & binedgepbok1<7000)),cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
ylabel('Q (\%)','FontSize',24,'interpreter','latex')
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'YTickMode','manual','YTick',[-2 0])
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
set(ax1,'Layer','top')


subtightplot(4,2,8,[0.01,0.075],0.05,0.1)
hold all
scatter(binedgeubok1(find(binedgepbok1>4100 & binedgepbok1<7000)),binmeanubok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,75,cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'filled','^','MarkerEdgeColor','k')
blah1 = line([6598 6598],[-4 3],'LineStyle','--','Color',[0 0 0])
blah2 = line([4861 4861],[-4 3],'LineStyle','--','Color',[0 0 0])
plot(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*0.095.*100,'Color',[0.2 0.2 0.2])
filly = (spolb2_20120323/max(spolb2_20120323)*0.095.*100)
fill([spolb1_20120323' max(spolb1_20120323) min(spolb1_20120323) min(spolb1_20120323)],[(spolb2_20120323/max(spolb2_20120323)*0.095.*100*0.5-4)' -4 -4 filly(1)],[0.925 0.925 0.925]);
%alpha(0.25);
ylabel('U (\%)','FontSize',24,'interpreter','latex')
chandle=cline(binedgeubok1(find(binedgepbok1>4100 & binedgepbok1<7000)),binmeanubok(find(binedgepbok1>4100 & binedgepbok1<7000)).*100,binedgeu1(find(binedgepbok1>4100 & binedgepbok1<7000)),cvec(find(binedgepbok1>4100 & binedgepbok1<7000)),'jet');
set(chandle,'linewidth',1);
axis([[4100 7000] [-0.04.*100 0.01.*100]])
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.05 axpos(2)+axpos(4)*0.1 axpos(3)*0.95 axpos(4)*0.92])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'YTickMode','manual','YTick',[-2 0])
set(ax1,'FontSize',20)
set(ax1,'xlim',[4100 7000.1])
xlabel(ax1,'Rest Wavelength ($\AA$) ','interpreter','LaTex','FontSize',24);
set(ax1,'Layer','top')

saveas(plotting, ['QUBok.eps'], 'epsc');
eval(['!epstopdf QUBok.eps']);









set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1]);
set(plotting,'Position',[0 0 3 1]);
clf
subtightplot(4,2,[1 3 5 7],[0.0,0.0],0.05,0.1)
hold on
scatter(binmeanqbok(find(binedgepbok1>4100)).*100,binmeanubok(find(binedgepbok1>4100)).*100,75,cvec(find(binedgepbok1>4100)),'filled','MarkerEdgeColor','k')
scatter(circx125.*100,circy125.*100,25,'.','MarkerEdgeColor','k')
scatter(circx250.*100,circy250.*100,25,'.','MarkerEdgeColor','k')
scatter(circx375.*100,circy375.*100,25,'.','MarkerEdgeColor','k')
scatter(circx500.*100,circy500.*100,25,'.','MarkerEdgeColor','k')
chandle=cline(binmeanqbok(find(binedgepbok1>4100)).*100,binmeanubok(find(binedgepbok1>4100)).*100,binmeanqbok(find(binedgepbok1>4100)).*100,cvec(find(binedgepbok1>4100)),'jet');
set(chandle,'linewidth',1);
axis([[-5 5] [-5 5]])
xlabel('Q (\%)','FontSize',24,'interpreter','latex')
ylabel('U (\%)','FontSize',24,'interpreter','latex')
ax1 = gca;
set(ax1,'XTickLabel',[-5:5])
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1) axpos(2)+axpos(4)*0.05 axpos(3) axpos(4)*0.95])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XTickMode','manual','XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)
hold off

subtightplot(4,2,[2 4],[0.01,0.075],0.05,0.1)
hold on
scatter(binedgepbok1(find(binedgepbok1>4100)),binmeanpbok(find(binedgepbok1>4100)).*100,75,cvec(find(binedgepbok1>4100)),'filled','^','MarkerEdgeColor','k')
plot(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*0.095.*100)
axis([[3750 7250] [0 0.1.*100]])
line([6598 6598],[0 100],'LineStyle','--','Color',[0 0 0])
line([4861 4861],[0 100],'LineStyle','--','Color',[0 0 0])
ylabel('P (\%)','FontSize',24,'interpreter','latex')
set(gca,'XTickLabel',[]);
chandle=cline(binedgepbok1(find(binedgepbok1>4100)),binmeanpbok(find(binedgepbok1>4100)).*100,binedgepbok1(find(binedgepbok1>4100)),cvec(find(binedgepbok1>4100)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1) axpos(2)+axpos(4)*0.05 axpos(3) axpos(4)*0.95])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)
hold off

subtightplot(4,2,6,[0.01,0.075],0.05,0.1)
scatter(binedgeu1(find(binedgepbok1>4100)),binmeanubok(find(binedgepbok1>4100)).*100,75,cvec(find(binedgepbok1>4100)),'filled','^','MarkerEdgeColor','k')
axis([[3750 7250] [-0.06.*100 0.06.*100]])
line([6598 6598],[-0.06.*100 0.06.*100],'LineStyle','--','Color',[0 0 0])
line([4861 4861],[-0.06.*100 0.06.*100],'LineStyle','--','Color',[0 0 0])
ylabel('U (\%)','FontSize',24,'interpreter','latex')
set(gca,'XTickLabel',[]);
chandle=cline(binedgeu1(find(binedgepbok1>4100)),binmeanubok(find(binedgepbok1>4100)).*100,binedgeu1(find(binedgepbok1>4100)),cvec(find(binedgepbok1>4100)),'jet');
set(chandle,'linewidth',1);
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1) axpos(2)+axpos(4)*0.05 axpos(3) axpos(4)*0.95])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)

subtightplot(4,2,8,[0.01,0.075],0.05,0.1)
scatter(binedgeqbok1(find(binedgepbok1>4100)),binmeanqbok(find(binedgepbok1>4100)).*100,75,cvec(find(binedgepbok1>4100)),'filled','^','MarkerEdgeColor','k')
axis([[3750 7250] [-0.06.*100 0.06.*100]])
line([6598 6598],[-0.06.*100 0.06.*100],'LineStyle','--','Color',[0 0 0])
line([4861 4861],[-0.06.*100 0.06.*100],'LineStyle','--','Color',[0 0 0])
chandle=cline(binedgeqbok1(find(binedgepbok1>4100)),binmeanqbok(find(binedgepbok1>4100)).*100,binedgeqbok1(find(binedgepbok1>4100)),cvec(find(binedgepbok1>4100)),'jet');
set(chandle,'linewidth',1);
xlabel('Rest Wavelength \AA','interpreter','latex','FontSize',28)
ylabel('Q (\%)','FontSize',24,'interpreter','latex')
ax1 = gca;
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1) axpos(2)+axpos(4)*0.1 axpos(3) axpos(4)*0.9])
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',28)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
set(ax1,'FontSize',20)

saveas(plotting, ['QUBok.eps'], 'epsc');
eval(['!epstopdf QUBok.eps']);

















%%%BOK QU

clf
subtightplot(4,2,[1 3 5 7],[0.0,0.0],0.05,0.1)
hold on
scatter(binmeanqbok,binmeanubok,75,cvec,'filled','MarkerEdgeColor','k')
scatter(circx125,circy125,25,'.','MarkerEdgeColor','k')
scatter(circx250,circy250,25,'.','MarkerEdgeColor','k')
scatter(circx375,circy375,25,'.','MarkerEdgeColor','k')
scatter(circx500,circy500,25,'.','MarkerEdgeColor','k')
chandle=cline(binmeanqbok,binmeanubok,binmeanqbok,cvec,'jet');
set(chandle,'linewidth',1);
axis([[-0.05 0.05] [-0.05 0.05]])
xlabel('Q (%)','FontSize',14)
ylabel('U (%)','FontSize',14)
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
hold off

subtightplot(4,2,[2 4],[0.01,0.075],0.05,0.1)
hold on
scatter(binedgepbok1,binmeanpbok,75,cvec,'filled','^','MarkerEdgeColor','k')
plot(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*0.1)
axis([[3750 7250] [0 0.1]])
line([6598 6598],[0 1],'LineStyle','--','Color',[0 0 0])
line([4861 4861],[0 1],'LineStyle','--','Color',[0 0 0])
ylabel('P (%)','FontSize',14)
set(gca,'XTickLabel',[]);
chandle=cline(binedgepbok1,binmeanpbok,binedgepbok1,cvec,'jet');
set(chandle,'linewidth',1);
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
hold off

subtightplot(4,2,6,[0.01,0.075],0.05,0.1)
scatter(binedgeubok1,binmeanubok,75,cvec,'filled','^','MarkerEdgeColor','k')
axis([[3750 7250] [-0.06 0.06]])
line([6598 6598],[-0.06 0.06],'LineStyle','--','Color',[0 0 0])
line([4861 4861],[-0.06 0.06],'LineStyle','--','Color',[0 0 0])
ylabel('U (%)','FontSize',14)
set(gca,'XTickLabel',[]);
chandle=cline(binedgeubok1,binmeanubok,binedgeubok1,cvec,'jet');
set(chandle,'linewidth',1);
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])

subtightplot(4,2,8,[0.01,0.075],0.05,0.1)
scatter(binedgeqbok1,binmeanqbok,75,cvec,'filled','^','MarkerEdgeColor','k')
axis([[3750 7250] [-0.06 0.06]])
line([6598 6598],[-0.06 0.06],'LineStyle','--','Color',[0 0 0])
line([4861 4861],[-0.06 0.06],'LineStyle','--','Color',[0 0 0])
chandle=cline(binedgeqbok1,binmeanqbok,binedgeqbok1,cvec,'jet');
set(chandle,'linewidth',1);
xlabel('Rest Wavelength \AA','interpreter','latex','FontSize',18)
ylabel('Q (%)','FontSize',18)
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])

saveas(plotting, ['QUBok.eps'], 'epsc');
eval(['!epstopdf QUBok.eps']);


%Comparing epochs SPOL
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
clf
subtightplot(4,1,[1 2],[0.01,0.0],0.05,0.05)
hold all
%plot(mmtbc1_20120301,mmtbc2_20120301)
%plot(spolm1_20120416,spolm2_20120416)
plot(spolb1_20120323,spolb2_20120323/max(spolb2_20120323)*1-0.25,'LineWidth',3)
plot(spolm1_20120416,spolm2_20120416/max(spolm2_20120416)*1,'LineWidth',3)
%plot(mmtbc1_20120529,mmtbc2_20120529)
%plot(mmtbc1_20120701NO,mmtbc2_20120701NO)
%plot(mmtbc1_20120701,mmtbc2_20120701)
%plot(keckD1_20121115,keckD2_20121115)
axis([[3800 7250] [0.05 1.05]])
%line([6598 6598],[-0.2 0.15],'LineStyle','--','Color',[0 0 0])
%line([4861 4861],[-0.2 0.15],'LineStyle','--','Color',[0 0 0])
ylabel('F_\lambda Scaled','interpreter','tex','FontSize',30,'FontName','CMU Serif Roman')
htext = text(3520,0.45,'.','interpreter','latex','FontName','CMU Serif Roman','Color',[0.9 0.9 0.9])
%title('MMT Spectra', 'FontSize', 20)
set(gca,'XTickLabel',[]);
h_legend=legend('Bok 03-23-2015','MMT 04-16-2015','Location','Northwest')
set(h_legend,'FontSize',24,'interpreter','latex');
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.1 axpos(2) axpos(3)*0.9 axpos(4)])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',30)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',24)
set(ax2,'FontSize',24)
set(ax1,'XMinorTick','on','YMinorTick','on')
hold off

subtightplot(4,1,3,[0.01,0.0],0.05,0.05)
hold all
plot(pbok1,smooth(pbok2).*100,'LineWidth',2)
plot(p1,smooth(p2).*100,'LineWidth',2)
%htext = text(360,5,'.','interpreter','tex','FontName','CMU Serif Roman','Color',[0.9 0.9 0.9])
set(gca,'XTickLabel',[]);
axis([[3800 7250] [-0.01*100 0.075*100]])
ylabel('P (%)','FontSize',30)
%h_legend=legend('Bok 03-23-2015','MMT 04-16-2015','Location','Northwest')
%set(h_legend,'FontSize',20);
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.1 axpos(2) axpos(3)*0.9 axpos(4)])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',30)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',24)
set(ax2,'FontSize',24)
set(ax1,'XMinorTick','on','YMinorTick','on')
hold off

subtightplot(4,1,4,[0.01,0.0],0.05,0.05)
hold all
plot(t1,smooth(t2),'LineWidth',2)
plot(tbok1,smooth(tbok2),'LineWidth',2)
%htext = text(360,0,'...','interpreter','tex','FontName','CMU Serif Roman','Color',[0.1 0.1 0.1])
xlabel('Rest Wavelength (\AA)','interpreter','latex','FontSize',30)
ylabel('\theta (°)','FontSize',30)
%h_legend=legend('Bok 03-23-2015','MMT 04-16-2015','Location','Northwest')
%set(h_legend,'FontSize',18);
axis([[3800 7250] [-inf inf]])
axpos = get(gca, 'Position')
set(gca, 'Position', [axpos(1)+axpos(3)*0.1 axpos(2)+axpos(4)*0.15 axpos(3)*0.9 axpos(4)*0.85])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',30)
xlabel(ax2,'')
set(ax1,'FontSize',24)
set(ax2,'FontSize',24)
set(ax2,'xtick',[],'YTick',[])
set(ax1,'XMinorTick','on','YMinorTick','on')
hold off

export_fig spectra.pdf -pdf

%saveas(plotting, ['spectra.eps'], 'epsc');
%eval(['!epstopdf spectra.eps']);






%%%TEST HALPHA WITH PLOTS
clf
plot(halphafitLkast2_20120223,Lkast1_20120223,Lkast2_20120223)
axis([[5750 8250] [-inf inf]])
saveas(plotting, ['halphafitLkast20120223.eps'], 'epsc');
eval(['!epstopdf halphafitLkast20120223.eps']);

clf
plot(halphafitmmtbc2_20120301,mmtbc1_20120301,mmtbc2_20120301)
axis([[6000 7000] [-inf inf]])
saveas(plotting, ['halphafit0301.eps'], 'epsc');
eval(['!epstopdf halphafit0301.eps']);

clf
hold on
plot(halphafitspolb2_20120323,spolb1_20120323,spolb2_20120323)
axis([[5500 7250] [-inf inf]])
saveas(plotting, ['halphafitBokMarch.eps'], 'epsc');
eval(['!epstopdf halphafitBokMarch.eps']);

clf
hold on
plot(halphafitspolm2_20120416,spolm1_20120416,spolm2_20120416)
axis([[5500 7250] [-inf inf]])
saveas(plotting, ['halphafitMMTApril.eps'], 'epsc');
eval(['!epstopdf halphafitMMTApril.eps']);

clf
plot(halphafitmmtbc2_20120417,mmtbc1_20120417,mmtbc2_20120417)
axis([[6000 7000] [-inf inf]])
saveas(plotting, ['halphafit0416.eps'], 'epsc');
eval(['!epstopdf halphafit0416.eps']);

clf
plot(halphafitLkast2_20120428,Lkast1_20120428,Lkast2_20120428)
axis([[5250 8250] [-inf inf]])
saveas(plotting, ['halphafitLkast20120428.eps'], 'epsc');
eval(['!epstopdf halphafitLkast20120428.eps']);

clf
plot(halphafitmmtbc2_20120529,mmtbc1_20120529,mmtbc2_20120529)
axis([[6000 7000] [-inf inf]])
saveas(plotting, ['halphafit0529.eps'], 'epsc');
eval(['!epstopdf halphafit0529.eps']);

clf
plot(halphafitkeckL2_20120616,keckL1_20120616,keckL2_20120616)
axis([[5250 8250] [-inf inf]])
saveas(plotting, ['halphafitkeckL20120616.eps'], 'epsc');
eval(['!epstopdf halphafitkeckL20120616.eps']);

clf
plot(halphafitmmtbc2_20120701,mmtbc1_20120701,mmtbc2_20120701)
axis([[6000 7000] [-inf inf]])
saveas(plotting, ['halphafit0701.eps'], 'epsc');
eval(['!epstopdf halphafit0701.eps']);

clf
plot(halphafitkeckD2_20121115,keckD1_20121115,keckD2_20121115)
axis([[5250 8250] [-inf inf]])
saveas(plotting, ['halphafitkeck.eps'], 'epsc');
eval(['!epstopdf halphafitkeck.eps']);

%%%END TEST


%%%TEST NAID WITH PLOTS
clf
hold all
plot(Lkast1_20120223(Lkast1_20120223>5660 & Lkast1_20120223 < 6100),Lkast2_20120223_naIDcontnormsub(Lkast1_20120223>5660 & Lkast1_20120223 < 6100),'--','LineWidth',2,'Color',[0 1 0])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895.9 5895.9],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(Lkast1_20120223(Lkast1_20120223>5885 & Lkast1_20120223 <= 5893),Lkast2_20120223_naIDcontnormsub(Lkast1_20120223>5885 & Lkast1_20120223 <=5893),'FaceColor',[1 0 0])
area(Lkast1_20120223(Lkast1_20120223>5893 & Lkast1_20120223 < 5901),Lkast2_20120223_naIDcontnormsub(Lkast1_20120223>5893 & Lkast1_20120223 < 5901))
plot(naIDfitLkast2_20120223,Lkast1_20120223,Lkast2_20120223)
plot(Lkast1_20120223((Lkast1_20120223>5660)&(Lkast1_20120223<6100)),naIDfitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>5660)&(Lkast1_20120223<6100)))./mean(naIDfitLkast2_20120223(Lkast1_20120223((Lkast1_20120223>5885)&(Lkast1_20120223<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120223.eps'], 'epsc');
eval(['!epstopdf NaID20120223.eps']);

clf
hold all
plot(mmtbc1_20120301(mmtbc1_20120301>5660 & mmtbc1_20120301 < 6100),mmtbc2_20120301_naIDcontnormsub(mmtbc1_20120301>5660 & mmtbc1_20120301 < 6100),'LineWidth',2,'Color',[0 0 0])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(mmtbc1_20120301(mmtbc1_20120301>5885 & mmtbc1_20120301 <= 5893),mmtbc2_20120301_naIDcontnormsub(mmtbc1_20120301>5885 & mmtbc1_20120301 <=5893),'FaceColor',[1 0 0])
area(mmtbc1_20120301(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901),mmtbc2_20120301_naIDcontnormsub(mmtbc1_20120301>5893 & mmtbc1_20120301 < 5901))
plot(mmtbc1_20120301((mmtbc1_20120301>5660)&(mmtbc1_20120301<6100)),naIDfitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>5660)&(mmtbc1_20120301<6100)))./mean(naIDfitmmtbc2_20120301(mmtbc1_20120301((mmtbc1_20120301>5885)&(mmtbc1_20120301<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120301.eps'], 'epsc');
eval(['!epstopdf NaID20120301.eps']);


clf
hold all
plot(spolb1_20120323(spolb1_20120323>5660 & spolb1_20120323 < 6100),spolb2_20120323_naIDcontnormsub(spolb1_20120323>5660 & spolb1_20120323 < 6100),'--','LineWidth',2,'Color',[0 0 1])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(spolb1_20120323(spolb1_20120323>5885 & spolb1_20120323 <= 5893),spolb2_20120323_naIDcontnormsub(spolb1_20120323>5885 & spolb1_20120323 <=5893),'FaceColor',[1 0 0])
area(spolb1_20120323(spolb1_20120323>5893 & spolb1_20120323 < 5901),spolb2_20120323_naIDcontnormsub(spolb1_20120323>5893 & spolb1_20120323 < 5901))
plot(spolb1_20120323((spolb1_20120323>5660)&(spolb1_20120323<6100)),naIDfitspolb2_20120323(spolb1_20120323((spolb1_20120323>5660)&(spolb1_20120323<6100)))./mean(naIDfitspolb2_20120323(spolb1_20120323((spolb1_20120323>5885)&(spolb1_20120323<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120323.eps'], 'epsc');
eval(['!epstopdf NaID20120323.eps']);

clf
hold all
plot(spolm1_20120416(spolm1_20120416>5660 & spolm1_20120416 < 6100),spolm2_20120416_naIDcontnormsub(spolm1_20120416>5660 & spolm1_20120416 < 6100),'--','LineWidth',2,'Color',[0 1 1])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(spolm1_20120416(spolm1_20120416>5885 & spolm1_20120416 <= 5893),spolm2_20120416_naIDcontnormsub(spolm1_20120416>5885 & spolm1_20120416 <=5893),'FaceColor',[1 0 0])
area(spolm1_20120416(spolm1_20120416>5893 & spolm1_20120416 < 5901),spolm2_20120416_naIDcontnormsub(spolm1_20120416>5893 & spolm1_20120416 < 5901))
plot(spolm1_20120416((spolm1_20120416>5660)&(spolm1_20120416<6100)),naIDfitspolm2_20120416(spolm1_20120416((spolm1_20120416>5660)&(spolm1_20120416<6100)))./mean(naIDfitspolm2_20120416(spolm1_20120416((spolm1_20120416>5885)&(spolm1_20120416<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120416.eps'], 'epsc');
eval(['!epstopdf NaID20120416.eps']);

clf
hold all
plot(mmtbc1_20120417(mmtbc1_20120417>5660 & mmtbc1_20120417 < 6100),mmtbc2_20120417_naIDcontnormsub(mmtbc1_20120417>5660 & mmtbc1_20120417 < 6100),'LineWidth',2,'Color',[0.3 0.3 0.3])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(mmtbc1_20120417(mmtbc1_20120417>5885 & mmtbc1_20120417 <= 5893),mmtbc2_20120417_naIDcontnormsub(mmtbc1_20120417>5885 & mmtbc1_20120417 <=5893),'FaceColor',[1 0 0])
area(mmtbc1_20120417(mmtbc1_20120417>5893 & mmtbc1_20120417 < 5901),mmtbc2_20120417_naIDcontnormsub(mmtbc1_20120417>5893 & mmtbc1_20120417 < 5901))
plot(mmtbc1_20120417((mmtbc1_20120417>5660)&(mmtbc1_20120417<6100)),naIDfitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>5660)&(mmtbc1_20120417<6100)))./mean(naIDfitmmtbc2_20120417(mmtbc1_20120417((mmtbc1_20120417>5885)&(mmtbc1_20120417<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120417.eps'], 'epsc');
eval(['!epstopdf NaID20120417.eps']);

clf
hold all
plot(Lkast1_20120428(Lkast1_20120428>5660 & Lkast1_20120428 < 6100),Lkast2_20120428_naIDcontnormsub(Lkast1_20120428>5660 & Lkast1_20120428 < 6100),'--','LineWidth',2,'Color',[0 .66 0])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(Lkast1_20120428(Lkast1_20120428>5885 & Lkast1_20120428 <= 5893),Lkast2_20120428_naIDcontnormsub(Lkast1_20120428>5885 & Lkast1_20120428 <=5893),'FaceColor',[1 0 0])
area(Lkast1_20120428(Lkast1_20120428>5893 & Lkast1_20120428 < 5901),Lkast2_20120428_naIDcontnormsub(Lkast1_20120428>5893 & Lkast1_20120428 < 5901))
plot(Lkast1_20120428((Lkast1_20120428>5660)&(Lkast1_20120428<6100)),naIDfitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>5660)&(Lkast1_20120428<6100)))./mean(naIDfitLkast2_20120428(Lkast1_20120428((Lkast1_20120428>5885)&(Lkast1_20120428<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120428.eps'], 'epsc');
eval(['!epstopdf NaID20120428.eps']);

clf
hold all
plot(mmtbc1_20120529(mmtbc1_20120529>5660 & mmtbc1_20120529 < 6100),mmtbc2_20120529_naIDcontnormsub(mmtbc1_20120529>5660 & mmtbc1_20120529 < 6100),'LineWidth',2,'Color',[0.6 0.6 0.6])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(mmtbc1_20120529(mmtbc1_20120529>5885 & mmtbc1_20120529 <= 5893),mmtbc2_20120529_naIDcontnormsub(mmtbc1_20120529>5885 & mmtbc1_20120529 <=5893),'FaceColor',[1 0 0])
area(mmtbc1_20120529(mmtbc1_20120529>5893 & mmtbc1_20120529 < 5901),mmtbc2_20120529_naIDcontnormsub(mmtbc1_20120529>5893 & mmtbc1_20120529 < 5901))
plot(mmtbc1_20120529((mmtbc1_20120529>5660)&(mmtbc1_20120529<6100)),naIDfitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>5660)&(mmtbc1_20120529<6100)))./mean(naIDfitmmtbc2_20120529(mmtbc1_20120529((mmtbc1_20120529>5885)&(mmtbc1_20120529<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120529.eps'], 'epsc');
eval(['!epstopdf NaID20120529.eps']);

clf
hold all
plot(keckL1_20120616(keckL1_20120616>5660 & keckL1_20120616 < 6100),keckL2_20120616_naIDcontnormsub(keckL1_20120616>5660 & keckL1_20120616 < 6100),'LineWidth',2,'Color',[1 0 1])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(keckL1_20120616(keckL1_20120616>5885 & keckL1_20120616 <= 5893),keckL2_20120616_naIDcontnormsub(keckL1_20120616>5885 & keckL1_20120616 <=5893),'FaceColor',[1 0 0])
area(keckL1_20120616(keckL1_20120616>5893 & keckL1_20120616 < 5901),keckL2_20120616_naIDcontnormsub(keckL1_20120616>5893 & keckL1_20120616 < 5901))
plot(keckL1_20120616((keckL1_20120616>5660)&(keckL1_20120616<6100)),naIDfitkeckL2_20120616(keckL1_20120616((keckL1_20120616>5660)&(keckL1_20120616<6100)))./mean(naIDfitkeckL2_20120616(keckL1_20120616((keckL1_20120616>5885)&(keckL1_20120616<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120616.eps'], 'epsc');
eval(['!epstopdf NaID20120616.eps']);

clf
hold all
plot(mmtbc1_20120701(mmtbc1_20120701>5660 & mmtbc1_20120701 < 6100),mmtbc2_20120701_naIDcontnormsub(mmtbc1_20120701>5660 & mmtbc1_20120701 < 6100),'LineWidth',2,'Color',[0.9 0.9 0.9])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(mmtbc1_20120701(mmtbc1_20120701>5885 & mmtbc1_20120701 <= 5893),mmtbc2_20120701_naIDcontnormsub(mmtbc1_20120701>5885 & mmtbc1_20120701 <=5893),'FaceColor',[1 0 0])
area(mmtbc1_20120701(mmtbc1_20120701>5893 & mmtbc1_20120701 < 5901),mmtbc2_20120701_naIDcontnormsub(mmtbc1_20120701>5893 & mmtbc1_20120701 < 5901))
plot(mmtbc1_20120701((mmtbc1_20120701>5660)&(mmtbc1_20120701<6100)),naIDfitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>5660)&(mmtbc1_20120701<6100)))./mean(naIDfitmmtbc2_20120701(mmtbc1_20120701((mmtbc1_20120701>5885)&(mmtbc1_20120701<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120701.eps'], 'epsc');
eval(['!epstopdf NaID20120701.eps']);

clf
hold all
plot(Lkast1_20120720(Lkast1_20120720>5660 & Lkast1_20120720 < 6100),Lkast2_20120720_naIDcontnormsub(Lkast1_20120720>5660 & Lkast1_20120720 < 6100),'--','LineWidth',2,'Color',[0 0.33 0])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(Lkast1_20120720(Lkast1_20120720>5885 & Lkast1_20120720 <= 5893),Lkast2_20120720_naIDcontnormsub(Lkast1_20120720>5885 & Lkast1_20120720 <=5893),'FaceColor',[1 0 0])
area(Lkast1_20120720(Lkast1_20120720>5893 & Lkast1_20120720 < 5901),Lkast2_20120720_naIDcontnormsub(Lkast1_20120720>5893 & Lkast1_20120720 < 5901))
plot(Lkast1_20120720((Lkast1_20120720>5660)&(Lkast1_20120720<6100)),naIDfitLkast2_20120720(Lkast1_20120720((Lkast1_20120720>5660)&(Lkast1_20120720<6100)))./mean(naIDfitLkast2_20120720(Lkast1_20120720((Lkast1_20120720>5885)&(Lkast1_20120720<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20120720.eps'], 'epsc');
eval(['!epstopdf NaID20120720.eps']);

clf
hold all
plot(keckD1_20121115(keckD1_20121115>5660 & keckD1_20121115 < 6100),keckD2_20121115_naIDcontnormsub(keckD1_20121115>5660 & keckD1_20121115 < 6100),'LineWidth',2,'Color',[1 0 0])
line([5890 5890],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
line([5895 5895],[-0.3 0.3],'LineStyle','--','Color',[0 0 0])
area(keckD1_20121115(keckD1_20121115>5885 & keckD1_20121115 <= 5893),keckD2_20121115_naIDcontnormsub(keckD1_20121115>5885 & keckD1_20121115 <=5893),'FaceColor',[1 0 0])
area(keckD1_20121115(keckD1_20121115>5893 & keckD1_20121115 < 5901),keckD2_20121115_naIDcontnormsub(keckD1_20121115>5893 & keckD1_20121115 < 5901))
plot(keckD1_20121115((keckD1_20121115>5660)&(keckD1_20121115<6100)),naIDfitkeckD2_20121115(keckD1_20121115((keckD1_20121115>5660)&(keckD1_20121115<6100)))./mean(naIDfitkeckD2_20121115(keckD1_20121115((keckD1_20121115>5885)&(keckD1_20121115<5900))))-1,'--r')
axis([[5660 6100] [-0.3 0.3]])
saveas(plotting, ['NaID20121115.eps'], 'epsc');
eval(['!epstopdf NaID20121115.eps']);

%%%END TEST



%%%TESTING EQUIVALENT WIDTH INTERPOLATION REGIONS
clf
hold all


plot(keckD1_20121115(find(keckD1_20121115>6543 & keckD1_20121115 < 6551))/10^3,keckD2_20121115_interp(find(keckD1_20121115>6543 & keckD1_20121115 < 6551)),'LineWidth',2,'Color',[1 0 0])
plot(Lkast1_20120223(find(Lkast1_20120223>6543 & Lkast1_20120223 < 6551))/10^3,Lkast2_20120223_interp(find(Lkast1_20120223>6543 & Lkast1_20120223 < 6551)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>6543 & mmtbc1_20120301 < 6551))/10^3,mmtbc2_20120301_interp(find(mmtbc1_20120301>6543 & mmtbc1_20120301 < 6551)),'LineWidth',2,'Color',[0 0 0])
plot(spolb1_20120323(find(spolb1_20120323>6543 & spolb1_20120323 < 6551))/10^3,spolb2_20120323_interp(find(spolb1_20120323>6543 & spolb1_20120323 < 6551)),'--','LineWidth',2,'Color',[0 0 1])
plot(spolm1_20120416(find(spolm1_20120416>6543 & spolm1_20120416 < 6551))/10^3,spolm2_20120416_interp(find(spolm1_20120416>6543 & spolm1_20120416 < 6551)),'--','LineWidth',2,'Color',[0 1 1])
plot(mmtbc1_20120417(find(mmtbc1_20120417>6543 & mmtbc1_20120417 < 6551))/10^3,mmtbc2_20120417_interp(find(mmtbc1_20120417>6543 & mmtbc1_20120417 < 6551)),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(Lkast1_20120428(find(Lkast1_20120428>6543 & Lkast1_20120428 < 6551))/10^3,Lkast2_20120428_interp(find(Lkast1_20120428>6543 & Lkast1_20120428 < 6551)),'--','LineWidth',2,'Color',[0 .66 0])
plot(mmtbc1_20120529(find(mmtbc1_20120529>6543 & mmtbc1_20120529 < 6551))/10^3,mmtbc2_20120529_interp(find(mmtbc1_20120529>6543 & mmtbc1_20120529 < 6551)),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(keckL1_20120616(find(keckL1_20120616>6543 & keckL1_20120616 < 6551))/10^3,keckL2_20120616_interp(find(keckL1_20120616>6543 & keckL1_20120616 < 6551)),'LineWidth',2,'Color',[1 0 1])
plot(mmtbc1_20120701(find(mmtbc1_20120701>6543 & mmtbc1_20120701 < 6551))/10^3,mmtbc2_20120701_interp(find(mmtbc1_20120701>6543 & mmtbc1_20120701 < 6551)),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(Lkast1_20120720(find(Lkast1_20120720>6543 & Lkast1_20120720 < 6551))/10^3,Lkast2_20120720_interp(find(Lkast1_20120720>6543 & Lkast1_20120720 < 6551)),'--','LineWidth',2,'Color',[0 0.33 0])



plot(keckD1_20121115(find(keckD1_20121115>6557 & keckD1_20121115 < 6570))/10^3,keckD2_20121115_interp(find(keckD1_20121115>6557 & keckD1_20121115 < 6570)),'LineWidth',2,'Color',[1 0 0])
plot(Lkast1_20120223(find(Lkast1_20120223>6557 & Lkast1_20120223 < 6570))/10^3,Lkast2_20120223_interp(find(Lkast1_20120223>6557 & Lkast1_20120223 < 6570)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>6557 & mmtbc1_20120301 < 6570))/10^3,mmtbc2_20120301_interp(find(mmtbc1_20120301>6557 & mmtbc1_20120301 < 6570)),'LineWidth',2,'Color',[0 0 0])
plot(spolb1_20120323(find(spolb1_20120323>6557 & spolb1_20120323 < 6570))/10^3,spolb2_20120323_interp(find(spolb1_20120323>6557 & spolb1_20120323 < 6570)),'--','LineWidth',2,'Color',[0 0 1])
plot(spolm1_20120416(find(spolm1_20120416>6557 & spolm1_20120416 < 6570))/10^3,spolm2_20120416_interp(find(spolm1_20120416>6557 & spolm1_20120416 < 6570)),'--','LineWidth',2,'Color',[0 1 1])
plot(mmtbc1_20120417(find(mmtbc1_20120417>6557 & mmtbc1_20120417 < 6570))/10^3,mmtbc2_20120417_interp(find(mmtbc1_20120417>6557 & mmtbc1_20120417 < 6570)),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(Lkast1_20120428(find(Lkast1_20120428>6557 & Lkast1_20120428 < 6570))/10^3,Lkast2_20120428_interp(find(Lkast1_20120428>6557 & Lkast1_20120428 < 6570)),'--','LineWidth',2,'Color',[0 .66 0])
plot(mmtbc1_20120529(find(mmtbc1_20120529>6557 & mmtbc1_20120529 < 6570))/10^3,mmtbc2_20120529_interp(find(mmtbc1_20120529>6557 & mmtbc1_20120529 < 6570)),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(keckL1_20120616(find(keckL1_20120616>6557 & keckL1_20120616 < 6570))/10^3,keckL2_20120616_interp(find(keckL1_20120616>6557 & keckL1_20120616 < 6570)),'LineWidth',2,'Color',[1 0 1])
plot(mmtbc1_20120701(find(mmtbc1_20120701>6557 & mmtbc1_20120701 < 6570))/10^3,mmtbc2_20120701_interp(find(mmtbc1_20120701>6557 & mmtbc1_20120701 < 6570)),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(Lkast1_20120720(find(Lkast1_20120720>6557 & Lkast1_20120720 < 6570))/10^3,Lkast2_20120720_interp(find(Lkast1_20120720>6557 & Lkast1_20120720 < 6570)),'--','LineWidth',2,'Color',[0 0.33 0])



plot(keckD1_20121115(find(keckD1_20121115>6579 & keckD1_20121115 < 6587))/10^3,keckD2_20121115_interp(find(keckD1_20121115>6579 & keckD1_20121115 < 6587)),'LineWidth',2,'Color',[1 0 0])
plot(Lkast1_20120223(find(Lkast1_20120223>6579 & Lkast1_20120223 < 6587))/10^3,Lkast2_20120223_interp(find(Lkast1_20120223>6579 & Lkast1_20120223 < 6587)),'--','LineWidth',2,'Color',[0 1 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>6579 & mmtbc1_20120301 < 6587))/10^3,mmtbc2_20120301_interp(find(mmtbc1_20120301>6579 & mmtbc1_20120301 < 6587)),'LineWidth',2,'Color',[0 0 0])
plot(spolb1_20120323(find(spolb1_20120323>6579 & spolb1_20120323 < 6587))/10^3,spolb2_20120323_interp(find(spolb1_20120323>6579 & spolb1_20120323 < 6587)),'--','LineWidth',2,'Color',[0 0 1])
plot(spolm1_20120416(find(spolm1_20120416>6579 & spolm1_20120416 < 6587))/10^3,spolm2_20120416_interp(find(spolm1_20120416>6579 & spolm1_20120416 < 6587)),'--','LineWidth',2,'Color',[0 1 1])
plot(mmtbc1_20120417(find(mmtbc1_20120417>6579 & mmtbc1_20120417 < 6587))/10^3,mmtbc2_20120417_interp(find(mmtbc1_20120417>6579 & mmtbc1_20120417 < 6587)),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(Lkast1_20120428(find(Lkast1_20120428>6579 & Lkast1_20120428 < 6587))/10^3,Lkast2_20120428_interp(find(Lkast1_20120428>6579 & Lkast1_20120428 < 6587)),'--','LineWidth',2,'Color',[0 .66 0])
plot(mmtbc1_20120529(find(mmtbc1_20120529>6579 & mmtbc1_20120529 < 6587))/10^3,mmtbc2_20120529_interp(find(mmtbc1_20120529>6579 & mmtbc1_20120529 < 6587)),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(keckL1_20120616(find(keckL1_20120616>6579 & keckL1_20120616 < 6587))/10^3,keckL2_20120616_interp(find(keckL1_20120616>6579 & keckL1_20120616 < 6587)),'LineWidth',2,'Color',[1 0 1])
plot(mmtbc1_20120701(find(mmtbc1_20120701>6579 & mmtbc1_20120701 < 6587))/10^3,mmtbc2_20120701_interp(find(mmtbc1_20120701>6579 & mmtbc1_20120701 < 6587)),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(Lkast1_20120720(find(Lkast1_20120720>6579 & Lkast1_20120720 < 6587))/10^3,Lkast2_20120720_interp(find(Lkast1_20120720>6579 & Lkast1_20120720 < 6587)),'--','LineWidth',2,'Color',[0 0.33 0])


%%%END TEST


%%%BEGIN TEST PLOTS OF INTERPOLATIONS AND ACTUAL SPECTRUM SHOWN

clf
hold all
plot(Lkast1_20120223(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763))/10^3,Lkast2_20120223_interp(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763)),'--','LineWidth',2,'Color',[0 1 0])
plot(Lkast1_20120223(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763))/10^3,Lkast2_20120223_halphacontnorm(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763)),'--','LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp23.eps'], 'epsc');
eval(['!epstopdf _interp23.eps']);

clf
hold all
plot(mmtbc1_20120301(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763))/10^3,mmtbc2_20120301_interp(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763)),'LineWidth',2,'Color',[0 0 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763))/10^3,mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp30.eps'], 'epsc');
eval(['!epstopdf _interp30.eps']);

clf
hold all
plot(spolb1_20120323(find(spolb1_20120323>4761 & spolb1_20120323 < 6763))/10^3,spolb2_20120323_interp(find(spolb1_20120323>4761 & spolb1_20120323 < 6763)),'--','LineWidth',2,'Color',[0 0 1])
plot(spolb1_20120323(find(spolb1_20120323>4761 & spolb1_20120323 < 6763))/10^3,spolb2_20120323_halphacontnorm(find(spolb1_20120323>4761 & spolb1_20120323 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp52.eps'], 'epsc');
eval(['!epstopdf _interp52.eps']);

clf
hold all
plot(spolm1_20120416(find(spolm1_20120416>4761 & spolm1_20120416 < 6763))/10^3,spolm2_20120416_interp(find(spolm1_20120416>4761 & spolm1_20120416 < 6763)),'--','LineWidth',2,'Color',[0 1 1])
plot(spolm1_20120416(find(spolm1_20120416>4761 & spolm1_20120416 < 6763))/10^3,spolm2_20120416_halphacontnorm(find(spolm1_20120416>4761 & spolm1_20120416 < 6763)),'--','LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp76.eps'], 'epsc');
eval(['!epstopdf _interp76.eps']);

clf
hold all
plot(mmtbc1_20120417(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763))/10^3,mmtbc2_20120417_interp(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763)),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(mmtbc1_20120417(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763))/10^3,mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp77.eps'], 'epsc');
eval(['!epstopdf _interp77.eps']);

clf
hold all
plot(Lkast1_20120428(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763))/10^3,Lkast2_20120428_interp(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763)),'--','LineWidth',2,'Color',[0 .66 0])
plot(Lkast1_20120428(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763))/10^3,Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763)),'--','LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp88.eps'], 'epsc');
eval(['!epstopdf _interp88.eps']);

clf
hold all
plot(mmtbc1_20120529(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763))/10^3,mmtbc2_20120529_interp(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763)),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(mmtbc1_20120529(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763))/10^3,mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['interp119.eps'], 'epsc');
eval(['!epstopdf interp119.eps']);

clf
hold all
plot(keckL1_20120616(find(keckL1_20120616>4761 & keckL1_20120616 < 6763))/10^3,keckL2_20120616_interp(find(keckL1_20120616>4761 & keckL1_20120616 < 6763)),'LineWidth',2,'Color',[1 0 1])
plot(keckL1_20120616(find(keckL1_20120616>4761 & keckL1_20120616 < 6763))/10^3,keckL2_20120616_halphacontnorm(find(keckL1_20120616>4761 & keckL1_20120616 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['interp137.eps'], 'epsc');
eval(['!epstopdf interp137.eps']);

clf
hold all
plot(mmtbc1_20120701(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763))/10^3,mmtbc2_20120701_interp(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763)),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(mmtbc1_20120701(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763))/10^3,mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['interp152.eps'], 'epsc');
eval(['!epstopdf interp152.eps']);

clf
hold all
plot(Lkast1_20120720(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763))/10^3,Lkast2_20120720_interp(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763)),'--','LineWidth',2,'Color',[0 0.33 0])
plot(Lkast1_20120720(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763))/10^3,Lkast2_20120720_halphacontnorm(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['interp171.eps'], 'epsc');
eval(['!epstopdf interp171.eps']);

clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 6763))/10^3,keckD2_20121115_interp(find(keckD1_20121115>4761 & keckD1_20121115 < 6763)),'LineWidth',2,'Color',[1 0 0])
plot(keckD1_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 6763))/10^3,keckD2_20121115_halphacontnorm(find(keckD1_20121115>4761 & keckD1_20121115 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interp289.eps'], 'epsc');
eval(['!epstopdf _interp289.eps']);


%%% END TEST

%%%BEGIN TESTING EQUIVALENT WIDTH FOR NARROW HALPHA COMPONENT PLOTS
clf
hold all
plot(Lkast1_20120223(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763))/10^3,Lkast2_20120223_interpsub(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763)),'--','LineWidth',2,'Color',[0 1 0])
plot(Lkast1_20120223(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763))/10^3,Lkast2_20120223_halphacontnorm(find(Lkast1_20120223>4761 & Lkast1_20120223 < 6763)),'--','LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub23.eps'], 'epsc');
eval(['!epstopdf _interpsub23.eps']);

clf
hold all
plot(mmtbc1_20120301(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763))/10^3,mmtbc2_20120301_interpsub(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763)),'LineWidth',2,'Color',[0 0 0])
plot(mmtbc1_20120301(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763))/10^3,mmtbc2_20120301_halphacontnorm(find(mmtbc1_20120301>4761 & mmtbc1_20120301 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub30.eps'], 'epsc');
eval(['!epstopdf _interpsub30.eps']);

clf
hold all
plot(spolb1_20120323(find(spolb1_20120323>4761 & spolb1_20120323 < 6763))/10^3,spolb2_20120323_interpsub(find(spolb1_20120323>4761 & spolb1_20120323 < 6763)),'--','LineWidth',2,'Color',[0 0 1])
plot(spolb1_20120323(find(spolb1_20120323>4761 & spolb1_20120323 < 6763))/10^3,spolb2_20120323_halphacontnorm(find(spolb1_20120323>4761 & spolb1_20120323 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub52.eps'], 'epsc');
eval(['!epstopdf _interpsub52.eps']);

clf
hold all
plot(spolm1_20120416(find(spolm1_20120416>4761 & spolm1_20120416 < 6763))/10^3,spolm2_20120416_interpsub(find(spolm1_20120416>4761 & spolm1_20120416 < 6763)),'--','LineWidth',2,'Color',[0 1 1])
plot(spolm1_20120416(find(spolm1_20120416>4761 & spolm1_20120416 < 6763))/10^3,spolm2_20120416_halphacontnorm(find(spolm1_20120416>4761 & spolm1_20120416 < 6763)),'--','LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub76.eps'], 'epsc');
eval(['!epstopdf _interpsub76.eps']);

clf
hold all
plot(mmtbc1_20120417(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763))/10^3,mmtbc2_20120417_interpsub(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763)),'LineWidth',2,'Color',[0.3 0.3 0.3])
plot(mmtbc1_20120417(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763))/10^3,mmtbc2_20120417_halphacontnorm(find(mmtbc1_20120417>4761 & mmtbc1_20120417 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub77.eps'], 'epsc');
eval(['!epstopdf _interpsub77.eps']);

clf
hold all
plot(Lkast1_20120428(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763))/10^3,Lkast2_20120428_interpsub(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763)),'--','LineWidth',2,'Color',[0 .66 0])
plot(Lkast1_20120428(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763))/10^3,Lkast2_20120428_halphacontnorm(find(Lkast1_20120428>4761 & Lkast1_20120428 < 6763)),'--','LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub88.eps'], 'epsc');
eval(['!epstopdf _interpsub88.eps']);

clf
hold all
plot(mmtbc1_20120529(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763))/10^3,mmtbc2_20120529_interpsub(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763)),'LineWidth',2,'Color',[0.6 0.6 0.6])
plot(mmtbc1_20120529(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763))/10^3,mmtbc2_20120529_halphacontnorm(find(mmtbc1_20120529>4761 & mmtbc1_20120529 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub119.eps'], 'epsc');
eval(['!epstopdf _interpsub119.eps']);

clf
hold all
plot(keckL1_20120616(find(keckL1_20120616>4761 & keckL1_20120616 < 6763))/10^3,keckL2_20120616_interpsub(find(keckL1_20120616>4761 & keckL1_20120616 < 6763)),'LineWidth',2,'Color',[1 0 1])
plot(keckL1_20120616(find(keckL1_20120616>4761 & keckL1_20120616 < 6763))/10^3,keckL2_20120616_halphacontnorm(find(keckL1_20120616>4761 & keckL1_20120616 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub137.eps'], 'epsc');
eval(['!epstopdf _interpsub137.eps']);

clf
hold all
plot(mmtbc1_20120701(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763))/10^3,mmtbc2_20120701_interpsub(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763)),'LineWidth',2,'Color',[0.9 0.9 0.9])
plot(mmtbc1_20120701(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763))/10^3,mmtbc2_20120701_halphacontnorm(find(mmtbc1_20120701>4761 & mmtbc1_20120701 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub152.eps'], 'epsc');
eval(['!epstopdf _interpsub152.eps']);

clf
hold all
plot(Lkast1_20120720(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763))/10^3,Lkast2_20120720_interpsub(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763)),'--','LineWidth',2,'Color',[0 0.33 0])
plot(Lkast1_20120720(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763))/10^3,Lkast2_20120720_halphacontnorm(find(Lkast1_20120720>4761 & Lkast1_20120720 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub171.eps'], 'epsc');
eval(['!epstopdf _interpsub171.eps']);

clf
hold all
plot(keckD1_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 6763))/10^3,keckD2_20121115_interpsub(find(keckD1_20121115>4761 & keckD1_20121115 < 6763)),'LineWidth',2,'Color',[1 0 0])
plot(keckD1_20121115(find(keckD1_20121115>4761 & keckD1_20121115 < 6763))/10^3,keckD2_20121115_halphacontnorm(find(keckD1_20121115>4761 & keckD1_20121115 < 6763)),'LineWidth',2,'Color',[0 0 0])

saveas(plotting, ['_interpsub289.eps'], 'epsc');
eval(['!epstopdf _interpsub289.eps']);


%%%END TEST


%%%extraneous things
[Lkast1_20120720 Lkast2_20120720 Lkast3_20120720] =textread('sn2012ab-20120720.189-ui.flm','%f%f%f','delimiter',' ');

[mmtbc1_20120701NO mmtbc2_20120701NO] =textread('sn2012ab_MMT_BCH_1200_6350_20120701_NOfluxcal.txt','%f%f','delimiter',' ');
[mmtbc1_20120417ext mmtbc2_20120417ext] =textread('sn2012ab_MMT_BCH_1200_6350_20120416_fluxcal_extcor.txt','%f%f','delimiter',' ');




%frac = (reldate(6) - LCdates(find(LCdates < reldate(6),1,'last')))/ (LCdates(find(LCdates > reldate(6),1,'first')) - LCdates(find(LCdates < reldate(6),1,'last')));
%scaling = (ROTSEabsmag(find(LCdates > reldate(6),1,'first')) - ROTSEabsmag(find(LCdates < reldate(6),1,'last')));
%mR_20120428 = ROTSEabsmag(find(LCdates < reldate(6),1,'last')) + scaling * frac - redshiftdistancemodulus
%FR_20120428 = FR0*10^((mR_20120428 -mR0)/(-2.5))
%meanR_20120428 = mean(Lkast2_20120428((Lkast1_20120428>4000)&(Lkast1_20120428<9000)))






%restrict to deredden range
keckD1_20121115 = keckD1_20121115(1:7643);
keckD2_20121115 = keckD2_20121115(1:7643);
Lkast1_20120223 = Lkast1_20120223(1:find(Lkast1_20120223==min(Lkast1_20120223(Lkast1_20120223>9090)),1,'first'));
Lkast2_20120223 = Lkast2_20120223(1:find(Lkast1_20120223==min(Lkast1_20120223(Lkast1_20120223>9090)),1,'first'));
Lkast1_20120428 = Lkast1_20120428(1:find(Lkast1_20120428==min(Lkast1_20120428(Lkast1_20120428>9090)),1,'first'));
Lkast2_20120428 = Lkast2_20120428(1:find(Lkast1_20120428==min(Lkast1_20120428(Lkast1_20120428>9090)),1,'first'));
Lkast1_20120720 = Lkast1_20120720(1:find(Lkast1_20120720==min(Lkast1_20120720(Lkast1_20120720>9090)),1,'first'));
Lkast2_20120720 = Lkast2_20120720(1:find(Lkast1_20120720==min(Lkast1_20120720(Lkast1_20120720>9090)),1,'first'));
keckL1_20120616 = keckL1_20120616(1:find(keckL1_20120616==min(keckL1_20120616(keckL1_20120616>9090)),1,'first'));
keckL2_20120616 = keckL2_20120616(1:find(keckL1_20120616==min(keckL1_20120616(keckL1_20120616>9090)),1,'first'));


%highres
%6543 6551
%6557 6570
%6579 6587

%lowres 20120223
%6543 6551
%6554 6574
%6576 6591

%lowres bok
%6543 6551
%6553 6577
%6577 6597

%lowres 20120428
%6543 6551
%6552 6572
%6572 6593

%highres keckL
%6543 6551
%6557 6570
%6579 6589

%lowres 0701
%6543 6551
%6557 6578
%6578 6592

%lowres 20120720
%6543 6554
%6554 6574
%6576 6593





%%%OLD CODE

%removed 2016-03-04, from:
%various continuum fitting regions
%halpha continuum
halphafitLkast2_20120223 = fit(Lkast1_20120223,Lkast2_20120223,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120223<5750)|(Lkast1_20120223>8250)|(Lkast1_20120223>6162&Lkast1_20120223<6962));
halphafitmmtbc2_20120301 = fit(mmtbc1_20120301,mmtbc2_20120301,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120301<6000)|(mmtbc1_20120301>8250)|(mmtbc1_20120301>6262&mmtbc1_20120301<6862));
halphafitspolb2_20120323 = fit(spolb1_20120323,spolb2_20120323,'poly3','Robust','Bisquare','Exclude',(spolb1_20120323<5500)|(spolb1_20120323>7250)|(spolb1_20120323>6262&spolb1_20120323<6862));
halphafitspolm2_20120416 = fit(spolm1_20120416,spolm2_20120416,'poly3','Robust','Bisquare','Exclude',(spolm1_20120416<6000)|(spolm1_20120416>8250)|(spolm1_20120416>6262&spolm1_20120416<6862));
halphafitmmtbc2_20120417 = fit(mmtbc1_20120417,mmtbc2_20120417,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120417<5500)|(mmtbc1_20120417>7250)|(mmtbc1_20120417>6262&mmtbc1_20120417<6862));
halphafitLkast2_20120428 = fit(Lkast1_20120428,Lkast2_20120428,'poly3','Robust','Bisquare','Exclude',(Lkast1_20120428<5250)|(Lkast1_20120428>8250)|(Lkast1_20120428>6162&Lkast1_20120428<6962));
halphafitmmtbc2_20120529 = fit(mmtbc1_20120529,mmtbc2_20120529,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120529<6000)|(mmtbc1_20120529>8250)|(mmtbc1_20120529>6262&mmtbc1_20120529<6862));
halphafitkeckL2_20120616 = fit(keckL1_20120616,keckL2_20120616,'poly3','Robust','Bisquare','Exclude',(keckL1_20120616<5250)|(keckL1_20120616>8250)|(keckL1_20120616>6162&keckL1_20120616<6962));
halphafitmmtbc2_20120701 = fit(mmtbc1_20120701,mmtbc2_20120701,'poly3','Robust','Bisquare','Exclude',(mmtbc1_20120701<6000)|(mmtbc1_20120701>8250)|(mmtbc1_20120701>6262&mmtbc1_20120701<6862));
halphafitkeckD2_20121115 = fit(keckD1_20121115,keckD2_20121115,'poly3','Robust','Bisquare','Exclude',(keckD1_20121115<5250)|(keckD1_20121115>8250)|(keckD1_20121115>6162&keckD1_20121115<6962));
halphafitkeckD2_20150521 = fit(keckD1_20150521,keckD2_20150521,'poly3','Robust','Bisquare','Exclude',(keckD1_20150521<5250)|(keckD1_20150521>8250)|(keckD1_20150521>6162&keckD1_20150521<6962));
halphafithetms2_20120207 = fit(hetms1_20120207,hetms2_20120207,'poly3','Robust','Bisquare','Exclude',(hetms1_20120207<5850)|(hetms1_20120207>9000)|(hetms1_20120207>6162&hetms1_20120207<6962));
halphafithetms2_20120216 = fit(hetms1_20120216,hetms2_20120216,'poly3','Robust','Bisquare','Exclude',(hetms1_20120216<5850)|(hetms1_20120216>9000)|(hetms1_20120216>6162&hetms1_20120216<6962));
halphafithetms2_20120301 = fit(hetms1_20120301,hetms2_20120301,'poly3','Robust','Bisquare','Exclude',(hetms1_20120301<5850)|(hetms1_20120301>9000)|(hetms1_20120301>6162&hetms1_20120301<6962));





%interpolate between actual 0.5

for i=1:length(hetms1_20120207(find(hetms1_20120207 >= 6313 & hetms1_20120207 <= hetms2_20120207_centern)))
	leftfracheight(1,i) = hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 >= 6313,1,'first')+(i-1))/hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern));
end
for i=1:length(hetms1_20120207(find(hetms1_20120207 >= hetms2_20120207_centern & hetms1_20120207 <= 6613)))
	rightfracheight(1,i) = hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern)+(i-1))/hetms2_20120207_halphacontfitnormsubinterp(find(hetms1_20120207 == hetms2_20120207_centern));
end
widthofleft50height(1) = hetms2_20120207_centern - hetms1_20120207(find(hetms1_20120207 >= 6313,1,'first') + (find(leftfracheight(1,:)<=0.5&leftfracheight(1,:)>0,1,'last')-1))
widthofright50height(1) = hetms1_20120207(find(hetms1_20120207 == hetms2_20120207_centern) + (find(rightfracheight(1,:)<=0.5,1,'first')-1)) - hetms2_20120207_centern 


for i=1:length(hetms1_20120216(find(hetms1_20120216 >= 6313 & hetms1_20120216 <= hetms2_20120216_centern)))
	leftfracheight(2,i) = hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 >= 6313,1,'first')+(i-1))/hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern));
end
for i=1:length(hetms1_20120216(find(hetms1_20120216 >= hetms2_20120216_centern & hetms1_20120216 <= 6813)))
	rightfracheight(2,i) = hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern)+(i-1))/hetms2_20120216_halphacontfitnormsubinterp(find(hetms1_20120216 == hetms2_20120216_centern));
end
widthofleft50height(2) = hetms2_20120216_centern - hetms1_20120216(find(hetms1_20120216 >= 6313,1,'first') + (find(leftfracheight(2,:)<=0.5&leftfracheight(2,:)>0,1,'last')-1))
widthofright50height(2) = hetms1_20120216(find(hetms1_20120216 == hetms2_20120216_centern) + (find(rightfracheight(2,:)<=0.5,1,'first')-1)) - hetms2_20120216_centern 

for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= 6313 & Lkast1_20120223 <= Lkast2_20120223_centern)))
	leftfracheight(3,i) = Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 >= 6313,1,'first')+(i-1))/Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern));
end
for i=1:length(Lkast1_20120223(find(Lkast1_20120223 >= Lkast2_20120223_centern & Lkast1_20120223 <= 6813)))
	rightfracheight(3,i) = Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern)+(i-1))/Lkast2_20120223_halphacontfitnormsubinterp(find(Lkast1_20120223 == Lkast2_20120223_centern));
end
widthofleft50height(3) = Lkast2_20120223_centern - Lkast1_20120223(find(Lkast1_20120223 >= 6313,1,'first') + (find(leftfracheight(3,:)<=0.5&leftfracheight(3,:)>0,1,'last')-1))
widthofright50height(3) = Lkast1_20120223(find(Lkast1_20120223 == Lkast2_20120223_centern) + (find(rightfracheight(3,:)<=0.5,1,'first')-1)) - Lkast2_20120223_centern 



for i=1:length(hetms1_20120301(find(hetms1_20120301 >= 6313 & hetms1_20120301 <= hetms2_20120301_centern)))
	leftfracheight(4,i) = hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 >= 6313,1,'first')+(i-1))/hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern));
end
for i=1:length(hetms1_20120301(find(hetms1_20120301 >= hetms2_20120301_centern & hetms1_20120301 <= 6813)))
	rightfracheight(4,i) = hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern)+(i-1))/hetms2_20120301_halphacontfitnormsubinterp(find(hetms1_20120301 == hetms2_20120301_centern));
end
widthofleft50height(4) = hetms2_20120301_centern - hetms1_20120301(find(hetms1_20120301 >= 6313,1,'first') + (find(leftfracheight(4,:)<=0.5&leftfracheight(4,:)>0,1,'last')-1))
widthofright50height(4) = hetms1_20120301(find(hetms1_20120301 == hetms2_20120301_centern) + (find(rightfracheight(4,:)<=0.5,1,'first')-1)) - hetms2_20120301_centern 


for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= 6313 & mmtbc1_20120301 <= mmtbc2_20120301_centern)))
	leftfracheight(5,i) = mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 >= 6313,1,'first')+(i-1))/mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern));
end
for i=1:length(mmtbc1_20120301(find(mmtbc1_20120301 >= mmtbc2_20120301_centern & mmtbc1_20120301 <= 6813)))
	rightfracheight(5,i) = mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern)+(i-1))/mmtbc2_20120301_halphacontfitnormsubinterp(find(mmtbc1_20120301 == mmtbc2_20120301_centern));
end
widthofleft50height(5) = mmtbc2_20120301_centern - mmtbc1_20120301(find(mmtbc1_20120301 >= 6313,1,'first') + (find(leftfracheight(5,:)<=0.5&leftfracheight(5,:)>0,1,'last')-1))
widthofright50height(5) = mmtbc1_20120301(find(mmtbc1_20120301 == mmtbc2_20120301_centern) + (find(rightfracheight(5,:)<=0.5,1,'first')-1)) - mmtbc2_20120301_centern 


for i=1:length(spolb1_20120323(find(spolb1_20120323 >= 6313 & spolb1_20120323 <= spolb2_20120323_centern)))
	leftfracheight(6,i) = spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 >= 6313,1,'first')+(i-1))/spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern));
end
for i=1:length(spolb1_20120323(find(spolb1_20120323 >= spolb2_20120323_centern & spolb1_20120323 <= 6813)))
	rightfracheight(6,i) = spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern)+(i-1))/spolb2_20120323_halphacontfitnormsubinterp(find(spolb1_20120323 == spolb2_20120323_centern));
end
widthofleft50height(6) = spolb2_20120323_centern - spolb1_20120323(find(spolb1_20120323 >= 6313,1,'first') + (find(leftfracheight(6,:)<=0.5&leftfracheight(6,:)>0,1,'last')-1))
widthofright50height(6) = spolb1_20120323(find(spolb1_20120323 == spolb2_20120323_centern) + (find(rightfracheight(6,:)<=0.5,1,'first')-1)) - spolb2_20120323_centern 


for i=1:length(spolm1_20120416 (find(spolm1_20120416  >= 6313 & spolm1_20120416  <= spolm2_20120416_centern)))
	leftfracheight(7,i) = spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  >= 6313,1,'first')+(i-1))/spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern));
end
for i=1:length(spolm1_20120416 (find(spolm1_20120416  >= spolm2_20120416_centern & spolm1_20120416  <= 6813)))
	rightfracheight(7,i) = spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern)+(i-1))/spolm2_20120416_halphacontfitnormsubinterp(find(spolm1_20120416  == spolm2_20120416_centern));
end
widthofleft50height(7) = spolm2_20120416_centern - spolm1_20120416 (find(spolm1_20120416  >= 6313,1,'first') + (find(leftfracheight(7,:)<=0.5&leftfracheight(7,:)>0,1,'last')-1))
widthofright50height(7) = spolm1_20120416 (find(spolm1_20120416  == spolm2_20120416_centern) + (find(rightfracheight(7,:)<=0.5,1,'first')-1)) - spolm2_20120416_centern 


for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= 6313 & mmtbc1_20120417 <= mmtbc2_20120417_centern)))
	leftfracheight(8,i) = mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 >= 6313,1,'first')+(i-1))/mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern));
end
for i=1:length(mmtbc1_20120417(find(mmtbc1_20120417 >= mmtbc2_20120417_centern & mmtbc1_20120417 <= 6813)))
	rightfracheight(8,i) = mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern)+(i-1))/mmtbc2_20120417_halphacontfitnormsubinterp(find(mmtbc1_20120417 == mmtbc2_20120417_centern));
end
widthofleft50height(8) = mmtbc2_20120417_centern - mmtbc1_20120417(find(mmtbc1_20120417 >= 6313,1,'first') + (find(leftfracheight(8,:)<=0.5&leftfracheight(8,:)>0,1,'last')-1))
widthofright50height(8) = mmtbc1_20120417(find(mmtbc1_20120417 == mmtbc2_20120417_centern) + (find(rightfracheight(8,:)<=0.5,1,'first')-1)) - mmtbc2_20120417_centern 


for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= 6313 & Lkast1_20120428 <= Lkast2_20120428_centern)))
	leftfracheight(9,i) = Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 >= 6313,1,'first')+(i-1))/Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern));
end
for i=1:length(Lkast1_20120428(find(Lkast1_20120428 >= Lkast2_20120428_centern & Lkast1_20120428 <= 6813)))
	rightfracheight(9,i) = Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern)+(i-1))/Lkast2_20120428_halphacontfitnormsubinterp(find(Lkast1_20120428 == Lkast2_20120428_centern));
end
widthofleft50height(9) = Lkast2_20120428_centern - Lkast1_20120428(find(Lkast1_20120428 >= 6313,1,'first') + (find(leftfracheight(9,:)<=0.5&leftfracheight(9,:)>0,1,'last')-1))
widthofright50height(9) = Lkast1_20120428(find(Lkast1_20120428 == Lkast2_20120428_centern) + (find(rightfracheight(9,:)<=0.5,1,'first')-1)) - Lkast2_20120428_centern 


for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= 6313 & mmtbc1_20120529 <= mmtbc2_20120529_centern)))
	leftfracheight(10,i) = mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 >= 6313,1,'first')+(i-1))/mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern));
end
for i=1:length(mmtbc1_20120529(find(mmtbc1_20120529 >= mmtbc2_20120529_centern & mmtbc1_20120529 <= 6813)))
	rightfracheight(10,i) = mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern)+(i-1))/mmtbc2_20120529_halphacontfitnormsubinterp(find(mmtbc1_20120529 == mmtbc2_20120529_centern));
end
widthofleft50height(10) = mmtbc2_20120529_centern - mmtbc1_20120529(find(mmtbc1_20120529 >= 6313,1,'first') + (find(leftfracheight(10,:)<=0.5&leftfracheight(10,:)>0,1,'last')-1))
widthofright50height(10) = mmtbc1_20120529(find(mmtbc1_20120529 == mmtbc2_20120529_centern) + (find(rightfracheight(10,:)<=0.5,1,'first')-1)) - mmtbc2_20120529_centern 


for i=1:length(keckL1_20120616(find(keckL1_20120616 >= 6313 & keckL1_20120616 <= keckL2_20120616_centern)))
	leftfracheight(11,i) = keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 >= 6313,1,'first')+(i-1))/keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern));
end
for i=1:length(keckL1_20120616(find(keckL1_20120616 >= keckL2_20120616_centern & keckL1_20120616 <= 6813)))
	rightfracheight(11,i) = keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern)+(i-1))/keckL2_20120616_halphacontfitnormsubinterp(find(keckL1_20120616 == keckL2_20120616_centern));
end
widthofleft50height(11) = keckL2_20120616_centern - keckL1_20120616(find(keckL1_20120616 >= 6313,1,'first') + (find(leftfracheight(11,:)<=0.5&leftfracheight(11,:)>0,1,'last')-1))
widthofright50height(11) = keckL1_20120616(find(keckL1_20120616 == keckL2_20120616_centern) + (find(rightfracheight(11,:)<=0.5,1,'first')-1)) - keckL2_20120616_centern 


for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= 6313 & mmtbc1_20120701 <= mmtbc2_20120701_centern)))
	leftfracheight(12,i) = mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 >= 6313,1,'first')+(i-1))/mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern));
end
for i=1:length(mmtbc1_20120701(find(mmtbc1_20120701 >= mmtbc2_20120701_centern & mmtbc1_20120701 <= 6813)))
	rightfracheight(12,i) = mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern)+(i-1))/mmtbc2_20120701_halphacontfitnormsubinterp(find(mmtbc1_20120701 == mmtbc2_20120701_centern));
end
widthofleft50height(12) = mmtbc2_20120701_centern - mmtbc1_20120701(find(mmtbc1_20120701 >= 6313,1,'first') + (find(leftfracheight(12,:)<=0.5&leftfracheight(12,:)>0,1,'last')-1))
widthofright50height(12) = mmtbc1_20120701(find(mmtbc1_20120701 == mmtbc2_20120701_centern) + (find(rightfracheight(12,:)<=0.5,1,'first')-1)) - mmtbc2_20120701_centern 


for i=1:length(keckD1_20121115(find(keckD1_20121115 >= 6313 & keckD1_20121115 <= keckD2_20121115_centern)))
	leftfracheight(13,i) = keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 >= 6313,1,'first')+(i-1))/keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern));
end
for i=1:length(keckD1_20121115(find(keckD1_20121115 >= keckD2_20121115_centern & keckD1_20121115 <= 6813)))
	rightfracheight(13,i) = keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern)+(i-1))/keckD2_20121115_halphacontfitnormsubinterp(find(keckD1_20121115 == keckD2_20121115_centern));
end
widthofleft50height(13) = keckD2_20121115_centern - keckD1_20121115(find(keckD1_20121115 >= 6313,1,'first') + (find(leftfracheight(13,:)<=0.5&leftfracheight(13,:)>0,1,'last')-1))
widthofright50height(13) = keckD1_20121115(find(keckD1_20121115 == keckD2_20121115_centern) + (find(rightfracheight(13,:)<=0.5,1,'first')-1)) - keckD2_20121115_centern 


for i=1:length(keckD1_20150521(find(keckD1_20150521 >= 6313 & keckD1_20150521 <= keckD2_20150521_centern)))
	leftfracheight(14,i) = keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 >= 6313,1,'first')+(i-1))/keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern));
end
for i=1:length(keckD1_20150521(find(keckD1_20150521 >= keckD2_20150521_centern & keckD1_20150521 <= 6813)))
	rightfracheight(14,i) = keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern)+(i-1))/keckD2_20150521_halphacontfitnormsubinterp(find(keckD1_20150521 == keckD2_20150521_centern));
end
widthofleft50height(14) = keckD2_20150521_centern - keckD1_20150521(find(keckD1_20150521 >= 6313,1,'first') + (find(leftfracheight(14,:)<=0.5&leftfracheight(14,:)>0,1,'last')-1))
widthofright50height(14) = keckD1_20150521(find(keckD1_20150521 == keckD2_20150521_centern) + (find(rightfracheight(14,:)<=0.5,1,'first')-1)) - keckD2_20150521_centern 









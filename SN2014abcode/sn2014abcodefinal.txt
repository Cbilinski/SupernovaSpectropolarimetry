clear all
opengl software
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\altmany-export_fig-2763b78'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\useradded\append_pdfs'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\useradded\export_fig'))
addpath(genpath('C:\Users\Cbilinski\Desktop\code\matlab\cgb'))
plotting = figure;
set(gcf,'color','w');
set(plotting,'units','normalized','outerposition',[0 0 1 1]);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(gcf,'renderer','painters')
colormap jet


%define constants
lambdaHalpha = 6562.81;
%http://www.rochesterastronomy.org/sn2014/index.html
%http://ned.ipac.caltech.edu/cgi-bin/nph-objsearch?objname=UGC+8728&img_stamp=YES&extend=no&list_limit=9
%z_sn2014ab= 0.023226;
z_sn2014ab= 0.023516;
%juliandate(2014,03,9.43)+reltest(1)-juliandate(2014,01,12+11/24+24/60/24+41/60/60/24) determines the actual discovery date even though it was not announced
discoverydatejd_sn2014ab= juliandate(2014,01,12.4755);
discoverydatejd_sn2014ab_rochester = juliandate(2014,03,9.43);
jdtomjd=-2400000.5;
discoverydatemjd = discoverydatejd_sn2014ab+jdtomjd;
%A_B_sn2014ab= 0.110;
%A_V_sn2014ab= 0.083;
%A_R_sn2014ab= 0.066;
%A_I_sn2014ab= 0.045;
A_B_sn2014ab= 0.107;
A_V_sn2014ab= 0.081;
A_R_sn2014ab= 0.064;
A_I_sn2014ab= 0.044;
redshiftdistance_2014ab = 105.7; %in Mpc error 7.3
redshiftdistancemodulus_2014ab = -5*(log10(redshiftdistance_2014ab*10^6)-1);
%R.A. = 13:48:05.99, 
%Decl. = +07:23:16.4 

%apply known milky way reddening, fix narrow lines, then measure the NaID, then apply NaID and adjust the narrow line offset
%with narrow line offset first, then apply a new narrow line correction after applying this new reddening
%A_V_NaID = 0.2147;
%A_R_NaID = 0.1738;
%A_I_NaID = 0.1284;
%A_B_NaID = 0.2813;
%A_V_NaID = 0.2314;
%A_R_NaID = 0.1873;
%A_I_NaID = 0.1384;
%A_B_NaID = 0.3032;
A_V_NaID = 0.1756;
A_R_NaID = 0.1422;
A_I_NaID = 0.1050;
A_B_NaID = 0.2300;

%if no narrow line offset
%A_V_NaID = 0.3297;
%A_R_NaID = 0.2669;
%A_I_NaID = 0.1969;
%A_B_NaID = 0.4315;

%create relative dates for years 2004-2016
year2004MJD = 53005;
yearaxisreldate(1) = year2004MJD-discoverydatemjd;
for i=2:13
	yearaxisreldate(i) = year2004MJD-discoverydatemjd+(i-1)*365.25;
end

%read in data

%new light curve
[LCsn2014ab(1,:) LCsn2014ab(2,:) LCsn2014ab(3,:) LCsn2014ab(4,:) LCsn2014ab(5,:) LCsn2014ab(6,:) LCsn2014ab(7,:) LCsn2014ab(8,:) LCsn2014ab(9,:) LCsn2014ab(10,:) LCsn2014ab(11,:)] = textread('lightcurve_sn2014ab_nickel_standard_table_readable.dat','%f%f%f%f%f%f%f%f%f%f%f','delimiter',',');

for i=1:size(LCsn2014ab,1)
	for j=1:size(LCsn2014ab,2)
		if(LCsn2014ab(i,j) == 0)
			LCsn2014ab(i,j) = NaN;
		end
	end
end

%CSS light curve 
[LCCSSsn2014abunsort(1,:) LCCSSsn2014abunsort(2,:) LCCSSsn2014abunsort(3,:) LCCSSsn2014abunsort(4,:) LCCSSsn2014abunsort(5,:) LCCSSsn2014abunsort(6,:) LCCSSsn2014abunsort(7,:)] = textread('CSS2014abLightCurve_fromresultweb.txt','%f%f%f%f%f%f%f','delimiter',',');
[CSSsortdate, CSSsortdateindex] = sort(LCCSSsn2014abunsort(6,:));
for i=1:7
	LCCSSsn2014ab(i,:) = LCCSSsn2014abunsort(i,CSSsortdateindex);
end

%convert to absolute magnitude and remove MW extinction and remove NaID extinction
absmagB_sn2014ab = LCsn2014ab(4,:) +redshiftdistancemodulus_2014ab-A_B_sn2014ab-A_B_NaID;
absmagV_sn2014ab = LCsn2014ab(6,:) +redshiftdistancemodulus_2014ab-A_V_sn2014ab-A_V_NaID;
absmagR_sn2014ab = LCsn2014ab(8,:) +redshiftdistancemodulus_2014ab-A_R_sn2014ab-A_R_NaID;
absmagI_sn2014ab = LCsn2014ab(10,:)+redshiftdistancemodulus_2014ab-A_I_sn2014ab-A_I_NaID;
absmagVCSS_sn2014ab = LCCSSsn2014ab(2,:)+redshiftdistancemodulus_2014ab-A_V_sn2014ab-A_V_NaID;

magerrorB_sn2014ab= LCsn2014ab(5,:);
magerrorV_sn2014ab= LCsn2014ab(7,:);
magerrorR_sn2014ab= LCsn2014ab(9,:);
magerrorI_sn2014ab= LCsn2014ab(11,:);
magerrorVCSS_sn2014ab = LCCSSsn2014ab(3,:);

LCreldateB_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCreldateV_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCreldateR_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCreldateI_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCCSSreldateV_sn2014ab = LCCSSsn2014ab(6,:) - discoverydatemjd;

%CSS
%day -56 (using old relative dates
(absmagVCSS_sn2014ab(342)+absmagVCSS_sn2014ab(343)+absmagVCSS_sn2014ab(344)+absmagVCSS_sn2014ab(345))/4
%day 18
(absmagVCSS_sn2014ab(350)+absmagVCSS_sn2014ab(351)+absmagVCSS_sn2014ab(352)+absmagVCSS_sn2014ab(353))/4

%day 114
(absmagVCSS_sn2014ab(374)+absmagVCSS_sn2014ab(375)+absmagVCSS_sn2014ab(376)+absmagVCSS_sn2014ab(377))/4

%spectra
%Magellan
[d20140519_sn2014ab_1(1,:)  d20140519_sn2014ab_1(2,:)] =textread('SN2014ab_IMACS_1200_2014-05-19.txt','%f%f','delimiter',' ');

%%%%%should compare what the difference between these two is
%NTT
[d20140310_sn2014ab_1(1,:)  d20140310_sn2014ab_1(2,:)] =textread('PSJ13480599+0723164_20140309_Gr13_Free_slit1.0_57003_1.dat','%f%f','delimiter',' ');
[d20140310_sn2014ab_2(1,:)  d20140310_sn2014ab_2(2,:)] =textread('tPSJ13480599+0723164_20140309_Gr13_Free_slit1.0_1_f.asci','%f%f','delimiter',' ');

%actually somewhat different but ignoring for now
clf
plot(d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))
hold all
plot(d20140310_sn2014ab_2(1,:),d20140310_sn2014ab_2(2,:))



%Lick
[d20140324_sn2014ab_1(1,:)  d20140324_sn2014ab_1(2,:) d20140324_sn2014ab_1(3,:)] =textread('sn2014ab-20140324.533-ui.flm','%f%f%f','delimiter',' ');
[d20140430_sn2014ab_1(1,:)  d20140430_sn2014ab_1(2,:) d20140430_sn2014ab_1(3,:)] =textread('sn2014ab-20140430.405-ui.flm','%f%f%f','delimiter',' ');
[d20140528_sn2014ab_1(1,:)  d20140528_sn2014ab_1(2,:) d20140528_sn2014ab_1(3,:)] =textread('sn2014ab-20140528.350-ui.flm','%f%f%f','delimiter',' ');
[d20140621_sn2014ab_1(1,:)  d20140621_sn2014ab_1(2,:) d20140621_sn2014ab_1(3,:)] =textread('sn2014ab-20140621.267-ui.flm','%f%f%f','delimiter',' ');
[d20140630_sn2014ab_1(1,:)  d20140630_sn2014ab_1(2,:) d20140630_sn2014ab_1(3,:)] =textread('sn2014ab-20140630.275-ui.flm','%f%f%f','delimiter',' ');

%Floyds
%code for iraf to generate the ascii files from the fits files:
%wspectext 14ab_20140408_redblu_130141.688.fits[*,1] 14ab_20140408_redblu_130141.688.ascii     
%wspectext 14ab_20140409_redblu_130138.753a.fits[*,1] 14ab_20140409_redblu_130138.753a.ascii     
%wspectext 14ab_20140411_redblu_110654.037a.fits[*,1] 14ab_20140411_redblu_110654.037a.ascii     
%wspectext PSN134805_20140507_redblu_091056.362a.fits[*,1] PSN134805_20140507_redblu_091056.362a.ascii
%wspectext PSN134805_20140507_redblu_111119.119a.fits[*,1] PSN134805_20140507_redblu_111119.119a.ascii
%wspectext PSN134805_20140507_redblu_115738.671a.fits[*,1] PSN134805_20140507_redblu_115738.671a.ascii
%wspectext sn2014ab_20140420_redblu_135720.950a.fits[*,1] sn2014ab_20140420_redblu_135720.950a.ascii 
%wspectext sn2014ab_20140423_redblu_134720.890a.fits[*,1] sn2014ab_20140423_redblu_134720.890a.ascii 
%wspectext sn2014ab_20140522_redblu_080229.904a.fits[*,1] sn2014ab_20140522_redblu_080229.904a.ascii 

%read in code for FLOYDS
[d20140408_sn2014ab_1(1,:)  d20140408_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140408_redblu_130141.688.ascii     ','%f%f','delimiter',' ');
[d20140409_sn2014ab_1(1,:)  d20140409_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140409_redblu_130138.753a.ascii     ','%f%f','delimiter',' ');
[d20140411_sn2014ab_1(1,:)  d20140411_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140411_redblu_110654.037a.ascii     ','%f%f','delimiter',' ');
[d20140507_sn2014ab_1(1,:)  d20140507_sn2014ab_1(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_091056.362a.ascii','%f%f','delimiter',' ');
[d20140507_sn2014ab_2(1,:)  d20140507_sn2014ab_2(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_111119.119a.ascii','%f%f','delimiter',' ');
[d20140507_sn2014ab_3(1,:)  d20140507_sn2014ab_3(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_115738.671a.ascii','%f%f','delimiter',' ');
[d20140420_sn2014ab_1(1,:)  d20140420_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140420_redblu_135720.950a.ascii ','%f%f','delimiter',' ');
[d20140423_sn2014ab_1(1,:)  d20140423_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140423_redblu_134720.890a.ascii ','%f%f','delimiter',' ');
[d20140522_sn2014ab_1(1,:)  d20140522_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140522_redblu_080229.904a.ascii ','%f%f','delimiter',' ');

d20140507datacell1 = {d20140507_sn2014ab_1(1,:) d20140507_sn2014ab_2(1,:) d20140507_sn2014ab_3(1,:)};
d20140507datacell2 = {d20140507_sn2014ab_1(2,:) d20140507_sn2014ab_2(2,:) d20140507_sn2014ab_3(2,:)};
[d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:)] = interpcombinedata(d20140507datacell1,d20140507datacell2);

%clf
%hold all
%plot(d20140408_sn2014ab_1(1,:),d20140408_sn2014ab_1(2,:))
%plot(d20140409_sn2014ab_1(1,:),d20140409_sn2014ab_1(2,:))
%plot(d20140411_sn2014ab_1(1,:),d20140411_sn2014ab_1(2,:))
%axis([[4650 5100] [0.55*10^-16 4*10^-14]])
%export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\DoublePeakHbetaFLOYDS20140408to11.pdf

%VLT-X-Shooter
rawbt20140526_2 =  fitsread('ADP.2014-05-26T15_03_44.393.fits','binarytable');
rawbt20140526_3 =  fitsread('ADP.2014-05-26T15_03_44.407.fits','binarytable');
rawbt20140526_4 =  fitsread('ADP.2014-05-26T15_03_44.607.fits','binarytable');
rawbt20140602_1 =  fitsread('ADP.2014-06-02T12_54_50.840.fits','binarytable');
rawbt20140602_2 =  fitsread('ADP.2014-06-02T12_54_51.460.fits','binarytable');
rawbt20140602_3 =  fitsread('ADP.2014-06-02T12_54_51.513.fits','binarytable');
rawbt20140722_1 =  fitsread('ADP.2014-07-22T07_25_21.390.fits','binarytable');
rawbt20140722_2 =  fitsread('ADP.2014-07-22T07_25_21.403.fits','binarytable');
rawbt20140722_3 =  fitsread('ADP.2014-07-22T07_25_21.717.fits','binarytable');
rawbt20140722_4 =  fitsread('ADP.2014-07-22T07_35_01.203.fits','binarytable');
rawbt20140722_5 =  fitsread('ADP.2014-07-22T07_35_01.463.fits','binarytable');
rawbt20140722_6 =  fitsread('ADP.2014-07-22T07_35_01.713.fits','binarytable');
rawbt20140808_1 =  fitsread('ADP.2014-08-08T10_21_32.763.fits','binarytable');
rawbt20140808_2 =  fitsread('ADP.2014-08-08T10_21_32.777.fits','binarytable');
rawbt20140808_3 =  fitsread('ADP.2014-08-08T10_21_32.977.fits','binarytable');

d20140526_sn2014abtemp_2(1,:) = cell2mat(rawbt20140526_2(1)).*10;
d20140526_sn2014abtemp_3(1,:) = cell2mat(rawbt20140526_3(1)).*10;
d20140526_sn2014abtemp_4(1,:) = cell2mat(rawbt20140526_4(1)).*10;
d20140602_sn2014abtemp_1(1,:) = cell2mat(rawbt20140602_1(1)).*10;
d20140602_sn2014abtemp_2(1,:) = cell2mat(rawbt20140602_2(1)).*10;
d20140602_sn2014abtemp_3(1,:) = cell2mat(rawbt20140602_3(1)).*10;
d20140722_sn2014abtemp_1(1,:) = cell2mat(rawbt20140722_1(1)).*10;
d20140722_sn2014abtemp_2(1,:) = cell2mat(rawbt20140722_2(1)).*10;
d20140722_sn2014abtemp_3(1,:) = cell2mat(rawbt20140722_3(1)).*10;
d20140722_sn2014abtemp_4(1,:) = cell2mat(rawbt20140722_4(1)).*10;
d20140722_sn2014abtemp_5(1,:) = cell2mat(rawbt20140722_5(1)).*10;
d20140722_sn2014abtemp_6(1,:) = cell2mat(rawbt20140722_6(1)).*10;
d20140808_sn2014abtemp_1(1,:) = cell2mat(rawbt20140808_1(1)).*10;
d20140808_sn2014abtemp_2(1,:) = cell2mat(rawbt20140808_2(1)).*10;
d20140808_sn2014abtemp_3(1,:) = cell2mat(rawbt20140808_3(1)).*10;

d20140526_sn2014abtemp_2(2,:) = cell2mat(rawbt20140526_2(2));
d20140526_sn2014abtemp_3(2,:) = cell2mat(rawbt20140526_3(2));
d20140526_sn2014abtemp_4(2,:) = cell2mat(rawbt20140526_4(2));
d20140602_sn2014abtemp_1(2,:) = cell2mat(rawbt20140602_1(2));
d20140602_sn2014abtemp_2(2,:) = cell2mat(rawbt20140602_2(2));
d20140602_sn2014abtemp_3(2,:) = cell2mat(rawbt20140602_3(2));
d20140722_sn2014abtemp_1(2,:) = cell2mat(rawbt20140722_1(2));
d20140722_sn2014abtemp_2(2,:) = cell2mat(rawbt20140722_2(2));
d20140722_sn2014abtemp_3(2,:) = cell2mat(rawbt20140722_3(2));
d20140722_sn2014abtemp_4(2,:) = cell2mat(rawbt20140722_4(2));
d20140722_sn2014abtemp_5(2,:) = cell2mat(rawbt20140722_5(2));
d20140722_sn2014abtemp_6(2,:) = cell2mat(rawbt20140722_6(2));
d20140808_sn2014abtemp_1(2,:) = cell2mat(rawbt20140808_1(2));
d20140808_sn2014abtemp_2(2,:) = cell2mat(rawbt20140808_2(2));
d20140808_sn2014abtemp_3(2,:) = cell2mat(rawbt20140808_3(2));

%stitch together VLT X-Shooter data
d20140526_sn2014ab_2(1,:) = [d20140526_sn2014abtemp_3(1,:) d20140526_sn2014abtemp_2(1,(find(d20140526_sn2014abtemp_2(1,:) > max(d20140526_sn2014abtemp_3(1,:)),1,'first')):length(d20140526_sn2014abtemp_2)) d20140526_sn2014abtemp_4(1,(find(d20140526_sn2014abtemp_4(1,:) > max(d20140526_sn2014abtemp_2(1,:)),1,'first')):length(d20140526_sn2014abtemp_4))];
d20140526_sn2014ab_2(2,:) = [d20140526_sn2014abtemp_3(2,:) d20140526_sn2014abtemp_2(2,(find(d20140526_sn2014abtemp_2(1,:) > max(d20140526_sn2014abtemp_3(1,:)),1,'first')):length(d20140526_sn2014abtemp_2)) d20140526_sn2014abtemp_4(2,(find(d20140526_sn2014abtemp_4(1,:) > max(d20140526_sn2014abtemp_2(1,:)),1,'first')):length(d20140526_sn2014abtemp_4))];

d20140602_sn2014ab_1(1,:) = [d20140602_sn2014abtemp_1(1,:) d20140602_sn2014abtemp_3(1,(find(d20140602_sn2014abtemp_3(1,:) > max(d20140602_sn2014abtemp_1(1,:)),1,'first')):length(d20140602_sn2014abtemp_3)) d20140602_sn2014abtemp_2(1,(find(d20140602_sn2014abtemp_2(1,:) > max(d20140602_sn2014abtemp_3(1,:)),1,'first')):length(d20140602_sn2014abtemp_2))];
d20140602_sn2014ab_1(2,:) = [d20140602_sn2014abtemp_1(2,:) d20140602_sn2014abtemp_3(2,(find(d20140602_sn2014abtemp_3(1,:) > max(d20140602_sn2014abtemp_1(1,:)),1,'first')):length(d20140602_sn2014abtemp_3)) d20140602_sn2014abtemp_2(2,(find(d20140602_sn2014abtemp_2(1,:) > max(d20140602_sn2014abtemp_3(1,:)),1,'first')):length(d20140602_sn2014abtemp_2))];

%321
d20140722_sn2014ab_1(1,:) = [d20140722_sn2014abtemp_3(1,:) d20140722_sn2014abtemp_2(1,(find(d20140722_sn2014abtemp_2(1,:) > max(d20140722_sn2014abtemp_3(1,:)),1,'first')):length(d20140722_sn2014abtemp_2)) d20140722_sn2014abtemp_1(1,(find(d20140722_sn2014abtemp_1(1,:) > max(d20140722_sn2014abtemp_2(1,:)),1,'first')):length(d20140722_sn2014abtemp_1))];
d20140722_sn2014ab_1(2,:) = [d20140722_sn2014abtemp_3(2,:) d20140722_sn2014abtemp_2(2,(find(d20140722_sn2014abtemp_2(1,:) > max(d20140722_sn2014abtemp_3(1,:)),1,'first')):length(d20140722_sn2014abtemp_2)) d20140722_sn2014abtemp_1(2,(find(d20140722_sn2014abtemp_1(1,:) > max(d20140722_sn2014abtemp_2(1,:)),1,'first')):length(d20140722_sn2014abtemp_1))];

%465
d20140722_sn2014ab_4(1,:) = [d20140722_sn2014abtemp_4(1,:) d20140722_sn2014abtemp_6(1,(find(d20140722_sn2014abtemp_6(1,:) > max(d20140722_sn2014abtemp_4(1,:)),1,'first')):length(d20140722_sn2014abtemp_6)) d20140722_sn2014abtemp_5(1,(find(d20140722_sn2014abtemp_5(1,:) > max(d20140722_sn2014abtemp_6(1,:)),1,'first')):length(d20140722_sn2014abtemp_5))];
d20140722_sn2014ab_4(2,:) = [d20140722_sn2014abtemp_4(2,:) d20140722_sn2014abtemp_6(2,(find(d20140722_sn2014abtemp_6(1,:) > max(d20140722_sn2014abtemp_4(1,:)),1,'first')):length(d20140722_sn2014abtemp_6)) d20140722_sn2014abtemp_5(2,(find(d20140722_sn2014abtemp_5(1,:) > max(d20140722_sn2014abtemp_6(1,:)),1,'first')):length(d20140722_sn2014abtemp_5))];

d20140808_sn2014ab_1(1,:) = [d20140808_sn2014abtemp_2(1,:) d20140808_sn2014abtemp_3(1,(find(d20140808_sn2014abtemp_3(1,:) > max(d20140808_sn2014abtemp_2(1,:)),1,'first')):length(d20140808_sn2014abtemp_3)) d20140808_sn2014abtemp_1(1,(find(d20140808_sn2014abtemp_1(1,:) > max(d20140808_sn2014abtemp_3(1,:)),1,'first')):length(d20140808_sn2014abtemp_1))];
d20140808_sn2014ab_1(2,:) = [d20140808_sn2014abtemp_2(2,:) d20140808_sn2014abtemp_3(2,(find(d20140808_sn2014abtemp_3(1,:) > max(d20140808_sn2014abtemp_2(1,:)),1,'first')):length(d20140808_sn2014abtemp_3)) d20140808_sn2014abtemp_1(2,(find(d20140808_sn2014abtemp_1(1,:) > max(d20140808_sn2014abtemp_3(1,:)),1,'first')):length(d20140808_sn2014abtemp_1))];


%clf
%semilogy(d20140722_sn2014abtemp_4(1,:),d20140722_sn2014abtemp_4(2,:))
%hold on 
%semilogy(d20140722_sn2014abtemp_5(1,:),d20140722_sn2014abtemp_5(2,:))
%semilogy(d20140722_sn2014abtemp_6(1,:),d20140722_sn2014abtemp_6(2,:))

%flxxx matches the q2 files for all of the cases where there is a q1 and q2, why is this and what is the other file?  Where are the error files?
%0329 q2
%0501 q2
%0523 q2
%0622 q2
%0623 q2

%read in data for late-time MMT spectrum
[d20180414_sn2014ab_1(1,:) d20180414_sn2014ab_1(2,:)] =textread('MMT/SN2014abGal-2018-04-14-MMT-BCH-1200_formatedited.txt','%f%f','delimiter',' ');

%spectropolarimetry spol
[d20140329_sn2014ab_1(1,:)  d20140329_sn2014ab_1(2,:)] =textread('20140329_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140329_sn2014ab_1(3,:)] =textread('20140329_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140329_sn2014ab_1(4,:)] =textread('20140329_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140329_sn2014ab_1(5,:)] =textread('20140329_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp d20140329_sn2014ab_1(6,:)] =textread('20140329_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140330_sn2014ab_1(1,:)  d20140330_sn2014ab_1(2,:)] =textread('20140330_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140330_sn2014ab_1(3,:)] =textread('20140330_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140330_sn2014ab_1(4,:)] =textread('20140330_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140331_sn2014ab_1(1,:)  d20140331_sn2014ab_1(2,:)] =textread('20140331_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140331_sn2014ab_1(3,:)] =textread('20140331_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140331_sn2014ab_1(4,:)] =textread('20140331_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140402_sn2014ab_1(1,:)  d20140402_sn2014ab_1(2,:)] =textread('20140402_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140402_sn2014ab_1(3,:)] =textread('20140402_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140402_sn2014ab_1(4,:)] =textread('20140402_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140426_sn2014ab_1(1,:)  d20140426_sn2014ab_1(2,:)] =textread('20140426_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140426_sn2014ab_1(3,:)] =textread('20140426_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140426_sn2014ab_1(4,:)] =textread('20140426_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140427_sn2014ab_1(1,:)  d20140427_sn2014ab_1(2,:)] =textread('20140427_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140427_sn2014ab_1(3,:)] =textread('20140427_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140427_sn2014ab_1(4,:)] =textread('20140427_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140428_sn2014ab_1(1,:)  d20140428_sn2014ab_1(2,:)] =textread('20140428_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140428_sn2014ab_1(3,:)] =textread('20140428_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140428_sn2014ab_1(4,:)] =textread('20140428_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140501_sn2014ab_1(1,:)  d20140501_sn2014ab_1(2,:)] =textread('20140501_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140501_sn2014ab_1(3,:)] =textread('20140501_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140501_sn2014ab_1(4,:)] =textread('20140501_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140501_sn2014ab_1(5,:)] =textread('20140501_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp d20140501_sn2014ab_1(6,:)] =textread('20140501_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140523_sn2014ab_1(1,:)  d20140523_sn2014ab_1(2,:)] =textread('20140523_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(3,:)] =textread('20140523_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(4,:)] =textread('20140523_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(5,:)] =textread('20140523_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(6,:)] =textread('20140523_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140524_sn2014ab_1(1,:)  d20140524_sn2014ab_1(2,:)] =textread('20140524_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140524_sn2014ab_1(3,:)] =textread('20140524_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140524_sn2014ab_1(4,:)] =textread('20140524_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140526_sn2014ab_1(1,:)  d20140526_sn2014ab_1(2,:)] =textread('20140526_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140526_sn2014ab_1(3,:)] =textread('20140526_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140526_sn2014ab_1(4,:)] =textread('20140526_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140622_sn2014ab_1(1,:)  d20140622_sn2014ab_1(2,:)] =textread('20140622_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(3,:)] =textread('20140622_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(4,:)] =textread('20140622_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(5,:)] =textread('20140622_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(6,:)] =textread('20140622_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140623_sn2014ab_1(1,:)  d20140623_sn2014ab_1(2,:)] =textread('20140623_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(3,:)] =textread('20140623_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(4,:)] =textread('20140623_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(5,:)] =textread('20140623_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(6,:)] =textread('20140623_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140624_sn2014ab_1(1,:)  d20140624_sn2014ab_1(2,:)] =textread('20140624_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140624_sn2014ab_1(3,:)] =textread('20140624_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140624_sn2014ab_1(4,:)] =textread('20140624_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140626_sn2014ab_1(1,:)  d20140626_sn2014ab_1(2,:)] =textread('20140626_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140626_sn2014ab_1(3,:)] =textread('20140626_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140626_sn2014ab_1(4,:)] =textread('20140626_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140420_sn2014ab_2(1,:)  d20140420_sn2014ab_2(2,:)] =textread('MMT/20140420_spol_sn2014ab.flx.txt','%f%f','delimiter',' ');
[temp  d20140420_sn2014ab_2(3,:)] =textread('MMT/20140420_spol_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140420_sn2014ab_2(4,:)] =textread('MMT/20140420_spol_sn2014ab.u.txt','%f%f','delimiter',' ');

%OTHER SN DATA
%SN 2010jl
z_sn2010jl = 0.010697;
discoverydatejd_SN2010jl       = juliandate(2010,11,02.06       );

%Spectrum
[d_sn2010jl(1,:) d_sn2010jl(2,:) d_sn2010jl(3,:)] =textread('Hrenorm_sn2010jl-110406.dat','%f%f%f','delimiter',' ');
p_sn2010jl(1,:) = d_sn2010jl(1,:)./(1+z_sn2010jl);

[d20110102_sn2010jl(1,:) d20110102_sn2010jl(2,:)] = textread('2010jlspectra/2011jan02_sn2010jl.flx.txt','%f%f','delimiter',' ');
p20110102_sn2010jl(1,:) = d20110102_sn2010jl(1,:)/(1+z_sn2010jl);

%Lick SPOL (to compare Ca II region of line)
[d20110103_sn2010jl(1,:) d20110103_sn2010jl(2,:) cp cp cp cp cp cp cp cp] = textread('lick\sn2010jl_kast_20110103_specpol.txt','%f%f%f%f%f%f%f%f%f%f','delimiter',' ');
p20110103_sn2010jl(1,:) = d20110103_sn2010jl(1,:)/(1+z_sn2010jl);

[d20110125_sn2010jl(1,:) d20110125_sn2010jl(2,:) cp cp cp cp cp cp cp cp] = textread('lick\sn2010jl_kast_20110125_specpol.txt','%f%f%f%f%f%f%f%f%f%f','delimiter',' ');
p20110125_sn2010jl(1,:) = d20110125_sn2010jl(1,:)/(1+z_sn2010jl);

[d20110201_sn2010jl(1,:) d20110201_sn2010jl(2,:) cp cp cp cp cp cp cp cp] = textread('lick\sn2010jl_kast_20110201_specpol.txt','%f%f%f%f%f%f%f%f%f%f','delimiter',' ');
p20110201_sn2010jl(1,:) = d20110201_sn2010jl(1,:)/(1+z_sn2010jl);

%Light curve
fid   = fopen('sn2010jl_phot_fransson.txt');
LCsn2010jlscan =  textscan(fid,'%f%f%f%f%f%f%f%f%f%f%f%f%s%s','delimiter',' ','headerlines',1);
fclose(fid);

for i = 1:size(LCsn2010jlscan,2)-2
	LCsn2010jl(i,:) = LCsn2010jlscan{1,i};
end

LCsn2010jl(LCsn2010jl == 0) = NaN

uprime_ind_sn2010jl = ~isnan(LCsn2010jl(3,:));
LCsn2010jl_uprime_epoch = LCsn2010jl(2,uprime_ind_sn2010jl);
LCsn2010jl_uprime_appmags = LCsn2010jl(3,uprime_ind_sn2010jl);
LCsn2010jl_uprime_appmagserr = LCsn2010jl(4,uprime_ind_sn2010jl);

B_ind_sn2010jl = ~isnan(LCsn2010jl(5,:));
LCsn2010jl_B_epoch = LCsn2010jl(2,B_ind_sn2010jl);
LCsn2010jl_B_appmags = LCsn2010jl(5,B_ind_sn2010jl);
LCsn2010jl_B_appmagserr = LCsn2010jl(6,B_ind_sn2010jl);

V_ind_sn2010jl = ~isnan(LCsn2010jl(7,:));
LCsn2010jl_V_epoch = LCsn2010jl(2,V_ind_sn2010jl);
LCsn2010jl_V_appmags = LCsn2010jl(7,V_ind_sn2010jl);
LCsn2010jl_V_appmagserr = LCsn2010jl(8,V_ind_sn2010jl);

rprime_ind_sn2010jl = ~isnan(LCsn2010jl(9,:));
LCsn2010jl_rprime_epoch = LCsn2010jl(2,rprime_ind_sn2010jl);
LCsn2010jl_rprime_appmags = LCsn2010jl(9,rprime_ind_sn2010jl);
LCsn2010jl_rprime_appmagserr = LCsn2010jl(10,rprime_ind_sn2010jl);

iprime_ind_sn2010jl = ~isnan(LCsn2010jl(11,:));
LCsn2010jl_iprime_epoch = LCsn2010jl(2,iprime_ind_sn2010jl);
LCsn2010jl_iprime_appmags = LCsn2010jl(11,iprime_ind_sn2010jl);
LCsn2010jl_iprime_appmagserr = LCsn2010jl(12,iprime_ind_sn2010jl);

[LC1999em(1,:) LC1999em(2,:) LC1999em(3,:) LC1999em(4,:) LC1999em(5,:)] = textread('SN1999emLC.txt','%f%f%f%f%f','delimiter',' ');
[LC1998S(1,:) LC1998S(2,:) LC1998S(3,:)] = textread('SN1998SLC_R.txt','%f%f%f','delimiter',' ');
[LC2003hf(1,:) LC2003hf(2,:) LC2003hf(3,:) LC2003hf(4,:) LC2003hf(5,:) LC2003hf(6,:) LC2003hf(7,:) LC2003hf(8,:) LC2003hf(9,:) LC2003hf(10,:)] = textread('sn03hf-faran.txt','%f%f%f%f%f%f%f%f%f%f','delimiter',' ');


redshiftdistance1999em = 8.2;
redshiftdistancemodulus1999em = -5*(log10(8.2*10^6)-1);
A_R1999em= 3.1 * 0.04;
z1999em = 0.002392;

distance1998S = 15.612;
distancemodulus1998S = -5*(log10(distance1998S*10^6)-1);
A_R1998S= 3.1 * 0.050;
E_BmVgal1998S = 0.20;
A_R1998Sgal = 0.5189;

distance2010jl = 48.8;
distancemodulus2010jl = -5*(log10(distance2010jl*10^6)-1);
A_R2010jl = 0.059;
A_V2010jl = 0.075;
z2010jl = 0.010697;

redshiftdistance2003hf = 127.7;
redshiftdistancemodulus2003hf = -5*(log10(redshiftdistance2003hf*10^6)-1);
A_R2003hf = 0.047;
A_V2003hf = 0.060;
z2003hf = 0.031302;

LC1999emmjd = juliandate(LC1999em(3,:),LC1999em(1,:),LC1999em(2,:))-2400000.5;
peakdate1999em = LC1999emmjd(min(find(LC1999em(4,:)==min(LC1999em(4,:)))));
LC1999emabsmag = LC1999em(4,:)+redshiftdistancemodulus1999em-A_R1999em;

LC1998Smjd = LC1998S(1,:)+2450000-2400000.5;
peakdate1998S = LC1998Smjd(min(find(LC1998S(2,:)==min(LC1998S(2,:)))));
LC1998Sabsmag = LC1998S(2,:)+distancemodulus1998S-A_R1998S-A_R1998Sgal;

LC2003hfmjd = LC2003hf(1,:);
peakdate2003hf = 52863;
LC2003hfabsmag = LC2003hf(7,:)+redshiftdistancemodulus2003hf-A_R2003hf;

LC2010jlabsmagR = LCsn2010jl_rprime_appmags+distancemodulus2010jl-A_R2010jl;

%truncate ugly data
%temp1 = d20140526_sn2014ab_2(1,:);
%temp2 = d20140526_sn2014ab_2(2,:);
%clear d20140526_sn2014ab_2;
%d20140526_sn2014ab_2(2,:) = temp2(find(temp1>5500));
%d20140526_sn2014ab_2(1,:) = temp1(find(temp1>5500));
temp1 = d20140507_sn2014ab_4(1,1:end);
temp2 = d20140507_sn2014ab_4(2,1:end);
clear d20140507_sn2014ab_4
d20140507_sn2014ab_4(1,:) = temp1;
d20140507_sn2014ab_4(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140519_sn2014ab_1(1,1:4088);
temp2 = d20140519_sn2014ab_1(2,1:4088);
clear d20140519_sn2014ab_1
d20140519_sn2014ab_1(1,:) = temp1;
d20140519_sn2014ab_1(2,:) = temp2;

%truncate floyds data
clear temp1 temp2;
temp1 = d20140408_sn2014ab_1(1,find(d20140408_sn2014ab_1(1,:)>5000,1,'first'):end)
temp2 = d20140408_sn2014ab_1(2,find(d20140408_sn2014ab_1(1,:)>5000,1,'first'):end)
clear d20140408_sn2014ab_1
d20140408_sn2014ab_1(1,:) = temp1;
d20140408_sn2014ab_1(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140409_sn2014ab_1(1,find(d20140409_sn2014ab_1(1,:)>5000,1,'first'):end)
temp2 = d20140409_sn2014ab_1(2,find(d20140409_sn2014ab_1(1,:)>5000,1,'first'):end)
clear d20140409_sn2014ab_1
d20140409_sn2014ab_1(1,:) = temp1;
d20140409_sn2014ab_1(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140411_sn2014ab_1(1,find(d20140411_sn2014ab_1(1,:)>5000,1,'first'):end)
temp2 = d20140411_sn2014ab_1(2,find(d20140411_sn2014ab_1(1,:)>5000,1,'first'):end)
clear d20140411_sn2014ab_1
d20140411_sn2014ab_1(1,:) = temp1;
d20140411_sn2014ab_1(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140507_sn2014ab_1(1,find(d20140507_sn2014ab_1(1,:)>4000,1,'first'):end)
temp2 = d20140507_sn2014ab_1(2,find(d20140507_sn2014ab_1(1,:)>4000,1,'first'):end)
clear d20140507_sn2014ab_1
d20140507_sn2014ab_1(1,:) = temp1;
d20140507_sn2014ab_1(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140507_sn2014ab_2(1,find(d20140507_sn2014ab_2(1,:)>4000,1,'first'):end)
temp2 = d20140507_sn2014ab_2(2,find(d20140507_sn2014ab_2(1,:)>4000,1,'first'):end)
clear d20140507_sn2014ab_2
d20140507_sn2014ab_2(1,:) = temp1;
d20140507_sn2014ab_2(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140507_sn2014ab_3(1,find(d20140507_sn2014ab_3(1,:)>4000,1,'first'):end)
temp2 = d20140507_sn2014ab_3(2,find(d20140507_sn2014ab_3(1,:)>4000,1,'first'):end)
clear d20140507_sn2014ab_3
d20140507_sn2014ab_3(1,:) = temp1;
d20140507_sn2014ab_3(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140420_sn2014ab_1(1,find(d20140420_sn2014ab_1(1,:)>4000,1,'first'):end)
temp2 = d20140420_sn2014ab_1(2,find(d20140420_sn2014ab_1(1,:)>4000,1,'first'):end)
clear d20140420_sn2014ab_1
d20140420_sn2014ab_1(1,:) = temp1;
d20140420_sn2014ab_1(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140423_sn2014ab_1(1,find(d20140423_sn2014ab_1(1,:)>4000,1,'first'):end)
temp2 = d20140423_sn2014ab_1(2,find(d20140423_sn2014ab_1(1,:)>4000,1,'first'):end)
clear d20140423_sn2014ab_1
d20140423_sn2014ab_1(1,:) = temp1;
d20140423_sn2014ab_1(2,:) = temp2;

clear temp1 temp2;
temp1 = d20140522_sn2014ab_1(1,find(d20140522_sn2014ab_1(1,:)>4000,1,'first'):end)
temp2 = d20140522_sn2014ab_1(2,find(d20140522_sn2014ab_1(1,:)>4000,1,'first'):end)
clear d20140522_sn2014ab_1
d20140522_sn2014ab_1(1,:) = temp1;
d20140522_sn2014ab_1(2,:) = temp2;

clf
plot(d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:))

%calculate relative dates
p20140310_sn2014ab_1(1,1) = round(juliandate(2014,03,10) - discoverydatejd_sn2014ab)
%p20140310_sn2014ab_2(1,1) = round(juliandate(2014,03,10) - discoverydatejd_sn2014ab)
p20140324_sn2014ab_1(1,1) = round(juliandate(2014,03,24) - discoverydatejd_sn2014ab)
p20140329_sn2014ab_1(1,1) = round(juliandate(2014,03,29) - discoverydatejd_sn2014ab)
p20140330_sn2014ab_1(1,1) = round(juliandate(2014,03,30) - discoverydatejd_sn2014ab)
p20140331_sn2014ab_1(1,1) = round(juliandate(2014,03,31) - discoverydatejd_sn2014ab)
p20140402_sn2014ab_1(1,1) = round(juliandate(2014,04,02) - discoverydatejd_sn2014ab)
p20140426_sn2014ab_1(1,1) = round(juliandate(2014,04,26) - discoverydatejd_sn2014ab)
p20140427_sn2014ab_1(1,1) = round(juliandate(2014,04,27) - discoverydatejd_sn2014ab)
p20140428_sn2014ab_1(1,1) = round(juliandate(2014,04,28) - discoverydatejd_sn2014ab)
p20140430_sn2014ab_1(1,1) = round(juliandate(2014,04,30) - discoverydatejd_sn2014ab)
p20140501_sn2014ab_1(1,1) = round(juliandate(2014,05,01) - discoverydatejd_sn2014ab)
p20140519_sn2014ab_1(1,1) = round(juliandate(2014,05,19) - discoverydatejd_sn2014ab)
p20140523_sn2014ab_1(1,1) = round(juliandate(2014,05,23) - discoverydatejd_sn2014ab)
p20140524_sn2014ab_1(1,1) = round(juliandate(2014,05,24) - discoverydatejd_sn2014ab)
p20140526_sn2014ab_1(1,1) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
p20140528_sn2014ab_1(1,1) = round(juliandate(2014,05,28) - discoverydatejd_sn2014ab)
p20140621_sn2014ab_1(1,1) = round(juliandate(2014,06,21) - discoverydatejd_sn2014ab)
p20140622_sn2014ab_1(1,1) = round(juliandate(2014,06,22) - discoverydatejd_sn2014ab)
p20140623_sn2014ab_1(1,1) = round(juliandate(2014,06,23) - discoverydatejd_sn2014ab)
p20140624_sn2014ab_1(1,1) = round(juliandate(2014,06,24) - discoverydatejd_sn2014ab)
p20140626_sn2014ab_1(1,1) = round(juliandate(2014,06,26) - discoverydatejd_sn2014ab)
p20140630_sn2014ab_1(1,1) = round(juliandate(2014,06,30) - discoverydatejd_sn2014ab)
p20140526_sn2014ab_2(1,:) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
%p20140526_sn2014ab_3(1,:) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
%p20140526_sn2014ab_4(1,:) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
p20140602_sn2014ab_1(1,:) = round(juliandate(2014,06,02) - discoverydatejd_sn2014ab)
%p20140602_sn2014ab_2(1,:) = round(juliandate(2014,06,02) - discoverydatejd_sn2014ab)
%p20140602_sn2014ab_3(1,:) = round(juliandate(2014,06,02) - discoverydatejd_sn2014ab)
p20140722_sn2014ab_1(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_2(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_3(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
p20140722_sn2014ab_4(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_5(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_6(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
p20140808_sn2014ab_1(1,:) = round(juliandate(2014,08,08) - discoverydatejd_sn2014ab)
%p20140808_sn2014ab_2(1,:) = round(juliandate(2014,08,08) - discoverydatejd_sn2014ab)
%p20140808_sn2014ab_3(1,:) = round(juliandate(2014,08,08) - discoverydatejd_sn2014ab)
p20140408_sn2014ab_1(1,:) = round(juliandate(2014,04,08) - discoverydatejd_sn2014ab)
p20140409_sn2014ab_1(1,:) = round(juliandate(2014,04,09) - discoverydatejd_sn2014ab)
p20140411_sn2014ab_1(1,:) = round(juliandate(2014,04,11) - discoverydatejd_sn2014ab)
p20140507_sn2014ab_4(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
%p20140507_sn2014ab_1(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
%p20140507_sn2014ab_2(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
%p20140507_sn2014ab_3(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
p20140420_sn2014ab_1(1,:) = round(juliandate(2014,04,20) - discoverydatejd_sn2014ab)
p20140420_sn2014ab_2(1,:) = round(juliandate(2014,04,20) - discoverydatejd_sn2014ab)
p20140423_sn2014ab_1(1,:) = round(juliandate(2014,04,23) - discoverydatejd_sn2014ab)
p20140522_sn2014ab_1(1,:) = round(juliandate(2014,05,22) - discoverydatejd_sn2014ab)
p20180414_sn2014ab_1(1,:) = round(juliandate(2018,04,14) - discoverydatejd_sn2014ab)


data.reldate(1 ) = p20140310_sn2014ab_1(1,1);
data.reldate(2 ) = p20140324_sn2014ab_1(1,1);
data.reldate(3 ) = p20140329_sn2014ab_1(1,1);
data.reldate(4 ) = p20140330_sn2014ab_1(1,1);
data.reldate(5 ) = p20140331_sn2014ab_1(1,1);
data.reldate(6 ) = p20140402_sn2014ab_1(1,1);
data.reldate(7 ) = p20140408_sn2014ab_1(1,:);
data.reldate(8 ) = p20140409_sn2014ab_1(1,:);
data.reldate(9 ) = p20140411_sn2014ab_1(1,:);
data.reldate(10) = p20140420_sn2014ab_1(1,:);
data.reldate(11) = p20140420_sn2014ab_2(1,:);
data.reldate(12) = p20140423_sn2014ab_1(1,:);
data.reldate(13) = p20140426_sn2014ab_1(1,1);
data.reldate(14) = p20140427_sn2014ab_1(1,1);
data.reldate(15) = p20140428_sn2014ab_1(1,1);
data.reldate(16) = p20140430_sn2014ab_1(1,1);
data.reldate(17) = p20140501_sn2014ab_1(1,1);
data.reldate(18) = p20140507_sn2014ab_4(1,:);
data.reldate(19) = p20140519_sn2014ab_1(1,1);
data.reldate(20) = p20140522_sn2014ab_1(1,:);
data.reldate(21) = p20140523_sn2014ab_1(1,1);
data.reldate(22) = p20140524_sn2014ab_1(1,1);
data.reldate(23) = p20140526_sn2014ab_1(1,1);
data.reldate(24) = p20140526_sn2014ab_2(1,:);
data.reldate(25) = p20140528_sn2014ab_1(1,1);
data.reldate(26) = p20140602_sn2014ab_1(1,:);
data.reldate(27) = p20140621_sn2014ab_1(1,1);
data.reldate(28) = p20140622_sn2014ab_1(1,1);
data.reldate(29) = p20140623_sn2014ab_1(1,1);
data.reldate(30) = p20140624_sn2014ab_1(1,1);
data.reldate(31) = p20140626_sn2014ab_1(1,1);
data.reldate(32) = p20140630_sn2014ab_1(1,1);
data.reldate(33) = p20140722_sn2014ab_1(1,:);
data.reldate(34) = p20140722_sn2014ab_4(1,:);
data.reldate(35) = p20140808_sn2014ab_1(1,:);
data.reldate(36) = p20180414_sn2014ab_1(1,:);

data.ymd{1 } = '20140310';
data.ymd{2 } = '20140324';
data.ymd{3 } = '20140329';
data.ymd{4 } = '20140330';
data.ymd{5 } = '20140331';
data.ymd{6 } = '20140402';
data.ymd{7 } = '20140408';
data.ymd{8 } = '20140409';
data.ymd{9 } = '20140411';
data.ymd{10} = '20140420';
data.ymd{11} = '20140420';
data.ymd{12} = '20140423';
data.ymd{13} = '20140426';
data.ymd{14} = '20140427';
data.ymd{15} = '20140428';
data.ymd{16} = '20140430';
data.ymd{17} = '20140501';
data.ymd{18} = '20140507';
data.ymd{19} = '20140519';
data.ymd{20} = '20140522';
data.ymd{21} = '20140523';
data.ymd{22} = '20140524';
data.ymd{23} = '20140526';
data.ymd{24} = '20140526';
data.ymd{25} = '20140528';
data.ymd{26} = '20140602';
data.ymd{27} = '20140621';
data.ymd{28} = '20140622';
data.ymd{29} = '20140623';
data.ymd{30} = '20140624';
data.ymd{31} = '20140626';
data.ymd{32} = '20140630';
data.ymd{33} = '20140722';
data.ymd{34} = '20140722';
data.ymd{35} = '20140808';
data.ymd{36} = '20180414';



%deredshift
d20140310_sn2014ab_1(1,:) = d20140310_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
%d20140310_sn2014ab_2(1,:) = d20140310_sn2014ab_2(1,:)/(1+z_sn2014ab)  ;
d20140324_sn2014ab_1(1,:) = d20140324_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140329_sn2014ab_1(1,:) = d20140329_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140330_sn2014ab_1(1,:) = d20140330_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140331_sn2014ab_1(1,:) = d20140331_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140402_sn2014ab_1(1,:) = d20140402_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140426_sn2014ab_1(1,:) = d20140426_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140427_sn2014ab_1(1,:) = d20140427_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140428_sn2014ab_1(1,:) = d20140428_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140430_sn2014ab_1(1,:) = d20140430_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140501_sn2014ab_1(1,:) = d20140501_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140519_sn2014ab_1(1,:) = d20140519_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140523_sn2014ab_1(1,:) = d20140523_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140524_sn2014ab_1(1,:) = d20140524_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140526_sn2014ab_1(1,:) = d20140526_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140528_sn2014ab_1(1,:) = d20140528_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140621_sn2014ab_1(1,:) = d20140621_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140622_sn2014ab_1(1,:) = d20140622_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140623_sn2014ab_1(1,:) = d20140623_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140624_sn2014ab_1(1,:) = d20140624_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140626_sn2014ab_1(1,:) = d20140626_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140630_sn2014ab_1(1,:) = d20140630_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140526_sn2014ab_2(1,:) = d20140526_sn2014ab_2(1,:)/(1+z_sn2014ab)  ;
d20140526_sn2014ab_2_onlyderedshifted(1,:) = d20140526_sn2014ab_2(1,:);
d20140526_sn2014ab_2_onlyderedshifted(2,:) = d20140526_sn2014ab_2(2,:);
%d20140526_sn2014ab_3(1,:) = d20140526_sn2014ab_3(1,:)/(1+z_sn2014ab) ;
%d20140526_sn2014ab_4(1,:) = d20140526_sn2014ab_4(1,:)/(1+z_sn2014ab) ;
d20140602_sn2014ab_1(1,:) = d20140602_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
%d20140602_sn2014ab_2(1,:) = d20140602_sn2014ab_2(1,:)/(1+z_sn2014ab) ;
%d20140602_sn2014ab_3(1,:) = d20140602_sn2014ab_3(1,:)/(1+z_sn2014ab) ;
d20140722_sn2014ab_1(1,:) = d20140722_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
%d20140722_sn2014ab_2(1,:) = d20140722_sn2014ab_2(1,:)/(1+z_sn2014ab) ;
%d20140722_sn2014ab_3(1,:) = d20140722_sn2014ab_3(1,:)/(1+z_sn2014ab) ;
d20140722_sn2014ab_4(1,:) = d20140722_sn2014ab_4(1,:)/(1+z_sn2014ab)  ;
%d20140722_sn2014ab_5(1,:) = d20140722_sn2014ab_5(1,:)/(1+z_sn2014ab) ;
%d20140722_sn2014ab_6(1,:) = d20140722_sn2014ab_6(1,:)/(1+z_sn2014ab) ;
d20140808_sn2014ab_1(1,:) = d20140808_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
%d20140808_sn2014ab_2(1,:) = d20140808_sn2014ab_2(1,:)/(1+z_sn2014ab) ;
%d20140808_sn2014ab_3(1,:) = d20140808_sn2014ab_3(1,:)/(1+z_sn2014ab) ;
d20140408_sn2014ab_1(1,:) = d20140408_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140409_sn2014ab_1(1,:) = d20140409_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140411_sn2014ab_1(1,:) = d20140411_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140507_sn2014ab_4(1,:) = d20140507_sn2014ab_4(1,:)/(1+z_sn2014ab)  ;
%d20140507_sn2014ab_1(1,:) = d20140507_sn2014ab_1(1,:)/(1+z_sn2014ab) ;
%d20140507_sn2014ab_2(1,:) = d20140507_sn2014ab_2(1,:)/(1+z_sn2014ab) ;
%d20140507_sn2014ab_3(1,:) = d20140507_sn2014ab_3(1,:)/(1+z_sn2014ab) ;
d20140420_sn2014ab_1(1,:) = d20140420_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140423_sn2014ab_1(1,:) = d20140423_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140522_sn2014ab_1(1,:) = d20140522_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20180414_sn2014ab_1(1,:) = d20180414_sn2014ab_1(1,:)/(1+z_sn2014ab)  ;
d20140420_sn2014ab_2(1,:) = d20140420_sn2014ab_2(1,:)/(1+z_sn2014ab)  ;


data.wave_dez{1 } =  d20140310_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{2 } =  d20140324_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{3 } =  d20140329_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{4 } =  d20140330_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{5 } =  d20140331_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{6 } =  d20140402_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{7 } =  d20140408_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{8 } =  d20140409_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{9 } =  d20140411_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{10} =  d20140420_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{11} =  d20140420_sn2014ab_2(1,:)/(1+z_sn2014ab);
data.wave_dez{12} =  d20140423_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{13} =  d20140426_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{14} =  d20140427_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{15} =  d20140428_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{16} =  d20140430_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{17} =  d20140501_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{18} =  d20140507_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{19} =  d20140519_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{20} =  d20140522_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{21} =  d20140523_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{22} =  d20140524_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{23} =  d20140526_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{24} =  d20140526_sn2014ab_2(1,:)/(1+z_sn2014ab);
data.wave_dez{25} =  d20140528_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{26} =  d20140602_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{27} =  d20140621_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{28} =  d20140622_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{29} =  d20140623_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{30} =  d20140624_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{31} =  d20140626_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{32} =  d20140630_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{33} =  d20140722_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{34} =  d20140722_sn2014ab_4(1,:)/(1+z_sn2014ab);
data.wave_dez{35} =  d20140808_sn2014ab_1(1,:)/(1+z_sn2014ab);
data.wave_dez{36} =  d20180414_sn2014ab_1(1,:)/(1+z_sn2014ab);

data.flux{1 } =  d20140310_sn2014ab_1(2,:)
data.flux{2 } =  d20140324_sn2014ab_1(2,:)
data.flux{3 } =  d20140329_sn2014ab_1(2,:)
data.flux{4 } =  d20140330_sn2014ab_1(2,:)
data.flux{5 } =  d20140331_sn2014ab_1(2,:)
data.flux{6 } =  d20140402_sn2014ab_1(2,:)
data.flux{7 } =  d20140408_sn2014ab_1(2,:)
data.flux{8 } =  d20140409_sn2014ab_1(2,:)
data.flux{9 } =  d20140411_sn2014ab_1(2,:)
data.flux{10} =  d20140420_sn2014ab_1(2,:)
data.flux{11} =  d20140420_sn2014ab_2(2,:)
data.flux{12} =  d20140423_sn2014ab_1(2,:)
data.flux{13} =  d20140426_sn2014ab_1(2,:)
data.flux{14} =  d20140427_sn2014ab_1(2,:)
data.flux{15} =  d20140428_sn2014ab_1(2,:)
data.flux{16} =  d20140430_sn2014ab_1(2,:)
data.flux{17} =  d20140501_sn2014ab_1(2,:)
data.flux{18} =  d20140507_sn2014ab_1(2,:)
data.flux{19} =  d20140519_sn2014ab_1(2,:)
data.flux{20} =  d20140522_sn2014ab_1(2,:)
data.flux{21} =  d20140523_sn2014ab_1(2,:)
data.flux{22} =  d20140524_sn2014ab_1(2,:)
data.flux{23} =  d20140526_sn2014ab_1(2,:)
data.flux{24} =  d20140526_sn2014ab_2(2,:)
data.flux{25} =  d20140528_sn2014ab_1(2,:)
data.flux{26} =  d20140602_sn2014ab_1(2,:)
data.flux{27} =  d20140621_sn2014ab_1(2,:)
data.flux{28} =  d20140622_sn2014ab_1(2,:)
data.flux{29} =  d20140623_sn2014ab_1(2,:)
data.flux{30} =  d20140624_sn2014ab_1(2,:)
data.flux{31} =  d20140626_sn2014ab_1(2,:)
data.flux{32} =  d20140630_sn2014ab_1(2,:)
data.flux{33} =  d20140722_sn2014ab_1(2,:)
data.flux{34} =  d20140722_sn2014ab_4(2,:)
data.flux{35} =  d20140808_sn2014ab_1(2,:)
data.flux{36} =  d20180414_sn2014ab_1(2,:)


data.flux_deredMW{1 } = deredden(data.wave_dez{1 },data.flux{1 },A_V_sn2014ab);
data.flux_deredMW{2 } = deredden(data.wave_dez{2 },data.flux{2 },A_V_sn2014ab);
data.flux_deredMW{3 } = deredden(data.wave_dez{3 },data.flux{3 },A_V_sn2014ab);
data.flux_deredMW{4 } = deredden(data.wave_dez{4 },data.flux{4 },A_V_sn2014ab);
data.flux_deredMW{5 } = deredden(data.wave_dez{5 },data.flux{5 },A_V_sn2014ab);
data.flux_deredMW{6 } = deredden(data.wave_dez{6 },data.flux{6 },A_V_sn2014ab);
data.flux_deredMW{7 } = deredden(data.wave_dez{7 },data.flux{7 },A_V_sn2014ab);
data.flux_deredMW{8 } = deredden(data.wave_dez{8 },data.flux{8 },A_V_sn2014ab);
data.flux_deredMW{9 } = deredden(data.wave_dez{9 },data.flux{9 },A_V_sn2014ab);
data.flux_deredMW{10} = deredden(data.wave_dez{10},data.flux{10},A_V_sn2014ab);
data.flux_deredMW{11} = deredden(data.wave_dez{11},data.flux{11},A_V_sn2014ab);
data.flux_deredMW{12} = deredden(data.wave_dez{12},data.flux{12},A_V_sn2014ab);
data.flux_deredMW{13} = deredden(data.wave_dez{13},data.flux{13},A_V_sn2014ab);
data.flux_deredMW{14} = deredden(data.wave_dez{14},data.flux{14},A_V_sn2014ab);
data.flux_deredMW{15} = deredden(data.wave_dez{15},data.flux{15},A_V_sn2014ab);
data.flux_deredMW{16} = deredden(data.wave_dez{16},data.flux{16},A_V_sn2014ab);
data.flux_deredMW{17} = deredden(data.wave_dez{17},data.flux{17},A_V_sn2014ab);
data.flux_deredMW{18} = deredden(data.wave_dez{18},data.flux{18},A_V_sn2014ab);
data.flux_deredMW{19} = deredden(data.wave_dez{19},data.flux{19},A_V_sn2014ab);
data.flux_deredMW{20} = deredden(data.wave_dez{20},data.flux{20},A_V_sn2014ab);
data.flux_deredMW{21} = deredden(data.wave_dez{21},data.flux{21},A_V_sn2014ab);
data.flux_deredMW{22} = deredden(data.wave_dez{22},data.flux{22},A_V_sn2014ab);
data.flux_deredMW{23} = deredden(data.wave_dez{23},data.flux{23},A_V_sn2014ab);
data.flux_deredMW{24} = deredden(data.wave_dez{24},data.flux{24},A_V_sn2014ab);
data.flux_deredMW{25} = deredden(data.wave_dez{25},data.flux{25},A_V_sn2014ab);
data.flux_deredMW{26} = deredden(data.wave_dez{26},data.flux{26},A_V_sn2014ab);
data.flux_deredMW{27} = deredden(data.wave_dez{27},data.flux{27},A_V_sn2014ab);
data.flux_deredMW{28} = deredden(data.wave_dez{28},data.flux{28},A_V_sn2014ab);
data.flux_deredMW{29} = deredden(data.wave_dez{29},data.flux{29},A_V_sn2014ab);
data.flux_deredMW{30} = deredden(data.wave_dez{30},data.flux{30},A_V_sn2014ab);
data.flux_deredMW{31} = deredden(data.wave_dez{31},data.flux{31},A_V_sn2014ab);
data.flux_deredMW{32} = deredden(data.wave_dez{32},data.flux{32},A_V_sn2014ab);
data.flux_deredMW{33} = deredden(data.wave_dez{33},data.flux{33},A_V_sn2014ab);
data.flux_deredMW{34} = deredden(data.wave_dez{34},data.flux{34},A_V_sn2014ab);
data.flux_deredMW{35} = deredden(data.wave_dez{35},data.flux{35},A_V_sn2014ab);
data.flux_deredMW{36} = deredden(data.wave_dez{36},data.flux{36},A_V_sn2014ab);



data.flux_deredMWHG{1 } = deredden(data.wave_dez{1 },data.flux{1 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{2 } = deredden(data.wave_dez{2 },data.flux{2 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{3 } = deredden(data.wave_dez{3 },data.flux{3 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{4 } = deredden(data.wave_dez{4 },data.flux{4 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{5 } = deredden(data.wave_dez{5 },data.flux{5 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{6 } = deredden(data.wave_dez{6 },data.flux{6 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{7 } = deredden(data.wave_dez{7 },data.flux{7 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{8 } = deredden(data.wave_dez{8 },data.flux{8 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{9 } = deredden(data.wave_dez{9 },data.flux{9 },A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{10} = deredden(data.wave_dez{10},data.flux{10},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{11} = deredden(data.wave_dez{11},data.flux{11},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{12} = deredden(data.wave_dez{12},data.flux{12},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{13} = deredden(data.wave_dez{13},data.flux{13},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{14} = deredden(data.wave_dez{14},data.flux{14},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{15} = deredden(data.wave_dez{15},data.flux{15},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{16} = deredden(data.wave_dez{16},data.flux{16},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{17} = deredden(data.wave_dez{17},data.flux{17},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{18} = deredden(data.wave_dez{18},data.flux{18},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{19} = deredden(data.wave_dez{19},data.flux{19},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{20} = deredden(data.wave_dez{20},data.flux{20},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{21} = deredden(data.wave_dez{21},data.flux{21},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{22} = deredden(data.wave_dez{22},data.flux{22},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{23} = deredden(data.wave_dez{23},data.flux{23},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{24} = deredden(data.wave_dez{24},data.flux{24},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{25} = deredden(data.wave_dez{25},data.flux{25},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{26} = deredden(data.wave_dez{26},data.flux{26},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{27} = deredden(data.wave_dez{27},data.flux{27},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{28} = deredden(data.wave_dez{28},data.flux{28},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{29} = deredden(data.wave_dez{29},data.flux{29},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{30} = deredden(data.wave_dez{30},data.flux{30},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{31} = deredden(data.wave_dez{31},data.flux{31},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{32} = deredden(data.wave_dez{32},data.flux{32},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{33} = deredden(data.wave_dez{33},data.flux{33},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{34} = deredden(data.wave_dez{34},data.flux{34},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{35} = deredden(data.wave_dez{35},data.flux{35},A_V_sn2014ab+ A_V_NaID);
data.flux_deredMWHG{36} = deredden(data.wave_dez{36},data.flux{36},A_V_sn2014ab+ A_V_NaID);





%deredden
d20140310_sn2014ab_1(2,:) = deredden(d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
%d20140310_sn2014ab_2(2,:) = deredden(d20140310_sn2014ab_2(1,:),d20140310_sn2014ab_2(2,:),A_V_sn2014ab + A_V_NaID);
d20140324_sn2014ab_1(2,:) = deredden(d20140324_sn2014ab_1(1,:),d20140324_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140329_sn2014ab_1(2,:) = deredden(d20140329_sn2014ab_1(1,:),d20140329_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140330_sn2014ab_1(2,:) = deredden(d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140331_sn2014ab_1(2,:) = deredden(d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140402_sn2014ab_1(2,:) = deredden(d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140426_sn2014ab_1(2,:) = deredden(d20140426_sn2014ab_1(1,:),d20140426_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140427_sn2014ab_1(2,:) = deredden(d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140428_sn2014ab_1(2,:) = deredden(d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140430_sn2014ab_1(2,:) = deredden(d20140430_sn2014ab_1(1,:),d20140430_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140501_sn2014ab_1(2,:) = deredden(d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140519_sn2014ab_1(2,:) = deredden(d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140523_sn2014ab_1(2,:) = deredden(d20140523_sn2014ab_1(1,:),d20140523_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140524_sn2014ab_1(2,:) = deredden(d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140526_sn2014ab_1(2,:) = deredden(d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140528_sn2014ab_1(2,:) = deredden(d20140528_sn2014ab_1(1,:),d20140528_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140621_sn2014ab_1(2,:) = deredden(d20140621_sn2014ab_1(1,:),d20140621_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140622_sn2014ab_1(2,:) = deredden(d20140622_sn2014ab_1(1,:),d20140622_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140623_sn2014ab_1(2,:) = deredden(d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140624_sn2014ab_1(2,:) = deredden(d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140626_sn2014ab_1(2,:) = deredden(d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140630_sn2014ab_1(2,:) = deredden(d20140630_sn2014ab_1(1,:),d20140630_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140526_sn2014ab_2(2,:) = deredden(d20140526_sn2014ab_2(1,:),d20140526_sn2014ab_2(2,:),A_V_sn2014ab + A_V_NaID);
d20140526_sn2014ab_2_dereddened(2,:) = d20140526_sn2014ab_2(2,:);
%d20140526_sn2014ab_3(2,:) = deredden(d20140526_sn2014ab_3(1,:),d20140526_sn2014ab_3(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140526_sn2014ab_4(2,:) = deredden(d20140526_sn2014ab_4(1,:),d20140526_sn2014ab_4(2,:),A_V_sn2014ab+ A_V_NaID);
d20140602_sn2014ab_1(2,:) = deredden(d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
%d20140602_sn2014ab_2(2,:) = deredden(d20140602_sn2014ab_2(1,:),d20140602_sn2014ab_2(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140602_sn2014ab_3(2,:) = deredden(d20140602_sn2014ab_3(1,:),d20140602_sn2014ab_3(2,:),A_V_sn2014ab+ A_V_NaID);
d20140722_sn2014ab_1(2,:) = deredden(d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
%d20140722_sn2014ab_2(2,:) = deredden(d20140722_sn2014ab_2(1,:),d20140722_sn2014ab_2(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140722_sn2014ab_3(2,:) = deredden(d20140722_sn2014ab_3(1,:),d20140722_sn2014ab_3(2,:),A_V_sn2014ab+ A_V_NaID);
d20140722_sn2014ab_4(2,:) = deredden(d20140722_sn2014ab_4(1,:),d20140722_sn2014ab_4(2,:),A_V_sn2014ab + A_V_NaID);
%d20140722_sn2014ab_5(2,:) = deredden(d20140722_sn2014ab_5(1,:),d20140722_sn2014ab_5(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140722_sn2014ab_6(2,:) = deredden(d20140722_sn2014ab_6(1,:),d20140722_sn2014ab_6(2,:),A_V_sn2014ab+ A_V_NaID);
d20140808_sn2014ab_1(2,:) = deredden(d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
%d20140808_sn2014ab_2(2,:) = deredden(d20140808_sn2014ab_2(1,:),d20140808_sn2014ab_2(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140808_sn2014ab_3(2,:) = deredden(d20140808_sn2014ab_3(1,:),d20140808_sn2014ab_3(2,:),A_V_sn2014ab+ A_V_NaID);
d20140408_sn2014ab_1(2,:) = deredden(d20140408_sn2014ab_1(1,:),d20140408_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140409_sn2014ab_1(2,:) = deredden(d20140409_sn2014ab_1(1,:),d20140409_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140411_sn2014ab_1(2,:) = deredden(d20140411_sn2014ab_1(1,:),d20140411_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140507_sn2014ab_4(2,:) = deredden(d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:),A_V_sn2014ab + A_V_NaID);
%d20140507_sn2014ab_1(2,:) = deredden(d20140507_sn2014ab_1(1,:),d20140507_sn2014ab_1(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140507_sn2014ab_2(2,:) = deredden(d20140507_sn2014ab_2(1,:),d20140507_sn2014ab_2(2,:),A_V_sn2014ab+ A_V_NaID);
%d20140507_sn2014ab_3(2,:) = deredden(d20140507_sn2014ab_3(1,:),d20140507_sn2014ab_3(2,:),A_V_sn2014ab+ A_V_NaID);
d20140420_sn2014ab_1(2,:) = deredden(d20140420_sn2014ab_1(1,:),d20140420_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140423_sn2014ab_1(2,:) = deredden(d20140423_sn2014ab_1(1,:),d20140423_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140522_sn2014ab_1(2,:) = deredden(d20140522_sn2014ab_1(1,:),d20140522_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20180414_sn2014ab_1(2,:) = deredden(d20180414_sn2014ab_1(1,:),d20180414_sn2014ab_1(2,:),A_V_sn2014ab + A_V_NaID);
d20140420_sn2014ab_2(2,:) = deredden(d20140420_sn2014ab_2(1,:),d20140420_sn2014ab_2(2,:),A_V_sn2014ab + A_V_NaID);

%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)
%+ A_V_NaID)

%apply narrow line offset to each high res spectrum individually, and to low res by interpolating between the high res spectra and the shape of the low res spectra's low res features
%zzz not at all complete

narrowoffsetwav_initrun(1) = -3.6960;
narrowoffsetwav_initrun(2) = -3.9462;
narrowoffsetwav_initrun(3) = -3.7507;
narrowoffsetwav_initrun(4) = -3.1643;
narrowoffsetwav_initrun(5) = -3.1643;
narrowoffsetwav_initrun(6) = -2.6785;

narrowoffsetmult(1) = lambdaHalpha / (lambdaHalpha + narrowoffsetwav_initrun(1));
narrowoffsetmult(2) = lambdaHalpha / (lambdaHalpha + narrowoffsetwav_initrun(2));
narrowoffsetmult(3) = lambdaHalpha / (lambdaHalpha + narrowoffsetwav_initrun(3));
narrowoffsetmult(4) = lambdaHalpha / (lambdaHalpha + narrowoffsetwav_initrun(4));
narrowoffsetmult(5) = lambdaHalpha / (lambdaHalpha + narrowoffsetwav_initrun(5));
narrowoffsetmult(6) = lambdaHalpha / (lambdaHalpha + narrowoffsetwav_initrun(6));

%%%% 1: velHalpha_20140519_1
%%%% 2: velHalpha_20140526_2
%%%% 3: velHalpha_20140602_1
%%%% 4: velHalpha_20140722_1
%%%% 5: velHalpha_20140808_1
%%%% 6: velHalpha_20180414_1

d20140310_sn2014ab_1(1,:) = d20140310_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140324_sn2014ab_1(1,:) = d20140324_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140329_sn2014ab_1(1,:) = d20140329_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140330_sn2014ab_1(1,:) = d20140330_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140331_sn2014ab_1(1,:) = d20140331_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140402_sn2014ab_1(1,:) = d20140402_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140408_sn2014ab_1(1,:) = d20140408_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140409_sn2014ab_1(1,:) = d20140409_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140411_sn2014ab_1(1,:) = d20140411_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140420_sn2014ab_1(1,:) = d20140420_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140420_sn2014ab_2(1,:) = d20140420_sn2014ab_2(1,:)  *narrowoffsetmult(1);
d20140423_sn2014ab_1(1,:) = d20140423_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140426_sn2014ab_1(1,:) = d20140426_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140427_sn2014ab_1(1,:) = d20140427_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140428_sn2014ab_1(1,:) = d20140428_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140430_sn2014ab_1(1,:) = d20140430_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140501_sn2014ab_1(1,:) = d20140501_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140507_sn2014ab_4(1,:) = d20140507_sn2014ab_4(1,:)  *narrowoffsetmult(1);
d20140519_sn2014ab_1(1,:) = d20140519_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140522_sn2014ab_1(1,:) = d20140522_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140523_sn2014ab_1(1,:) = d20140523_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140524_sn2014ab_1(1,:) = d20140524_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140526_sn2014ab_1(1,:) = d20140526_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140526_sn2014ab_2(1,:) = d20140526_sn2014ab_2(1,:)  *narrowoffsetmult(2);
d20140528_sn2014ab_1(1,:) = d20140528_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140602_sn2014ab_1(1,:) = d20140602_sn2014ab_1(1,:)  *narrowoffsetmult(3);
d20140621_sn2014ab_1(1,:) = d20140621_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140622_sn2014ab_1(1,:) = d20140622_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140623_sn2014ab_1(1,:) = d20140623_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140624_sn2014ab_1(1,:) = d20140624_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140626_sn2014ab_1(1,:) = d20140626_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140630_sn2014ab_1(1,:) = d20140630_sn2014ab_1(1,:)  *narrowoffsetmult(1);
d20140722_sn2014ab_1(1,:) = d20140722_sn2014ab_1(1,:)  *narrowoffsetmult(4);
d20140722_sn2014ab_4(1,:) = d20140722_sn2014ab_4(1,:)  *narrowoffsetmult(1);
d20140808_sn2014ab_1(1,:) = d20140808_sn2014ab_1(1,:)  *narrowoffsetmult(5);
d20180414_sn2014ab_1(1,:) = d20180414_sn2014ab_1(1,:)  *narrowoffsetmult(6);

%temporary use of narrowoffsetmult so we can fit voigt profile
d20140310_sn2014ab_1(1,:) = d20140310_sn2014ab_1(1,:);
d20140324_sn2014ab_1(1,:) = d20140324_sn2014ab_1(1,:);
d20140329_sn2014ab_1(1,:) = d20140329_sn2014ab_1(1,:);
d20140330_sn2014ab_1(1,:) = d20140330_sn2014ab_1(1,:);
d20140331_sn2014ab_1(1,:) = d20140331_sn2014ab_1(1,:);
d20140402_sn2014ab_1(1,:) = d20140402_sn2014ab_1(1,:);
d20140408_sn2014ab_1(1,:) = d20140408_sn2014ab_1(1,:);
d20140409_sn2014ab_1(1,:) = d20140409_sn2014ab_1(1,:);
d20140411_sn2014ab_1(1,:) = d20140411_sn2014ab_1(1,:);
d20140420_sn2014ab_1(1,:) = d20140420_sn2014ab_1(1,:);
d20140420_sn2014ab_2(1,:) = d20140420_sn2014ab_2(1,:);
d20140423_sn2014ab_1(1,:) = d20140423_sn2014ab_1(1,:);
d20140426_sn2014ab_1(1,:) = d20140426_sn2014ab_1(1,:);
d20140427_sn2014ab_1(1,:) = d20140427_sn2014ab_1(1,:);
d20140428_sn2014ab_1(1,:) = d20140428_sn2014ab_1(1,:);
d20140430_sn2014ab_1(1,:) = d20140430_sn2014ab_1(1,:);
d20140501_sn2014ab_1(1,:) = d20140501_sn2014ab_1(1,:);
d20140507_sn2014ab_4(1,:) = d20140507_sn2014ab_4(1,:);
d20140519_sn2014ab_1(1,:) = d20140519_sn2014ab_1(1,:);
d20140522_sn2014ab_1(1,:) = d20140522_sn2014ab_1(1,:);
d20140523_sn2014ab_1(1,:) = d20140523_sn2014ab_1(1,:);
d20140524_sn2014ab_1(1,:) = d20140524_sn2014ab_1(1,:);
d20140526_sn2014ab_1(1,:) = d20140526_sn2014ab_1(1,:);
d20140526_sn2014ab_2(1,:) = d20140526_sn2014ab_2(1,:);
d20140528_sn2014ab_1(1,:) = d20140528_sn2014ab_1(1,:);
d20140602_sn2014ab_1(1,:) = d20140602_sn2014ab_1(1,:);
d20140621_sn2014ab_1(1,:) = d20140621_sn2014ab_1(1,:);
d20140622_sn2014ab_1(1,:) = d20140622_sn2014ab_1(1,:);
d20140623_sn2014ab_1(1,:) = d20140623_sn2014ab_1(1,:);
d20140624_sn2014ab_1(1,:) = d20140624_sn2014ab_1(1,:);
d20140626_sn2014ab_1(1,:) = d20140626_sn2014ab_1(1,:);
d20140630_sn2014ab_1(1,:) = d20140630_sn2014ab_1(1,:);
d20140722_sn2014ab_1(1,:) = d20140722_sn2014ab_1(1,:);
d20140722_sn2014ab_4(1,:) = d20140722_sn2014ab_4(1,:);
d20140808_sn2014ab_1(1,:) = d20140808_sn2014ab_1(1,:);
d20180414_sn2014ab_1(1,:) = d20180414_sn2014ab_1(1,:);

%find min and max wavelengths for table
wavelengthfilenew = fopen('spectralwavelengthsnew.txt','w');
for i=1:size(data.wave_dez,2)
	fprintf(wavelengthfilenew,'%5.0f',data.wave_dez{i}(1));
	fprintf(wavelengthfilenew,'-');
	fprintf(wavelengthfilenew,'%5.0f',data.wave_dez{i}(end));
	fprintf(wavelengthfilenew,'\n');
end
fclose(wavelengthfilenew);


wavelengthfile = fopen('spectralwavelengths.txt','w');
fprintf(wavelengthfile,'%5.0f',d20140310_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140310_sn2014ab_1(1,length(d20140310_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140324_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140324_sn2014ab_1(1,length(d20140324_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140329_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140329_sn2014ab_1(1,length(d20140329_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140330_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140330_sn2014ab_1(1,length(d20140330_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140331_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140331_sn2014ab_1(1,length(d20140331_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140402_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140402_sn2014ab_1(1,length(d20140402_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140408_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140408_sn2014ab_1(1,length(d20140408_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140409_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140409_sn2014ab_1(1,length(d20140409_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140411_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140411_sn2014ab_1(1,length(d20140411_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140420_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140420_sn2014ab_1(1,length(d20140420_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140420_sn2014ab_2(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140420_sn2014ab_2(1,length(d20140420_sn2014ab_2(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140423_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140423_sn2014ab_1(1,length(d20140423_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140426_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140426_sn2014ab_1(1,length(d20140426_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140427_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140427_sn2014ab_1(1,length(d20140427_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140428_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140428_sn2014ab_1(1,length(d20140428_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140430_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140430_sn2014ab_1(1,length(d20140430_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140501_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140501_sn2014ab_1(1,length(d20140501_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_1(1,length(d20140507_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
%fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_2(1,1))
%fprintf(wavelengthfile,'-')
%fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_2(1,length(d20140507_sn2014ab_2(1,:))))
%fprintf(wavelengthfile,'\n')
%fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_3(1,1))
%fprintf(wavelengthfile,'-')
%fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_3(1,length(d20140507_sn2014ab_3(1,:))))
%fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140519_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140519_sn2014ab_1(1,length(d20140519_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140522_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140522_sn2014ab_1(1,length(d20140522_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140523_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140523_sn2014ab_1(1,length(d20140523_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140524_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140524_sn2014ab_1(1,length(d20140524_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_1(1,length(d20140526_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_2(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_2(1,length(d20140526_sn2014ab_2(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140528_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140528_sn2014ab_1(1,length(d20140528_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140602_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140602_sn2014ab_1(1,length(d20140602_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140621_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140621_sn2014ab_1(1,length(d20140621_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140622_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140622_sn2014ab_1(1,length(d20140622_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140623_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140623_sn2014ab_1(1,length(d20140623_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140624_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140624_sn2014ab_1(1,length(d20140624_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140626_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140626_sn2014ab_1(1,length(d20140626_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140630_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140630_sn2014ab_1(1,length(d20140630_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140722_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140722_sn2014ab_1(1,length(d20140722_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140808_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140808_sn2014ab_1(1,length(d20140808_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20180414_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20180414_sn2014ab_1(1,length(d20180414_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fclose(wavelengthfile);

%spectral resolution calculations
%MMT Blue Channel
((6863-5588)/2+5588)/1.45

%magellan
((6864-5350)/2+5350)/0.3794

%%%zzz need to do SPOL resolution calculation here for day 99 2014-04-20

%maxvaluecontscaling
for i=1:size(data.flux_deredMWHG,2)
	data.flux_contscale{i} = data.flux_deredMWHG{i}(1,:)/max(data.flux_deredMWHG{i}(1,:));
end
contscaled20140310_sn2014ab_1(2,:) = d20140310_sn2014ab_1(2,:)/max(d20140310_sn2014ab_1(2,:));
%contscaled20140310_sn2014ab_2(2,:) = d20140310_sn2014ab_2(2,:)/max(d20140310_sn2014ab_2(2,:));
contscaled20140324_sn2014ab_1(2,:) = d20140324_sn2014ab_1(2,:)/max(d20140324_sn2014ab_1(2,:));
contscaled20140329_sn2014ab_1(2,:) = d20140329_sn2014ab_1(2,:)/max(d20140329_sn2014ab_1(2,:));
contscaled20140330_sn2014ab_1(2,:) = d20140330_sn2014ab_1(2,:)/max(d20140330_sn2014ab_1(2,:));
contscaled20140331_sn2014ab_1(2,:) = d20140331_sn2014ab_1(2,:)/max(d20140331_sn2014ab_1(2,:));
contscaled20140402_sn2014ab_1(2,:) = d20140402_sn2014ab_1(2,:)/max(d20140402_sn2014ab_1(2,:));
contscaled20140426_sn2014ab_1(2,:) = d20140426_sn2014ab_1(2,:)/max(d20140426_sn2014ab_1(2,:));
contscaled20140427_sn2014ab_1(2,:) = d20140427_sn2014ab_1(2,:)/max(d20140427_sn2014ab_1(2,:));
contscaled20140428_sn2014ab_1(2,:) = d20140428_sn2014ab_1(2,:)/max(d20140428_sn2014ab_1(2,:));
contscaled20140430_sn2014ab_1(2,:) = d20140430_sn2014ab_1(2,:)/max(d20140430_sn2014ab_1(2,:));
contscaled20140501_sn2014ab_1(2,:) = d20140501_sn2014ab_1(2,:)/max(d20140501_sn2014ab_1(2,:));
contscaled20140519_sn2014ab_1(2,:) = d20140519_sn2014ab_1(2,:)/max(d20140519_sn2014ab_1(2,:));
contscaled20140523_sn2014ab_1(2,:) = d20140523_sn2014ab_1(2,:)/max(d20140523_sn2014ab_1(2,:));
contscaled20140524_sn2014ab_1(2,:) = d20140524_sn2014ab_1(2,:)/max(d20140524_sn2014ab_1(2,:));
contscaled20140526_sn2014ab_1(2,:) = d20140526_sn2014ab_1(2,:)/max(d20140526_sn2014ab_1(2,:));
contscaled20140528_sn2014ab_1(2,:) = d20140528_sn2014ab_1(2,:)/max(d20140528_sn2014ab_1(2,:));
contscaled20140621_sn2014ab_1(2,:) = d20140621_sn2014ab_1(2,:)/max(d20140621_sn2014ab_1(2,:));
contscaled20140622_sn2014ab_1(2,:) = d20140622_sn2014ab_1(2,:)/max(d20140622_sn2014ab_1(2,:));
contscaled20140623_sn2014ab_1(2,:) = d20140623_sn2014ab_1(2,:)/max(d20140623_sn2014ab_1(2,:));
contscaled20140624_sn2014ab_1(2,:) = d20140624_sn2014ab_1(2,:)/max(d20140624_sn2014ab_1(2,:));
contscaled20140626_sn2014ab_1(2,:) = d20140626_sn2014ab_1(2,:)/max(d20140626_sn2014ab_1(2,:));
contscaled20140630_sn2014ab_1(2,:) = d20140630_sn2014ab_1(2,:)/max(d20140630_sn2014ab_1(2,:));
contscaled20140526_sn2014ab_2(2,:) = d20140526_sn2014ab_2(2,:)/max(d20140526_sn2014ab_2(2,:));
%contscaled20140526_sn2014ab_3(2,:) = d20140526_sn2014ab_3(2,:)/max(d20140526_sn2014ab_3(2,:));
%contscaled20140526_sn2014ab_4(2,:) = d20140526_sn2014ab_4(2,:)/max(d20140526_sn2014ab_4(2,:));
contscaled20140602_sn2014ab_1(2,:) = d20140602_sn2014ab_1(2,:)/max(d20140602_sn2014ab_1(2,:));
%contscaled20140602_sn2014ab_2(2,:) = d20140602_sn2014ab_2(2,:)/max(d20140602_sn2014ab_2(2,:));
%contscaled20140602_sn2014ab_3(2,:) = d20140602_sn2014ab_3(2,:)/max(d20140602_sn2014ab_3(2,:));
contscaled20140722_sn2014ab_1(2,:) = d20140722_sn2014ab_1(2,:)/max(d20140722_sn2014ab_1(2,:));
%contscaled20140722_sn2014ab_2(2,:) = d20140722_sn2014ab_2(2,:)/max(d20140722_sn2014ab_2(2,:));
%contscaled20140722_sn2014ab_3(2,:) = d20140722_sn2014ab_3(2,:)/max(d20140722_sn2014ab_3(2,:));
contscaled20140722_sn2014ab_4(2,:) = d20140722_sn2014ab_4(2,:)/max(d20140722_sn2014ab_4(2,:));
%contscaled20140722_sn2014ab_5(2,:) = d20140722_sn2014ab_5(2,:)/max(d20140722_sn2014ab_5(2,:));
%contscaled20140722_sn2014ab_6(2,:) = d20140722_sn2014ab_6(2,:)/max(d20140722_sn2014ab_6(2,:));
contscaled20140808_sn2014ab_1(2,:) = d20140808_sn2014ab_1(2,:)/max(d20140808_sn2014ab_1(2,:));
%contscaled20140808_sn2014ab_2(2,:) = d20140808_sn2014ab_2(2,:)/max(d20140808_sn2014ab_2(2,:));
%contscaled20140808_sn2014ab_3(2,:) = d20140808_sn2014ab_3(2,:)/max(d20140808_sn2014ab_3(2,:));
contscaled20140408_sn2014ab_1(2,:) = d20140408_sn2014ab_1(2,:)./max(d20140408_sn2014ab_1(2,:));
contscaled20140409_sn2014ab_1(2,:) = d20140409_sn2014ab_1(2,:)./max(d20140409_sn2014ab_1(2,:));
contscaled20140411_sn2014ab_1(2,:) = d20140411_sn2014ab_1(2,:)./max(d20140411_sn2014ab_1(2,:));
contscaled20140507_sn2014ab_4(2,:) = d20140507_sn2014ab_4(2,:)./max(d20140507_sn2014ab_4(2,:));
%contscaled20140507_sn2014ab_1(2,:) = d20140507_sn2014ab_1(2,:)./max(d20140507_sn2014ab_1(2,:));
%contscaled20140507_sn2014ab_2(2,:) = d20140507_sn2014ab_2(2,:)./max(d20140507_sn2014ab_2(2,:));
%contscaled20140507_sn2014ab_3(2,:) = d20140507_sn2014ab_3(2,:)./max(d20140507_sn2014ab_3(2,:));
contscaled20140420_sn2014ab_1(2,:) = d20140420_sn2014ab_1(2,:)./max(d20140420_sn2014ab_1(2,:));
contscaled20140423_sn2014ab_1(2,:) = d20140423_sn2014ab_1(2,:)./max(d20140423_sn2014ab_1(2,:));
contscaled20140522_sn2014ab_1(2,:) = d20140522_sn2014ab_1(2,:)./max(d20140522_sn2014ab_1(2,:));
contscaled20180414_sn2014ab_1(2,:) = d20180414_sn2014ab_1(2,:)./max(d20180414_sn2014ab_1(2,:));
contscaled20140420_sn2014ab_2(2,:) = d20140420_sn2014ab_2(2,:)./max(d20140420_sn2014ab_2(2,:));

%various continuum fitting regions
%halpha continuum
%%%
%trying new estimate_cont_halpha code
%data.flux_norm_cont_halpha{1} = estimate_cont_halpha(d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:));
%data.align_halpha.multiplier{1} = measure_peaks_halpha(d20140310_sn2014ab_1(1,:),data.flux_norm_cont_halpha(1,:));
%
%data.flux_norm_cont_halpha{1} = estimate_cont_halpha(data.wave_dez{1},data.flux_deredMW{1});
%data.align_halpha.multiplier{1} = measure_peaks_halpha(data.wave_dez{1},data.flux_norm_cont_halpha{1});
%
%
%
%align_halpha(data.wave_dez,data.align_halpha.multiplier, all dates)



%%%%


halphafit20140310_sn2014ab_1= fit(d20140310_sn2014ab_1(1,[find(d20140310_sn2014ab_1(1,:)>6000,3,'first') find(d20140310_sn2014ab_1(1,:)<6884,3,'last')])',d20140310_sn2014ab_1(2,[find(d20140310_sn2014ab_1(1,:)>6000,3,'first') find(d20140310_sn2014ab_1(1,:)<6884,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140310_sn2014ab_1= mean(halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,(d20140310_sn2014ab_1(1,:)>6462.8 & d20140310_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140310_sn2014ab_1= d20140310_sn2014ab_1(2,:)/halphanormconstant20140310_sn2014ab_1;
halphavarscaledsub20140310_sn2014ab_1= (d20140310_sn2014ab_1(2,:) - halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,:))')./halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,:))';

clf
plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))

%zzz bbody sub stuff here
%clf
%plot(d20140310_sn2014ab_1(1,:),flux_bbodysub20140310)
%hold on
%plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))
%
%clf
%plot(d20140310_sn2014ab_1(1,:),bbodyfitflux20140310)
%hold on
%plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))
%
%
%clf
%plot(d20140310_sn2014ab_1(1,:),bbodyfit20140310)
%hold on
%plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))

clf
semilogy(d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))
hold on
semilogy(d20140310_sn2014ab_1(1,:),halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,:)))

halphafit20140324_sn2014ab_1= fit(d20140324_sn2014ab_1(1,[find(d20140324_sn2014ab_1(1,:)>6050,3,'first') find(d20140324_sn2014ab_1(1,:)<6907,3,'last')])',d20140324_sn2014ab_1(2,[find(d20140324_sn2014ab_1(1,:)>6050,3,'first') find(d20140324_sn2014ab_1(1,:)<6907,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140324_sn2014ab_1= mean(halphafit20140324_sn2014ab_1(d20140324_sn2014ab_1(1,(d20140324_sn2014ab_1(1,:)>6462.8 & d20140324_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140324_sn2014ab_1= d20140324_sn2014ab_1(2,:)/halphanormconstant20140324_sn2014ab_1;
halphavarscaledsub20140324_sn2014ab_1= (d20140324_sn2014ab_1(2,:) - halphafit20140324_sn2014ab_1(d20140324_sn2014ab_1(1,:))')./halphafit20140324_sn2014ab_1(d20140324_sn2014ab_1(1,:))';

clf
plot(halphafit20140324_sn2014ab_1,d20140324_sn2014ab_1(1,:),d20140324_sn2014ab_1(2,:))

halphafit20140329_sn2014ab_1= fit(d20140329_sn2014ab_1(1,[find(d20140329_sn2014ab_1(1,:)>6000,3,'first') find(d20140329_sn2014ab_1(1,:)<6922,3,'last')])',d20140329_sn2014ab_1(2,[find(d20140329_sn2014ab_1(1,:)>6000,3,'first') find(d20140329_sn2014ab_1(1,:)<6922,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140329_sn2014ab_1= mean(halphafit20140329_sn2014ab_1(d20140329_sn2014ab_1(1,(d20140329_sn2014ab_1(1,:)>6462.8 & d20140329_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140329_sn2014ab_1= d20140329_sn2014ab_1(2,:)/halphanormconstant20140329_sn2014ab_1;
halphavarscaledsub20140329_sn2014ab_1= (d20140329_sn2014ab_1(2,:) - halphafit20140329_sn2014ab_1(d20140329_sn2014ab_1(1,:))')./halphafit20140329_sn2014ab_1(d20140329_sn2014ab_1(1,:))';

clf
plot(halphafit20140329_sn2014ab_1,d20140329_sn2014ab_1(1,:),d20140329_sn2014ab_1(2,:))

halphafit20140330_sn2014ab_1= fit(d20140330_sn2014ab_1(1,[find(d20140330_sn2014ab_1(1,:)>6000,3,'first') find(d20140330_sn2014ab_1(1,:)<7125,3,'last')])',d20140330_sn2014ab_1(2,[find(d20140330_sn2014ab_1(1,:)>6000,3,'first') find(d20140330_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140330_sn2014ab_1= mean(halphafit20140330_sn2014ab_1(d20140330_sn2014ab_1(1,(d20140330_sn2014ab_1(1,:)>6462.8 & d20140330_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140330_sn2014ab_1= d20140330_sn2014ab_1(2,:)/halphanormconstant20140330_sn2014ab_1;
halphavarscaledsub20140330_sn2014ab_1= (d20140330_sn2014ab_1(2,:) - halphafit20140330_sn2014ab_1(d20140330_sn2014ab_1(1,:))')./halphafit20140330_sn2014ab_1(d20140330_sn2014ab_1(1,:))';

clf
plot(halphafit20140330_sn2014ab_1,d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(2,:))

halphafit20140331_sn2014ab_1= fit(d20140331_sn2014ab_1(1,[find(d20140331_sn2014ab_1(1,:)>6000,3,'first') find(d20140331_sn2014ab_1(1,:)<6965,3,'last')])',d20140331_sn2014ab_1(2,[find(d20140331_sn2014ab_1(1,:)>6000,3,'first') find(d20140331_sn2014ab_1(1,:)<6965,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140331_sn2014ab_1= mean(halphafit20140331_sn2014ab_1(d20140331_sn2014ab_1(1,(d20140331_sn2014ab_1(1,:)>6462.8 & d20140331_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140331_sn2014ab_1= d20140331_sn2014ab_1(2,:)/halphanormconstant20140331_sn2014ab_1;
halphavarscaledsub20140331_sn2014ab_1= (d20140331_sn2014ab_1(2,:) - halphafit20140331_sn2014ab_1(d20140331_sn2014ab_1(1,:))')./halphafit20140331_sn2014ab_1(d20140331_sn2014ab_1(1,:))';

clf
plot(halphafit20140331_sn2014ab_1,d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(2,:))

halphafit20140402_sn2014ab_1= fit(d20140402_sn2014ab_1(1,[find(d20140402_sn2014ab_1(1,:)>6000,3,'first') find(d20140402_sn2014ab_1(1,:)<6955,3,'last')])',d20140402_sn2014ab_1(2,[find(d20140402_sn2014ab_1(1,:)>6000,3,'first') find(d20140402_sn2014ab_1(1,:)<6955,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140402_sn2014ab_1= mean(halphafit20140402_sn2014ab_1(d20140402_sn2014ab_1(1,(d20140402_sn2014ab_1(1,:)>6462.8 & d20140402_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140402_sn2014ab_1= d20140402_sn2014ab_1(2,:)/halphanormconstant20140402_sn2014ab_1;
halphavarscaledsub20140402_sn2014ab_1= (d20140402_sn2014ab_1(2,:) - halphafit20140402_sn2014ab_1(d20140402_sn2014ab_1(1,:))')./halphafit20140402_sn2014ab_1(d20140402_sn2014ab_1(1,:))';

clf
plot(halphafit20140402_sn2014ab_1,d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(2,:))

halphafit20140426_sn2014ab_1= fit(d20140426_sn2014ab_1(1,[find(d20140426_sn2014ab_1(1,:)>6000,3,'first') find(d20140426_sn2014ab_1(1,:)<7125,3,'last')])',d20140426_sn2014ab_1(2,[find(d20140426_sn2014ab_1(1,:)>6000,3,'first') find(d20140426_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140426_sn2014ab_1= mean(halphafit20140426_sn2014ab_1(d20140426_sn2014ab_1(1,(d20140426_sn2014ab_1(1,:)>6462.8 & d20140426_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140426_sn2014ab_1= d20140426_sn2014ab_1(2,:)/halphanormconstant20140426_sn2014ab_1;
halphavarscaledsub20140426_sn2014ab_1= (d20140426_sn2014ab_1(2,:) - halphafit20140426_sn2014ab_1(d20140426_sn2014ab_1(1,:))')./halphafit20140426_sn2014ab_1(d20140426_sn2014ab_1(1,:))';

clf
plot(halphafit20140426_sn2014ab_1,d20140426_sn2014ab_1(1,:),d20140426_sn2014ab_1(2,:))

halphafit20140427_sn2014ab_1= fit(d20140427_sn2014ab_1(1,[find(d20140427_sn2014ab_1(1,:)>6000,3,'first') find(d20140427_sn2014ab_1(1,:)<7125,3,'last')])',d20140427_sn2014ab_1(2,[find(d20140427_sn2014ab_1(1,:)>6000,3,'first') find(d20140427_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140427_sn2014ab_1= mean(halphafit20140427_sn2014ab_1(d20140427_sn2014ab_1(1,(d20140427_sn2014ab_1(1,:)>6462.8 & d20140427_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140427_sn2014ab_1= d20140427_sn2014ab_1(2,:)/halphanormconstant20140427_sn2014ab_1;
halphavarscaledsub20140427_sn2014ab_1= (d20140427_sn2014ab_1(2,:) - halphafit20140427_sn2014ab_1(d20140427_sn2014ab_1(1,:))')./halphafit20140427_sn2014ab_1(d20140427_sn2014ab_1(1,:))';

clf
plot(halphafit20140427_sn2014ab_1,d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(2,:))

halphafit20140428_sn2014ab_1= fit(d20140428_sn2014ab_1(1,[find(d20140428_sn2014ab_1(1,:)>6000,3,'first') find(d20140428_sn2014ab_1(1,:)<7125,3,'last')])',d20140428_sn2014ab_1(2,[find(d20140428_sn2014ab_1(1,:)>6000,3,'first') find(d20140428_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140428_sn2014ab_1= mean(halphafit20140428_sn2014ab_1(d20140428_sn2014ab_1(1,(d20140428_sn2014ab_1(1,:)>6462.8 & d20140428_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140428_sn2014ab_1= d20140428_sn2014ab_1(2,:)/halphanormconstant20140428_sn2014ab_1;
halphavarscaledsub20140428_sn2014ab_1= (d20140428_sn2014ab_1(2,:) - halphafit20140428_sn2014ab_1(d20140428_sn2014ab_1(1,:))')./halphafit20140428_sn2014ab_1(d20140428_sn2014ab_1(1,:))';

clf
plot(halphafit20140428_sn2014ab_1,d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(2,:))

halphafit20140430_sn2014ab_1= fit(d20140430_sn2014ab_1(1,[find(d20140430_sn2014ab_1(1,:)>6000,3,'first') find(d20140430_sn2014ab_1(1,:)<6892,3,'last')])',d20140430_sn2014ab_1(2,[find(d20140430_sn2014ab_1(1,:)>6000,3,'first') find(d20140430_sn2014ab_1(1,:)<6892,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140430_sn2014ab_1= mean(halphafit20140430_sn2014ab_1(d20140430_sn2014ab_1(1,(d20140430_sn2014ab_1(1,:)>6462.8 & d20140430_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140430_sn2014ab_1= d20140430_sn2014ab_1(2,:)/halphanormconstant20140430_sn2014ab_1;
halphavarscaledsub20140430_sn2014ab_1= (d20140430_sn2014ab_1(2,:) - halphafit20140430_sn2014ab_1(d20140430_sn2014ab_1(1,:))')./halphafit20140430_sn2014ab_1(d20140430_sn2014ab_1(1,:))';

clf
plot(halphafit20140430_sn2014ab_1,d20140430_sn2014ab_1(1,:),d20140430_sn2014ab_1(2,:))

halphafit20140501_sn2014ab_1= fit(d20140501_sn2014ab_1(1,[find(d20140501_sn2014ab_1(1,:)>6000,3,'first') find(d20140501_sn2014ab_1(1,:)<7125,3,'last')])',d20140501_sn2014ab_1(2,[find(d20140501_sn2014ab_1(1,:)>6000,3,'first') find(d20140501_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140501_sn2014ab_1= mean(halphafit20140501_sn2014ab_1(d20140501_sn2014ab_1(1,(d20140501_sn2014ab_1(1,:)>6462.8 & d20140501_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140501_sn2014ab_1= d20140501_sn2014ab_1(2,:)/halphanormconstant20140501_sn2014ab_1;
halphavarscaledsub20140501_sn2014ab_1= (d20140501_sn2014ab_1(2,:) - halphafit20140501_sn2014ab_1(d20140501_sn2014ab_1(1,:))')./halphafit20140501_sn2014ab_1(d20140501_sn2014ab_1(1,:))';

clf
plot(halphafit20140501_sn2014ab_1,d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(2,:))

halphafit20140519_sn2014ab_1= fit(d20140519_sn2014ab_1(1,[find(d20140519_sn2014ab_1(1,:)>6015,3,'first') find(d20140519_sn2014ab_1(1,:)<6885,3,'last')])',d20140519_sn2014ab_1(2,[find(d20140519_sn2014ab_1(1,:)>6015,3,'first') find(d20140519_sn2014ab_1(1,:)<6885,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140519_sn2014ab_1= mean(halphafit20140519_sn2014ab_1(d20140519_sn2014ab_1(1,(d20140519_sn2014ab_1(1,:)>6462.8 & d20140519_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140519_sn2014ab_1= d20140519_sn2014ab_1(2,:)/halphanormconstant20140519_sn2014ab_1;
halphavarscaledsub20140519_sn2014ab_1= (d20140519_sn2014ab_1(2,:) - halphafit20140519_sn2014ab_1(d20140519_sn2014ab_1(1,:))')./halphafit20140519_sn2014ab_1(d20140519_sn2014ab_1(1,:))';

clf
plot(halphafit20140519_sn2014ab_1,d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:))
axis([5800 6000 0.10*10^-15 1*10^-15])

clf
plot(d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:))
axis([5800 6000 0.10*10^-15 1*10^-15])

halphafit20140523_sn2014ab_1= fit(d20140523_sn2014ab_1(1,[find(d20140523_sn2014ab_1(1,:)>6000,3,'first') find(d20140523_sn2014ab_1(1,:)<6920,3,'last')])',d20140523_sn2014ab_1(2,[find(d20140523_sn2014ab_1(1,:)>6000,3,'first') find(d20140523_sn2014ab_1(1,:)<6920,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140523_sn2014ab_1= mean(halphafit20140523_sn2014ab_1(d20140523_sn2014ab_1(1,(d20140523_sn2014ab_1(1,:)>6462.8 & d20140523_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140523_sn2014ab_1= d20140523_sn2014ab_1(2,:)/halphanormconstant20140523_sn2014ab_1;
halphavarscaledsub20140523_sn2014ab_1= (d20140523_sn2014ab_1(2,:) - halphafit20140523_sn2014ab_1(d20140523_sn2014ab_1(1,:))')./halphafit20140523_sn2014ab_1(d20140523_sn2014ab_1(1,:))';

clf
plot(halphafit20140523_sn2014ab_1,d20140523_sn2014ab_1(1,:),d20140523_sn2014ab_1(2,:))

halphafit20140524_sn2014ab_1= fit(d20140524_sn2014ab_1(1,[find(d20140524_sn2014ab_1(1,:)>6000,3,'first') find(d20140524_sn2014ab_1(1,:)<7125,3,'last')])',d20140524_sn2014ab_1(2,[find(d20140524_sn2014ab_1(1,:)>6000,3,'first') find(d20140524_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140524_sn2014ab_1= mean(halphafit20140524_sn2014ab_1(d20140524_sn2014ab_1(1,(d20140524_sn2014ab_1(1,:)>6462.8 & d20140524_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140524_sn2014ab_1= d20140524_sn2014ab_1(2,:)/halphanormconstant20140524_sn2014ab_1;
halphavarscaledsub20140524_sn2014ab_1= (d20140524_sn2014ab_1(2,:) - halphafit20140524_sn2014ab_1(d20140524_sn2014ab_1(1,:))')./halphafit20140524_sn2014ab_1(d20140524_sn2014ab_1(1,:))';

clf
plot(halphafit20140524_sn2014ab_1,d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(2,:))

halphafit20140526_sn2014ab_1= fit(d20140526_sn2014ab_1(1,[find(d20140526_sn2014ab_1(1,:)>6000,3,'first') find(d20140526_sn2014ab_1(1,:)<6880,3,'last')])',d20140526_sn2014ab_1(2,[find(d20140526_sn2014ab_1(1,:)>6000,3,'first') find(d20140526_sn2014ab_1(1,:)<6880,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140526_sn2014ab_1= mean(halphafit20140526_sn2014ab_1(d20140526_sn2014ab_1(1,(d20140526_sn2014ab_1(1,:)>6462.8 & d20140526_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140526_sn2014ab_1= d20140526_sn2014ab_1(2,:)/halphanormconstant20140526_sn2014ab_1;
halphavarscaledsub20140526_sn2014ab_1= (d20140526_sn2014ab_1(2,:) - halphafit20140526_sn2014ab_1(d20140526_sn2014ab_1(1,:))')./halphafit20140526_sn2014ab_1(d20140526_sn2014ab_1(1,:))';

clf
plot(d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
axis([5700 6200 0.50*10^-15 2*10^-15])

halphafit20140528_sn2014ab_1= fit(d20140528_sn2014ab_1(1,[find(d20140528_sn2014ab_1(1,:)>6000,3,'first') find(d20140528_sn2014ab_1(1,:)<6930,3,'last')])',d20140528_sn2014ab_1(2,[find(d20140528_sn2014ab_1(1,:)>6000,3,'first') find(d20140528_sn2014ab_1(1,:)<6930,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140528_sn2014ab_1= mean(halphafit20140528_sn2014ab_1(d20140528_sn2014ab_1(1,(d20140528_sn2014ab_1(1,:)>6462.8 & d20140528_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140528_sn2014ab_1= d20140528_sn2014ab_1(2,:)/halphanormconstant20140528_sn2014ab_1;
halphavarscaledsub20140528_sn2014ab_1= (d20140528_sn2014ab_1(2,:) - halphafit20140528_sn2014ab_1(d20140528_sn2014ab_1(1,:))')./halphafit20140528_sn2014ab_1(d20140528_sn2014ab_1(1,:))';

clf
plot(halphafit20140528_sn2014ab_1,d20140528_sn2014ab_1(1,:),d20140528_sn2014ab_1(2,:))

halphafit20140621_sn2014ab_1= fit(d20140621_sn2014ab_1(1,[find(d20140621_sn2014ab_1(1,:)>6000,3,'first') find(d20140621_sn2014ab_1(1,:)<6900,3,'last')])',d20140621_sn2014ab_1(2,[find(d20140621_sn2014ab_1(1,:)>6000,3,'first') find(d20140621_sn2014ab_1(1,:)<6900,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140621_sn2014ab_1= mean(halphafit20140621_sn2014ab_1(d20140621_sn2014ab_1(1,(d20140621_sn2014ab_1(1,:)>6462.8 & d20140621_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140621_sn2014ab_1= d20140621_sn2014ab_1(2,:)/halphanormconstant20140621_sn2014ab_1;
halphavarscaledsub20140621_sn2014ab_1= (d20140621_sn2014ab_1(2,:) - halphafit20140621_sn2014ab_1(d20140621_sn2014ab_1(1,:))')./halphafit20140621_sn2014ab_1(d20140621_sn2014ab_1(1,:))';

clf
plot(halphafit20140621_sn2014ab_1,d20140621_sn2014ab_1(1,:),d20140621_sn2014ab_1(2,:))

halphafit20140622_sn2014ab_1= fit(d20140622_sn2014ab_1(1,[find(d20140622_sn2014ab_1(1,:)>6000,3,'first') find(d20140622_sn2014ab_1(1,:)<6905,3,'last')])',d20140622_sn2014ab_1(2,[find(d20140622_sn2014ab_1(1,:)>6000,3,'first') find(d20140622_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140622_sn2014ab_1= mean(halphafit20140622_sn2014ab_1(d20140622_sn2014ab_1(1,(d20140622_sn2014ab_1(1,:)>6462.8 & d20140622_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140622_sn2014ab_1= d20140622_sn2014ab_1(2,:)/halphanormconstant20140622_sn2014ab_1;
halphavarscaledsub20140622_sn2014ab_1= (d20140622_sn2014ab_1(2,:) - halphafit20140622_sn2014ab_1(d20140622_sn2014ab_1(1,:))')./halphafit20140622_sn2014ab_1(d20140622_sn2014ab_1(1,:))';

clf
plot(halphafit20140622_sn2014ab_1,d20140622_sn2014ab_1(1,:),d20140622_sn2014ab_1(2,:))

halphafit20140623_sn2014ab_1= fit(d20140623_sn2014ab_1(1,[find(d20140623_sn2014ab_1(1,:)>6000,3,'first') find(d20140623_sn2014ab_1(1,:)<6905,3,'last')])',d20140623_sn2014ab_1(2,[find(d20140623_sn2014ab_1(1,:)>6000,3,'first') find(d20140623_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140623_sn2014ab_1= mean(halphafit20140623_sn2014ab_1(d20140623_sn2014ab_1(1,(d20140623_sn2014ab_1(1,:)>6462.8 & d20140623_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140623_sn2014ab_1= d20140623_sn2014ab_1(2,:)/halphanormconstant20140623_sn2014ab_1;
halphavarscaledsub20140623_sn2014ab_1= (d20140623_sn2014ab_1(2,:) - halphafit20140623_sn2014ab_1(d20140623_sn2014ab_1(1,:))')./halphafit20140623_sn2014ab_1(d20140623_sn2014ab_1(1,:))';

clf
plot(halphafit20140623_sn2014ab_1,d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(2,:))

halphafit20140624_sn2014ab_1= fit(d20140624_sn2014ab_1(1,[find(d20140624_sn2014ab_1(1,:)>6000,3,'first') find(d20140624_sn2014ab_1(1,:)<6905,3,'last')])',d20140624_sn2014ab_1(2,[find(d20140624_sn2014ab_1(1,:)>6000,3,'first') find(d20140624_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140624_sn2014ab_1= mean(halphafit20140624_sn2014ab_1(d20140624_sn2014ab_1(1,(d20140624_sn2014ab_1(1,:)>6462.8 & d20140624_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140624_sn2014ab_1= d20140624_sn2014ab_1(2,:)/halphanormconstant20140624_sn2014ab_1;
halphavarscaledsub20140624_sn2014ab_1= (d20140624_sn2014ab_1(2,:) - halphafit20140624_sn2014ab_1(d20140624_sn2014ab_1(1,:))')./halphafit20140624_sn2014ab_1(d20140624_sn2014ab_1(1,:))';

clf
plot(halphafit20140624_sn2014ab_1,d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(2,:))

halphafit20140626_sn2014ab_1= fit(d20140626_sn2014ab_1(1,[find(d20140626_sn2014ab_1(1,:)>6000,3,'first') find(d20140626_sn2014ab_1(1,:)<6915,3,'last')])',d20140626_sn2014ab_1(2,[find(d20140626_sn2014ab_1(1,:)>6000,3,'first') find(d20140626_sn2014ab_1(1,:)<6915,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140626_sn2014ab_1= mean(halphafit20140626_sn2014ab_1(d20140626_sn2014ab_1(1,(d20140626_sn2014ab_1(1,:)>6462.8 & d20140626_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140626_sn2014ab_1= d20140626_sn2014ab_1(2,:)/halphanormconstant20140626_sn2014ab_1;
halphavarscaledsub20140626_sn2014ab_1= (d20140626_sn2014ab_1(2,:) - halphafit20140626_sn2014ab_1(d20140626_sn2014ab_1(1,:))')./halphafit20140626_sn2014ab_1(d20140626_sn2014ab_1(1,:))';

clf
plot(halphafit20140626_sn2014ab_1,d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(2,:))

halphafit20140630_sn2014ab_1= fit(d20140630_sn2014ab_1(1,[find(d20140630_sn2014ab_1(1,:)>6000,3,'first') find(d20140630_sn2014ab_1(1,:)<6935,3,'last')])',d20140630_sn2014ab_1(2,[find(d20140630_sn2014ab_1(1,:)>6000,3,'first') find(d20140630_sn2014ab_1(1,:)<6935,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140630_sn2014ab_1= mean(halphafit20140630_sn2014ab_1(d20140630_sn2014ab_1(1,(d20140630_sn2014ab_1(1,:)>6462.8 & d20140630_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140630_sn2014ab_1= d20140630_sn2014ab_1(2,:)/halphanormconstant20140630_sn2014ab_1;
halphavarscaledsub20140630_sn2014ab_1= (d20140630_sn2014ab_1(2,:) - halphafit20140630_sn2014ab_1(d20140630_sn2014ab_1(1,:))')./halphafit20140630_sn2014ab_1(d20140630_sn2014ab_1(1,:))';

clf
plot(halphafit20140630_sn2014ab_1,d20140630_sn2014ab_1(1,:),d20140630_sn2014ab_1(2,:))

halphafit20140526_sn2014ab_2= fit(d20140526_sn2014ab_2(1,[find(d20140526_sn2014ab_2(1,:)>6000,3,'first') find(d20140526_sn2014ab_2(1,:)<6905,3,'last')])',d20140526_sn2014ab_2(2,[find(d20140526_sn2014ab_2(1,:)>6000,3,'first') find(d20140526_sn2014ab_2(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140526_sn2014ab_2= mean(halphafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,(d20140526_sn2014ab_2(1,:)>6462.8 & d20140526_sn2014ab_2(1,:)<6662.8))));
halphauniscaled20140526_sn2014ab_2= d20140526_sn2014ab_2(2,:)/halphanormconstant20140526_sn2014ab_2;
halphavarscaledsub20140526_sn2014ab_2= (d20140526_sn2014ab_2(2,:) - halphafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))')./halphafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))';

clf
plot(halphafit20140526_sn2014ab_2,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))

halphafit20140602_sn2014ab_1= fit(d20140602_sn2014ab_1(1,[find(d20140602_sn2014ab_1(1,:)>6000,3,'first') find(d20140602_sn2014ab_1(1,:)<6905,3,'last')])',d20140602_sn2014ab_1(2,[find(d20140602_sn2014ab_1(1,:)>6000,3,'first') find(d20140602_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140602_sn2014ab_1= mean(halphafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,(d20140602_sn2014ab_1(1,:)>6462.8 & d20140602_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140602_sn2014ab_1= d20140602_sn2014ab_1(2,:)/halphanormconstant20140602_sn2014ab_1;
halphavarscaledsub20140602_sn2014ab_1= (d20140602_sn2014ab_1(2,:) - halphafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))')./halphafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))';

clf
plot(halphafit20140602_sn2014ab_1,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
axis([4400 8800 0.10*10^-15 0.5*10^-14])

halphafit20140722_sn2014ab_1= fit(d20140722_sn2014ab_1(1,[find(d20140722_sn2014ab_1(1,:)>6000,3,'first') find(d20140722_sn2014ab_1(1,:)<6905,3,'last')])',d20140722_sn2014ab_1(2,[find(d20140722_sn2014ab_1(1,:)>6000,3,'first') find(d20140722_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140722_sn2014ab_1= mean(halphafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,(d20140722_sn2014ab_1(1,:)>6462.8 & d20140722_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140722_sn2014ab_1= d20140722_sn2014ab_1(2,:)/halphanormconstant20140722_sn2014ab_1;
halphavarscaledsub20140722_sn2014ab_1= (d20140722_sn2014ab_1(2,:) - halphafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))')./halphafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))';

clf
plot(halphafit20140722_sn2014ab_1,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
axis([4400 8800 0.10*10^-15 0.5*10^-14])

halphafit20140722_sn2014ab_4= fit(d20140722_sn2014ab_4(1,[find(d20140722_sn2014ab_4(1,:)>6000,3,'first') find(d20140722_sn2014ab_4(1,:)<6905,3,'last')])',d20140722_sn2014ab_4(2,[find(d20140722_sn2014ab_4(1,:)>6000,3,'first') find(d20140722_sn2014ab_4(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140722_sn2014ab_4= mean(halphafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,(d20140722_sn2014ab_4(1,:)>6462.8 & d20140722_sn2014ab_4(1,:)<6662.8))));
halphauniscaled20140722_sn2014ab_4= d20140722_sn2014ab_4(2,:)/halphanormconstant20140722_sn2014ab_4;
halphavarscaledsub20140722_sn2014ab_4= (d20140722_sn2014ab_4(2,:) - halphafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,:))')./halphafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,:))';

clf
plot(halphafit20140722_sn2014ab_4,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
axis([4400 8800 0.10*10^-15 0.5*10^-14])

halphafit20140808_sn2014ab_1= fit(d20140808_sn2014ab_1(1,[find(d20140808_sn2014ab_1(1,:)>6000,3,'first') find(d20140808_sn2014ab_1(1,:)<6905,3,'last')])',d20140808_sn2014ab_1(2,[find(d20140808_sn2014ab_1(1,:)>6000,3,'first') find(d20140808_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140808_sn2014ab_1= mean(halphafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,(d20140808_sn2014ab_1(1,:)>6462.8 & d20140808_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140808_sn2014ab_1= d20140808_sn2014ab_1(2,:)/halphanormconstant20140808_sn2014ab_1;
halphavarscaledsub20140808_sn2014ab_1= (d20140808_sn2014ab_1(2,:) - halphafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))')./halphafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))';

clf
plot(halphafit20140808_sn2014ab_1,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
axis([4400 8800 0.10*10^-15 0.5*10^-14])

halphafit20140408_sn2014ab_1= fit(d20140408_sn2014ab_1(1,[find(d20140408_sn2014ab_1(1,:)>6000,3,'first') find(d20140408_sn2014ab_1(1,:)<7125,3,'last')])',d20140408_sn2014ab_1(2,[find(d20140408_sn2014ab_1(1,:)>6000,3,'first') find(d20140408_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140408_sn2014ab_1= mean(halphafit20140408_sn2014ab_1(d20140408_sn2014ab_1(1,(d20140408_sn2014ab_1(1,:)>6462.8 & d20140408_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140408_sn2014ab_1= d20140408_sn2014ab_1(2,:)/halphanormconstant20140408_sn2014ab_1;
halphavarscaledsub20140408_sn2014ab_1= (d20140408_sn2014ab_1(2,:) - halphafit20140408_sn2014ab_1(d20140408_sn2014ab_1(1,:))')./halphafit20140408_sn2014ab_1(d20140408_sn2014ab_1(1,:))';

clf
plot(halphafit20140408_sn2014ab_1,d20140408_sn2014ab_1(1,:),d20140408_sn2014ab_1(2,:))

halphafit20140409_sn2014ab_1= fit(d20140409_sn2014ab_1(1,[find(d20140409_sn2014ab_1(1,:)>6000,3,'first') find(d20140409_sn2014ab_1(1,:)<6905,3,'last')])',d20140409_sn2014ab_1(2,[find(d20140409_sn2014ab_1(1,:)>6000,3,'first') find(d20140409_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140409_sn2014ab_1= mean(halphafit20140409_sn2014ab_1(d20140409_sn2014ab_1(1,(d20140409_sn2014ab_1(1,:)>6462.8 & d20140409_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140409_sn2014ab_1= d20140409_sn2014ab_1(2,:)/halphanormconstant20140409_sn2014ab_1;
halphavarscaledsub20140409_sn2014ab_1= (d20140409_sn2014ab_1(2,:) - halphafit20140409_sn2014ab_1(d20140409_sn2014ab_1(1,:))')./halphafit20140409_sn2014ab_1(d20140409_sn2014ab_1(1,:))';

clf
plot(halphafit20140409_sn2014ab_1,d20140409_sn2014ab_1(1,:),d20140409_sn2014ab_1(2,:))

halphafit20140411_sn2014ab_1= fit(d20140411_sn2014ab_1(1,[find(d20140411_sn2014ab_1(1,:)>6000,3,'first') find(d20140411_sn2014ab_1(1,:)<6925,3,'last')])',d20140411_sn2014ab_1(2,[find(d20140411_sn2014ab_1(1,:)>6000,3,'first') find(d20140411_sn2014ab_1(1,:)<6925,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140411_sn2014ab_1= mean(halphafit20140411_sn2014ab_1(d20140411_sn2014ab_1(1,(d20140411_sn2014ab_1(1,:)>6462.8 & d20140411_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140411_sn2014ab_1= d20140411_sn2014ab_1(2,:)/halphanormconstant20140411_sn2014ab_1;
halphavarscaledsub20140411_sn2014ab_1= (d20140411_sn2014ab_1(2,:) - halphafit20140411_sn2014ab_1(d20140411_sn2014ab_1(1,:))')./halphafit20140411_sn2014ab_1(d20140411_sn2014ab_1(1,:))';

clf
plot(halphafit20140411_sn2014ab_1,d20140411_sn2014ab_1(1,:),d20140411_sn2014ab_1(2,:))

halphafit20140420_sn2014ab_1= fit(d20140420_sn2014ab_1(1,[find(d20140420_sn2014ab_1(1,:)>6000,3,'first') find(d20140420_sn2014ab_1(1,:)<6905,3,'last')])',d20140420_sn2014ab_1(2,[find(d20140420_sn2014ab_1(1,:)>6000,3,'first') find(d20140420_sn2014ab_1(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140420_sn2014ab_1= mean(halphafit20140420_sn2014ab_1(d20140420_sn2014ab_1(1,(d20140420_sn2014ab_1(1,:)>6462.8 & d20140420_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140420_sn2014ab_1= d20140420_sn2014ab_1(2,:)/halphanormconstant20140420_sn2014ab_1;
halphavarscaledsub20140420_sn2014ab_1= (d20140420_sn2014ab_1(2,:) - halphafit20140420_sn2014ab_1(d20140420_sn2014ab_1(1,:))')./halphafit20140420_sn2014ab_1(d20140420_sn2014ab_1(1,:))';

clf
plot(halphafit20140420_sn2014ab_1,d20140420_sn2014ab_1(1,:),d20140420_sn2014ab_1(2,:))

halphafit20140420_sn2014ab_2= fit(d20140420_sn2014ab_2(1,[find(d20140420_sn2014ab_2(1,:)>6000,3,'first') find(d20140420_sn2014ab_2(1,:)<6905,3,'last')])',d20140420_sn2014ab_2(2,[find(d20140420_sn2014ab_2(1,:)>6000,3,'first') find(d20140420_sn2014ab_2(1,:)<6905,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140420_sn2014ab_2= mean(halphafit20140420_sn2014ab_2(d20140420_sn2014ab_2(1,(d20140420_sn2014ab_2(1,:)>6462.8 & d20140420_sn2014ab_2(1,:)<6662.8))));
halphauniscaled20140420_sn2014ab_2= d20140420_sn2014ab_2(2,:)/halphanormconstant20140420_sn2014ab_2;
halphavarscaledsub20140420_sn2014ab_2= (d20140420_sn2014ab_2(2,:) - halphafit20140420_sn2014ab_2(d20140420_sn2014ab_2(1,:))')./halphafit20140420_sn2014ab_2(d20140420_sn2014ab_2(1,:))';

clf
plot(halphafit20140420_sn2014ab_2,d20140420_sn2014ab_2(1,:),d20140420_sn2014ab_2(2,:))

halphafit20140423_sn2014ab_1= fit(d20140423_sn2014ab_1(1,[find(d20140423_sn2014ab_1(1,:)>6000,3,'first') find(d20140423_sn2014ab_1(1,:)<6885,3,'last')])',d20140423_sn2014ab_1(2,[find(d20140423_sn2014ab_1(1,:)>6000,3,'first') find(d20140423_sn2014ab_1(1,:)<6885,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140423_sn2014ab_1= mean(halphafit20140423_sn2014ab_1(d20140423_sn2014ab_1(1,(d20140423_sn2014ab_1(1,:)>6462.8 & d20140423_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140423_sn2014ab_1= d20140423_sn2014ab_1(2,:)/halphanormconstant20140423_sn2014ab_1;
halphavarscaledsub20140423_sn2014ab_1= (d20140423_sn2014ab_1(2,:) - halphafit20140423_sn2014ab_1(d20140423_sn2014ab_1(1,:))')./halphafit20140423_sn2014ab_1(d20140423_sn2014ab_1(1,:))';

clf
plot(halphafit20140423_sn2014ab_1,d20140423_sn2014ab_1(1,:),d20140423_sn2014ab_1(2,:))

halphafit20140507_sn2014ab_4= fit(d20140507_sn2014ab_4(1,[find(d20140507_sn2014ab_4(1,:)>6000,3,'first') find(d20140507_sn2014ab_4(1,:)<6885,3,'last')])',d20140507_sn2014ab_4(2,[find(d20140507_sn2014ab_4(1,:)>6000,3,'first') find(d20140507_sn2014ab_4(1,:)<6885,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140507_sn2014ab_4= mean(halphafit20140507_sn2014ab_4(d20140507_sn2014ab_4(1,(d20140507_sn2014ab_4(1,:)>6462.8 & d20140507_sn2014ab_4(1,:)<6662.8))));
halphauniscaled20140507_sn2014ab_4= d20140507_sn2014ab_4(2,:)/halphanormconstant20140507_sn2014ab_4;
halphavarscaledsub20140507_sn2014ab_4= (d20140507_sn2014ab_4(2,:) - halphafit20140507_sn2014ab_4(d20140507_sn2014ab_4(1,:))')./halphafit20140507_sn2014ab_4(d20140507_sn2014ab_4(1,:))';

clf
plot(halphafit20140507_sn2014ab_4,d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:))

halphafit20140522_sn2014ab_1= fit(d20140522_sn2014ab_1(1,[find(d20140522_sn2014ab_1(1,:)>6177,3,'first') find(d20140522_sn2014ab_1(1,:)<7125,3,'last')])',d20140522_sn2014ab_1(2,[find(d20140522_sn2014ab_1(1,:)>6177,3,'first') find(d20140522_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140522_sn2014ab_1= mean(halphafit20140522_sn2014ab_1(d20140522_sn2014ab_1(1,(d20140522_sn2014ab_1(1,:)>6462.8 & d20140522_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140522_sn2014ab_1= d20140522_sn2014ab_1(2,:)/halphanormconstant20140522_sn2014ab_1;
halphavarscaledsub20140522_sn2014ab_1= (d20140522_sn2014ab_1(2,:) - halphafit20140522_sn2014ab_1(d20140522_sn2014ab_1(1,:))')./halphafit20140522_sn2014ab_1(d20140522_sn2014ab_1(1,:))';

clf
plot(halphafit20140522_sn2014ab_1,d20140522_sn2014ab_1(1,:),d20140522_sn2014ab_1(2,:))

halphafit20180414_sn2014ab_1= fit(d20180414_sn2014ab_1(1,[find(d20180414_sn2014ab_1(1,:)>6177,3,'first') find(d20180414_sn2014ab_1(1,:)<7125,3,'last')])',d20180414_sn2014ab_1(2,[find(d20180414_sn2014ab_1(1,:)>6177,3,'first') find(d20180414_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20180414_sn2014ab_1= mean(halphafit20180414_sn2014ab_1(d20180414_sn2014ab_1(1,(d20180414_sn2014ab_1(1,:)>6462.8 & d20180414_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20180414_sn2014ab_1= d20180414_sn2014ab_1(2,:)/halphanormconstant20180414_sn2014ab_1;
halphavarscaledsub20180414_sn2014ab_1= (d20180414_sn2014ab_1(2,:) - halphafit20180414_sn2014ab_1(d20180414_sn2014ab_1(1,:))')./halphafit20180414_sn2014ab_1(d20180414_sn2014ab_1(1,:))';

clf
plot(halphafit20180414_sn2014ab_1,d20180414_sn2014ab_1(1,:),d20180414_sn2014ab_1(2,:))

clf
plot(d20180414_sn2014ab_1(1,:),d20180414_sn2014ab_1(2,:))

%%%
clf
plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))
line([5889.950 5889.950], [0 max(d20140310_sn2014ab_1(2,:))])
line([5895.924 5895.924], [0 max(d20140310_sn2014ab_1(2,:))])
axis([5400 7100 min(d20140310_sn2014ab_1(2,:)) max(d20140310_sn2014ab_1(2,:))])

clf
plot(halphafit20140324_sn2014ab_1,d20140324_sn2014ab_1(1,:),d20140324_sn2014ab_1(2,:))
line([5889.950 5889.950], [0 max(d20140324_sn2014ab_1(2,:))])
line([5895.924 5895.924], [0 max(d20140324_sn2014ab_1(2,:))])
axis([5400 7100 min(d20140324_sn2014ab_1(2,:)) max(d20140324_sn2014ab_1(2,:))])

%naid line locations
%5889.950 and 5895.924

%%% test the plot here for 20140519

clf
plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))

clf
plot(halphafit20140324_sn2014ab_1,d20140324_sn2014ab_1(1,:),d20140324_sn2014ab_1(2,:))

clf
plot(halphafit20140329_sn2014ab_1,d20140329_sn2014ab_1(1,:),d20140329_sn2014ab_1(2,:))

clf
plot(halphafit20140330_sn2014ab_1,d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(2,:))

clf
plot(halphafit20140331_sn2014ab_1,d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(2,:))

clf
plot(halphafit20140402_sn2014ab_1,d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(2,:))

clf
plot(halphafit20140426_sn2014ab_1,d20140426_sn2014ab_1(1,:),d20140426_sn2014ab_1(2,:))

clf
plot(halphafit20140427_sn2014ab_1,d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(2,:))

clf
plot(halphafit20140428_sn2014ab_1,d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(2,:))

clf
plot(halphafit20140430_sn2014ab_1,d20140430_sn2014ab_1(1,:),d20140430_sn2014ab_1(2,:))

clf
plot(halphafit20140501_sn2014ab_1,d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(2,:))

clf
plot(halphafit20140519_sn2014ab_1,d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:))
axis([5400 7100 0.10*10^-15 1*10^-15])

clf
plot(halphafit20140523_sn2014ab_1,d20140523_sn2014ab_1(1,:),d20140523_sn2014ab_1(2,:))

clf
plot(halphafit20140524_sn2014ab_1,d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(2,:))

clf
plot(halphafit20140526_sn2014ab_1,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))

clf
plot(halphafit20140528_sn2014ab_1,d20140528_sn2014ab_1(1,:),d20140528_sn2014ab_1(2,:))

clf
plot(halphafit20140621_sn2014ab_1,d20140621_sn2014ab_1(1,:),d20140621_sn2014ab_1(2,:))

clf
plot(halphafit20140622_sn2014ab_1,d20140622_sn2014ab_1(1,:),d20140622_sn2014ab_1(2,:))

clf
plot(halphafit20140623_sn2014ab_1,d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(2,:))

clf
plot(halphafit20140624_sn2014ab_1,d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(2,:))

clf
plot(halphafit20140626_sn2014ab_1,d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(2,:))

clf
plot(halphafit20140630_sn2014ab_1,d20140630_sn2014ab_1(1,:),d20140630_sn2014ab_1(2,:))

clf
plot(halphafit20140408_sn2014ab_1,d20140408_sn2014ab_1(1,:),d20140408_sn2014ab_1(2,:))

clf
plot(halphafit20140409_sn2014ab_1,d20140409_sn2014ab_1(1,:),d20140409_sn2014ab_1(2,:))

clf
plot(halphafit20140411_sn2014ab_1,d20140411_sn2014ab_1(1,:),d20140411_sn2014ab_1(2,:))

clf
plot(halphafit20140507_sn2014ab_4,d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:))

clf
plot(halphafit20140420_sn2014ab_1,d20140420_sn2014ab_1(1,:),d20140420_sn2014ab_1(2,:))

clf
plot(halphafit20140423_sn2014ab_1,d20140423_sn2014ab_1(1,:),d20140423_sn2014ab_1(2,:))

clf
plot(halphafit20140522_sn2014ab_1,d20140522_sn2014ab_1(1,:),d20140522_sn2014ab_1(2,:))

clf
plot(halphafit20140526_sn2014ab_2,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
%clf
%plot(halphafit20140526_sn2014ab_3,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
%clf
%plot(halphafit20140526_sn2014ab_4,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
clf
plot(halphafit20140602_sn2014ab_1,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140602_sn2014ab_2,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140602_sn2014ab_3,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
clf
plot(halphafit20140722_sn2014ab_1,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_2,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_3,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
clf
plot(halphafit20140722_sn2014ab_4,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_5,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_6,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
clf
plot(halphafit20140808_sn2014ab_1,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140808_sn2014ab_2,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140808_sn2014ab_3,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))

%axis conversion to velocity relative to Halpha
%velocity in km/s
lambdaHalpha = 6562.81;
c=3*10^10;
velHalpha_20140310_1 = 10^-5 .* c.* (d20140310_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140324_1 = 10^-5 .* c.* (d20140324_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140329_1 = 10^-5 .* c.* (d20140329_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140330_1 = 10^-5 .* c.* (d20140330_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140331_1 = 10^-5 .* c.* (d20140331_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140402_1 = 10^-5 .* c.* (d20140402_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140426_1 = 10^-5 .* c.* (d20140426_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140427_1 = 10^-5 .* c.* (d20140427_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140428_1 = 10^-5 .* c.* (d20140428_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140430_1 = 10^-5 .* c.* (d20140430_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140501_1 = 10^-5 .* c.* (d20140501_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140519_1 = 10^-5 .* c.* (d20140519_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140523_1 = 10^-5 .* c.* (d20140523_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140524_1 = 10^-5 .* c.* (d20140524_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140526_1 = 10^-5 .* c.* (d20140526_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140528_1 = 10^-5 .* c.* (d20140528_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140621_1 = 10^-5 .* c.* (d20140621_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140622_1 = 10^-5 .* c.* (d20140622_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140623_1 = 10^-5 .* c.* (d20140623_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140624_1 = 10^-5 .* c.* (d20140624_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140626_1 = 10^-5 .* c.* (d20140626_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140630_1 = 10^-5 .* c.* (d20140630_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140526_3 = 10^-5 .* c.* (d20140526_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140526_4 = 10^-5 .* c.* (d20140526_sn2014ab_4(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140602_2 = 10^-5 .* c.* (d20140602_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140602_3 = 10^-5 .* c.* (d20140602_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_2 = 10^-5 .* c.* (d20140722_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_3 = 10^-5 .* c.* (d20140722_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140722_4 = 10^-5 .* c.* (d20140722_sn2014ab_4(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_5 = 10^-5 .* c.* (d20140722_sn2014ab_5(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_6 = 10^-5 .* c.* (d20140722_sn2014ab_6(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140808_2 = 10^-5 .* c.* (d20140808_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140808_3 = 10^-5 .* c.* (d20140808_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140408_1 = 10^-5 .* c.* (d20140408_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140409_1 = 10^-5 .* c.* (d20140409_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140411_1 = 10^-5 .* c.* (d20140411_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140507_4 = 10^-5 .* c.* (d20140507_sn2014ab_4(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140420_1 = 10^-5 .* c.* (d20140420_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140420_2 = 10^-5 .* c.* (d20140420_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140423_1 = 10^-5 .* c.* (d20140423_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140522_1 = 10^-5 .* c.* (d20140522_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20180414_1 = 10^-5 .* c.* (d20180414_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;


%velHalpha_offset_2_10140310 = 10^-5 .* c.* (d20140310_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140324 = 10^-5 .* c.* (d20140324_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140329 = 10^-5 .* c.* (d20140329_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140330 = 10^-5 .* c.* (d20140330_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140331 = 10^-5 .* c.* (d20140331_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140402 = 10^-5 .* c.* (d20140402_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140426 = 10^-5 .* c.* (d20140426_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140427 = 10^-5 .* c.* (d20140427_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140428 = 10^-5 .* c.* (d20140428_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140430 = 10^-5 .* c.* (d20140430_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140501 = 10^-5 .* c.* (d20140501_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140523 = 10^-5 .* c.* (d20140523_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140524 = 10^-5 .* c.* (d20140524_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140526 = 10^-5 .* c.* (d20140526_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140528 = 10^-5 .* c.* (d20140528_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140621 = 10^-5 .* c.* (d20140621_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140622 = 10^-5 .* c.* (d20140622_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140623 = 10^-5 .* c.* (d20140623_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140624 = 10^-5 .* c.* (d20140624_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140626 = 10^-5 .* c.* (d20140626_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140630 = 10^-5 .* c.* (d20140630_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;

%axis conversion to velocity relative to Hbeta
lambdaHbeta = 4861.363;
velHbeta_20140310_1 = 10^-5 .* c.* (d20140310_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140324_1 = 10^-5 .* c.* (d20140324_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140329_1 = 10^-5 .* c.* (d20140329_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140330_1 = 10^-5 .* c.* (d20140330_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140331_1 = 10^-5 .* c.* (d20140331_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140402_1 = 10^-5 .* c.* (d20140402_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140426_1 = 10^-5 .* c.* (d20140426_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140427_1 = 10^-5 .* c.* (d20140427_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140428_1 = 10^-5 .* c.* (d20140428_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140430_1 = 10^-5 .* c.* (d20140430_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140501_1 = 10^-5 .* c.* (d20140501_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140519_1 = 10^-5 .* c.* (d20140519_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140523_1 = 10^-5 .* c.* (d20140523_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140524_1 = 10^-5 .* c.* (d20140524_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140526_1 = 10^-5 .* c.* (d20140526_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140528_1 = 10^-5 .* c.* (d20140528_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140621_1 = 10^-5 .* c.* (d20140621_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140622_1 = 10^-5 .* c.* (d20140622_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140623_1 = 10^-5 .* c.* (d20140623_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140624_1 = 10^-5 .* c.* (d20140624_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140626_1 = 10^-5 .* c.* (d20140626_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140630_1 = 10^-5 .* c.* (d20140630_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140526_3 = 10^-5 .* c.* (d20140526_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140526_4 = 10^-5 .* c.* (d20140526_sn2014ab_4(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140602_2 = 10^-5 .* c.* (d20140602_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140602_3 = 10^-5 .* c.* (d20140602_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_2 = 10^-5 .* c.* (d20140722_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_3 = 10^-5 .* c.* (d20140722_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140722_4 = 10^-5 .* c.* (d20140722_sn2014ab_4(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_5 = 10^-5 .* c.* (d20140722_sn2014ab_5(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_6 = 10^-5 .* c.* (d20140722_sn2014ab_6(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140808_2 = 10^-5 .* c.* (d20140808_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140808_3 = 10^-5 .* c.* (d20140808_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140408_1 = 10^-5 .* c.* (d20140408_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140409_1 = 10^-5 .* c.* (d20140409_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140411_1 = 10^-5 .* c.* (d20140411_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140507_4 = 10^-5 .* c.* (d20140507_sn2014ab_4(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140420_1 = 10^-5 .* c.* (d20140420_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140420_2 = 10^-5 .* c.* (d20140420_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140423_1 = 10^-5 .* c.* (d20140423_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140522_1 = 10^-5 .* c.* (d20140522_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20180414_1 = 10^-5 .* c.* (d20180414_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;

5895.924
%axis conversion to velocity relative to Na I D
lambdaNaID1= 5889.950;
lambdaNaID2= 5895.924;
lambdaNaID = (lambdaNaID1 + lambdaNaID2)/2;

velNaID_20140310_1 = 10^-5 .* c.* (d20140310_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140324_1 = 10^-5 .* c.* (d20140324_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140329_1 = 10^-5 .* c.* (d20140329_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140330_1 = 10^-5 .* c.* (d20140330_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140331_1 = 10^-5 .* c.* (d20140331_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140402_1 = 10^-5 .* c.* (d20140402_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140426_1 = 10^-5 .* c.* (d20140426_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140427_1 = 10^-5 .* c.* (d20140427_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140428_1 = 10^-5 .* c.* (d20140428_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140430_1 = 10^-5 .* c.* (d20140430_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140501_1 = 10^-5 .* c.* (d20140501_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140519_1 = 10^-5 .* c.* (d20140519_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140523_1 = 10^-5 .* c.* (d20140523_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140524_1 = 10^-5 .* c.* (d20140524_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140526_1 = 10^-5 .* c.* (d20140526_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140528_1 = 10^-5 .* c.* (d20140528_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140621_1 = 10^-5 .* c.* (d20140621_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140622_1 = 10^-5 .* c.* (d20140622_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140623_1 = 10^-5 .* c.* (d20140623_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140624_1 = 10^-5 .* c.* (d20140624_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140626_1 = 10^-5 .* c.* (d20140626_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140630_1 = 10^-5 .* c.* (d20140630_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140526_3 = 10^-5 .* c.* (d20140526_sn2014ab_3(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140526_4 = 10^-5 .* c.* (d20140526_sn2014ab_4(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140602_2 = 10^-5 .* c.* (d20140602_sn2014ab_2(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140602_3 = 10^-5 .* c.* (d20140602_sn2014ab_3(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140722_2 = 10^-5 .* c.* (d20140722_sn2014ab_2(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140722_3 = 10^-5 .* c.* (d20140722_sn2014ab_3(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140722_4 = 10^-5 .* c.* (d20140722_sn2014ab_4(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140722_5 = 10^-5 .* c.* (d20140722_sn2014ab_5(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140722_6 = 10^-5 .* c.* (d20140722_sn2014ab_6(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140808_2 = 10^-5 .* c.* (d20140808_sn2014ab_2(1,:)-lambdaNaID)./lambdaNaID;
%velNaID_20140808_3 = 10^-5 .* c.* (d20140808_sn2014ab_3(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140408_1 = 10^-5 .* c.* (d20140408_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140409_1 = 10^-5 .* c.* (d20140409_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140411_1 = 10^-5 .* c.* (d20140411_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140507_4 = 10^-5 .* c.* (d20140507_sn2014ab_4(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140420_1 = 10^-5 .* c.* (d20140420_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140420_2 = 10^-5 .* c.* (d20140420_sn2014ab_2(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140423_1 = 10^-5 .* c.* (d20140423_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20140522_1 = 10^-5 .* c.* (d20140522_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;
velNaID_20180414_1 = 10^-5 .* c.* (d20180414_sn2014ab_1(1,:)-lambdaNaID)./lambdaNaID;

%%Determining the appropriate offset for the spectra without a narrow line
% nothing here?

clf
hold all 
plot(velHalpha_20140310_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140324_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140329_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140330_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140331_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140402_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140408_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140409_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140411_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140420_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140423_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140426_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140427_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140428_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140430_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140501_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140507_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))/10^3,halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140522_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.0000         0    1.0000])
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])

line([0 0],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
axis([[-5 5] [0 1.1]])

plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])

plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])

clf
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
hold all                                                                                              
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.6667])
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.3333])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])
plot(velHalpha_20180414_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])

line([0 0],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
axis([[-5 5] [0 1]])


%velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~ (d20140526_sn2014ab_2(1,:)>6513 & d20140526_sn2014ab_2(1,:)<6613)))
%
%
%clf
%plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',2,'Color',[0.5714         0    1.0000])
%hold all                                                                                              
%plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~ (d20140526_sn2014ab_2(1,:)>6558 & d20140526_sn2014ab_2(1,:)<6568)))/10^3,halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~(d20140526_sn2014ab_2(1,:)>6558 & d20140526_sn2014ab_2(1,:)<6568)))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~(d20140526_sn2014ab_2(1,:)>6558 & d20140526_sn2014ab_2(1,:)<6568)))),'LineWidth',2,'Color',[1.0000         0    0.6667])
%plot(smooth(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,200),smooth(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),200),'LineWidth',2,'Color',[1         0    1.0000])
%
%findpeaks(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))))
%
%blah2 = halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963)));
%blah = velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3;
%findpeaks(blah2,blah,'MinPeakProminence',0.05)






%test1 = velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~ (d20140526_sn2014ab_2(1,:)>6558 & d20140526_sn2014ab_2(1,:)<6568)))/10^3
%test2 = halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~(d20140526_sn2014ab_2(1,:)>6558 & d20140526_sn2014ab_2(1,:)<6568)))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963 &~(d20140526_sn2014ab_2(1,:)>6558 & d20140526_sn2014ab_2(1,:)<6568))))
%testold1=velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3
%testold2=halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963)))
%
%plot(test1,test2)
%
%plot(testold1,testold2)
%plot(smooth(testold1),smooth(testold2))
%
%

%ftestold = fit(testold1',testold2','gauss2')

plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.3333])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])
plot(velHalpha_20180414_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])

line([0 0],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
axis([[-5 5] [0 1]])






%xtest = velHalpha_20140310_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))
%ytest = halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963)))
%
%g3fit_20140310_1 = fit(velHalpha_20140310_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))),'gauss3')
%
%clf
%hold all
%plot(xtest,g3fit_20140310_1.a1*exp(-((xtest-g3fit_20140310_1.b1)./g3fit_20140310_1.c1).^2))
%plot(xtest,g3fit_20140310_1.a2*exp(-((xtest-g3fit_20140310_1.b2)./g3fit_20140310_1.c2).^2))
%plot(xtest,g3fit_20140310_1.a3*exp(-((xtest-g3fit_20140310_1.b3)./g3fit_20140310_1.c3).^2))
%plot(xtest,ytest)

%g3fit_20140324_1 = fit(velHalpha_20140324_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140329_1 = fit(velHalpha_20140329_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140330_1 = fit(velHalpha_20140330_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140331_1 = fit(velHalpha_20140331_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140402_1 = fit(velHalpha_20140402_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140408_1 = fit(velHalpha_20140408_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140409_1 = fit(velHalpha_20140409_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140411_1 = fit(velHalpha_20140411_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140420_1 = fit(velHalpha_20140420_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140423_1 = fit(velHalpha_20140423_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140426_1 = fit(velHalpha_20140426_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140427_1 = fit(velHalpha_20140427_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140428_1 = fit(velHalpha_20140428_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140430_1 = fit(velHalpha_20140430_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140501_1 = fit(velHalpha_20140501_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140507_4 = fit(velHalpha_20140507_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))',halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))'./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))),'gauss3')
%g3fit_20140522_1 = fit(velHalpha_20140522_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))),'gauss3')
%g3fit_20140519_1 = fit(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))',halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'gauss3')
%
%
%
%xtest = velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))
%ytest = halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))'./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963)))
%
%g2fit_20140519_1 = fit(xtest(ytest>0)',ytest(ytest>0),'gauss2')
%
%clf
%hold all
%plot(xtest,g2fit_20140519_1.a1*exp(-((xtest-g2fit_20140519_1.b1)./g2fit_20140519_1.c1).^2))
%plot(xtest,g3fit_20140519_1.a2*exp(-((xtest-g3fit_20140519_1.b2)./g3fit_20140519_1.c2).^2))
%%plot(xtest,g3fit_20140519_1.a3*exp(-((xtest-g3fit_20140519_1.b3)./g3fit_20140519_1.c3).^2))
%plot(xtest(ytest>0),ytest(ytest>0))
%
%
%findpeaks(ytest(ytest>0),'MinPeakProminence',0.05,'Annotate','extents')
%
%











%xnewtest = smooth(xtest(ytest>0),150)
%ynewtest = smooth(ytest(ytest>0),150)
%g2fit_20140519_1 = fit(xnewtest,ynewtest,'gauss1')
%
%clf
%hold all
%plot(xnewtest,g2fit_20140519_1.a1*exp(-((xnewtest-g2fit_20140519_1.b1)./g2fit_20140519_1.c1).^2))
%%plot(xnewtest,g2fit_20140519_1.a2*exp(-((xnewtest-g2fit_20140519_1.b2)./g2fit_20140519_1.c2).^2))
%%plot(xnewtest,g2fit_20140519_1.a3*exp(-((xnewtest-g2fit_20140519_1.b3)./g2fit_20140519_1.c3).^2))
%plot(smooth(xnewtest(ynewtest>0),150),smooth(ynewtest(ynewtest>0),150))











%%Finding the narrow line offset, only run before narrow line calibration is applied so it is commented out now.
%%narrow Halpha velocity
clf
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
hold all                                                                                              
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.6667])
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.3333])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])
plot(velHalpha_20180414_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])

line([0 0],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
axis([[-5 5] [0 1]])


%looking for narrow absorption--its there! zzz make plot of this
clf
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1+halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.0000 0.7255 0.0902])
hold all
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,1+halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineWidth',3,'Color',[0.0000 0.0000 1.0000])
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,1+halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000 0.0000 0.0000])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,1+halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.0000 0.3922 0.0039])
plot(velHalpha_20140722_4(find(d20140722_sn2014ab_4(1,:)>6163 & d20140722_sn2014ab_4(1,:)<6963))/10^3,1+halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:)>6163 & d20140722_sn2014ab_4(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:)>6163 & d20140722_sn2014ab_4(1,:)<6963))),'LineWidth',3,'Color',[0.4941 0.1765 0.8235])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1+halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.9961 0.5373 0.0000])
plot(velHalpha_20180414_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))/10^3,1+halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.0000 0.6824 0.4941])
box on
line([0 0],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
axis([[-0.25 0.25] [1.45 1.8]])
xlabel('Doppler velocity (10^3 km/s)','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')

%saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\narrowHalphaAbs.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\narrowHalphaAbs.eps']);

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\narrowHalphaAbs.pdf


%%Its good after initial narrow fits
%%check hbeta narrow line 
%%4361 - 4861 - 5361
%clf
%plot(velHbeta_20140519_1(find(d20140519_sn2014ab_1(1,:)>4361 & d20140519_sn2014ab_1(1,:)<5361))/10^3,halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4361 & d20140519_sn2014ab_1(1,:)<5361))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4361 & d20140519_sn2014ab_1(1,:)<5361))),'LineWidth',3,'Color',[0.5714         0    1.0000])
%hold all
%plot(velHbeta_20140526_2(find(d20140526_sn2014ab_2(1,:)>4361 & d20140526_sn2014ab_2(1,:)<5361))/10^3,halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4361 & d20140526_sn2014ab_2(1,:)<5361))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4361 & d20140526_sn2014ab_2(1,:)<5361))),'LineWidth',3,'Color',[1.0000         0    0.6667])
%plot(velHbeta_20140602_1(find(d20140602_sn2014ab_1(1,:)>4361 & d20140602_sn2014ab_1(1,:)<5361))/10^3,halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4361 & d20140602_sn2014ab_1(1,:)<5361))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4361 & d20140602_sn2014ab_1(1,:)<5361))),'LineWidth',3,'Color',[1.0000         0    0.3333])
%plot(velHbeta_20140722_1(find(d20140722_sn2014ab_1(1,:)>4361 & d20140722_sn2014ab_1(1,:)<5361))/10^3,halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4361 & d20140722_sn2014ab_1(1,:)<5361))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4361 & d20140722_sn2014ab_1(1,:)<5361))),'LineWidth',3,'Color',[0.1667         0         0])
%plot(velHbeta_20140808_1(find(d20140808_sn2014ab_1(1,:)>4361 & d20140808_sn2014ab_1(1,:)<5361))/10^3,halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4361 & d20140808_sn2014ab_1(1,:)<5361))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4361 & d20140808_sn2014ab_1(1,:)<5361))),'LineWidth',3,'Color',[     0         0         0])
%plot(velHbeta_20180414_1(find(d20180414_sn2014ab_1(1,:)>4361 & d20180414_sn2014ab_1(1,:)<5361))/10^3,halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>4361 & d20180414_sn2014ab_1(1,:)<5361))./max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>4361 & d20180414_sn2014ab_1(1,:)<5361))),'LineWidth',3,'Color',[     0         0         0])
%
%line([0 0],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
%axis([[-2 2] [0 1]])


narrowoffset(1) = velHalpha_20140519_1(find(halphavarscaledsub20140519_sn2014ab_1 == max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963)))));
narrowoffset(2) = velHalpha_20140526_2(find(halphavarscaledsub20140526_sn2014ab_2 == max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963)))));
narrowoffset(3) = velHalpha_20140602_1(find(halphavarscaledsub20140602_sn2014ab_1 == max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963)))));
narrowoffset(4) = velHalpha_20140722_1(find(halphavarscaledsub20140722_sn2014ab_1 == max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963)))));
narrowoffset(5) = velHalpha_20140808_1(find(halphavarscaledsub20140808_sn2014ab_1 == max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963)))));
narrowoffset(6) = velHalpha_20180414_1(find(halphavarscaledsub20180414_sn2014ab_1 == max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963)))));

narrowoffsetwav(1) = lambdaHalpha * (narrowoffset(1)/(10^-5 .* c)) 
narrowoffsetwav(2) = lambdaHalpha * (narrowoffset(2)/(10^-5 .* c)) 
narrowoffsetwav(3) = lambdaHalpha * (narrowoffset(3)/(10^-5 .* c)) 
narrowoffsetwav(4) = lambdaHalpha * (narrowoffset(4)/(10^-5 .* c)) 
narrowoffsetwav(5) = lambdaHalpha * (narrowoffset(5)/(10^-5 .* c)) 
narrowoffsetwav(6) = lambdaHalpha * (narrowoffset(6)/(10^-5 .* c)) 

%% %% %% init run values set here
%narrowoffsetwav_initrun(1) = -3.6960;
%narrowoffsetwav_initrun(2) = -3.9462;
%narrowoffsetwav_initrun(3) = -3.7507;
%narrowoffsetwav_initrun(4) = -3.1643;
%narrowoffsetwav_initrun(5) = -3.1643;
%narrowoffsetwav_initrun(6) = -2.6785;
meannarrowoffsetvel = mean(narrowoffset)
meannarrowoffsetwavcalib= lambdaHalpha * (meannarrowoffsetvel/(10^-5 .* c))

20140310
20140324
20140329
20140330
20140331
20140402
20140426
20140427
20140428
20140430
20140501
20140523
20140524
20140526
20140528
20140602
20140621
20140622
20140623
20140624
20140626
20140630
20140722
20140808


%maybe also check on HII region lines or set limits here zzz

[leftEWHalpha(1) ,leftNEWerr(1) ,leftdEWHalpha(1) ,rightEWHalpha(1) ,rightNEWerr(1) ,rightdEWHalpha(1) ,reldate(1) ] = measureEWleftright(d20140310_sn2014ab_1,halphavarscaledsub20140310_sn2014ab_1,p20140310_sn2014ab_1(1,1))
[leftEWHalpha(2) ,leftNEWerr(2) ,leftdEWHalpha(2) ,rightEWHalpha(2) ,rightNEWerr(2) ,rightdEWHalpha(2) ,reldate(2) ] = measureEWleftright(d20140324_sn2014ab_1,halphavarscaledsub20140324_sn2014ab_1,p20140324_sn2014ab_1(1,1))
[leftEWHalpha(3) ,leftNEWerr(3) ,leftdEWHalpha(3) ,rightEWHalpha(3) ,rightNEWerr(3) ,rightdEWHalpha(3) ,reldate(3) ] = measureEWleftright(d20140329_sn2014ab_1,halphavarscaledsub20140329_sn2014ab_1,p20140329_sn2014ab_1(1,1))
[leftEWHalpha(4) ,leftNEWerr(4) ,leftdEWHalpha(4) ,rightEWHalpha(4) ,rightNEWerr(4) ,rightdEWHalpha(4) ,reldate(4) ] = measureEWleftright(d20140330_sn2014ab_1,halphavarscaledsub20140330_sn2014ab_1,p20140330_sn2014ab_1(1,1))
[leftEWHalpha(5) ,leftNEWerr(5) ,leftdEWHalpha(5) ,rightEWHalpha(5) ,rightNEWerr(5) ,rightdEWHalpha(5) ,reldate(5) ] = measureEWleftright(d20140331_sn2014ab_1,halphavarscaledsub20140331_sn2014ab_1,p20140331_sn2014ab_1(1,1))
[leftEWHalpha(6) ,leftNEWerr(6) ,leftdEWHalpha(6) ,rightEWHalpha(6) ,rightNEWerr(6) ,rightdEWHalpha(6) ,reldate(6) ] = measureEWleftright(d20140402_sn2014ab_1,halphavarscaledsub20140402_sn2014ab_1,p20140402_sn2014ab_1(1,1))
[leftEWHalpha(7) ,leftNEWerr(7) ,leftdEWHalpha(7) ,rightEWHalpha(7) ,rightNEWerr(7) ,rightdEWHalpha(7) ,reldate(7) ] = measureEWleftright(d20140426_sn2014ab_1,halphavarscaledsub20140426_sn2014ab_1,p20140426_sn2014ab_1(1,1))
[leftEWHalpha(8) ,leftNEWerr(8) ,leftdEWHalpha(8) ,rightEWHalpha(8) ,rightNEWerr(8) ,rightdEWHalpha(8) ,reldate(8) ] = measureEWleftright(d20140427_sn2014ab_1,halphavarscaledsub20140427_sn2014ab_1,p20140427_sn2014ab_1(1,1))
[leftEWHalpha(9) ,leftNEWerr(9) ,leftdEWHalpha(9) ,rightEWHalpha(9) ,rightNEWerr(9) ,rightdEWHalpha(9) ,reldate(9) ] = measureEWleftright(d20140428_sn2014ab_1,halphavarscaledsub20140428_sn2014ab_1,p20140428_sn2014ab_1(1,1))
[leftEWHalpha(10),leftNEWerr(10),leftdEWHalpha(10),rightEWHalpha(10),rightNEWerr(10),rightdEWHalpha(10),reldate(10)] = measureEWleftright(d20140430_sn2014ab_1,halphavarscaledsub20140430_sn2014ab_1,p20140430_sn2014ab_1(1,1))
[leftEWHalpha(11),leftNEWerr(11),leftdEWHalpha(11),rightEWHalpha(11),rightNEWerr(11),rightdEWHalpha(11),reldate(11)] = measureEWleftright(d20140501_sn2014ab_1,halphavarscaledsub20140501_sn2014ab_1,p20140501_sn2014ab_1(1,1))
[leftEWHalpha(12),leftNEWerr(12),leftdEWHalpha(12),rightEWHalpha(12),rightNEWerr(12),rightdEWHalpha(12),reldate(12)] = measureEWleftright(d20140519_sn2014ab_1,halphavarscaledsub20140519_sn2014ab_1,p20140519_sn2014ab_1(1,1))
[leftEWHalpha(13),leftNEWerr(13),leftdEWHalpha(13),rightEWHalpha(13),rightNEWerr(13),rightdEWHalpha(13),reldate(13)] = measureEWleftright(d20140523_sn2014ab_1,halphavarscaledsub20140523_sn2014ab_1,p20140523_sn2014ab_1(1,1))
[leftEWHalpha(14),leftNEWerr(14),leftdEWHalpha(14),rightEWHalpha(14),rightNEWerr(14),rightdEWHalpha(14),reldate(14)] = measureEWleftright(d20140524_sn2014ab_1,halphavarscaledsub20140524_sn2014ab_1,p20140524_sn2014ab_1(1,1))
[leftEWHalpha(15),leftNEWerr(15),leftdEWHalpha(15),rightEWHalpha(15),rightNEWerr(15),rightdEWHalpha(15),reldate(15)] = measureEWleftright(d20140526_sn2014ab_1,halphavarscaledsub20140526_sn2014ab_1,p20140526_sn2014ab_1(1,1))
[leftEWHalpha(16),leftNEWerr(16),leftdEWHalpha(16),rightEWHalpha(16),rightNEWerr(16),rightdEWHalpha(16),reldate(16)] = measureEWleftright(d20140526_sn2014ab_2,halphavarscaledsub20140526_sn2014ab_2,p20140526_sn2014ab_2(1,1))
[leftEWHalpha(17),leftNEWerr(17),leftdEWHalpha(17),rightEWHalpha(17),rightNEWerr(17),rightdEWHalpha(17),reldate(17)] = measureEWleftright(d20140528_sn2014ab_1,halphavarscaledsub20140528_sn2014ab_1,p20140528_sn2014ab_1(1,1))
[leftEWHalpha(18),leftNEWerr(18),leftdEWHalpha(18),rightEWHalpha(18),rightNEWerr(18),rightdEWHalpha(18),reldate(18)] = measureEWleftright(d20140602_sn2014ab_1,halphavarscaledsub20140602_sn2014ab_1,p20140602_sn2014ab_1(1,1))
[leftEWHalpha(19),leftNEWerr(19),leftdEWHalpha(19),rightEWHalpha(19),rightNEWerr(19),rightdEWHalpha(19),reldate(19)] = measureEWleftright(d20140621_sn2014ab_1,halphavarscaledsub20140621_sn2014ab_1,p20140621_sn2014ab_1(1,1))
[leftEWHalpha(20),leftNEWerr(20),leftdEWHalpha(20),rightEWHalpha(20),rightNEWerr(20),rightdEWHalpha(20),reldate(20)] = measureEWleftright(d20140622_sn2014ab_1,halphavarscaledsub20140622_sn2014ab_1,p20140622_sn2014ab_1(1,1))
[leftEWHalpha(21),leftNEWerr(21),leftdEWHalpha(21),rightEWHalpha(21),rightNEWerr(21),rightdEWHalpha(21),reldate(21)] = measureEWleftright(d20140623_sn2014ab_1,halphavarscaledsub20140623_sn2014ab_1,p20140623_sn2014ab_1(1,1))
[leftEWHalpha(22),leftNEWerr(22),leftdEWHalpha(22),rightEWHalpha(22),rightNEWerr(22),rightdEWHalpha(22),reldate(22)] = measureEWleftright(d20140624_sn2014ab_1,halphavarscaledsub20140624_sn2014ab_1,p20140624_sn2014ab_1(1,1))
[leftEWHalpha(23),leftNEWerr(23),leftdEWHalpha(23),rightEWHalpha(23),rightNEWerr(23),rightdEWHalpha(23),reldate(23)] = measureEWleftright(d20140626_sn2014ab_1,halphavarscaledsub20140626_sn2014ab_1,p20140626_sn2014ab_1(1,1))
[leftEWHalpha(24),leftNEWerr(24),leftdEWHalpha(24),rightEWHalpha(24),rightNEWerr(24),rightdEWHalpha(24),reldate(24)] = measureEWleftright(d20140630_sn2014ab_1,halphavarscaledsub20140630_sn2014ab_1,p20140630_sn2014ab_1(1,1))
[leftEWHalpha(25),leftNEWerr(25),leftdEWHalpha(25),rightEWHalpha(25),rightNEWerr(25),rightdEWHalpha(25),reldate(25)] = measureEWleftright(d20140722_sn2014ab_1,halphavarscaledsub20140722_sn2014ab_1,p20140722_sn2014ab_1(1,1))
[leftEWHalpha(26),leftNEWerr(26),leftdEWHalpha(26),rightEWHalpha(26),rightNEWerr(26),rightdEWHalpha(26),reldate(26)] = measureEWleftright(d20140722_sn2014ab_4,halphavarscaledsub20140722_sn2014ab_4,p20140722_sn2014ab_4(1,1))
[leftEWHalpha(27),leftNEWerr(27),leftdEWHalpha(27),rightEWHalpha(27),rightNEWerr(27),rightdEWHalpha(27),reldate(27)] = measureEWleftright(d20140808_sn2014ab_1,halphavarscaledsub20140808_sn2014ab_1,p20140808_sn2014ab_1(1,1))
[leftEWHalpha(28),leftNEWerr(28),leftdEWHalpha(28),rightEWHalpha(28),rightNEWerr(28),rightdEWHalpha(28),reldate(28)] = measureEWleftright(d20140408_sn2014ab_1,halphavarscaledsub20140408_sn2014ab_1,p20140408_sn2014ab_1(1,1))
[leftEWHalpha(29),leftNEWerr(29),leftdEWHalpha(29),rightEWHalpha(29),rightNEWerr(29),rightdEWHalpha(29),reldate(29)] = measureEWleftright(d20140409_sn2014ab_1,halphavarscaledsub20140409_sn2014ab_1,p20140409_sn2014ab_1(1,1))
[leftEWHalpha(30),leftNEWerr(30),leftdEWHalpha(30),rightEWHalpha(30),rightNEWerr(30),rightdEWHalpha(30),reldate(30)] = measureEWleftright(d20140411_sn2014ab_1,halphavarscaledsub20140411_sn2014ab_1,p20140411_sn2014ab_1(1,1))
[leftEWHalpha(31),leftNEWerr(31),leftdEWHalpha(31),rightEWHalpha(31),rightNEWerr(31),rightdEWHalpha(31),reldate(31)] = measureEWleftright(d20140507_sn2014ab_4,halphavarscaledsub20140507_sn2014ab_4,p20140507_sn2014ab_4(1,1))
[leftEWHalpha(32),leftNEWerr(32),leftdEWHalpha(32),rightEWHalpha(32),rightNEWerr(32),rightdEWHalpha(32),reldate(32)] = measureEWleftright(d20140420_sn2014ab_1,halphavarscaledsub20140420_sn2014ab_1,p20140420_sn2014ab_1(1,1))
[leftEWHalpha(33),leftNEWerr(33),leftdEWHalpha(33),rightEWHalpha(33),rightNEWerr(33),rightdEWHalpha(33),reldate(33)] = measureEWleftright(d20140423_sn2014ab_1,halphavarscaledsub20140423_sn2014ab_1,p20140423_sn2014ab_1(1,1))
[leftEWHalpha(34),leftNEWerr(34),leftdEWHalpha(34),rightEWHalpha(34),rightNEWerr(34),rightdEWHalpha(34),reldate(34)] = measureEWleftright(d20140522_sn2014ab_1,halphavarscaledsub20140522_sn2014ab_1,p20140522_sn2014ab_1(1,1))
[leftEWHalpha(35),leftNEWerr(35),leftdEWHalpha(35),rightEWHalpha(35),rightNEWerr(35),rightdEWHalpha(35),reldate(35)] = measureEWleftright(d20140420_sn2014ab_2,halphavarscaledsub20140420_sn2014ab_2,p20140420_sn2014ab_2(1,1))

[sorted_reldate reldate_order] = sort(reldate);
sorted_leftEWHalpha = leftEWHalpha(reldate_order);
sorted_leftNEWerr = leftNEWerr(reldate_order);
sorted_leftdEWHalpha = leftdEWHalpha(reldate_order);
sorted_rightEWHalpha = rightEWHalpha(reldate_order);
sorted_rightNEWerr = rightNEWerr(reldate_order);
sorted_rightdEWHalpha = rightdEWHalpha(reldate_order);

%%%check 0519 if it needs a new name here

%interpolate all groups of spectra
%parts created here
%also interpolate SPOL q and u values for those spectra here to combine, also combine the errors in qsig and usig appropriately and then recalculate p, theta for the combined SPOL groups

%0329 q2
%0501 q2
%0523 q2
%0622 q2
%0623 q2
%d20140329_sn2014ab_1(5,:) q  d20140329_sn2014ab_1(6,:) u  d20140330_sn2014ab_1(3,:) q d20140330_sn2014ab_1(4,:) u

%all these dates are using the old relative date system except the new MMT SPOL data
flux_2014ab_Bok_ep20_24_part(1,:)   = contscaled20140329_sn2014ab_1(2,:);
flux_2014ab_Bok_ep20_24_part(2,:)   = interp1(d20140330_sn2014ab_1(1,:),contscaled20140330_sn2014ab_1(2,:),d20140329_sn2014ab_1(1,:));
flux_2014ab_Bok_ep20_24_part(3,:)   = interp1(d20140331_sn2014ab_1(1,:),contscaled20140331_sn2014ab_1(2,:),d20140329_sn2014ab_1(1,:));
flux_2014ab_Bok_ep20_24_part(4,:)   = interp1(d20140402_sn2014ab_1(1,:),contscaled20140402_sn2014ab_1(2,:),d20140329_sn2014ab_1(1,:));

q_2014ab_Bok_ep20_24_part(1,:)   = d20140329_sn2014ab_1(5,:)
q_2014ab_Bok_ep20_24_part(2,:)   = interp1(d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(3,:),d20140329_sn2014ab_1(1,:));
q_2014ab_Bok_ep20_24_part(3,:)   = interp1(d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(3,:),d20140329_sn2014ab_1(1,:));
q_2014ab_Bok_ep20_24_part(4,:)   = interp1(d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(3,:),d20140329_sn2014ab_1(1,:));

u_2014ab_Bok_ep20_24_part(1,:)   = d20140329_sn2014ab_1(6,:)
u_2014ab_Bok_ep20_24_part(2,:)   = interp1(d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(4,:),d20140329_sn2014ab_1(1,:));
u_2014ab_Bok_ep20_24_part(3,:)   = interp1(d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(4,:),d20140329_sn2014ab_1(1,:));
u_2014ab_Bok_ep20_24_part(4,:)   = interp1(d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(4,:),d20140329_sn2014ab_1(1,:));

flux_2014ab_LCO_ep30_33_part(1,:)   = contscaled20140408_sn2014ab_1(2,:);
flux_2014ab_LCO_ep30_33_part(2,:)   = interp1(d20140409_sn2014ab_1(1,:),contscaled20140409_sn2014ab_1(2,:),d20140408_sn2014ab_1(1,:));
flux_2014ab_LCO_ep30_33_part(3,:)   = interp1(d20140411_sn2014ab_1(1,:),contscaled20140411_sn2014ab_1(2,:),d20140408_sn2014ab_1(1,:));

flux_2014ab_LCO_ep42_45_part(1,:)   = contscaled20140420_sn2014ab_1(2,:);
flux_2014ab_LCO_ep42_45_part(2,:)   = interp1(d20140423_sn2014ab_1(1,:),contscaled20140423_sn2014ab_1(2,:),d20140420_sn2014ab_1(1,:));
   
flux_2014ab_Kui_ep48_53_part(1,:)   = contscaled20140426_sn2014ab_1(2,:);
flux_2014ab_Kui_ep48_53_part(2,:)   = interp1(d20140427_sn2014ab_1(1,:),contscaled20140427_sn2014ab_1(2,:),d20140426_sn2014ab_1(1,:));
flux_2014ab_Kui_ep48_53_part(3,:)   = interp1(d20140428_sn2014ab_1(1,:),contscaled20140428_sn2014ab_1(2,:),d20140426_sn2014ab_1(1,:));
flux_2014ab_Kui_ep48_53_part(4,:)   = interp1(d20140501_sn2014ab_1(1,:),contscaled20140501_sn2014ab_1(2,:),d20140426_sn2014ab_1(1,:));

q_2014ab_Kui_ep48_53_part(1,:) = d20140426_sn2014ab_1(3,:)
q_2014ab_Kui_ep48_53_part(2,:) = interp1(d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(3,:),d20140426_sn2014ab_1(1,:));
q_2014ab_Kui_ep48_53_part(3,:) = interp1(d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(3,:),d20140426_sn2014ab_1(1,:));
q_2014ab_Kui_ep48_53_part(4,:) = interp1(d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(5,:),d20140426_sn2014ab_1(1,:));

u_2014ab_Kui_ep48_53_part(1,:) = d20140426_sn2014ab_1(4,:)
u_2014ab_Kui_ep48_53_part(2,:) = interp1(d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(4,:),d20140426_sn2014ab_1(1,:));
u_2014ab_Kui_ep48_53_part(3,:) = interp1(d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(4,:),d20140426_sn2014ab_1(1,:));
u_2014ab_Kui_ep48_53_part(4,:) = interp1(d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(6,:),d20140426_sn2014ab_1(1,:));
  
flux_2014ab_Bok_ep75_78_part(1,:)   = contscaled20140523_sn2014ab_1(2,:);
flux_2014ab_Bok_ep75_78_part(2,:)   = interp1(d20140524_sn2014ab_1(1,:),contscaled20140524_sn2014ab_1(2,:),d20140523_sn2014ab_1(1,:));
flux_2014ab_Bok_ep75_78_part(3,:)   = interp1(d20140526_sn2014ab_1(1,:),contscaled20140526_sn2014ab_1(2,:),d20140523_sn2014ab_1(1,:));

q_2014ab_Bok_ep75_78_part(1,:) = d20140523_sn2014ab_1(5,:)
q_2014ab_Bok_ep75_78_part(2,:) = interp1(d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(3,:),d20140523_sn2014ab_1(1,:));
q_2014ab_Bok_ep75_78_part(3,:) = interp1(d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(3,:),d20140523_sn2014ab_1(1,:));

u_2014ab_Bok_ep75_78_part(1,:) = d20140523_sn2014ab_1(6,:)
u_2014ab_Bok_ep75_78_part(2,:) = interp1(d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(4,:),d20140523_sn2014ab_1(1,:));
u_2014ab_Bok_ep75_78_part(3,:) = interp1(d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(4,:),d20140523_sn2014ab_1(1,:));

flux_2014ab_Kui_ep105_109_part(1,:) = contscaled20140622_sn2014ab_1(2,:);
flux_2014ab_Kui_ep105_109_part(2,:) = interp1(d20140623_sn2014ab_1(1,:),contscaled20140623_sn2014ab_1(2,:),d20140622_sn2014ab_1(1,:));
flux_2014ab_Kui_ep105_109_part(3,:) = interp1(d20140624_sn2014ab_1(1,:),contscaled20140624_sn2014ab_1(2,:),d20140622_sn2014ab_1(1,:));
flux_2014ab_Kui_ep105_109_part(4,:) = interp1(d20140626_sn2014ab_1(1,:),contscaled20140626_sn2014ab_1(2,:),d20140622_sn2014ab_1(1,:));

q_2014ab_Kui_ep105_109_part(1,:) = d20140622_sn2014ab_1(5,:)
q_2014ab_Kui_ep105_109_part(2,:) = interp1(d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(5,:),d20140622_sn2014ab_1(1,:));
q_2014ab_Kui_ep105_109_part(3,:) = interp1(d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(3,:),d20140622_sn2014ab_1(1,:));
q_2014ab_Kui_ep105_109_part(4,:) = interp1(d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(3,:),d20140622_sn2014ab_1(1,:));

u_2014ab_Kui_ep105_109_part(1,:) = d20140622_sn2014ab_1(6,:)
u_2014ab_Kui_ep105_109_part(2,:) = interp1(d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(6,:),d20140622_sn2014ab_1(1,:));
u_2014ab_Kui_ep105_109_part(3,:) = interp1(d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(4,:),d20140622_sn2014ab_1(1,:));
u_2014ab_Kui_ep105_109_part(4,:) = interp1(d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(4,:),d20140622_sn2014ab_1(1,:));

flux_2014ab_VLT_ep135_part(1,:)     = d20140722_sn2014ab_1(2,:);
flux_2014ab_VLT_ep135_part(2,:)     = interp1(d20140722_sn2014ab_4(1,:),contscaled20140722_sn2014ab_4(2,:),d20140722_sn2014ab_1(1,:));

%median values stored here

wave_2014ab_NTT_ep1       = d20140310_sn2014ab_1(1,:);
flux_2014ab_NTT_ep1       = contscaled20140310_sn2014ab_1(2,:);
wave_2014ab_Lic_ep15      = d20140324_sn2014ab_1(1,:);
flux_2014ab_Lic_ep15      = contscaled20140324_sn2014ab_1(2,:);
wave_2014ab_Bok_ep20_24   = d20140329_sn2014ab_1(1,:);
flux_2014ab_Bok_ep20_24   = median(flux_2014ab_Bok_ep20_24_part,1);
q_2014ab_Bok_ep20_24      = median(q_2014ab_Bok_ep20_24_part);
u_2014ab_Bok_ep20_24      = median(u_2014ab_Bok_ep20_24_part);
wave_2014ab_LCO_ep30_33   = d20140408_sn2014ab_1(1,:);
flux_2014ab_LCO_ep30_33   = median(flux_2014ab_LCO_ep30_33_part,1);
wave_2014ab_LCO_ep42_45   = d20140420_sn2014ab_1(1,:);
flux_2014ab_LCO_ep42_45   = median(flux_2014ab_LCO_ep42_45_part,1);
wave_2014ab_MMT_ep30      = d20140420_sn2014ab_2(1,:);
flux_2014ab_MMT_ep30      = contscaled20140420_sn2014ab_2(2,:);
q_2014ab_MMT_ep30         = d20140420_sn2014ab_2(3,:)
u_2014ab_MMT_ep30         = d20140420_sn2014ab_2(4,:)
wave_2014ab_Kui_ep48_53   = d20140426_sn2014ab_1(1,:);
flux_2014ab_Kui_ep48_53   = median(flux_2014ab_Kui_ep48_53_part,1);
q_2014ab_Kui_ep48_53      = median(q_2014ab_Kui_ep48_53_part);
u_2014ab_Kui_ep48_53      = median(u_2014ab_Kui_ep48_53_part);
wave_2014ab_Lic_ep52      = d20140430_sn2014ab_1(1,:);
flux_2014ab_Lic_ep52      = contscaled20140430_sn2014ab_1(2,:);
wave_2014ab_LCO_ep59      = d20140507_sn2014ab_4(1,:);
flux_2014ab_LCO_ep59      = contscaled20140507_sn2014ab_4(2,:);
wave_2014ab_Mag_ep71      = d20140519_sn2014ab_1(1,:);
flux_2014ab_Mag_ep71      = contscaled20140519_sn2014ab_1(2,:);
wave_2014ab_LCO_ep74      = d20140522_sn2014ab_1(1,:);
flux_2014ab_LCO_ep74      = contscaled20140522_sn2014ab_1(2,:);
wave_2014ab_Bok_ep75_78   = d20140523_sn2014ab_1(1,:);
flux_2014ab_Bok_ep75_78   = median(flux_2014ab_Bok_ep75_78_part,1);
q_2014ab_Bok_ep75_78      = median(q_2014ab_Bok_ep75_78_part);
u_2014ab_Bok_ep75_78      = median(u_2014ab_Bok_ep75_78_part);
wave_2014ab_VLT_ep78      = d20140526_sn2014ab_2(1,:);
flux_2014ab_VLT_ep78      = contscaled20140526_sn2014ab_2(2,:);
wave_2014ab_Lic_ep80      = d20140528_sn2014ab_1(1,:);
flux_2014ab_Lic_ep80      = contscaled20140528_sn2014ab_1(2,:);
wave_2014ab_VLT_ep85      = d20140602_sn2014ab_1(1,:);
flux_2014ab_VLT_ep85      = contscaled20140602_sn2014ab_1(2,:);
wave_2014ab_Lic_ep104     = d20140621_sn2014ab_1(1,:);
flux_2014ab_Lic_ep104     = contscaled20140621_sn2014ab_1(2,:);
wave_2014ab_Kui_ep105_109 = d20140622_sn2014ab_1(1,:);
flux_2014ab_Kui_ep105_109 = median(flux_2014ab_Kui_ep105_109_part,1);
q_2014ab_Kui_ep105_109      = median(q_2014ab_Kui_ep105_109_part);
u_2014ab_Kui_ep105_109      = median(u_2014ab_Kui_ep105_109_part);
wave_2014ab_Lic_ep113     = d20140630_sn2014ab_1(1,:);
flux_2014ab_Lic_ep113     = contscaled20140630_sn2014ab_1(2,:);
wave_2014ab_VLT_ep135     = d20140722_sn2014ab_1(1,:);
flux_2014ab_VLT_ep135     = median(flux_2014ab_VLT_ep135_part,1);
wave_2014ab_VLT_ep152     = d20140808_sn2014ab_1(1,:);
flux_2014ab_VLT_ep152     = contscaled20140808_sn2014ab_1(2,:);
wave_2014ab_MMT_ep1497     = d20180414_sn2014ab_1(1,:);
flux_2014ab_MMT_ep1497     = contscaled20180414_sn2014ab_1(2,:);

%axis conversion to velocity relative to Paschen Beta
%velocity in km/s
%lambdaPabeta = 12822;
%velPabeta_20140526 = 10^-5 .* c.* (wave_2014ab_VLT_ep78-lambdaPabeta)./lambdaPabeta;
%velPabeta_20140602 = 10^-5 .* c.* (wave_2014ab_VLT_ep85-lambdaPabeta)./lambdaPabeta;
%velPabeta_20140722 = 10^-5 .* c.* (wave_2014ab_VLT_ep135-lambdaPabeta)./lambdaPabeta;
%velPabeta_20140808 = 10^-5 .* c.* (wave_2014ab_VLT_ep152-lambdaPabeta)./lambdaPabeta;

%Pabetafit2014ab_VLT_ep78= fit(wave_2014ab_VLT_ep78(1,[find(wave_2014ab_VLT_ep78(1,:)>12522,3,'first') find(wave_2014ab_VLT_ep78(1,:)<13122,3,'last')])',flux_2014ab_VLT_ep78([find(wave_2014ab_VLT_ep78(1,:)>12522,3,'first') find(wave_2014ab_VLT_ep78(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant2014ab_VLT_ep78= mean(Pabetafit2014ab_VLT_ep78(wave_2014ab_VLT_ep78(1,(wave_2014ab_VLT_ep78(1,:)>12722 & wave_2014ab_VLT_ep78(1,:)<12922))));
%Pabetauniscale2014ab_VLT_ep78= flux_2014ab_VLT_ep78/Pabetanormconstant2014ab_VLT_ep78;
%Pabetavarscaledsub2014ab_VLT_ep78= (flux_2014ab_VLT_ep78 - Pabetafit2014ab_VLT_ep78(wave_2014ab_VLT_ep78(1,:))')./Pabetafit2014ab_VLT_ep78(wave_2014ab_VLT_ep78(1,:))';
%
%Pabetafit20140602_sn2014ab= fit(d20140602_sn2014ab(1,[find(d20140602_sn2014ab(1,:)>12522,3,'first') find(d20140602_sn2014ab(1,:)<13122,3,'last')])',d20140602_sn2014ab(2,[find(d20140602_sn2014ab(1,:)>12522,3,'first') find(d20140602_sn2014ab(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant20140602_sn2014ab= mean(Pabetafit20140602_sn2014ab(d20140602_sn2014ab(1,(d20140602_sn2014ab(1,:)>12722 & d20140602_sn2014ab(1,:)<12922))));
%Pabetauniscaled20140602_sn2014ab= d20140602_sn2014ab(2,:)/Pabetanormconstant20140602_sn2014ab;
%Pabetavarscaledsub20140602_sn2014ab= (d20140602_sn2014ab(2,:) - Pabetafit20140602_sn2014ab(d20140602_sn2014ab(1,:))')./Pabetafit20140602_sn2014ab(d20140602_sn2014ab(1,:))';
%
%Pabetafit20140722_sn2014ab= fit(d20140722_sn2014ab(1,[find(d20140722_sn2014ab(1,:)>12522,3,'first') find(d20140722_sn2014ab(1,:)<13122,3,'last')])',d20140722_sn2014ab(2,[find(d20140722_sn2014ab(1,:)>12522,3,'first') find(d20140722_sn2014ab(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant20140722_sn2014ab= mean(Pabetafit20140722_sn2014ab(d20140722_sn2014ab(1,(d20140722_sn2014ab(1,:)>12722 & d20140722_sn2014ab(1,:)<12922))));
%Pabetauniscaled20140722_sn2014ab= d20140722_sn2014ab(2,:)/Pabetanormconstant20140722_sn2014ab;
%Pabetavarscaledsub20140722_sn2014ab= (d20140722_sn2014ab(2,:) - Pabetafit20140722_sn2014ab(d20140722_sn2014ab(1,:))')./Pabetafit20140722_sn2014ab(d20140722_sn2014ab(1,:))';
%
%Pabetafit20140808_sn2014ab= fit(d20140808_sn2014ab(1,[find(d20140808_sn2014ab(1,:)>12522,3,'first') find(d20140808_sn2014ab(1,:)<13122,3,'last')])',d20140808_sn2014ab(2,[find(d20140808_sn2014ab(1,:)>12522,3,'first') find(d20140808_sn2014ab(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant20140808_sn2014ab= mean(Pabetafit20140808_sn2014ab(d20140808_sn2014ab(1,(d20140808_sn2014ab(1,:)>12722 & d20140808_sn2014ab(1,:)<12922))));
%Pabetauniscaled20140808_sn2014ab= d20140808_sn2014ab(2,:)/Pabetanormconstant20140808_sn2014ab;
%Pabetavarscaledsub20140808_sn2014ab= (d20140808_sn2014ab(2,:) - Pabetafit20140808_sn2014ab(d20140808_sn2014ab(1,:))')./Pabetafit20140808_sn2014ab(d20140808_sn2014ab(1,:))';
%
%
%clf
%plot(Pabetafit2014ab_VLT_ep78,wave_2014ab_VLT_ep78,flux_2014ab_VLT_ep78)
%axis
%ratio calcs

roverbratio = sorted_rightEWHalpha./sorted_leftEWHalpha
roverbratioerr = roverbratio  .* sqrt((sorted_rightdEWHalpha./sorted_rightEWHalpha).^2 + (sorted_leftdEWHalpha./sorted_leftEWHalpha).^2)

%change if we change the reldate system
%adjusted for the change
medianCSSfluxwithnoSN = median(10.^(absmagVCSS_sn2014ab(find( (LCCSSreldateV_sn2014ab<-25) | (LCCSSreldateV_sn2014ab>250) ))./-2.5))
medianCSSmagwithnoSN = -2.5*log10(median(10.^(absmagVCSS_sn2014ab(find( (LCCSSreldateV_sn2014ab<-25) | (LCCSSreldateV_sn2014ab>250) ))./-2.5)))
absmagVCSS_sn2014ab_mediansubtracted = -2.5.*log10(10.^(absmagVCSS_sn2014ab./-2.5) - medianCSSfluxwithnoSN);

%%%zzz need to add in the 2nd ESO data on the 2nd to last date

%12822
%1
Paschenbetafit20140526_sn2014ab_2= fit(d20140526_sn2014ab_2(1,[find(d20140526_sn2014ab_2(1,:)>12400,25,'first') find(d20140526_sn2014ab_2(1,:)<15000,25,'last')])',d20140526_sn2014ab_2(2,[find(d20140526_sn2014ab_2(1,:)>12400,25,'first') find(d20140526_sn2014ab_2(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140526_sn2014ab_2= mean(Paschenbetafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,(d20140526_sn2014ab_2(1,:)>(12822-300) & d20140526_sn2014ab_2(1,:)<(12822+300)))));
Paschenbetauniscaled20140526_sn2014ab_2= d20140526_sn2014ab_2(2,:)/Paschenbetanormconstant20140526_sn2014ab_2;
Paschenbetavarscaledsub20140526_sn2014ab_2= (d20140526_sn2014ab_2(2,:) - Paschenbetafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))')./Paschenbetafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))';

clf
plot(Paschenbetafit20140526_sn2014ab_2,d20140526_sn2014ab_2(1,:),d20140526_sn2014ab_2(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(1)  = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= (12822-300) & d20140526_sn2014ab_2(1,:) <= (12822))),Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= (12822-300) & d20140526_sn2014ab_2(1,:) <= (12822))))
PabetaleftNEWerr(1)  = 5*std(Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 12000 & d20140526_sn2014ab_2(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(1)  = PabetaleftNEWerr(1)  * PabetaleftEWPaschenbeta(1) ;
PabetarightEWPaschenbeta(1)  = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= (12822) & d20140526_sn2014ab_2(1,:) <= (12822+300))),Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= (12822) & d20140526_sn2014ab_2(1,:) <= (12822+300))))
PabetarightNEWerr(1)  = 5*std(Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 13150 & d20140526_sn2014ab_2(1,:) <= 13200)));
PabetarightdEWPaschenbeta(1)  = PabetarightNEWerr(1)  * PabetarightEWPaschenbeta(1) 

%2
Paschenbetafit20140602_sn2014ab_1= fit(d20140602_sn2014ab_1(1,[find(d20140602_sn2014ab_1(1,:)>12400,25,'first') find(d20140602_sn2014ab_1(1,:)<15000,25,'last')])',d20140602_sn2014ab_1(2,[find(d20140602_sn2014ab_1(1,:)>12400,25,'first') find(d20140602_sn2014ab_1(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140602_sn2014ab_1= mean(Paschenbetafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,(d20140602_sn2014ab_1(1,:)>(12822-300) & d20140602_sn2014ab_1(1,:)<(12822+300)))));
Paschenbetauniscaled20140602_sn2014ab_1= d20140602_sn2014ab_1(2,:)/Paschenbetanormconstant20140602_sn2014ab_1;
Paschenbetavarscaledsub20140602_sn2014ab_1= (d20140602_sn2014ab_1(2,:) - Paschenbetafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))')./Paschenbetafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))';

clf
plot(Paschenbetafit20140602_sn2014ab_1,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(2)  = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= (12822-300) & d20140602_sn2014ab_1(1,:) <= (12822))),Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= (12822-300) & d20140602_sn2014ab_1(1,:) <= (12822))))
PabetaleftNEWerr(2)  = 5*std(Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 12000 & d20140602_sn2014ab_1(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(2)  = PabetaleftNEWerr(2)  * PabetaleftEWPaschenbeta(2) ;
PabetarightEWPaschenbeta(2)  = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= (12822) & d20140602_sn2014ab_1(1,:) <= (12822+300))),Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= (12822) & d20140602_sn2014ab_1(1,:) <= (12822+300))))
PabetarightNEWerr(2)  = 5*std(Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 13150 & d20140602_sn2014ab_1(1,:) <= 13200)));
PabetarightdEWPaschenbeta(2)  = PabetarightNEWerr(2)  * PabetarightEWPaschenbeta(2) 

%3
Paschenbetafit20140722_sn2014ab_1= fit(d20140722_sn2014ab_1(1,[find(d20140722_sn2014ab_1(1,:)>12400,25,'first') find(d20140722_sn2014ab_1(1,:)<15000,25,'last')])',d20140722_sn2014ab_1(2,[find(d20140722_sn2014ab_1(1,:)>12400,25,'first') find(d20140722_sn2014ab_1(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140722_sn2014ab_1= mean(Paschenbetafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,(d20140722_sn2014ab_1(1,:)>(12822-300) & d20140722_sn2014ab_1(1,:)<(12822+300)))));
Paschenbetauniscaled20140722_sn2014ab_1= d20140722_sn2014ab_1(2,:)/Paschenbetanormconstant20140722_sn2014ab_1;
Paschenbetavarscaledsub20140722_sn2014ab_1= (d20140722_sn2014ab_1(2,:) - Paschenbetafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))')./Paschenbetafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))';

clf
plot(Paschenbetafit20140722_sn2014ab_1,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(3)  = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= (12822-300) & d20140722_sn2014ab_1(1,:) <= (12822))),Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= (12822-300) & d20140722_sn2014ab_1(1,:) <= (12822))))
PabetaleftNEWerr(3)  = 5*std(Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 12000 & d20140722_sn2014ab_1(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(3)  = PabetaleftNEWerr(3)  * PabetaleftEWPaschenbeta(3) ;
PabetarightEWPaschenbeta(3)  = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= (12822) & d20140722_sn2014ab_1(1,:) <= (12822+300))),Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= (12822) & d20140722_sn2014ab_1(1,:) <= (12822+300))))
PabetarightNEWerr(3)  = 5*std(Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 13150 & d20140722_sn2014ab_1(1,:) <= 13200)));
PabetarightdEWPaschenbeta(3)  = PabetarightNEWerr(3)  * PabetarightEWPaschenbeta(3) 


%4
Paschenbetafit20140722_sn2014ab_4= fit(d20140722_sn2014ab_4(1,[find(d20140722_sn2014ab_4(1,:)>12400,25,'first') find(d20140722_sn2014ab_4(1,:)<15000,25,'last')])',d20140722_sn2014ab_4(2,[find(d20140722_sn2014ab_4(1,:)>12400,25,'first') find(d20140722_sn2014ab_4(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140722_sn2014ab_4= mean(Paschenbetafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,(d20140722_sn2014ab_4(1,:)>(12822-300) & d20140722_sn2014ab_4(1,:)<(12822+300)))));
Paschenbetauniscaled20140722_sn2014ab_4= d20140722_sn2014ab_4(2,:)/Paschenbetanormconstant20140722_sn2014ab_4;
Paschenbetavarscaledsub20140722_sn2014ab_4= (d20140722_sn2014ab_4(2,:) - Paschenbetafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,:))')./Paschenbetafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,:))';

clf
plot(Paschenbetafit20140722_sn2014ab_4,d20140722_sn2014ab_4(1,:),d20140722_sn2014ab_4(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140722_4 = 10^-5 .* c.* (d20140722_sn2014ab_4(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(4)  = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= (12822-300) & d20140722_sn2014ab_4(1,:) <= (12822))),Paschenbetavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= (12822-300) & d20140722_sn2014ab_4(1,:) <= (12822))))
PabetaleftNEWerr(4)  = 5*std(Paschenbetavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 12000 & d20140722_sn2014ab_4(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(4)  = PabetaleftNEWerr(4)  * PabetaleftEWPaschenbeta(4) ;
PabetarightEWPaschenbeta(4)  = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= (12822) & d20140722_sn2014ab_4(1,:) <= (12822+300))),Paschenbetavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= (12822) & d20140722_sn2014ab_4(1,:) <= (12822+300))))
PabetarightNEWerr(4)  = 5*std(Paschenbetavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 13150 & d20140722_sn2014ab_4(1,:) <= 13200)));
PabetarightdEWPaschenbeta(4)  = PabetarightNEWerr(4)  * PabetarightEWPaschenbeta(4) 






%5
Paschenbetafit20140808_sn2014ab_1= fit(d20140808_sn2014ab_1(1,[find(d20140808_sn2014ab_1(1,:)>12400,25,'first') find(d20140808_sn2014ab_1(1,:)<15000,25,'last')])',d20140808_sn2014ab_1(2,[find(d20140808_sn2014ab_1(1,:)>12400,25,'first') find(d20140808_sn2014ab_1(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140808_sn2014ab_1= mean(Paschenbetafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,(d20140808_sn2014ab_1(1,:)>(12822-300) & d20140808_sn2014ab_1(1,:)<(12822+300)))));
Paschenbetauniscaled20140808_sn2014ab_1= d20140808_sn2014ab_1(2,:)/Paschenbetanormconstant20140808_sn2014ab_1;
Paschenbetavarscaledsub20140808_sn2014ab_1= (d20140808_sn2014ab_1(2,:) - Paschenbetafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))')./Paschenbetafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))';

clf
plot(Paschenbetafit20140808_sn2014ab_1,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(5)  = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= (12822-300) & d20140808_sn2014ab_1(1,:) <= (12822))),Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= (12822-300) & d20140808_sn2014ab_1(1,:) <= (12822))))
PabetaleftNEWerr(5)  = 5*std(Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 12000 & d20140808_sn2014ab_1(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(5)  = PabetaleftNEWerr(5)  * PabetaleftEWPaschenbeta(5)
PabetarightEWPaschenbeta(5)  = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= (12822) & d20140808_sn2014ab_1(1,:) <= (12822+300))),Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= (12822) & d20140808_sn2014ab_1(1,:) <= (12822+300))))
PabetarightNEWerr(5)  = 5*std(Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 13150 & d20140808_sn2014ab_1(1,:) <= 13200)));
PabetarightdEWPaschenbeta(5)  = PabetarightNEWerr(5)  * PabetarightEWPaschenbeta(5) 

Pabetaroverbratio = PabetarightEWPaschenbeta./PabetaleftEWPaschenbeta
Pabetaroverbratioerr = Pabetaroverbratio  .* sqrt((PabetarightdEWPaschenbeta./PabetarightEWPaschenbeta).^2 + (PabetaleftdEWPaschenbeta./PabetaleftEWPaschenbeta).^2)











































%need to fix offset multiplier for MW label in here zzz
measureNaID(d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:),A_V_sn2014ab,1/(narrowoffsetmult(1)*(1/(1+z_sn2014ab))))  

%[bbodyfit11 , wavetemp11  ,bestT(1 ,1), bestalpha(1 ,1)] = blackbodyfit(d20140310_sn2014ab_1(1,:),contscaled20140310_sn2014ab_1(2,:),3000,6400)
%[bbodyfit12 , wavetemp12  ,bestT(1 ,2), bestalpha(1 ,2)] = blackbodyfit(d20140310_sn2014ab_1(1,:),contscaled20140310_sn2014ab_1(2,:),7000,8200)
%[bbodyfit21 , wavetemp21  ,bestT(2 ,1), bestalpha(2 ,1)] = blackbodyfit(d20140808_sn2014ab_3(1,:),contscaled20140808_sn2014ab_3(2,:),5400,6400)
%[bbodyfit22 , wavetemp22  ,bestT(2 ,2), bestalpha(2 ,2)] = blackbodyfit(d20140808_sn2014ab_3(1,:),contscaled20140808_sn2014ab_3(2,:),7000,8200)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%plots

%data.ymdplotlabel(1) = 0

%fix this zzz
%data(end).ymdplotlabel = [num2str(datetime(mean(data(end).date),'convertfrom','juliandate').Year),'-',num2str(datetime(mean(data(end).date),'convertfrom','juliandate').Month),'-',num2str(datetime(mean(data(end).date),'convertfrom','juliandate').Day),num2str(datetime(mean(data(end).date),'convertfrom','juliandate').Hour/24)];


%zzz temporary qsum and usums
qsum_ep20 = ones(1,length(wave_2014ab_Bok_ep20_24));
usum_ep20 = ones(1,length(wave_2014ab_Bok_ep20_24));

qsum_ep48 = ones(1,length(wave_2014ab_Kui_ep48_53));
usum_ep48 = ones(1,length(wave_2014ab_Kui_ep48_53));

qsum_ep75 = ones(1,length(wave_2014ab_Bok_ep75_78));
usum_ep75 = ones(1,length(wave_2014ab_Bok_ep75_78));

qsum_ep105 = ones(1,length(wave_2014ab_Kui_ep105_109));
usum_ep105 = ones(1,length(wave_2014ab_Kui_ep105_109));

qsum_ep30 = ones(1,length(wave_2014ab_MMT_ep30));
usum_ep30 = ones(1,length(wave_2014ab_MMT_ep30));

reldate_ep20 = mean([77 78 79 81]);
reldate_ep48 = mean([105 106 107 110]);
reldate_ep75 = mean([132 133 135]);
reldate_ep105= mean([162 163 164 166]);
reldate_ep30 = mean([99]);

SPOLPlotter(wave_2014ab_Bok_ep20_24,flux_2014ab_Bok_ep20_24,q_2014ab_Bok_ep20_24,u_2014ab_Bok_ep20_24,q_2014ab_Bok_ep20_24./2,u_2014ab_Bok_ep20_24./2,qsum_ep20,usum_ep20,'2014-03-24',reldate_ep20,'SN2014ab','Bok','ISP',0.87)
SPOLPlotter(wave_2014ab_Kui_ep48_53,flux_2014ab_Kui_ep48_53,q_2014ab_Kui_ep48_53,u_2014ab_Kui_ep48_53,q_2014ab_Kui_ep48_53./2,u_2014ab_Kui_ep48_53./2,qsum_ep48,usum_ep48,'2014-04-26',reldate_ep48,'SN2014ab','Kuiper','ISP',0.87)
SPOLPlotter(wave_2014ab_Bok_ep75_78,flux_2014ab_Bok_ep75_78,q_2014ab_Bok_ep75_78,u_2014ab_Bok_ep75_78,q_2014ab_Bok_ep75_78./2,u_2014ab_Bok_ep75_78./2,qsum_ep75,usum_ep75,'2014-05-23',reldate_ep75,'SN2014ab','Bok','ISP',0.87)
SPOLPlotter(wave_2014ab_Kui_ep105_109,flux_2014ab_Kui_ep105_109,q_2014ab_Kui_ep105_109,u_2014ab_Kui_ep105_109,q_2014ab_Kui_ep105_109./2,u_2014ab_Kui_ep105_109./2,qsum_ep105,usum_ep105,'2014-06-22',reldate_ep105,'SN2014ab','Kuiper','ISP',0.87)
SPOLPlotter(wave_2014ab_MMT_ep30,flux_2014ab_MMT_ep30,q_2014ab_MMT_ep30,u_2014ab_MMT_ep30,q_2014ab_MMT_ep30./2,u_2014ab_MMT_ep30./2,qsum_ep30,usum_ep30,'2014-04-20',reldate_ep30,'SN2014ab','MMT','ISP',0.87)


%sum_ep20,usum_ep20,'Days 77-81',reldate_ep20,'SN
%sum_ep48,usum_ep48,'Days 105-110','SN2014ab','Ku
%sum_ep75,usum_ep75,'Days 132-135',reldate_ep75,'
%105_109./2,qsum_ep105,usum_ep105,'Days 162-166',
%,'Day 99',reldate_ep30,'SN2014ab','MMT','ISP',0.






%SPOLPlotter(wave_2014ab_Bok_ep20_24,flux_2014ab_Bok_ep20_24,q_2014ab_Bok_ep20_24,u_2014ab_Bok_ep20_24,q_2014ab_Bok_ep20_24./3,u_2014ab_Bok_ep20_24./3,'2014-03-29',79,'SN2014ab','Bok','ISP',0.87)
%SPOLPlotter(wave_2014ab_Kui_ep48_53,flux_2014ab_Kui_ep48_53,q_2014ab_Kui_ep48_53,u_2014ab_Kui_ep48_53,q_2014ab_Kui_ep48_53./3,u_2014ab_Kui_ep48_53./3,'2','Days 105-110','SN2014ab','Kuiper','ISP',0.87)
%SPOLPlotter(wave_2014ab_Bok_ep75_78,flux_2014ab_Bok_ep75_78,q_2014ab_Bok_ep75_78,u_2014ab_Bok_ep75_78,q_2014ab_Bok_ep75_78./3,u_2014ab_Bok_ep75_78./3,'3','Days 132-135','SN2014ab','Bok','ISP',0.87)
%SPOLPlotter(wave_2014ab_Kui_ep105_109,flux_2014ab_Kui_ep105_109,q_2014ab_Kui_ep105_109,u_2014ab_Kui_ep105_109,q_2014ab_Kui_ep105_109./3,u_2014ab_Kui_ep105_109./3,'4','Days 162-166','SN2014ab','Kuiper','ISP',0.87)
%SPOLPlotter(wave_2014ab_MMT_ep30,flux_2014ab_MMT_ep30,q_2014ab_MMT_ep30,u_2014ab_MMT_ep30,q_2014ab_MMT_ep30./3,u_2014ab_MMT_ep30./3,'2014-04-20',99,'SN2014ab','MMT','ISP',0.87)

%SPOL1Bok
%SPOL2Kuiper
%SPOL3Bok
%SPOL4Kuiper
%SPOL5MMT




2014-03-10	&	57 &	ESO-NTT/EFOSC2	& 3500-8850  & 350\\
2014-03-24	&	71 &	Lick/Kast		& 3343-9551  & 600\\
2014-03-29	&	76 &	Bok/SPOL		& 3720-7541  & 200\\
2014-03-30	&	77 &	Bok/SPOL		& 3723-7543  & 200\\
2014-03-31	&	78 &	Bok/SPOL		& 3720-7541  & 200\\
2014-04-02	&	80 &	Bok/SPOL 		& 3718-7539  & 200\\
2014-04-08	&	86 & LCO/Floyds			& 4777-10753 & 550\\
2014-04-09	&	87 & LCO/Floyds			& 4777-8883  & 550\\
2014-04-11	&	89 & LCO/Floyds			& 4777-9551  & 550\\
2014-04-20	&	98 & LCO/Floyds			& 3821-8882  & 550\\
2014-04-20	&	98 & MMT/SPOL			& 3868-6829  & 400\\
2014-04-23	&	101 & LCO/Floyds		& 3822-9551	 & 550\\		
2014-04-26	&	104 &	Kuiper/SPOL		& 3729-7549  & 200\\
2014-04-27	&	105 &	Kuiper/SPOL		& 3728-7548  & 200\\
2014-04-28	&	106 &	Kuiper/SPOL		& 3729-7550  & 200\\
2014-04-30	&	108 &	Lick/Kast		& 3343-10029 & 600\\
2014-05-01	&	109 &	Kuiper/SPOL		& 3729-7550  & 200\\
2014-05-07	&	115 & LCO/Floyds		& 3909-9773  & 550\\	
2014-05-19  & 127 & Magellan/IMACS		& 5350-6864  & 1,600\\
2014-05-22	&	130 & LCO/Floyds		& 3821-9551  & 550\\	
2014-05-23	&	131 &	Bok/SPOL		& 3722-7543  & 200\\
2014-05-24	&	132 &	Bok/SPOL		& 3721-7542  & 200\\
2014-05-26	&	134 &	Bok/SPOL		& 3725-7545  & 200\\
2014-05-26 	& 134 & ESO-VLT/X-Shooter 	& 2855-23677 & 3,500\\
2014-05-28	&	136 &	Lick/Kast		& 3343-9551  & 600\\
2014-06-02 	& 141 & ESO-VLT/X-Shooter 	& 2855-23677 & 3,500\\
2014-06-21	&	160 &	Lick/Kast		& 3305-9742  & 600\\
2014-06-22	&	161 &	Kuiper/SPOL		& 3734-7554  & 200\\
2014-06-23	&	162 &	Kuiper/SPOL		& 3734-7555  & 200\\
2014-06-24	&	163 &	Kuiper/SPOL		& 3735-7555  & 200\\
2014-06-26	&	165 &	Kuiper/SPOL		& 3734-7555  & 200\\
2014-06-30	&	169 &	Lick/Kast		& 3295-10029 & 600\\
2014-07-22 	& 191 & ESO-VLT/X-Shooter	& 2855-23677 & 3,500\\
2014-07-22 	& 191 & ESO-VLT/X-Shooter	& 2855-23677 & 3,500\\
2014-08-08 	& 208 & ESO-VLT/X-Shooter	& 2855-23677 & 3,500\\
2018-04-14  & 1553& MMT/BlueChannel     & 5459-6704  & 4,200\\


















 sorted_reldate_2020= [ 57
          70
          71
          76
          77
          78
          80
          86
          87
          89
          98
          98
         101
         102
         104
         105
         106
         108
         109
         115
         127
         130
         131
         132
         134
         136
         160
         161
         162
         163
         163
         165
         168
         169
         188
        1553]
		
sorted_reldate_2020 = sorted_reldate_2020';


%%%light curve plot

min(real(absmagVCSS_sn2014ab_mediansubtracted))
absmagVCSS_sn2014ab_mediansubtracted(find((LCCSSreldateV_sn2014ab>-25) & (LCCSSreldateV_sn2014ab<250)))


plotting = figure(1)
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
p1 = scatter(LCreldateB_sn2014ab,absmagB_sn2014ab,50,[0.0000 0.0000 1.0000],'filled')
errorbar(LCreldateB_sn2014ab,absmagB_sn2014ab,magerrorB_sn2014ab,'Color',[0.0000 0.0000 1.0000])
p2 = scatter(LCreldateV_sn2014ab,absmagV_sn2014ab,50,[0.0000 0.7255 0.0902],'filled')
errorbar(LCreldateV_sn2014ab,absmagV_sn2014ab,magerrorV_sn2014ab,'Color',[0.0000 0.7255 0.0902])
p3 = scatter(LCreldateR_sn2014ab,absmagR_sn2014ab,50,[1.0000 0.0000 0.0000],'filled')
errorbar(LCreldateR_sn2014ab,absmagR_sn2014ab,magerrorR_sn2014ab,'Color',[1.0000 0.0000 0.0000])
p4 = scatter(LCreldateI_sn2014ab,absmagI_sn2014ab,50,[0 0 0],'filled')
errorbar(LCreldateI_sn2014ab,absmagI_sn2014ab,magerrorI_sn2014ab,'Color',[0 0 0])
p5 = scatter(LCCSSreldateV_sn2014ab(find((LCCSSreldateV_sn2014ab>-25) & (LCCSSreldateV_sn2014ab<250))),absmagVCSS_sn2014ab_mediansubtracted(find((LCCSSreldateV_sn2014ab>-25) & (LCCSSreldateV_sn2014ab<250))),50,[0.0000 0.3922 0.0039],'filled')
errorbar(LCCSSreldateV_sn2014ab(find((LCCSSreldateV_sn2014ab>-25) & (LCCSSreldateV_sn2014ab<250))),absmagVCSS_sn2014ab_mediansubtracted(find((LCCSSreldateV_sn2014ab>-25) & (LCCSSreldateV_sn2014ab<250))),magerrorVCSS_sn2014ab(find((LCCSSreldateV_sn2014ab>-25) & (LCCSSreldateV_sn2014ab<250))),'Color',[0.0000 0.3922 0.0039])
p6 = scatter(LCCSSreldateV_sn2014ab,absmagVCSS_sn2014ab,50,[0.65 0.65 0.65],'filled')
errorbar(LCCSSreldateV_sn2014ab,absmagVCSS_sn2014ab,magerrorVCSS_sn2014ab,'Color',[0.65 0.65 0.65],'LineStyle','-')
for i = 1:length(sorted_reldate)
	line([sorted_reldate_2020(i),sorted_reldate_2020(i)],[-17.75 -17.6],'LineStyle','-','Color',[0 0 0],'LineWidth',1)
end
htext = text(-350,-20.2,'SN 2014ab','interpreter','latex','Color', 'black','FontSize',22)
htext = text(95,-18.65,'B','interpreter','latex','Color', [0.0000 0.0000 1.0000],'FontSize',22)
htext = text(95,-19.01,'V','interpreter','latex')
set(htext, 'Color', [0.0000 0.7255 0.0902])
set(htext, 'FontSize',22)
htext = text(95,-19.42,'R','interpreter','latex')
set(htext, 'Color', [1.0000 0.0000 0.0000])
set(htext, 'FontSize',22)
htext = text(95,-19.55,'I','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',22)
htext = text(-10,-19.33,'CSS (V) ','interpreter','latex')
set(htext, 'Color',[0.0000 0.3922 0.0039])
set(htext, 'FontSize',22)
htext = text(150,-20.10,'CSS (V) host galaxy included','interpreter','latex')
set(htext, 'Color',[0.65 0.65 0.65])
set(htext, 'FontSize',22)
xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('Absolute Magnitude','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[-400 400] [-20.5 -17.5]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
set(ax1,'xtick',linspace(-400,400,17),'YTick',linspace(-20,-15,6))
atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%set(ax2,'xtick',get(ax1,'xtick'),'xticklab',get(ax1,'xticklab'))
ylabel(ax2,'')
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
annotation('textarrow',[0.535 0.565],[0.15 0.15],'String','Spectra','FontSize',22)
%legend([p1 p2 p3 p4],'B','V','R','I')

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Photometry.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Photometry.eps']);

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Photometry.pdf


%%CSS full range plot

yearaxisname = [2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016];

set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
p5 = scatter(LCCSSreldateV_sn2014ab,LCCSSsn2014ab(2,:),50,[0 0 0],'filled')
errorbar(LCCSSreldateV_sn2014ab,LCCSSsn2014ab(2,:),magerrorVCSS_sn2014ab,'Color',[0 0 0])

htext = text(300,15.2,'CSS (V)','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',28)
xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',28,'FontName','CMU Serif Roman')
ylabel('Apparent Magnitude','interpreter','tex','FontSize',28,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[-3250 900] [15 17]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
%set(ax1,'xtick',-3500:500:1000,'YTick',linspace(15,17,5))
atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%set(ax2,'xtick',yearaxisreldate,'xticklabel',yearaxisname)

set(ax2, 'XLim', get(ax1, 'XLim'),'YLim', get(ax1, 'YLim'));
ytickabs = linspace(15+redshiftdistancemodulus_2014ab-A_V_sn2014ab-A_V_NaID,17+redshiftdistancemodulus_2014ab-A_V_sn2014ab-A_V_NaID,5)
set(ax2, 'XTick', yearaxisreldate, 'YTick',linspace(15,17,5));
set(ax2, 'XTickLabel', yearaxisname);
set(ax2, 'YTickLabel', ytickabs);
%'YTickLabel',OppTickLabels);
set(ax2,'YDir','reverse');
ylabel(ax2,'Absolute Magnitude')
xlabel(ax2,'Year')
set(ax1,'FontSize',28)
set(ax2,'FontSize',28)

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\CSSFullRange.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\CSSFullRange.eps']);

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\CSSFullRange.pdf




%%%LC comparison plot

set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
plot([LCreldateR_sn2014ab(1:7) LCreldateR_sn2014ab(9:end)],[absmagR_sn2014ab(1:7) absmagR_sn2014ab(9:end)],'k')
scatter([LCreldateR_sn2014ab(1:7) LCreldateR_sn2014ab(9:end)],[absmagR_sn2014ab(1:7) absmagR_sn2014ab(9:end)],50,'k','filled')
plot(LC1999emmjd-LC1999emmjd(1),LC1999emabsmag,'Color',[0.9961 0.5373 0.0000])
scatter(LC1999emmjd-LC1999emmjd(1),LC1999emabsmag,50,[0.9961 0.5373 0.0000],'filled')
plot(LC1998Smjd-LC1998Smjd(1),LC1998Sabsmag,'r')
scatter(LC1998Smjd-LC1998Smjd(1),LC1998Sabsmag,'r','filled')
plot(LC2003hfmjd-LC2003hfmjd(1),LC2003hfabsmag,'Color',[0 0.6 0])
scatter(LC2003hfmjd-LC2003hfmjd(1),LC2003hfabsmag,50,[0 0.6 0],'filled')
plot(LCsn2010jl_rprime_epoch,LC2010jlabsmagR,'Color',[0.0000 0.4627 1.0000])
scatter(LCsn2010jl_rprime_epoch,LC2010jlabsmagR,50,[0.0000 0.4627 1.0000],'filled')
%scatter(sortedreldate(10:13),absmagest(10:13),75,'*','k')
set(gca,'box','on')
htext = text(5,-19.75,'SN 2014ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',22)
htext = text(10,-16.4,'SN 1999em (II-P)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.9961 0.5373 0.0000])
set(htext, 'FontSize',22)
htext = text(64,-18.4,'SN 1998S (IIn)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color', 'red')
set(htext, 'FontSize',22)
htext = text(30,-18,'SN 2003hf (II-L)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0 0.6 0])
set(htext, 'FontSize',22)
htext = text(30,-20.3,'SN 2010jl (IIn)','interpreter','tex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.0000 0.4627 1.0000])
set(htext, 'FontSize',22)

xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('Absolute Magnitude ($R$ band)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[-5 300] [-21 -15]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
set(ax1,'xtick',linspace(0,300,16),'YTick',linspace(-20,-15,6))

atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
%set(gca,'TickLength',atick); 

set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
set(ax2,'xtick',get(ax1,'xtick'),'xticklabel',get(ax1,'xticklabel'))
ylabel(ax2,'')
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\LCcompare.pdf -pdf





%Condensed Full Spectrum Plot
%need to add MMT spol spectrum zzz
set(plotting,'units','normalized','outerposition',[0 0 0.8 1]);
clf
l1 = semilogy(wave_2014ab_NTT_ep1,      flux_2014ab_NTT_ep1,                'LineWidth',2,'Color',[0.0000 0.3922 0.0039])
hold on
l2 = semilogy(wave_2014ab_Lic_ep15,     6^-1 *   1 * flux_2014ab_Lic_ep15,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l3 = semilogy(wave_2014ab_Bok_ep20_24,  6^-2 *   1 * flux_2014ab_Bok_ep20_24,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l4 = semilogy(wave_2014ab_LCO_ep30_33,  6^-3 *   2 * flux_2014ab_LCO_ep30_33,  'LineWidth',2,'Color',[0.5843 0.0000 0.2275])
l5 = semilogy(wave_2014ab_LCO_ep42_45,  6^-4 *   3 * flux_2014ab_LCO_ep42_45,  'LineWidth',2,'Color',[0.5843 0.0000 0.2275])
l6 = semilogy(wave_2014ab_Kui_ep48_53,  6^-5 *   2 * flux_2014ab_Kui_ep48_53,  'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l7 = semilogy(wave_2014ab_Lic_ep52,     6^-6 *   2 * flux_2014ab_Lic_ep52,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
%l8 = semilogy(wave_2014ab_Kui_ep53 ,   6^-7 *   2 * flux_2014ab_Kui_ep53,     'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l9 = semilogy(wave_2014ab_LCO_ep59,     6^-7 *   2 * flux_2014ab_LCO_ep59,     'LineWidth',2,'Color',[0.5843 0.0000 0.2275])
l10= semilogy(wave_2014ab_Mag_ep71 ,    6^-8 *3* 1 * flux_2014ab_Mag_ep71,     'LineWidth',2,'Color',[0.4941 0.1765 0.8235])
l11= semilogy(wave_2014ab_LCO_ep74,     6^-9*2.75* 1 * flux_2014ab_LCO_ep74,     'LineWidth',2,'Color',[0.5843 0.0000 0.2275])
l12= semilogy(wave_2014ab_Bok_ep75_78,  6^-10*2* 1 * flux_2014ab_Bok_ep75_78,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l13= semilogy(wave_2014ab_VLT_ep78,     6^-11*2* 15* flux_2014ab_VLT_ep78,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l14= semilogy(wave_2014ab_Lic_ep80,     6^-12*2* 1 * flux_2014ab_Lic_ep80,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l15= semilogy(wave_2014ab_VLT_ep85,     6^-13*2* 15* flux_2014ab_VLT_ep85,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l16= semilogy(wave_2014ab_Lic_ep104,    6^-14*2* 1 * flux_2014ab_Lic_ep104,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l17= semilogy(wave_2014ab_Kui_ep105_109,6^-15*2* 1 * flux_2014ab_Kui_ep105_109,'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l18= semilogy(wave_2014ab_Lic_ep113,    6^-16*2* 1 * flux_2014ab_Lic_ep113,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l19= semilogy(wave_2014ab_VLT_ep135,    6^-17*2* 25* flux_2014ab_VLT_ep135,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l20= semilogy(wave_2014ab_VLT_ep152,    6^-18*2* 1 * flux_2014ab_VLT_ep152,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l21= semilogy(wave_2014ab_MMT_ep1497,   6^-20*4* 1 * flux_2014ab_MMT_ep1497,   'LineWidth',2,'Color',[1.0000 0.0000 0.9647])
  

line([4101 4101],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4340 4340],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4861 4861],[0.55 0.85],'LineStyle','-','Color',[0 0 0])
line([4959 4959],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5007 5007],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5876 5876],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
line([5896 5896],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
%line([6548 6548],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
line([6562.81 6562.81],[1.3 2.3],'LineStyle','-','Color',[0 0 0])
%line([6583 6583],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
%line([6717 6717],[0.5 1],'LineStyle','-','Color',[0 0 0])
%line([6731 6731],[0.5 1],'LineStyle','-','Color',[0 0 0])
htext = text(4101,0.9,'H\delta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4340,0.9,'H\gamma','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4861,0.95,'H\beta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4983,0.9,'[OIII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5876-22,0.4,'HeI\lambda5876','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5896+22,0.4,'NaID','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6565.5,11.5,'[NII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6562.81,2.5,'H\alpha','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6724,1.1,'[SII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6754,0.22,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(7050,5,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext  = text(7050,0.8 *2*6^-1 ,'day 57'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.3922 0.0039])
htext  = text(7050,0.8 *2*6^-2 ,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext  = text(7050,0.8 *2*6^-3 ,'days 76-80'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext  = text(7050,1.0 *2*6^-4 ,'days 86-89'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.5843 0.0000 0.2275])
htext  = text(7050,1.5 *2*6^-5 ,'days 98-101'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.5843 0.0000 0.2275])
htext  = text(7050,1.2 *2*6^-6 ,'days 104-109'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext  = text(7050,1.0 *2*6^-7 ,'day 108'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
%htext = text(7050,1.3 *2*6^-8 ,'day '      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext  = text(7050,0.95*2*6^-8 ,'day 115'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.5843 0.0000 0.2275])
htext  = text(7050,0.9 *2*6^-9,'day 127'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.4941 0.1765 0.8235])
htext  = text(7050,1.1 *2*6^-10,'day 130'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.5843 0.0000 0.2275])
htext  = text(7050,1.2 *2*6^-11,'days 131-134'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext  = text(7050,1.6 *2*6^-12,'day 134'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext  = text(7050,1.5 *2*6^-13,'day 136'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext  = text(7050,1.5 *2*6^-14,'day 141'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext  = text(7050,1.05*2*6^-15,'day 160'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext  = text(7050,1.05*2*6^-16,'days 161-165','FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext  = text(7050,1.0 *2*6^-17,'day 169'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext  = text(7050,0.55*2*6^-18,'day 191'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext  = text(7050,0.18*2*6^-19,'day 208'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext  = text(7050,0.18*1.5*6^-20,'day 1553'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[1.0000 0.0000 0.9647])
htext  = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])
legend([l1, l2, l3, l6, l10, l13, l4, l21],'ESO-NTT','Lick-Kast','Bok-SPOL','Kuiper-SPOL', 'Magellan-IMACS', 'ESO-VLT','LCO-Floyds','MMT-BC')

xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3400 10000] [10^-17*2 250]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\FullSpectrum.pdf
set(plotting,'units','normalized','outerposition',[0 0 1 1]);

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\FullSpectrum.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\FullSpectrum.eps']);


%linear plot spectra
h = 6.626*10^-27; %erg s
c = 3*10^10; %cm s^-1
kB = 1.380658 * 10^-16; %erg K^-1


tempblackbody = 2*h*c^2./(d20140526_sn2014ab_2_onlyderedshifted(1,:).*10^-8).^5*1./(exp((h*c)./((d20140526_sn2014ab_2_onlyderedshifted(1,:).*10^-8).*kB.*7000))-1)
tempblackbodyvalues = 0.18.*tempblackbody./max(tempblackbody);

tempblackbody10 = 2*h*c^2./(d20140526_sn2014ab_2_onlyderedshifted(1,:).*10^-8).^5*1./(exp((h*c)./((d20140526_sn2014ab_2_onlyderedshifted(1,:).*10^-8).*kB.*7200))-1)
tempblackbodyvalues10 = 0.18.*tempblackbody10./max(tempblackbody);

reldate2010jllick(3) = juliandate(2011,01,03) - discoverydatejd_SN2010jl
reldate2010jllick(5) = juliandate(2011,01,25) - discoverydatejd_SN2010jl
reldate2010jllick(6) = juliandate(2011,02,01) - discoverydatejd_SN2010jl

clf
hold all
l1 = plot(p20110102_sn2010jl(1,1:900),d20110102_sn2010jl(2,1:900)./max(d20110102_sn2010jl(2,1:900)),'LineWidth',2,'Color',[0.0000 0.4627 1.0000])
l2= plot(d20140526_sn2014ab_2_onlyderedshifted(1,:),smooth(10*d20140526_sn2014ab_2_onlyderedshifted(2,:)/max(d20140526_sn2014ab_2_onlyderedshifted(2,:))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l3= plot(d20140526_sn2014ab_2_onlyderedshifted(1,:),smooth(25*d20140526_sn2014ab_2_dereddened(2,:)/max(d20140526_sn2014ab_2_dereddened(2,:))),     'LineWidth',2,'Color',[0.9961 0.1373 0.5000])
%l2= plot(wave_2014ab_VLT_ep78,smooth(0.1+7*flux_2014ab_VLT_ep78./max(flux_2014ab_VLT_ep78)),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l3 = plot(bbodywav20140526_2,bbodyfitflux20140526_2./max(bbodyfitflux20140526_2),'LineWidth',2,'Color',[0 0 0])
l3 = plot(d20140526_sn2014ab_2_onlyderedshifted(1,:),tempblackbodyvalues,'LineWidth',2,'Color',[0 0 0])
l4 = plot(d20140526_sn2014ab_2_onlyderedshifted(1,:),tempblackbodyvalues10,'LineWidth',2,'Color',[0.5 0.5 0.5])
%l5 = plot(p20110125_sn2010jl(1,:),1.2*d20110125_sn2010jl(2,:)./max(d20110125_sn2010jl(2,:)),'-','LineWidth',2,'Color',[0.0000 0.7255 0.0902])
%l6 = plot(p20110201_sn2010jl(1,:),1.2*d20110201_sn2010jl(2,:)./max(d20110201_sn2010jl(2,:)),'-','LineWidth',2,'Color',[1.0000 0.0000 0.0000])



lgd = legend([l1, l2],{'SN 2010jl day 59 MMT SPOL','SN 2014ab day 134 ESO-VLT'},'FontSize',22)
%lgd.FontSize = 22
axis([[3400 9000] [0.05 0.4]])
xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ax1 = gca;
set(ax1,'FontSize',22)
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
box on

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\LinearSpectrum.pdf







%IR Spectra Plot full
clf
l1j  = semilogy(wave_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13250))./10000,     6^0  *10* smooth(flux_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
hold on  
l1h  = semilogy(wave_2014ab_VLT_ep78(((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)))./10000,     6^0  *10* smooth(flux_2014ab_VLT_ep78(((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l1k  = semilogy(wave_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 > 19000))./10000,     6^0  *10* smooth(flux_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l2j  = semilogy(wave_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13250))./10000,     6^-1 *18* smooth(flux_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l2h  = semilogy(wave_2014ab_VLT_ep85(((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)))./10000,     6^-1 *18* smooth(flux_2014ab_VLT_ep85(((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l2k  = semilogy(wave_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 > 19000))./10000,     6^-1 *18* smooth(flux_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l3j  = semilogy(wave_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13250))./10000,     6^-2 *45* smooth(flux_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000]) 
l3h  = semilogy(wave_2014ab_VLT_ep135(((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)))./10000,     6^-2 *45* smooth(flux_2014ab_VLT_ep135(((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l3k  = semilogy(wave_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 > 19000))./10000,     6^-2 *45* smooth(flux_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l4j  = semilogy(wave_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13250))./10000,     6^-3 *5* smooth(flux_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000]) 
l4h  = semilogy(wave_2014ab_VLT_ep152(((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)))./10000,     6^-3 *5* smooth(flux_2014ab_VLT_ep152(((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l4k  = semilogy(wave_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 > 19000))./10000,     6^-3 *5* smooth(flux_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l5_sn2010jl = semilogy(p_sn2010jl(1,:)./10000,2*10^-4*d_sn2010jl(2,:)./max(d_sn2010jl(2,:)),'LineWidth',2,'Color',[0.0000 0.4627 1.0000]);

htext = text(1.077,0.15,'He I 1.0830','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.0830 1.0830],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.1,0.15,'Pa $\gamma$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.094 1.094],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.1287,0.15,'O I 1.1287','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.1287 1.1287],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.2822,0.15,'Pa $\beta$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.2822 1.2822],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.64117,0.15,'Br 12-4','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.64117 1.64117],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.68111,0.15,'Br 11-4','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.68111 1.68111],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.73669,0.15,'Br 10-4','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.73669 1.73669],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.9451,0.15,'Br $\delta$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.9451 1.9451],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(2.0589,0.15,'He I 2.0589','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([2.0589 2.0589],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(2.1661,0.15,'Br $\gamma$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([2.1661 2.1661],[0.000001 0.14],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)


htext = text(1.027*11000/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.04,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

htext = text(13800/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.02,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

htext = text(18700/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.01,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

htext = text(23200/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.01,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

htext = text(20000/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.015,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

htext = text(20600/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.015,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)

htext = text(1.3500/10000/(1+z_sn2014ab)*(narrowoffsetmult(1)),0.3,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', [0.9961 0.5373 0.0000])	
set(htext, 'FontSize',26)

htext = text(1.55,0.035 ,'day 134'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(1.55,0.007 ,'day 141'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(1.55,0.0012,'day 191'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(1.55,0.000175,'day 208'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])

htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman','interpreter','latex')
set(htext, 'Color',[0.8 0.8 0.8])

htext = text(1.46,0.0000325,'day 178 SN 2010jl','FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.4627 1.0000])


xlabel('Rest Wavelength ($\mu$m) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[1 2.5] [7*10^-6 1.6]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')
legend([l1j, l5_sn2010jl], 'SN 2014ab (VLT-Xshooter)','SN 2010jl (APO-TripleSpec)')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrumfull.pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrumfull.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrumfull.eps']);




clf
plot(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:)>4900 & d20140310_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>4900 & d20140310_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>4900 & d20140310_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    1.0000         0])
axis([[4900 5100] [0 1]])
line([5007 5007],[0 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([4959 4959],[0 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

clf
plot(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:)>4900 & d20140524_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>4900 & d20140524_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>4900 & d20140524_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    1.0000    0.5000])
hold all
plot(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:)>4900 & d20140526_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>4900 & d20140526_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>4900 & d20140526_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    1.0000    0.6667])
plot(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:)>4900 & d20140526_sn2014ab_2(1,:)<5100)),    halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4900 & d20140526_sn2014ab_2(1,:)<5100))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4900 & d20140526_sn2014ab_2(1,:)<5100))),'LineWidth',3,'Color', [     0    1.0000    0.8333])
plot(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:)>4900 & d20140528_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>4900 & d20140528_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>4900 & d20140528_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    1.0000    1.0000])
plot(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:)>4900 & d20140602_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4900 & d20140602_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4900 & d20140602_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    0.8571    1.0000])
plot(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:)>4900 & d20140621_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>4900 & d20140621_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>4900 & d20140621_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    0.7143    1.0000])
plot(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:)>4900 & d20140622_sn2014ab_1(1,:)<5100)),    halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>4900 & d20140622_sn2014ab_1(1,:)<5100))./max(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>4900 & d20140622_sn2014ab_1(1,:)<5100))),'LineWidth',3,'Color', [     0    0.5714    1.0000])
axis([[4950 5025] [0 1]])
line([5007 5007],[0 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([4959 4959],[0 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)





%%%Halpha Velocity Plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velHalpha_20140310_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))/10^3,    halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color', [     0    1.0000         0])
hold all 
plot(velHalpha_20140324_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.1667])
plot(velHalpha_20140329_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.3333])
plot(velHalpha_20140330_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.5000])
plot(velHalpha_20140331_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.6667])
plot(velHalpha_20140402_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.8333])
plot(velHalpha_20140408_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    1.0000])
plot(velHalpha_20140409_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.8571    1.0000])
plot(velHalpha_20140411_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.7143    1.0000])
plot(velHalpha_20140420_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.5714    1.0000])
plot(velHalpha_20140423_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.4286    1.0000])
plot(velHalpha_20140426_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.2857    1.0000])
plot(velHalpha_20140427_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.1429    1.0000])
plot(velHalpha_20140428_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0    1.0000])
plot(velHalpha_20140430_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.1429         0    1.0000])
plot(velHalpha_20140501_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.2857         0    1.0000])
plot(velHalpha_20140507_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))/10^3,     halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))),'LineWidth',3,'Color',[0.4286         0    1.0000])
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHalpha_20140522_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.7143         0    1.0000])
plot(velHalpha_20140523_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.8571         0    1.0000])
plot(velHalpha_20140524_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    1.0000])
plot(velHalpha_20140526_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.8571])
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.7143])
plot(velHalpha_20140528_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.5714])
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,1.80*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.4286])
plot(velHalpha_20140621_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.2857])
plot(velHalpha_20140622_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.1429])
plot(velHalpha_20140623_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0         0])
plot(velHalpha_20140624_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.8333         0         0])
plot(velHalpha_20140626_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.6667         0         0])
plot(velHalpha_20140630_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.5000         0         0])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,1.60*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.3333         0         0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.50*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velHalpha_20180414_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))/10^3,1.50*halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20180414_sn2014ab_1(find(d20180414_sn2014ab_1(1,:)>6163 & d20180414_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1.3]])

htext = text(-7,1.2,'day 1'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000         0])
htext = text(-7,1.1,'day 15'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.1667])
htext = text(-7,1.0,'day 20'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.3333])
htext = text(-7,0.9,'day 21'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.5000])
htext = text(-7,0.8,'day 22'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.6667])
htext = text(-7,0.7,'day 24'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.8333])
htext = text(-7,0.6,'day 30'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    1.0000])
htext = text(-5,1.2,'day 31'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.8571    1.0000])
htext = text(-5,1.1,'day 33'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.7143    1.0000])
htext = text(-5,1.0,'day 42'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.5714    1.0000])
htext = text(-5,0.9,'day 45'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4286    1.0000])
htext = text(-5,0.8,'day 48'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.2857    1.0000])
htext = text(-5,0.7,'day 49'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.1429    1.0000])
htext = text(-5,0.6,'day 50'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0    1.0000])
htext = text(-3,1.2,'day 52'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1429         0    1.0000])
htext = text(-3,1.1,'day 53'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2857         0    1.0000])
htext = text(-3,1.0,'day 59'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4286         0    1.0000])
htext = text(1 ,1.2,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5714         0    1.0000])
htext = text(1 ,1.1,'day 74'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.7143         0    1.0000])
htext = text(1 ,1.0,'day 75'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8571         0    1.0000])
htext = text(3 ,1.2,'day 76'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    1.0000])
htext = text(3 ,1.1,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.8571])
htext = text(3 ,1.0,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.7143])
htext = text(3 ,0.9,'day 80'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.5714])
htext = text(3 ,0.8,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.4286])
htext = text(3 ,0.7,'day 104'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.2857])
htext = text(3 ,0.6,'day 105'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.1429])
htext = text(5 ,1.2,'day 106'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0         0])
htext = text(5 ,1.1,'day 107'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8333         0         0])
htext = text(5 ,1.0,'day 109'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.6667         0         0])
htext = text(5 ,0.9,'day 113'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5000         0         0])
htext = text(5 ,0.8,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.3333         0         0])
htext = text(5 ,0.7,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1667         0         0])
htext = text(5 ,0.6,'day 1497'    ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0         0])


htext = text(-6,0.4,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.3,'H$\alpha$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
htext = text(-7,3.2,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocity.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);


%%asymmetric plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

mirrored_halphavarscaledsub20140808_sn2014ab_1 = [halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)<6551)), wrev(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)<6551)))];
mirrored_velHalpha_20140808_1 = velHalpha_20140808_1(1:length(mirrored_halphavarscaledsub20140808_sn2014ab_1));

mirroredat0_halphavarscaledsub20140808_sn2014ab_1 = [halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)<6563)), wrev(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)<6563)))];
mirroredat0_velHalpha_20140808_1 = velHalpha_20140808_1(1:length(mirroredat0_halphavarscaledsub20140808_sn2014ab_1));


clf
l1 = plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.50*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.1667         0         0])
hold all 
l2 = plot(mirrored_velHalpha_20140808_1/10^3,1.50*mirrored_halphavarscaledsub20140808_sn2014ab_1 ./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineStyle','--','LineWidth',3,'Color',[1         0         0])
l3 = plot(mirroredat0_velHalpha_20140808_1/10^3,1.50*mirroredat0_halphavarscaledsub20140808_sn2014ab_1 ./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineStyle',':','LineWidth',3,'Color',[0         0         1])
lgd = legend([l1],{'SN 2014ab day 208 ESO-VLT/X-Shooter'},'FontSize',22)
htext = text(1.05,1.05,'Spectrum Mirrored at -350 km s^{-1}')
set(htext, 'Color', 'red')
set(htext, 'FontSize',32)
htext = text(1.05,1.15,'Spectrum Mirrored at 0 km s^{-1}')
set(htext, 'Color', 'blue')
set(htext, 'FontSize',32)
axis([[-8 8] [-0.1 1.3]])
ax1 = gca;
set(ax1,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')
xlabel('Doppler velocity ($10^{3}\,\mathrm{km\,s^{-1}}$)','FontSize',32,'FontName','CMU Serif Roman','interpreter','latex')
ylabel('$F_{\lambda}$(Scaled)','interpreter','latex','FontSize',32,'FontName','CMU Serif Roman')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\MirrorAsymmetry.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\AsymmetricPlot.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\AsymmetricPlot.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);


%%%Hbeta Velocity Plot
%zzz change way continuum is handled so it is not 1+5*spectrum
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velHbeta_20140310_1(find(d20140310_sn2014ab_1(1,:)>4461 & d20140310_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>4461 & d20140310_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>4461 & d20140310_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color', [     0    1.0000         0])
hold all
plot(velHbeta_20140324_1(find(d20140324_sn2014ab_1(1,:)>4461 & d20140324_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>4461 & d20140324_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>4461 & d20140324_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.1667])
plot(velHbeta_20140329_1(find(d20140329_sn2014ab_1(1,:)>4461 & d20140329_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>4461 & d20140329_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>4461 & d20140329_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.3333])
plot(velHbeta_20140330_1(find(d20140330_sn2014ab_1(1,:)>4461 & d20140330_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>4461 & d20140330_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>4461 & d20140330_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.5000])
plot(velHbeta_20140331_1(find(d20140331_sn2014ab_1(1,:)>4461 & d20140331_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>4461 & d20140331_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>4461 & d20140331_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.6667])
plot(velHbeta_20140402_1(find(d20140402_sn2014ab_1(1,:)>4461 & d20140402_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>4461 & d20140402_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>4461 & d20140402_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.8333])
%plot(velHbeta_20140408_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))/10^3,0.8+5*    halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    1.0000])
%plot(velHbeta_20140409_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))/10^3,0.8+5*    halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.8571    1.0000])
%plot(velHbeta_20140411_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))/10^3,0.8+5*    halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.7143    1.0000])
plot(velHbeta_20140420_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.5714    1.0000])
plot(velHbeta_20140423_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.4286    1.0000])
plot(velHbeta_20140426_1(find(d20140426_sn2014ab_1(1,:)>4461 & d20140426_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>4461 & d20140426_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>4461 & d20140426_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.2857    1.0000])
plot(velHbeta_20140427_1(find(d20140427_sn2014ab_1(1,:)>4461 & d20140427_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>4461 & d20140427_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>4461 & d20140427_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.1429    1.0000])
plot(velHbeta_20140428_1(find(d20140428_sn2014ab_1(1,:)>4461 & d20140428_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>4461 & d20140428_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>4461 & d20140428_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0         0    1.0000])
plot(velHbeta_20140430_1(find(d20140430_sn2014ab_1(1,:)>4461 & d20140430_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>4461 & d20140430_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>4461 & d20140430_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.1429         0    1.0000])
plot(velHbeta_20140501_1(find(d20140501_sn2014ab_1(1,:)>4461 & d20140501_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>4461 & d20140501_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>4461 & d20140501_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.2857         0    1.0000])
plot(velHbeta_20140507_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))),'LineWidth',3,'Color',[0.4286         0    1.0000])
plot(velHbeta_20140519_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHbeta_20140522_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.7143         0    1.0000])
plot(velHbeta_20140523_1(find(d20140523_sn2014ab_1(1,:)>4461 & d20140523_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>4461 & d20140523_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>4461 & d20140523_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.8571         0    1.0000])
plot(velHbeta_20140524_1(find(d20140524_sn2014ab_1(1,:)>4461 & d20140524_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>4461 & d20140524_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>4461 & d20140524_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    1.0000])
plot(velHbeta_20140526_1(find(d20140526_sn2014ab_1(1,:)>4461 & d20140526_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>4461 & d20140526_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>4461 & d20140526_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.8333])
plot(velHbeta_20140526_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))/10^3,0.8+5*1.36*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.6667])
plot(velHbeta_20140528_1(find(d20140528_sn2014ab_1(1,:)>4461 & d20140528_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>4461 & d20140528_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>4461 & d20140528_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.5000])
plot(velHbeta_20140602_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.29*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.3333])
plot(velHbeta_20140621_1(find(d20140621_sn2014ab_1(1,:)>4461 & d20140621_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>4461 & d20140621_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>4461 & d20140621_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.1667])
plot(velHbeta_20140622_1(find(d20140622_sn2014ab_1(1,:)>4461 & d20140622_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>4461 & d20140622_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>4461 & d20140622_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0         0])
plot(velHbeta_20140623_1(find(d20140623_sn2014ab_1(1,:)>4461 & d20140623_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>4461 & d20140623_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>4461 & d20140623_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.8333         0         0])
plot(velHbeta_20140624_1(find(d20140624_sn2014ab_1(1,:)>4461 & d20140624_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>4461 & d20140624_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>4461 & d20140624_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.6667         0         0])
plot(velHbeta_20140626_1(find(d20140626_sn2014ab_1(1,:)>4461 & d20140626_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>4461 & d20140626_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>4461 & d20140626_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.5000         0         0])
plot(velHbeta_20140630_1(find(d20140630_sn2014ab_1(1,:)>4461 & d20140630_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>4461 & d20140630_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>4461 & d20140630_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.3333         0         0])
plot(velHbeta_20140722_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.22*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velHbeta_20140808_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.07*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0         0         0])
line([-20 20],[1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-0.25 0.25] [3 6]])

htext = text(-15,0.4+4*1.2,'day 1'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000         0])
htext = text(-15,0.4+4*1.1,'day 15'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.1667])
htext = text(-15,0.4+4*1.0,'day 20'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.3333])
htext = text(-15,0.4+4*0.9,'day 21'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.5000])
htext = text(-15,0.4+4*0.8,'day 22'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.6667])
htext = text(-15,0.4+4*0.7,'day 24'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.8333])
htext = text(-15,0.4+4*0.6,'day 30'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    1.0000])
htext = text(-10,0.4+4*1.2,'day 31'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.8571    1.0000])
%htext = text(-10,1.1,'day 33'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.7143    1.0000])
htext = text(-10,0.4+4*1.1,'day 42'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.5714    1.0000])
htext = text(-10,0.4+4*1.0,'day 45'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4286    1.0000])
htext = text(-10,0.4+4*0.9,'day 48'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.2857    1.0000])
htext = text(-10,0.4+4*0.8,'day 49'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.1429    1.0000])
htext = text(-10,0.4+4*0.7,'day 50'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0    1.0000])
htext = text(-5,0.4+4*1.2,'day 52'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1429         0    1.0000])
htext = text(-5,0.4+4*1.1,'day 53'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2857         0    1.0000])
htext = text(-5,0.4+4*1.0,'day 59'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4286         0    1.0000])
htext = text(5 ,0.4+4*1.2,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5714         0    1.0000])
htext = text(5 ,0.4+4*1.1,'day 74'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.7143         0    1.0000])
htext = text(5 ,0.4+4*1.0,'day 75'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8571         0    1.0000])
htext = text(10 ,0.4+4*1.2,'day 76'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    1.0000])
htext = text(10 ,0.4+4*1.1,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.8333])
htext = text(10 ,0.4+4*1.0,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.6667])
htext = text(10 ,0.4+4*0.9,'day 80'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.5000])
htext = text(10 ,0.4+4*0.8,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.3333])
htext = text(10 ,0.4+4*0.7,'day 104'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.1667])
htext = text(15 ,0.4+4*1.2,'day 105'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0         0])
htext = text(15 ,0.4+4*1.1,'day 106'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8333         0         0])
htext = text(15 ,0.4+4*1.0,'day 107'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.6667         0         0])
htext = text(15 ,0.4+4*0.9,'day 109'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5000         0         0])
htext = text(15 ,0.4+4*0.8,'day 113'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.3333         0         0])
htext = text(15 ,0.4+4*0.7,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1667         0         0])
htext = text(15 ,0.4+4*0.6,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0         0])

htext = text(-11,0.3+5*0.5,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-11,0.3+5*0.4,'H$\beta$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
%htext = text(-7,3.2,'H\alpha ')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HbetaVelocity.pdf -pdf

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\narrowhalpha2014ab.pdf -pdf

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\narrowhbeta2014ab.pdf -pdf


%NaID plot

%%%NaID Velocity Plot
%zzz change way continuum is handled so it is not 1+5*spectrum
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velNaID_20140310_1(find(d20140310_sn2014ab_1(1,:)>5493 & d20140310_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>5493 & d20140310_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>5493 & d20140310_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color', [     0    1.0000         0])
hold all                                                                                                                                                                                                              )                                               
plot(velNaID_20140324_1(find(d20140324_sn2014ab_1(1,:)>5493 & d20140324_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>5493 & d20140324_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>5493 & d20140324_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    1.0000    0.1667])
plot(velNaID_20140329_1(find(d20140329_sn2014ab_1(1,:)>5493 & d20140329_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>5493 & d20140329_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>5493 & d20140329_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    1.0000    0.3333])
plot(velNaID_20140330_1(find(d20140330_sn2014ab_1(1,:)>5493 & d20140330_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>5493 & d20140330_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>5493 & d20140330_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    1.0000    0.5000])
plot(velNaID_20140331_1(find(d20140331_sn2014ab_1(1,:)>5493 & d20140331_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>5493 & d20140331_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>5493 & d20140331_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    1.0000    0.6667])
plot(velNaID_20140402_1(find(d20140402_sn2014ab_1(1,:)>5493 & d20140402_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>5493 & d20140402_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>5493 & d20140402_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    1.0000    0.8333])
%plot(velNaID_20140408_1(find(d20140408_sn2014ab_1(1,:)>5493 & d20140408_sn2014ab_1(1,:)<6293))/10^3,0.8+5*    halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>5493 & d20140408_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>5493 & d20140408_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    1.0000    1.0000])
%plot(velNaID_20140409_1(find(d20140409_sn2014ab_1(1,:)>5493 & d20140409_sn2014ab_1(1,:)<6293))/10^3,0.8+5*    halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>5493 & d20140409_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>5493 & d20140409_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    0.8571    1.0000])
%plot(velNaID_20140411_1(find(d20140411_sn2014ab_1(1,:)>5493 & d20140411_sn2014ab_1(1,:)<6293))/10^3,0.8+5*    halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>5493 & d20140411_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>5493 & d20140411_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    0.7143    1.0000])
plot(velNaID_20140420_1(find(d20140420_sn2014ab_1(1,:)>5493 & d20140420_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>5493 & d20140420_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>5493 & d20140420_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    0.5714    1.0000])
plot(velNaID_20140423_1(find(d20140423_sn2014ab_1(1,:)>5493 & d20140423_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>5493 & d20140423_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>5493 & d20140423_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    0.4286    1.0000])
plot(velNaID_20140426_1(find(d20140426_sn2014ab_1(1,:)>5493 & d20140426_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>5493 & d20140426_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>5493 & d20140426_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    0.2857    1.0000])
plot(velNaID_20140427_1(find(d20140427_sn2014ab_1(1,:)>5493 & d20140427_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>5493 & d20140427_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>5493 & d20140427_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0    0.1429    1.0000])
plot(velNaID_20140428_1(find(d20140428_sn2014ab_1(1,:)>5493 & d20140428_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>5493 & d20140428_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>5493 & d20140428_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0         0    1.0000])
plot(velNaID_20140430_1(find(d20140430_sn2014ab_1(1,:)>5493 & d20140430_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>5493 & d20140430_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>5493 & d20140430_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.1429         0    1.0000])
plot(velNaID_20140501_1(find(d20140501_sn2014ab_1(1,:)>5493 & d20140501_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>5493 & d20140501_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>5493 & d20140501_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.2857         0    1.0000])
plot(velNaID_20140507_4(find(d20140507_sn2014ab_4(1,:)>5493 & d20140507_sn2014ab_4(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>5493 & d20140507_sn2014ab_4(1,:)<6293))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>5493 & d20140507_sn2014ab_4(1,:)<6293))),'LineWidth',3,'Color',[0.4286         0    1.0000])
plot(velNaID_20140519_1(find(d20140519_sn2014ab_1(1,:)>5493 & d20140519_sn2014ab_1(1,:)<6293))/10^3,0.8+5*1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>5493 & d20140519_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>5493 & d20140519_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velNaID_20140522_1(find(d20140522_sn2014ab_1(1,:)>5493 & d20140522_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>5493 & d20140522_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>5493 & d20140522_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.7143         0    1.0000])
plot(velNaID_20140523_1(find(d20140523_sn2014ab_1(1,:)>5493 & d20140523_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>5493 & d20140523_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>5493 & d20140523_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.8571         0    1.0000])
plot(velNaID_20140524_1(find(d20140524_sn2014ab_1(1,:)>5493 & d20140524_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>5493 & d20140524_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>5493 & d20140524_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0    1.0000])
plot(velNaID_20140526_1(find(d20140526_sn2014ab_1(1,:)>5493 & d20140526_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>5493 & d20140526_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>5493 & d20140526_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0    0.8333])
plot(velNaID_20140526_2(find(d20140526_sn2014ab_2(1,:)>5493 & d20140526_sn2014ab_2(1,:)<6293))/10^3,0.8+5*1.36*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>5493 & d20140526_sn2014ab_2(1,:)<6293))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>5493 & d20140526_sn2014ab_2(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0    0.6667])
plot(velNaID_20140528_1(find(d20140528_sn2014ab_1(1,:)>5493 & d20140528_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>5493 & d20140528_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>5493 & d20140528_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0    0.5000])
plot(velNaID_20140602_1(find(d20140602_sn2014ab_1(1,:)>5493 & d20140602_sn2014ab_1(1,:)<6293))/10^3,0.8+5*1.29*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>5493 & d20140602_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>5493 & d20140602_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0    0.3333])
plot(velNaID_20140621_1(find(d20140621_sn2014ab_1(1,:)>5493 & d20140621_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>5493 & d20140621_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>5493 & d20140621_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0    0.1667])
plot(velNaID_20140622_1(find(d20140622_sn2014ab_1(1,:)>5493 & d20140622_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>5493 & d20140622_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>5493 & d20140622_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[1.0000         0         0])
plot(velNaID_20140623_1(find(d20140623_sn2014ab_1(1,:)>5493 & d20140623_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>5493 & d20140623_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>5493 & d20140623_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.8333         0         0])
plot(velNaID_20140624_1(find(d20140624_sn2014ab_1(1,:)>5493 & d20140624_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>5493 & d20140624_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>5493 & d20140624_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.6667         0         0])
plot(velNaID_20140626_1(find(d20140626_sn2014ab_1(1,:)>5493 & d20140626_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>5493 & d20140626_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>5493 & d20140626_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.5000         0         0])
plot(velNaID_20140630_1(find(d20140630_sn2014ab_1(1,:)>5493 & d20140630_sn2014ab_1(1,:)<6293))/10^3,0.8+5*     halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>5493 & d20140630_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>5493 & d20140630_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.3333         0         0])
plot(velNaID_20140722_1(find(d20140722_sn2014ab_1(1,:)>5493 & d20140722_sn2014ab_1(1,:)<6293))/10^3,0.8+5*1.22*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>5493 & d20140722_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>5493 & d20140722_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velNaID_20140808_1(find(d20140808_sn2014ab_1(1,:)>5493 & d20140808_sn2014ab_1(1,:)<6293))/10^3,0.8+5*1.07*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>5493 & d20140808_sn2014ab_1(1,:)<6293))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>5493 & d20140808_sn2014ab_1(1,:)<6293))),'LineWidth',3,'Color',[     0         0         0])
line([-20 20],[1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-20 20] [-0.1 6]])

htext = text(-15,0.4+4*1.2,'day 1'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000         0])
htext = text(-15,0.4+4*1.1,'day 15'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.1667])
htext = text(-15,0.4+4*1.0,'day 20'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.3333])
htext = text(-15,0.4+4*0.9,'day 21'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.5000])
htext = text(-15,0.4+4*0.8,'day 22'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.6667])
htext = text(-15,0.4+4*0.7,'day 24'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.8333])
htext = text(-15,0.4+4*0.6,'day 30'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    1.0000])
htext = text(-10,0.4+4*1.2,'day 31'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.8571    1.0000])
%htext = text(-10,1.1,'day 33'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.7143    1.0000])
htext = text(-10,0.4+4*1.1,'day 42'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.5714    1.0000])
htext = text(-10,0.4+4*1.0,'day 45'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4286    1.0000])
htext = text(-10,0.4+4*0.9,'day 48'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.2857    1.0000])
htext = text(-10,0.4+4*0.8,'day 49'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.1429    1.0000])
htext = text(-10,0.4+4*0.7,'day 50'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0    1.0000])
htext = text(-5,0.4+4*1.2,'day 52'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1429         0    1.0000])
htext = text(-5,0.4+4*1.1,'day 53'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2857         0    1.0000])
htext = text(-5,0.4+4*1.0,'day 59'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4286         0    1.0000])
htext = text(5 ,0.4+4*1.2,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5714         0    1.0000])
htext = text(5 ,0.4+4*1.1,'day 74'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.7143         0    1.0000])
htext = text(5 ,0.4+4*1.0,'day 75'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8571         0    1.0000])
htext = text(10 ,0.4+4*1.2,'day 76'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    1.0000])
htext = text(10 ,0.4+4*1.1,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.8333])
htext = text(10 ,0.4+4*1.0,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.6667])
htext = text(10 ,0.4+4*0.9,'day 80'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.5000])
htext = text(10 ,0.4+4*0.8,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.3333])
htext = text(10 ,0.4+4*0.7,'day 104'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.1667])
htext = text(15 ,0.4+4*1.2,'day 105'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0         0])
htext = text(15 ,0.4+4*1.1,'day 106'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8333         0         0])
htext = text(15 ,0.4+4*1.0,'day 107'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.6667         0         0])
htext = text(15 ,0.4+4*0.9,'day 109'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5000         0         0])
htext = text(15 ,0.4+4*0.8,'day 113'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.3333         0         0])
htext = text(15 ,0.4+4*0.7,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1667         0         0])
htext = text(15 ,0.4+4*0.6,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0         0])

htext = text(-11,0.3+5*0.5,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-11,0.3+5*0.4,'Na I D','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
%htext = text(-7,3.2,'H\alpha ')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\NaIDVelocity.pdf -pdf


%%test new hbeta
%%%Hbeta Velocity Plot
4461
5261
%zzz change way continuum is handled so it is not 1+5*spectrum
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velHbeta_20140310_1(find(d20140310_sn2014ab_1(1,:)>4461 & d20140310_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>4461 & d20140310_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>4461 & d20140310_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color', [     0    1.0000         0])
hold all                                           
plot(velHbeta_20140324_1(find(d20140324_sn2014ab_1(1,:)>4461 & d20140324_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>4461 & d20140324_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>4461 & d20140324_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.1667])
plot(velHbeta_20140329_1(find(d20140329_sn2014ab_1(1,:)>4461 & d20140329_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>4461 & d20140329_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>4461 & d20140329_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.3333])
plot(velHbeta_20140330_1(find(d20140330_sn2014ab_1(1,:)>4461 & d20140330_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>4461 & d20140330_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>4461 & d20140330_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.5000])
plot(velHbeta_20140331_1(find(d20140331_sn2014ab_1(1,:)>4461 & d20140331_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>4461 & d20140331_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>4461 & d20140331_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.6667])
plot(velHbeta_20140402_1(find(d20140402_sn2014ab_1(1,:)>4461 & d20140402_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>4461 & d20140402_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>4461 & d20140402_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    0.8333])
%plot(velHbeta_20140408_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))/10^3,0.8+5*    halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    1.0000    1.0000])
%plot(velHbeta_20140409_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))/10^3,0.8+5*    halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.8571    1.0000])
%plot(velHbeta_20140411_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))/10^3,0.8+5*    halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.7143    1.0000])
plot(velHbeta_20140420_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.5714    1.0000])
plot(velHbeta_20140423_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.4286    1.0000])
plot(velHbeta_20140426_1(find(d20140426_sn2014ab_1(1,:)>4461 & d20140426_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>4461 & d20140426_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>4461 & d20140426_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.2857    1.0000])
plot(velHbeta_20140427_1(find(d20140427_sn2014ab_1(1,:)>4461 & d20140427_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>4461 & d20140427_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>4461 & d20140427_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.1429    1.0000])
plot(velHbeta_20140428_1(find(d20140428_sn2014ab_1(1,:)>4461 & d20140428_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>4461 & d20140428_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>4461 & d20140428_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0         0    1.0000])
plot(velHbeta_20140430_1(find(d20140430_sn2014ab_1(1,:)>4461 & d20140430_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>4461 & d20140430_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>4461 & d20140430_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.1429         0    1.0000])
plot(velHbeta_20140501_1(find(d20140501_sn2014ab_1(1,:)>4461 & d20140501_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>4461 & d20140501_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>4461 & d20140501_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.2857         0    1.0000])
plot(velHbeta_20140507_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))),'LineWidth',3,'Color',[0.4286         0    1.0000])
plot(velHbeta_20140519_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.5714         0    1.0000])
plot(velHbeta_20140522_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.7143         0    1.0000])
plot(velHbeta_20140523_1(find(d20140523_sn2014ab_1(1,:)>4461 & d20140523_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>4461 & d20140523_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>4461 & d20140523_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.8571         0    1.0000])
plot(velHbeta_20140524_1(find(d20140524_sn2014ab_1(1,:)>4461 & d20140524_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>4461 & d20140524_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>4461 & d20140524_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    1.0000])
plot(velHbeta_20140526_1(find(d20140526_sn2014ab_1(1,:)>4461 & d20140526_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>4461 & d20140526_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>4461 & d20140526_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.8333])
plot(velHbeta_20140526_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))/10^3,0.8+5*1.36*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.6667])
plot(velHbeta_20140528_1(find(d20140528_sn2014ab_1(1,:)>4461 & d20140528_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>4461 & d20140528_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>4461 & d20140528_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.5000])
plot(velHbeta_20140602_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.29*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.3333])
plot(velHbeta_20140621_1(find(d20140621_sn2014ab_1(1,:)>4461 & d20140621_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>4461 & d20140621_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>4461 & d20140621_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0    0.1667])
plot(velHbeta_20140622_1(find(d20140622_sn2014ab_1(1,:)>4461 & d20140622_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>4461 & d20140622_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>4461 & d20140622_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[1.0000         0         0])
plot(velHbeta_20140623_1(find(d20140623_sn2014ab_1(1,:)>4461 & d20140623_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>4461 & d20140623_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>4461 & d20140623_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.8333         0         0])
plot(velHbeta_20140624_1(find(d20140624_sn2014ab_1(1,:)>4461 & d20140624_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>4461 & d20140624_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>4461 & d20140624_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.6667         0         0])
plot(velHbeta_20140626_1(find(d20140626_sn2014ab_1(1,:)>4461 & d20140626_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>4461 & d20140626_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>4461 & d20140626_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.5000         0         0])
plot(velHbeta_20140630_1(find(d20140630_sn2014ab_1(1,:)>4461 & d20140630_sn2014ab_1(1,:)<5261))/10^3,0.8+5*     halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>4461 & d20140630_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>4461 & d20140630_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.3333         0         0])
plot(velHbeta_20140722_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.22*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.1667         0         0])
plot(velHbeta_20140808_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))/10^3,0.8+5*1.07*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0         0         0])
line([-20 20],[1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-20 20] [-0.1 6]])

htext = text(-15,0.4+4*1.2,'day 1'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000         0])
htext = text(-15,0.4+4*1.1,'day 15'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.1667])
htext = text(-15,0.4+4*1.0,'day 20'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.3333])
htext = text(-15,0.4+4*0.9,'day 21'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.5000])
htext = text(-15,0.4+4*0.8,'day 22'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.6667])
htext = text(-15,0.4+4*0.7,'day 24'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.8333])
htext = text(-15,0.4+4*0.6,'day 30'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    1.0000])
htext = text(-10,0.4+4*1.2,'day 31'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.8571    1.0000])
%htext = text(-10,1.1,'day 33'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.7143    1.0000])
htext = text(-10,0.4+4*1.1,'day 42'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.5714    1.0000])
htext = text(-10,0.4+4*1.0,'day 45'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4286    1.0000])
htext = text(-10,0.4+4*0.9,'day 48'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.2857    1.0000])
htext = text(-10,0.4+4*0.8,'day 49'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.1429    1.0000])
htext = text(-10,0.4+4*0.7,'day 50'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0    1.0000])
htext = text(-5,0.4+4*1.2,'day 52'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1429         0    1.0000])
htext = text(-5,0.4+4*1.1,'day 53'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2857         0    1.0000])
htext = text(-5,0.4+4*1.0,'day 59'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4286         0    1.0000])
htext = text(5 ,0.4+4*1.2,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5714         0    1.0000])
htext = text(5 ,0.4+4*1.1,'day 74'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.7143         0    1.0000])
htext = text(5 ,0.4+4*1.0,'day 75'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8571         0    1.0000])
htext = text(10 ,0.4+4*1.2,'day 76'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    1.0000])
htext = text(10 ,0.4+4*1.1,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.8333])
htext = text(10 ,0.4+4*1.0,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.6667])
htext = text(10 ,0.4+4*0.9,'day 80'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.5000])
htext = text(10 ,0.4+4*0.8,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.3333])
htext = text(10 ,0.4+4*0.7,'day 104'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.1667])
htext = text(15 ,0.4+4*1.2,'day 105'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0         0])
htext = text(15 ,0.4+4*1.1,'day 106'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8333         0         0])
htext = text(15 ,0.4+4*1.0,'day 107'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.6667         0         0])
htext = text(15 ,0.4+4*0.9,'day 109'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.5000         0         0])
htext = text(15 ,0.4+4*0.8,'day 113'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.3333         0         0])
htext = text(15 ,0.4+4*0.7,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1667         0         0])
htext = text(15 ,0.4+4*0.6,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0         0])

htext = text(-11,0.3+5*0.5,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-11,0.3+5*0.4,'Na I D','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
%htext = text(-7,3.2,'H\alpha ')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')









%hbeta and halpha comparison plot



%%%Halpha Velocity Plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])
hold all
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,1.80*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,1.60*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.50*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1 0 0])


plot(velHbeta_20140519_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))/10^3,1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>4461 & d20140519_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0 0 1])
plot(velHbeta_20140526_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))/10^3,1.36*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>4461 & d20140526_sn2014ab_2(1,:)<5261))),'LineWidth',3,'Color',[0 0 1])
plot(velHbeta_20140602_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))/10^3,1.29*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>4461 & d20140602_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0 0 1])
plot(velHbeta_20140722_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))/10^3,1.22*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>4461 & d20140722_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0 0 1])
plot(velHbeta_20140808_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))/10^3,1.07*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>4461 & d20140808_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0 0 1])



xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-15 15] [-0.1 1.3]])

htext = text(-13,0.4,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-13,0.3,'H$\alpha$ ','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0 0])
htext = text(-11,0.3,'vs','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-9,0.3,'H$\beta$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 1])



%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
htext = text(-7,3.2,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaHbetaCompare.pdf -pdf
















%for dave sand



%%% remove zzz
clf
hold all
plot(wave_2014ab_LCO_ep30_33,flux_2014ab_LCO_ep30_33_part(1,:))
plot(wave_2014ab_LCO_ep30_33,flux_2014ab_LCO_ep30_33_part(2,:))
plot(wave_2014ab_LCO_ep30_33,flux_2014ab_LCO_ep30_33_part(3,:))
plot(wave_2014ab_LCO_ep30_33,flux_2014ab_LCO_ep30_33)



%%%



%%%Hbeta Velocity Plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
clf
hold all                                
plot(velHbeta_20140411_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))/10^3,     halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>4461 & d20140411_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.7143    1.0000])
plot(velHbeta_20140420_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))/10^3,     halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>4461 & d20140420_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.5714    1.0000])
plot(velHbeta_20140423_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))/10^3,     halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>4461 & d20140423_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.4286    1.0000])
plot(velHbeta_20140507_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))/10^3,     halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>4461 & d20140507_sn2014ab_4(1,:)<5261))),'LineWidth',3,'Color',[0.4286         0    1.0000])
plot(velHbeta_20140522_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))/10^3,     halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>4461 & d20140522_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[0.7143         0    1.0000])
plot(velHbeta_20140408_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))/10^3,     halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>4461 & d20140408_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     0    0.0000    0.0000])
plot(velHbeta_20140409_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))/10^3,     halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>4461 & d20140409_sn2014ab_1(1,:)<5261))),'LineWidth',3,'Color',[     1    0    0.0000])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-20 20] [-0.1 1.3]])

 htext = text(-10,1.2,'day 30'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0    0])
 htext = text(-10,1.1,'day 31'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     1    0    0.0000])
 htext = text(-10,1.0,'day 33'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.7143    1.0000])
 htext = text(-10,0.9,'day 42'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.5714    1.0000])
 htext = text(-10,0.8,'day 45'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4286    1.0000])
 htext = text(-10,0.7,'day 59'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4286         0    1.0000])
 htext = text(-10 ,0.6,'day 74'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.7143         0    1.0000])

htext = text(-6,1.4,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,1.3,'H$\beta$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')









%%%Halpha Velocity Plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
hold all                                                                                                                                                                                                                                                                                                               )                                               
plot(velHalpha_20140408_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140408_sn2014ab_1(find(d20140408_sn2014ab_1(1,:)>6163 & d20140408_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.0000    0.0000])
plot(velHalpha_20140409_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140409_sn2014ab_1(find(d20140409_sn2014ab_1(1,:)>6163 & d20140409_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     1    0    0.0000])
plot(velHalpha_20140411_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140411_sn2014ab_1(find(d20140411_sn2014ab_1(1,:)>6163 & d20140411_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.7143    1.0000])
plot(velHalpha_20140420_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140420_sn2014ab_1(find(d20140420_sn2014ab_1(1,:)>6163 & d20140420_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.5714    1.0000])
plot(velHalpha_20140423_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140423_sn2014ab_1(find(d20140423_sn2014ab_1(1,:)>6163 & d20140423_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.4286    1.0000])
plot(velHalpha_20140507_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))/10^3,     halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))./max(halphavarscaledsub20140507_sn2014ab_4(find(d20140507_sn2014ab_4(1,:)>6163 & d20140507_sn2014ab_4(1,:)<6963))),'LineWidth',3,'Color',[0.4286         0    1.0000])
plot(velHalpha_20140522_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140522_sn2014ab_1(find(d20140522_sn2014ab_1(1,:)>6163 & d20140522_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.7143         0    1.0000])
line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1.3]])

htext = text(-7,0.6,'day 30'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.0000    0.0000])
htext = text(-5,1.2,'day 31'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     1    0    0.0000])
htext = text(-5,1.1,'day 33'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.7143    1.0000])
htext = text(-5,1.0,'day 42'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.5714    1.0000])
htext = text(-5,0.9,'day 45'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4286    1.0000])
htext = text(-3,1.0,'day 59'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4286         0    1.0000])
htext = text(1 ,1.1,'day 74'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.7143         0    1.0000])

htext = text(-6,0.4,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.3,'H$\alpha$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
htext = text(-7,3.2,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')










%end dave sand stuff





%paschen beta velocity plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(0.15+velPaschenbeta_20140526_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))/10^3,4.1 * smooth(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322)))./max(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))),'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
hold all
plot(0.15+velPaschenbeta_20140602_1(find(wave_2014ab_VLT_ep85>12322 & wave_2014ab_VLT_ep85<13322))/10^3,4.4   *smooth(Paschenbetavarscaledsub20140602_sn2014ab_1(find(wave_2014ab_VLT_ep85>12322 & wave_2014ab_VLT_ep85<13322)))./max(Paschenbetavarscaledsub20140602_sn2014ab_1(find(wave_2014ab_VLT_ep85>12322 & wave_2014ab_VLT_ep85<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.8902 0.1020 0.1100])
plot(0.15+velPaschenbeta_20140722_1(find(wave_2014ab_VLT_ep135>12322 & wave_2014ab_VLT_ep135<13322))/10^3,4.3 *smooth(Paschenbetavarscaledsub20140722_sn2014ab_1(find(wave_2014ab_VLT_ep135>12322 & wave_2014ab_VLT_ep135<13322)))./max(Paschenbetavarscaledsub20140722_sn2014ab_1(find(wave_2014ab_VLT_ep135>12322 & wave_2014ab_VLT_ep135<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.2 0.6275 0.1725])
plot(0.15+velPaschenbeta_20140808_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))/10^3,1.5 *smooth(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322)))./max(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1.3]])

htext = text(-6,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.6,'Pa$\beta$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,0.8,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
htext = text(4,0.7,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
htext = text(4,0.6,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.5,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])


htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig PabetaVelocity.pdf
export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);






%interpolate from -0.14km/s to 0.14 km/s to remove narrow line
%%interpolate from -0.27km/s to 0.02 km/s to remove narrow line
%%%interpolate from -0.10km/s to 0.18 km/s to remove narrow line
%Vq = interp1(X,V,Xq)

velHalphascaled20140526_2 = (velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6363 & d20140526_sn2014ab_2(1,:)<6763))/10^3)';                                                                                            
velHalphascaled20140602_1 = (velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6363 & d20140602_sn2014ab_1(1,:)<6763))/10^3)';
velHalphascaled20140722_1 = (velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6363 & d20140722_sn2014ab_1(1,:)<6763))/10^3)';
velHalphascaled20140808_1 = (velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6363 & d20140808_sn2014ab_1(1,:)<6763))/10^3)';
velHalphascaled20140519_1 = (velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6363 & d20140519_sn2014ab_1(1,:)<6763))/10^3)';

halphavarscaledsubnormalized20140526_sn2014ab_2 = (2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6363 & d20140526_sn2014ab_2(1,:)<6763))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6363 & d20140526_sn2014ab_2(1,:)<6763))))';                                                                                                                                                                                                                        
halphavarscaledsubnormalized20140602_sn2014ab_1 = (1.8 *halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6363 & d20140602_sn2014ab_1(1,:)<6763))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6363 & d20140602_sn2014ab_1(1,:)<6763))))';
halphavarscaledsubnormalized20140722_sn2014ab_1 = (1.6 *halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6363 & d20140722_sn2014ab_1(1,:)<6763))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6363 & d20140722_sn2014ab_1(1,:)<6763))))';
halphavarscaledsubnormalized20140808_sn2014ab_1 = (1.5 *halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6363 & d20140808_sn2014ab_1(1,:)<6763))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6363 & d20140808_sn2014ab_1(1,:)<6763))))';
halphavarscaledsubnormalized20140519_sn2014ab_1 = (1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6363 & d20140519_sn2014ab_1(1,:)<6763))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6363 & d20140519_sn2014ab_1(1,:)<6763))))';

halphavarscaledsubnormalized20140526_sn2014ab_2(find(velHalphascaled20140526_2>=-0.10,1,'first'):find(velHalphascaled20140526_2<0.18,1,'last')) = interp1([velHalphascaled20140526_2(find(velHalphascaled20140526_2>=-0.10,1,'first')) velHalphascaled20140526_2(find(velHalphascaled20140526_2>=0.18,1,'first'))] , [halphavarscaledsubnormalized20140526_sn2014ab_2(find(velHalphascaled20140526_2>=-0.10,1,'first')) halphavarscaledsubnormalized20140526_sn2014ab_2(find(velHalphascaled20140526_2>=0.18,1,'first'))] , velHalphascaled20140526_2((velHalphascaled20140526_2>=-0.10) & (velHalphascaled20140526_2<0.18)));
halphavarscaledsubnormalized20140602_sn2014ab_1(find(velHalphascaled20140602_1>=-0.10,1,'first'):find(velHalphascaled20140602_1<0.18,1,'last')) = interp1([velHalphascaled20140602_1(find(velHalphascaled20140602_1>=-0.10,1,'first')) velHalphascaled20140602_1(find(velHalphascaled20140602_1>=0.18,1,'first'))] , [halphavarscaledsubnormalized20140602_sn2014ab_1(find(velHalphascaled20140602_1>=-0.10,1,'first')) halphavarscaledsubnormalized20140602_sn2014ab_1(find(velHalphascaled20140602_1>=0.18,1,'first'))] , velHalphascaled20140602_1((velHalphascaled20140602_1>=-0.10) & (velHalphascaled20140602_1<0.18)));
halphavarscaledsubnormalized20140722_sn2014ab_1(find(velHalphascaled20140722_1>=-0.10,1,'first'):find(velHalphascaled20140722_1<0.18,1,'last')) = interp1([velHalphascaled20140722_1(find(velHalphascaled20140722_1>=-0.10,1,'first')) velHalphascaled20140722_1(find(velHalphascaled20140722_1>=0.18,1,'first'))] , [halphavarscaledsubnormalized20140722_sn2014ab_1(find(velHalphascaled20140722_1>=-0.10,1,'first')) halphavarscaledsubnormalized20140722_sn2014ab_1(find(velHalphascaled20140722_1>=0.18,1,'first'))] , velHalphascaled20140722_1((velHalphascaled20140722_1>=-0.10) & (velHalphascaled20140722_1<0.18)));
halphavarscaledsubnormalized20140808_sn2014ab_1(find(velHalphascaled20140808_1>=-0.10,1,'first'):find(velHalphascaled20140808_1<0.18,1,'last')) = interp1([velHalphascaled20140808_1(find(velHalphascaled20140808_1>=-0.10,1,'first')) velHalphascaled20140808_1(find(velHalphascaled20140808_1>=0.18,1,'first'))] , [halphavarscaledsubnormalized20140808_sn2014ab_1(find(velHalphascaled20140808_1>=-0.10,1,'first')) halphavarscaledsubnormalized20140808_sn2014ab_1(find(velHalphascaled20140808_1>=0.18,1,'first'))] , velHalphascaled20140808_1((velHalphascaled20140808_1>=-0.10) & (velHalphascaled20140808_1<0.18)));
halphavarscaledsubnormalized20140519_sn2014ab_1(find(velHalphascaled20140519_1>=-0.10,1,'first'):find(velHalphascaled20140519_1<0.18,1,'last')) = interp1([velHalphascaled20140519_1(find(velHalphascaled20140519_1>=-0.10,1,'first')) velHalphascaled20140519_1(find(velHalphascaled20140519_1>=0.18,1,'first'))] , [halphavarscaledsubnormalized20140519_sn2014ab_1(find(velHalphascaled20140519_1>=-0.10,1,'first')) halphavarscaledsubnormalized20140519_sn2014ab_1(find(velHalphascaled20140519_1>=0.18,1,'first'))] , velHalphascaled20140519_1((velHalphascaled20140519_1>=-0.10) & (velHalphascaled20140519_1<0.18)));



clf
hold all
plot(velHalphascaled20140526_2,halphavarscaledsubnormalized20140526_sn2014ab_2)


%not using
%fit gaussians to each spectrum


gauss_x_20140526_2 = velHalphascaled20140526_2;
gauss_x_20140602_1 = velHalphascaled20140602_1;
gauss_x_20140722_1 = velHalphascaled20140722_1;
gauss_x_20140808_1 = velHalphascaled20140808_1;
gauss_x_20140519_1 = velHalphascaled20140519_1;

numiterations = 11;

scalingfactor_int_20140526_2 = linspace(3,8,numiterations);
scalingfactor_int_20140602_1 = linspace(3,8,numiterations);
scalingfactor_int_20140722_1 = linspace(3,8,numiterations);
scalingfactor_int_20140808_1 = linspace(3,8,numiterations);
scalingfactor_int_20140519_1 = linspace(3,8,numiterations);

xloc_int_20140526_2 = linspace(-1.5,0.2,numiterations);
xloc_int_20140602_1 = linspace(-1.5,0.2,numiterations);
xloc_int_20140722_1 = linspace(-1.5,0.2,numiterations);
xloc_int_20140808_1 = linspace(-1.5,0.2,numiterations);
xloc_int_20140519_1 = linspace(-1.5,0.2,numiterations);

velocity_int_20140526_2 = linspace(3,8,numiterations);
velocity_int_20140602_1 = linspace(3,8,numiterations);
velocity_int_20140722_1 = linspace(3,8,numiterations);
velocity_int_20140808_1 = linspace(3,8,numiterations);
velocity_int_20140519_1 = linspace(3,8,numiterations);

clear gauss_int_20140526_2
clear gauss_int_20140602_1
clear gauss_int_20140722_1
clear gauss_int_20140808_1
clear gauss_int_20140519_1

gauss_int_20140526_2 = zeros(size(gauss_x_20140526_2,1),numiterations,numiterations,numiterations);
gauss_int_20140602_1 = zeros(size(gauss_x_20140602_1,1),numiterations,numiterations,numiterations);
gauss_int_20140722_1 = zeros(size(gauss_x_20140722_1,1),numiterations,numiterations,numiterations);
gauss_int_20140808_1 = zeros(size(gauss_x_20140808_1,1),numiterations,numiterations,numiterations);
gauss_int_20140519_1 = zeros(size(gauss_x_20140519_1,1),numiterations,numiterations,numiterations);


%make a grid of intermediate gaussians
for i=1:numiterations
i
	for j=1:numiterations
		for k=1:numiterations
			gauss_int_20140526_2(:,i,j,k) = scalingfactor_int_20140526_2(i) * normpdf(gauss_x_20140526_2,xloc_int_20140526_2(j),velocity_int_20140526_2(k)/2.3548);
		    gauss_int_20140602_1(:,i,j,k) = scalingfactor_int_20140602_1(i) * normpdf(gauss_x_20140602_1,xloc_int_20140602_1(j),velocity_int_20140602_1(k)/2.3548);
		    gauss_int_20140722_1(:,i,j,k) = scalingfactor_int_20140722_1(i) * normpdf(gauss_x_20140722_1,xloc_int_20140722_1(j),velocity_int_20140722_1(k)/2.3548);
		    gauss_int_20140808_1(:,i,j,k) = scalingfactor_int_20140808_1(i) * normpdf(gauss_x_20140808_1,xloc_int_20140808_1(j),velocity_int_20140808_1(k)/2.3548);
		    gauss_int_20140519_1(:,i,j,k) = scalingfactor_int_20140519_1(i) * normpdf(gauss_x_20140519_1,xloc_int_20140519_1(j),velocity_int_20140519_1(k)/2.3548);		
		end
	end
end


for i=1:numiterations
i
	for j=1:numiterations
		for k=1:numiterations
			gauss_chisquared_20140526_2(i,j,k) = sum(((halphavarscaledsubnormalized20140526_sn2014ab_2-gauss_int_20140526_2(:,i,j,k)).^2)./(gauss_int_20140526_2(:,i,j,k)));
			gauss_chisquared_20140602_1(i,j,k) = sum(((halphavarscaledsubnormalized20140602_sn2014ab_1-gauss_int_20140602_1(:,i,j,k)).^2)./(gauss_int_20140602_1(:,i,j,k)));
			gauss_chisquared_20140722_1(i,j,k) = sum(((halphavarscaledsubnormalized20140722_sn2014ab_1-gauss_int_20140722_1(:,i,j,k)).^2)./(gauss_int_20140722_1(:,i,j,k)));
			gauss_chisquared_20140808_1(i,j,k) = sum(((halphavarscaledsubnormalized20140808_sn2014ab_1-gauss_int_20140808_1(:,i,j,k)).^2)./(gauss_int_20140808_1(:,i,j,k)));
			gauss_chisquared_20140519_1(i,j,k) = sum(((halphavarscaledsubnormalized20140519_sn2014ab_1-gauss_int_20140519_1(:,i,j,k)).^2)./(gauss_int_20140519_1(:,i,j,k)));
		end
	end
end

%find the best fit chi^2 of the various gaussians

[mini_20140526_2 minj_20140526_2 mink_20140526_2] = ind2sub(size(gauss_chisquared_20140526_2),find(min(min(min(gauss_chisquared_20140526_2)))==gauss_chisquared_20140526_2));
[mini_20140602_1 minj_20140602_1 mink_20140602_1] = ind2sub(size(gauss_chisquared_20140602_1),find(min(min(min(gauss_chisquared_20140602_1)))==gauss_chisquared_20140602_1));
[mini_20140722_1 minj_20140722_1 mink_20140722_1] = ind2sub(size(gauss_chisquared_20140722_1),find(min(min(min(gauss_chisquared_20140722_1)))==gauss_chisquared_20140722_1));
[mini_20140808_1 minj_20140808_1 mink_20140808_1] = ind2sub(size(gauss_chisquared_20140808_1),find(min(min(min(gauss_chisquared_20140808_1)))==gauss_chisquared_20140808_1));
[mini_20140519_1 minj_20140519_1 mink_20140519_1] = ind2sub(size(gauss_chisquared_20140519_1),find(min(min(min(gauss_chisquared_20140519_1)))==gauss_chisquared_20140519_1));



scalingfactor_int_20140526_2(mini_20140526_2)
xloc_int_20140526_2(minj_20140526_2)
velocity_int_20140526_2(mink_20140526_2)



clf
hold all
plot(gauss_x_20140526_2,squeeze(squeeze(squeeze(squeeze(squeeze(gauss_int_20140526_2(:,mini_20140526_2,17,10 )))))))
plot(velHalphascaled20140526_2,halphavarscaledsubnormalized20140526_sn2014ab_2)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\gaussianattempt.pdf -pdf



%voigt profile fit


voigt_x_20140526_2 = velHalphascaled20140526_2;
voigt_x_20140602_1 = velHalphascaled20140602_1;
voigt_x_20140722_1 = velHalphascaled20140722_1;
voigt_x_20140808_1 = velHalphascaled20140808_1;
voigt_x_20140519_1 = velHalphascaled20140519_1;

numiterations = 18;

scalingfactor_voigt_20140526_2 = linspace(4,8,numiterations);
scalingfactor_voigt_20140602_1 = linspace(4,8,numiterations);
scalingfactor_voigt_20140722_1 = linspace(4,8,numiterations);
scalingfactor_voigt_20140808_1 = linspace(4,8,numiterations);
scalingfactor_voigt_20140519_1 = linspace(4,8,numiterations);

xloc_voigt_20140526_2 = linspace(-0.65,-0.2,numiterations);
xloc_voigt_20140602_1 = linspace(-0.65,-0.2,numiterations);
xloc_voigt_20140722_1 = linspace(-0.65,-0.2,numiterations);
xloc_voigt_20140808_1 = linspace(-0.65,-0.2,numiterations);
xloc_voigt_20140519_1 = linspace(-0.65,-0.2,numiterations);

sigma_voigt_20140526_2 = linspace(0.2,1.5,numiterations);
sigma_voigt_20140602_1 = linspace(0.2,1.5,numiterations);
sigma_voigt_20140722_1 = linspace(0.2,1.5,numiterations);
sigma_voigt_20140808_1 = linspace(0.2,1.5,numiterations);
sigma_voigt_20140519_1 = linspace(0.2,1.5,numiterations);

gamma_voigt_20140526_2 = linspace(1.4,2.1,numiterations);
gamma_voigt_20140602_1 = linspace(1.4,2.1,numiterations);
gamma_voigt_20140722_1 = linspace(1.4,2.1,numiterations);
gamma_voigt_20140808_1 = linspace(1.4,2.1,numiterations);
gamma_voigt_20140519_1 = linspace(1.4,2.1,numiterations);

clear voigt_20140526_2
clear voigt_20140602_1
clear voigt_20140722_1
clear voigt_20140808_1
clear voigt_20140519_1

clear voigt_chisquared_20140526_2
clear voigt_chisquared_20140602_1
clear voigt_chisquared_20140722_1
clear voigt_chisquared_20140808_1
clear voigt_chisquared_20140519_1

voigt_20140526_2 = zeros(size(voigt_x_20140526_2,1),numiterations,numiterations,numiterations,numiterations);
voigt_20140602_1 = zeros(size(voigt_x_20140602_1,1),numiterations,numiterations,numiterations,numiterations);
voigt_20140722_1 = zeros(size(voigt_x_20140722_1,1),numiterations,numiterations,numiterations,numiterations);
voigt_20140808_1 = zeros(size(voigt_x_20140808_1,1),numiterations,numiterations,numiterations,numiterations);
voigt_20140519_1 = zeros(size(voigt_x_20140519_1,1),numiterations,numiterations,numiterations,numiterations);


%make a grid of intermediate gaussians
for i=1:numiterations
i
	for j=1:numiterations
		for k=1:numiterations
			for ii=1:numiterations
				voigt_20140526_2(:,i,j,k,ii) = scalingfactor_voigt_20140526_2(i) * voigt(voigt_x_20140526_2,xloc_voigt_20140526_2(j),sigma_voigt_20140526_2(k),gamma_voigt_20140526_2(ii));
				voigt_20140602_1(:,i,j,k,ii) = scalingfactor_voigt_20140602_1(i) * voigt(voigt_x_20140602_1,xloc_voigt_20140602_1(j),sigma_voigt_20140602_1(k),gamma_voigt_20140602_1(ii));
				voigt_20140722_1(:,i,j,k,ii) = scalingfactor_voigt_20140722_1(i) * voigt(voigt_x_20140722_1,xloc_voigt_20140722_1(j),sigma_voigt_20140722_1(k),gamma_voigt_20140722_1(ii));
				voigt_20140808_1(:,i,j,k,ii) = scalingfactor_voigt_20140808_1(i) * voigt(voigt_x_20140808_1,xloc_voigt_20140808_1(j),sigma_voigt_20140808_1(k),gamma_voigt_20140808_1(ii));
				voigt_20140519_1(:,i,j,k,ii) = scalingfactor_voigt_20140519_1(i) * voigt(voigt_x_20140519_1,xloc_voigt_20140519_1(j),sigma_voigt_20140519_1(k),gamma_voigt_20140519_1(ii));		
			end
		end
	end
end


for i=1:numiterations
i
	for j=1:numiterations
		for k=1:numiterations
			for ii=1:numiterations
				voigt_chisquared_20140526_2(i,j,k,ii) = sum(((halphavarscaledsubnormalized20140526_sn2014ab_2-voigt_20140526_2(:,i,j,k,ii)).^2)./(voigt_20140526_2(:,i,j,k,ii)));
				voigt_chisquared_20140602_1(i,j,k,ii) = sum(((halphavarscaledsubnormalized20140602_sn2014ab_1-voigt_20140602_1(:,i,j,k,ii)).^2)./(voigt_20140602_1(:,i,j,k,ii)));
				voigt_chisquared_20140722_1(i,j,k,ii) = sum(((halphavarscaledsubnormalized20140722_sn2014ab_1-voigt_20140722_1(:,i,j,k,ii)).^2)./(voigt_20140722_1(:,i,j,k,ii)));
				voigt_chisquared_20140808_1(i,j,k,ii) = sum(((halphavarscaledsubnormalized20140808_sn2014ab_1-voigt_20140808_1(:,i,j,k,ii)).^2)./(voigt_20140808_1(:,i,j,k,ii)));
				voigt_chisquared_20140519_1(i,j,k,ii) = sum(((halphavarscaledsubnormalized20140519_sn2014ab_1-voigt_20140519_1(:,i,j,k,ii)).^2)./(voigt_20140519_1(:,i,j,k,ii)));
			end
		end
	end
end

%find the best fit chi^2 of the various gaussians

[mini_20140526_2 minj_20140526_2 mink_20140526_2 minii_20140526_2] = ind2sub(size(voigt_chisquared_20140526_2),find(min(min(min(min(voigt_chisquared_20140526_2))))==voigt_chisquared_20140526_2));
[mini_20140602_1 minj_20140602_1 mink_20140602_1 minii_20140602_1] = ind2sub(size(voigt_chisquared_20140602_1),find(min(min(min(min(voigt_chisquared_20140602_1))))==voigt_chisquared_20140602_1));
[mini_20140722_1 minj_20140722_1 mink_20140722_1 minii_20140722_1] = ind2sub(size(voigt_chisquared_20140722_1),find(min(min(min(min(voigt_chisquared_20140722_1))))==voigt_chisquared_20140722_1));
[mini_20140808_1 minj_20140808_1 mink_20140808_1 minii_20140808_1] = ind2sub(size(voigt_chisquared_20140808_1),find(min(min(min(min(voigt_chisquared_20140808_1))))==voigt_chisquared_20140808_1));
[mini_20140519_1 minj_20140519_1 mink_20140519_1 minii_20140519_1] = ind2sub(size(voigt_chisquared_20140519_1),find(min(min(min(min(voigt_chisquared_20140519_1))))==voigt_chisquared_20140519_1));



scalingfactor_voigt_20140526_2(mini_20140526_2)
xloc_voigt_20140526_2(minj_20140526_2)
sigma_voigt_20140526_2(mink_20140526_2)
gamma_voigt_20140526_2(minii_20140526_2)

mini_20140526_2
minj_20140526_2
mink_20140526_2
minii_20140526_2



clf
hold all
plot(voigt_x_20140526_2,voigt_20140526_2(:,mini_20140526_2,minj_20140526_2,mink_20140526_2,minii_20140526_2 ))
plot(velHalphascaled20140526_2,halphavarscaledsubnormalized20140526_sn2014ab_2)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\voigt20140526_2.pdf -pdf

clf
hold all
plot(voigt_x_20140602_1,voigt_20140602_1(:,mini_20140602_1,minj_20140602_1,mink_20140602_1,minii_20140602_1 ))
plot(velHalphascaled20140602_1,halphavarscaledsubnormalized20140602_sn2014ab_1)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\voigt20140602_1.pdf -pdf

clf
hold all
plot(voigt_x_20140722_1,voigt_20140722_1(:,mini_20140722_1,minj_20140722_1,mink_20140722_1,minii_20140722_1 ))
plot(velHalphascaled20140722_1,halphavarscaledsubnormalized20140722_sn2014ab_1)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\voigt20140722_1.pdf -pdf

clf
hold all
plot(voigt_x_20140808_1,voigt_20140808_1(:,mini_20140808_1,minj_20140808_1,mink_20140808_1,minii_20140808_1 ))
plot(velHalphascaled20140808_1,halphavarscaledsubnormalized20140808_sn2014ab_1)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\voigt20140808_1.pdf -pdf

clf
hold all
plot(voigt_x_20140519_1,voigt_20140519_1(:,mini_20140519_1,minj_20140519_1,mink_20140519_1,minii_20140519_1 ))
plot(velHalphascaled20140519_1,halphavarscaledsubnormalized20140519_sn2014ab_1)

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\voigt20140519_1.pdf -pdf







%halpha velocity plot limited to 5 high-res spectra with narrow component interpolated over
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
clf
plot(velHalphascaled20140526_2,halphavarscaledsubnormalized20140526_sn2014ab_2,'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
hold all                                                                                                                                                                                                                                                                                                                                      -
plot(velHalphascaled20140602_1,halphavarscaledsubnormalized20140602_sn2014ab_1, 'LineStyle','-','LineWidth',3,'Color',[0.8902 0.1020 0.1100])
plot(velHalphascaled20140722_1,halphavarscaledsubnormalized20140722_sn2014ab_1, 'LineStyle','-','LineWidth',3,'Color',[0.2 0.6275 0.1725])
plot(velHalphascaled20140808_1,halphavarscaledsubnormalized20140808_sn2014ab_1, 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])
plot(velHalphascaled20140519_1,halphavarscaledsubnormalized20140519_sn2014ab_1,'LineWidth',3,'Color',[0.9843 0.6039 0.6])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1.3]])
axis([[-0.25 0.25] [-0.1 1.3]])

htext = text(-6,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.6,'H$\alpha$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,0.9,'day 71 Magellan'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.9843 0.6039 0.6])
htext = text(4,0.8,'day 78 Xshooter'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
htext = text(4,0.7,'day 85 Xshooter'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
htext = text(4,0.6,'day 135 Xshooter'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.5,'day 152 Xshooter'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])

htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')


voigt(linspace(-8,8,1000),0.5,0.5)



export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocityHighResInterpOffset.pdf -pdf














%halpha velocity plot limited to 5 high-res spectra
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
clf
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
hold all                                                                                                                                                                                                                                                                                                                                                -
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,1.8*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.8902 0.1020 0.1100])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,1.6*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.2 0.6275 0.1725])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.9843 0.6039 0.6])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1.3]])

htext = text(-6,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.6,'H$\alpha$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,0.9,'day 71 Magellan'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.9843 0.6039 0.6])
htext = text(4,0.8,'day 78 Xshooter'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
htext = text(4,0.7,'day 85 Xshooter'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
htext = text(4,0.6,'day 135 Xshooter'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.5,'day 152 Xshooter'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])

htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocityHighRes.pdf


saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);




%halpha vs paschen beta comparison plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velPaschenbeta_20140526_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))/10^3,4.1*smooth(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322)))./max(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))),'LineStyle','-','LineWidth',3,'Color',[1 0 0])
hold all
plot(velPaschenbeta_20140808_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))/10^3,1.5 *smooth(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322)))./max(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.0706 1.0])

plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])


line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1.3]])

htext = text(-7.5,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
%htext = text(-7.5,0.6,'Pa$\beta$ (solid) vs. H$\alpha$ (dashed)','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,1.2,'day 78 Pa$\beta$'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0 0])
htext = text(4,1,'day 78 H$\alpha$'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
%htext = text(4,0.7,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
%htext = text(4,0.6,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.8,'day 152 Pa$\beta$'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.0706 1.0])
htext = text(4,0.6,'day 152 H$\alpha$'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])

htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig PabetavsHalphaVelocity.pdf
export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetavsHalphaVelocity.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);


















%blue vs red line equivalent width plot for Halpha



clf
hold all
plt1 = scatter(reldate,roverbratio,225,[0.0000 0.0000 0.0000],'MarkerFaceColor',[0.0000 0.0000 0.0000])
errorbar(reldate,roverbratio,roverbratioerr*0.5,'.','Color',[0.0000 0.0000 0.0000],'LineWidth',2)
plt2 = scatter(reldate([16 18 26:27]),Pabetaroverbratio,225,[1.000 0.4000 0.0000],'MarkerFaceColor',[1.000 0.4000 0.0000])
errorbar(reldate([16 18 26:27]),Pabetaroverbratio,PabetaleftdEWPaschenbeta./PabetaleftEWPaschenbeta*0.4,'.','Color',[1.000 0.4000 0.0000],'LineWidth',2)


%hL = legend([plt1 plt2],'','Location','Southeast')
htext = text(100,1.075,'Red side stronger','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',26)
htext = text(100,0.925,'Blue side stronger','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',26)

htext = text(20,0.3,'H$\alpha$','interpreter','latex')
set(htext, 'Color', [0 0 0])
set(htext, 'FontSize',26)
htext = text(20,0.1,'Pa$\beta$','interpreter','latex')
set(htext, 'Color', [1.000 0.4000 0.0000])
set(htext, 'FontSize',26)
line([-5 1000],[1 1],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Ratio of Red/Blue Flux','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 160],[0 1.2]])
box on
saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\bvsrratiored.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\bvsrratiored.eps']);



%blue vs red line equivalent width plot for Paschen beta
%not needed anymore because it was condensed into the previous plot

%clf
%hold all
%plt1 = scatter(reldate([16 18 26:27]),Pabetaroverbratio,225,[0.0000 0.0000 0.0000],'MarkerFaceColor',[0.0000 0.0000 0.0000])
%errorbar(reldate([16 18 26:27]),Pabetaroverbratio,PabetaleftdEWPaschenbeta./PabetaleftEWPaschenbeta*0.4,'.','Color','k')
%
%%Pabetaroverbratioerr
%
%%hL = legend([plt1 plt2],'','Location','Southeast')
%htext = text(100,1.075,'Red side stronger','interpreter','latex')
%set(htext, 'Color', [1 0 0])
%set(htext, 'FontSize',22)
%htext = text(100,0.925,'Blue side stronger','interpreter','latex')
%set(htext, 'Color', [0 0 1])
%set(htext, 'FontSize',22)
%line([-5 1000],[1 1],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)
%
%ax1 = gca;
%set(ax1,'FontSize',32)
%xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
%ylabel('Ratio of Red/Blue Flux','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
%set(gca,'XMinorTick','on','YMinorTick','on')
%axis([[0 160],[0 1.2]])
%box on
%saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Pabetabvsrratiored.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Pabetabvsrratiored.eps']);






















































%backup old numbers that line up exactly with J H K 
%clf
%l1  = semilogy(wave_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13680) | ((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)) | (wave_2014ab_VLT_ep78 > 19550))./10000,     smooth(6^0  *10* flux_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13680) | ((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)) | (wave_2014ab_VLT_ep78 > 19550))   ),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%hold on                                                                          
%l2 = semilogy(wave_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13680) | ((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)) | (wave_2014ab_VLT_ep85 > 19550)) ./10000,     smooth(6^-1 *18  * flux_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13680) | ((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)) | (wave_2014ab_VLT_ep85 > 19550)) ),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l3 = semilogy(wave_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13680) | ((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)) | (wave_2014ab_VLT_ep135 > 19550))./10000,     smooth(6^-2 *45  * flux_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13680) | ((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)) | (wave_2014ab_VLT_ep135 > 19550))),    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l4 = semilogy(wave_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13680) | ((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)) | (wave_2014ab_VLT_ep152 > 19550))./10000,     smooth(6^-3 *5   * flux_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13680) | ((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)) | (wave_2014ab_VLT_ep152 > 19550))),    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])


%line([1.075 1.075],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%line([1.368 1.368],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%
%line([1.466 1.466],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%line([1.759 1.759],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%
%line([1.955 1.955],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%line([2.346 2.346],[0.00001 1],'LineStyle','-','Color',[0 0 0])



         0    1.0000         0
         0    1.0000    0.2000
         0    1.0000    0.4000
         0    1.0000    0.6000
         0    1.0000    0.8000
         0    1.0000    1.0000
         0    0.8000    1.0000
         0    0.6000    1.0000
         0    0.4000    1.0000
         0    0.2000    1.0000
         0         0    1.0000
    0.2000         0    1.0000
    0.4000         0    1.0000
    0.6000         0    1.0000
    0.8000         0    1.0000
    1.0000         0    1.0000
    1.0000         0    0.8000
    1.0000         0    0.6000
    1.0000         0    0.4000
    1.0000         0    0.2000
    1.0000         0         0
    0.8000         0         0
    0.6000         0         0
    0.4000         0         0
    0.2000         0         0
         0         0         0



		 

         0    1.0000         0
         0    1.0000    0.1667
         0    1.0000    0.3333
         0    1.0000    0.5000
         0    1.0000    0.6667
         0    1.0000    0.8333
         0    1.0000    1.0000
         0    0.8571    1.0000
         0    0.7143    1.0000
         0    0.5714    1.0000
         0    0.4286    1.0000
         0    0.2857    1.0000
         0    0.1429    1.0000
         0         0    1.0000
    0.1429         0    1.0000
    0.2857         0    1.0000
    0.4286         0    1.0000
    0.5714         0    1.0000
    0.7143         0    1.0000
    0.8571         0    1.0000
    1.0000         0    1.0000
    1.0000         0    0.8333
    1.0000         0    0.6667
    1.0000         0    0.5000
    1.0000         0    0.3333
    1.0000         0    0.1667
    1.0000         0         0
    0.8333         0         0
    0.6667         0         0
    0.5000         0         0
    0.3333         0         0
    0.1667         0         0
         0         0         0

%








%%IR Spectra Plot
%clf
%l1  = semilogy(wave_2014ab_VLT_ep78./10000,     6^0  *10* flux_2014ab_VLT_ep78,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%hold on                            
%l2 = semilogy(wave_2014ab_VLT_ep85 ./10000,     6^-1 *18  * flux_2014ab_VLT_ep85,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l3 = semilogy(wave_2014ab_VLT_ep135./10000,     6^-2 *45  * flux_2014ab_VLT_ep135,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l4 = semilogy(wave_2014ab_VLT_ep152./10000,     6^-3 *5   * flux_2014ab_VLT_ep152,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%  
%legend([l1], 'ESO-VLT')
%
%
%%line([6731 6731],[0.5 1],'LineStyle','-','Color',[0 0 0])
%
%htext = text(1.2822,0.25,'Pa $\beta$','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',18)
%htext = text(1.3500,0.3,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
%set(htext, 'Color', 'black')	
%set(htext, 'FontSize',26)
%
%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'Color',[0.8 0.8 0.8])
%
%
%xlabel('Rest Wavelength ($\mu$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%axis([[1 1.5] [10^-5*2 1]])
%ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',22)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
%set(ax1,'FontSize',22)
%set(ax2,'FontSize',22)
%set(ax1,'XMinorTick','on','YMinorTick','on')
%
%saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrum.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrum.eps']);




%Condensed Full Spectrum Plot in nonlog
clf
l1  = plot(wave_2014ab_NTT_ep1,      25* flux_2014ab_NTT_ep1,                'LineWidth',2,'Color',[0.0000 0.3922 0.0039])
hold on
l2  = plot(wave_2014ab_Lic_ep15,     2 *   1 * flux_2014ab_Lic_ep15,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l3  = plot(wave_2014ab_Bok_ep20_24,  6^-2 *   1 * flux_2014ab_Bok_ep20_24,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l4  = plot(wave_2014ab_Kui_ep48_50,  6^-3 *   1 * flux_2014ab_Kui_ep48_50,  'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l5  = plot(wave_2014ab_Lic_ep52,     6^-4 *   1 * flux_2014ab_Lic_ep52,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l6  = plot(wave_2014ab_Kui_ep53 ,    6^-5 *   1 * flux_2014ab_Kui_ep53,     'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l7  = plot(wave_2014ab_Mag_ep71 ,    6^-6 *2* 1 * flux_2014ab_Mag_ep71,     'LineWidth',2,'Color',[0.4941 0.1765 0.8235])
l8  = plot(wave_2014ab_Bok_ep75_78,  6^-7 *2* 1 * flux_2014ab_Bok_ep75_78,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l9  = plot(wave_2014ab_VLT_ep78,     6^-8 *2* 15* flux_2014ab_VLT_ep78,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l10 = plot(wave_2014ab_Lic_ep80,     6^-9 *2* 1 * flux_2014ab_Lic_ep80,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l11 = plot(wave_2014ab_VLT_ep85,     6^-10*2* 15* flux_2014ab_VLT_ep85,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l12 = plot(wave_2014ab_Lic_ep104,    6^-11*2* 1 * flux_2014ab_Lic_ep104,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l13 = plot(wave_2014ab_Kui_ep105_109,6^-12*2* 1 * flux_2014ab_Kui_ep105_109,'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l14 = plot(wave_2014ab_Lic_ep113,    6^-13*2* 1 * flux_2014ab_Lic_ep113,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l15 = plot(wave_2014ab_VLT_ep135,    15*2* 25* flux_2014ab_VLT_ep135,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l16 = plot(wave_2014ab_VLT_ep152,    6^-15*2* 1 * flux_2014ab_VLT_ep152,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
  
legend([l1, l2, l3, l4, l7, l9],'ESO-NTT','Lick','Bok','Kuiper', 'Magellan', 'ESO-VLT')
line([4101 4101],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4340 4340],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4861 4861],[0.55 0.85],'LineStyle','-','Color',[0 0 0])
line([4959 4959],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5007 5007],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5876 5876],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
line([5896 5896],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
%line([6548 6548],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
line([6562.81 6562.81],[1.3 2.3],'LineStyle','-','Color',[0 0 0])
%line([6583 6583],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
%line([6717 6717],[0.5 1],'LineStyle','-','Color',[0 0 0])
%line([6731 6731],[0.5 1],'LineStyle','-','Color',[0 0 0])
htext = text(4101,0.9,'H\delta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4340,0.9,'H\gamma','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4861,0.95,'H\beta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4983,0.9,'[OIII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5876-22,0.4,'HeI\lambda5876','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5896+22,0.4,'NaID','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6565.5,11.5,'[NII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6562.81,2.5,'H\alpha','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6724,1.1,'[SII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6754,0.22,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(7050,5,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(7100,0.8 *2*6^-1 ,'day 1'       ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.3922 0.0039])
htext = text(7100,0.8 *2*6^-2 ,'day 15'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.8 *2*6^-3 ,'days 20-24'  ,'FontName','CMU Serif Roman','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext = text(7100,0.7 *2*6^-4 ,'days 48-50'  ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,0.65*2*6^-5 ,'day 52'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.8 *2*6^-6 ,'day 53'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,0.9 *2*6^-7 ,'day 71'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.4941 0.1765 0.8235])
htext = text(7100,1.2 *2*6^-8 ,'days 75-78'  ,'FontName','CMU Serif Roman','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext = text(7100,1.6 *2*6^-9 ,'day 78'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,1.5 *2*6^-10,'day 80'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,1.5 *2*6^-11,'day 85'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,1.05*2*6^-12,'day 104'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,1.05*2*6^-13,'days 105-109','FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,1.0 *2*6^-14,'day 113'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.55*2*6^-15,'day 135'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,0.18*2*6^-16,'day 152'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])


xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3400 10000] [10^-14*2 25]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')


saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Spectrumnonlog.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Spectrumnonlog.eps']);











%%%%%
OLD CODE
%%%%%


%apply narrow line offset
%meannarrowoffsetwav = -3.5443;
%meannarrowoffsetwavmult = -meannarrowoffsetwav/6562.81;
%d20140310_sn2014ab_1(1,:) = d20140310_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140310_sn2014ab_2(1,:) = d20140310_sn2014ab_2(1,:)  *(1+meannarrowoffsetwavmult);
%d20140324_sn2014ab_1(1,:) = d20140324_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140329_sn2014ab_1(1,:) = d20140329_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140330_sn2014ab_1(1,:) = d20140330_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140331_sn2014ab_1(1,:) = d20140331_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140402_sn2014ab_1(1,:) = d20140402_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140426_sn2014ab_1(1,:) = d20140426_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140427_sn2014ab_1(1,:) = d20140427_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140428_sn2014ab_1(1,:) = d20140428_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140430_sn2014ab_1(1,:) = d20140430_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140501_sn2014ab_1(1,:) = d20140501_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140519_sn2014ab_1(1,:) = d20140519_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140523_sn2014ab_1(1,:) = d20140523_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140524_sn2014ab_1(1,:) = d20140524_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140526_sn2014ab_1(1,:) = d20140526_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140528_sn2014ab_1(1,:) = d20140528_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140621_sn2014ab_1(1,:) = d20140621_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140622_sn2014ab_1(1,:) = d20140622_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140623_sn2014ab_1(1,:) = d20140623_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140624_sn2014ab_1(1,:) = d20140624_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140626_sn2014ab_1(1,:) = d20140626_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140630_sn2014ab_1(1,:) = d20140630_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140526_sn2014ab_2(1,:) = d20140526_sn2014ab_2(1,:)  *(1+meannarrowoffsetwavmult);
%%d20140526_sn2014ab_3(1,:) = d20140526_sn2014ab_3(1,:) *(1+meannarrowoffsetwavmult);
%%d20140526_sn2014ab_4(1,:) = d20140526_sn2014ab_4(1,:) *(1+meannarrowoffsetwavmult);
%d20140602_sn2014ab_1(1,:) = d20140602_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%%d20140602_sn2014ab_2(1,:) = d20140602_sn2014ab_2(1,:) *(1+meannarrowoffsetwavmult);
%%d20140602_sn2014ab_3(1,:) = d20140602_sn2014ab_3(1,:) *(1+meannarrowoffsetwavmult);
%d20140722_sn2014ab_1(1,:) = d20140722_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%%d20140722_sn2014ab_2(1,:) = d20140722_sn2014ab_2(1,:) *(1+meannarrowoffsetwavmult);
%%d20140722_sn2014ab_3(1,:) = d20140722_sn2014ab_3(1,:) *(1+meannarrowoffsetwavmult);
%d20140722_sn2014ab_4(1,:) = d20140722_sn2014ab_4(1,:)  *(1+meannarrowoffsetwavmult);
%%d20140722_sn2014ab_5(1,:) = d20140722_sn2014ab_5(1,:) *(1+meannarrowoffsetwavmult);
%%d20140722_sn2014ab_6(1,:) = d20140722_sn2014ab_6(1,:) *(1+meannarrowoffsetwavmult);
%d20140808_sn2014ab_1(1,:) = d20140808_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%%d20140808_sn2014ab_2(1,:) = d20140808_sn2014ab_2(1,:) *(1+meannarrowoffsetwavmult);
%%d20140808_sn2014ab_3(1,:) = d20140808_sn2014ab_3(1,:) *(1+meannarrowoffsetwavmult);
%d20140408_sn2014ab_1(1,:) = d20140408_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140409_sn2014ab_1(1,:) = d20140409_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140411_sn2014ab_1(1,:) = d20140411_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140507_sn2014ab_4(1,:) = d20140507_sn2014ab_4(1,:)  *(1+meannarrowoffsetwavmult);
%%d20140507_sn2014ab_1(1,:) = d20140507_sn2014ab_1(1,:) *(1+meannarrowoffsetwavmult);
%%d20140507_sn2014ab_2(1,:) = d20140507_sn2014ab_2(1,:) *(1+meannarrowoffsetwavmult);
%%d20140507_sn2014ab_3(1,:) = d20140507_sn2014ab_3(1,:) *(1+meannarrowoffsetwavmult);
%d20140420_sn2014ab_1(1,:) = d20140420_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140423_sn2014ab_1(1,:) = d20140423_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20140522_sn2014ab_1(1,:) = d20140522_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);
%d20180414_sn2014ab_1(1,:) = d20180414_sn2014ab_1(1,:)  *(1+meannarrowoffsetwavmult);



%d20140408_sn2014ab_1(1,:)
%d20140409_sn2014ab_1(1,:)
%d20140411_sn2014ab_1(1,:)
%d20140507_sn2014ab_1(1,:)
%d20140507_sn2014ab_2(1,:)
%d20140507_sn2014ab_3(1,:)
%d20140420_sn2014ab_1(1,:)
%d20140423_sn2014ab_1(1,:)
%d20140522_sn2014ab_1(1,:)


%xhooster is actually 3 separate parts that needed to be stitched together, not many separate spectra here
%halphafit20140526_sn2014ab_3= fit(d20140526_sn2014ab_3(1,[find(d20140526_sn2014ab_3(1,:)>6000,3,'first') find(d20140526_sn2014ab_3(1,:)<7125,3,'last')])',d20140526_sn2014ab_3(2,[find(d20140526_sn2014ab_3(1,:)>6000,3,'first') find(d20140526_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140526_sn2014ab_3= mean(halphafit20140526_sn2014ab_3(d20140526_sn2014ab_3(1,(d20140526_sn2014ab_3(1,:)>6462.8 & d20140526_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140526_sn2014ab_3= d20140526_sn2014ab_3(2,:)/halphanormconstant20140526_sn2014ab_3;
%halphavarscaledsub20140526_sn2014ab_3= (d20140526_sn2014ab_3(2,:) - halphafit20140526_sn2014ab_3(d20140526_sn2014ab_3(1,:))')./halphafit20140526_sn2014ab_3(d20140526_sn2014ab_3(1,:))';

%halphafit20140526_sn2014ab_4= fit(d20140526_sn2014ab_4(1,[find(d20140526_sn2014ab_4(1,:)>6000,3,'first') find(d20140526_sn2014ab_4(1,:)<7125,3,'last')])',d20140526_sn2014ab_4(2,[find(d20140526_sn2014ab_4(1,:)>6000,3,'first') find(d20140526_sn2014ab_4(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140526_sn2014ab_4= mean(halphafit20140526_sn2014ab_4(d20140526_sn2014ab_4(1,(d20140526_sn2014ab_4(1,:)>6462.8 & d20140526_sn2014ab_4(1,:)<6662.8))));
%halphauniscaled20140526_sn2014ab_4= d20140526_sn2014ab_4(2,:)/halphanormconstant20140526_sn2014ab_4;
%halphavarscaledsub20140526_sn2014ab_4= (d20140526_sn2014ab_4(2,:) - halphafit20140526_sn2014ab_4(d20140526_sn2014ab_4(1,:))')./halphafit20140526_sn2014ab_4(d20140526_sn2014ab_4(1,:))';



%halphafit20140602_sn2014ab_2= fit(d20140602_sn2014ab_2(1,[find(d20140602_sn2014ab_2(1,:)>6000,3,'first') find(d20140602_sn2014ab_2(1,:)<7125,3,'last')])',d20140602_sn2014ab_2(2,[find(d20140602_sn2014ab_2(1,:)>6000,3,'first') find(d20140602_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140602_sn2014ab_2= mean(halphafit20140602_sn2014ab_2(d20140602_sn2014ab_2(1,(d20140602_sn2014ab_2(1,:)>6462.8 & d20140602_sn2014ab_2(1,:)<6662.8))));
%halphauniscaled20140602_sn2014ab_2= d20140602_sn2014ab_2(2,:)/halphanormconstant20140602_sn2014ab_2;
%halphavarscaledsub20140602_sn2014ab_2= (d20140602_sn2014ab_2(2,:) - halphafit20140602_sn2014ab_2(d20140602_sn2014ab_2(1,:))')./halphafit20140602_sn2014ab_2(d20140602_sn2014ab_2(1,:))';

%halphafit20140602_sn2014ab_3= fit(d20140602_sn2014ab_3(1,[find(d20140602_sn2014ab_3(1,:)>6000,3,'first') find(d20140602_sn2014ab_3(1,:)<7125,3,'last')])',d20140602_sn2014ab_3(2,[find(d20140602_sn2014ab_3(1,:)>6000,3,'first') find(d20140602_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140602_sn2014ab_3= mean(halphafit20140602_sn2014ab_3(d20140602_sn2014ab_3(1,(d20140602_sn2014ab_3(1,:)>6462.8 & d20140602_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140602_sn2014ab_3= d20140602_sn2014ab_3(2,:)/halphanormconstant20140602_sn2014ab_3;
%halphavarscaledsub20140602_sn2014ab_3= (d20140602_sn2014ab_3(2,:) - halphafit20140602_sn2014ab_3(d20140602_sn2014ab_3(1,:))')./halphafit20140602_sn2014ab_3(d20140602_sn2014ab_3(1,:))';




%halphafit20140722_sn2014ab_2= fit(d20140722_sn2014ab_2(1,[find(d20140722_sn2014ab_2(1,:)>6000,3,'first') find(d20140722_sn2014ab_2(1,:)<7125,3,'last')])',d20140722_sn2014ab_2(2,[find(d20140722_sn2014ab_2(1,:)>6000,3,'first') find(d20140722_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_2= mean(halphafit20140722_sn2014ab_2(d20140722_sn2014ab_2(1,(d20140722_sn2014ab_2(1,:)>6462.8 & d20140722_sn2014ab_2(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_2= d20140722_sn2014ab_2(2,:)/halphanormconstant20140722_sn2014ab_2;
%halphavarscaledsub20140722_sn2014ab_2= (d20140722_sn2014ab_2(2,:) - halphafit20140722_sn2014ab_2(d20140722_sn2014ab_2(1,:))')./halphafit20140722_sn2014ab_2(d20140722_sn2014ab_2(1,:))';

%halphafit20140722_sn2014ab_3= fit(d20140722_sn2014ab_3(1,[find(d20140722_sn2014ab_3(1,:)>6000,3,'first') find(d20140722_sn2014ab_3(1,:)<7125,3,'last')])',d20140722_sn2014ab_3(2,[find(d20140722_sn2014ab_3(1,:)>6000,3,'first') find(d20140722_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_3= mean(halphafit20140722_sn2014ab_3(d20140722_sn2014ab_3(1,(d20140722_sn2014ab_3(1,:)>6462.8 & d20140722_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_3= d20140722_sn2014ab_3(2,:)/halphanormconstant20140722_sn2014ab_3;
%halphavarscaledsub20140722_sn2014ab_3= (d20140722_sn2014ab_3(2,:) - halphafit20140722_sn2014ab_3(d20140722_sn2014ab_3(1,:))')./halphafit20140722_sn2014ab_3(d20140722_sn2014ab_3(1,:))';


%halphafit20140722_sn2014ab_5= fit(d20140722_sn2014ab_5(1,[find(d20140722_sn2014ab_5(1,:)>6000,3,'first') find(d20140722_sn2014ab_5(1,:)<7125,3,'last')])',d20140722_sn2014ab_5(2,[find(d20140722_sn2014ab_5(1,:)>6000,3,'first') find(d20140722_sn2014ab_5(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_5= mean(halphafit20140722_sn2014ab_5(d20140722_sn2014ab_5(1,(d20140722_sn2014ab_5(1,:)>6462.8 & d20140722_sn2014ab_5(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_5= d20140722_sn2014ab_5(2,:)/halphanormconstant20140722_sn2014ab_5;
%halphavarscaledsub20140722_sn2014ab_5= (d20140722_sn2014ab_5(2,:) - halphafit20140722_sn2014ab_5(d20140722_sn2014ab_5(1,:))')./halphafit20140722_sn2014ab_5(d20140722_sn2014ab_5(1,:))';

%halphafit20140722_sn2014ab_6= fit(d20140722_sn2014ab_6(1,[find(d20140722_sn2014ab_6(1,:)>6000,3,'first') find(d20140722_sn2014ab_6(1,:)<7125,3,'last')])',d20140722_sn2014ab_6(2,[find(d20140722_sn2014ab_6(1,:)>6000,3,'first') find(d20140722_sn2014ab_6(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_6= mean(halphafit20140722_sn2014ab_6(d20140722_sn2014ab_6(1,(d20140722_sn2014ab_6(1,:)>6462.8 & d20140722_sn2014ab_6(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_6= d20140722_sn2014ab_6(2,:)/halphanormconstant20140722_sn2014ab_6;
%halphavarscaledsub20140722_sn2014ab_6= (d20140722_sn2014ab_6(2,:) - halphafit20140722_sn2014ab_6(d20140722_sn2014ab_6(1,:))')./halphafit20140722_sn2014ab_6(d20140722_sn2014ab_6(1,:))';

%halphafit20140808_sn2014ab_2= fit(d20140808_sn2014ab_2(1,[find(d20140808_sn2014ab_2(1,:)>6000,3,'first') find(d20140808_sn2014ab_2(1,:)<7125,3,'last')])',d20140808_sn2014ab_2(2,[find(d20140808_sn2014ab_2(1,:)>6000,3,'first') find(d20140808_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140808_sn2014ab_2= mean(halphafit20140808_sn2014ab_2(d20140808_sn2014ab_2(1,(d20140808_sn2014ab_2(1,:)>6462.8 & d20140808_sn2014ab_2(1,:)<6662.8))));
%halphauniscaled20140808_sn2014ab_2= d20140808_sn2014ab_2(2,:)/halphanormconstant20140808_sn2014ab_2;
%halphavarscaledsub20140808_sn2014ab_2= (d20140808_sn2014ab_2(2,:) - halphafit20140808_sn2014ab_2(d20140808_sn2014ab_2(1,:))')./halphafit20140808_sn2014ab_2(d20140808_sn2014ab_2(1,:))';

%halphafit20140808_sn2014ab_3= fit(d20140808_sn2014ab_3(1,[find(d20140808_sn2014ab_3(1,:)>6000,3,'first') find(d20140808_sn2014ab_3(1,:)<7125,3,'last')])',d20140808_sn2014ab_3(2,[find(d20140808_sn2014ab_3(1,:)>6000,3,'first') find(d20140808_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140808_sn2014ab_3= mean(halphafit20140808_sn2014ab_3(d20140808_sn2014ab_3(1,(d20140808_sn2014ab_3(1,:)>6462.8 & d20140808_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140808_sn2014ab_3= d20140808_sn2014ab_3(2,:)/halphanormconstant20140808_sn2014ab_3;
%halphavarscaledsub20140808_sn2014ab_3= (d20140808_sn2014ab_3(2,:) - halphafit20140808_sn2014ab_3(d20140808_sn2014ab_3(1,:))')./halphafit20140808_sn2014ab_3(d20140808_sn2014ab_3(1,:))';

%clf
%plot(halphafit20140526_sn2014ab_3,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
%clf
%plot(halphafit20140526_sn2014ab_4,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))

%clf                            
%plot(halphafit20140602_sn2014ab_2,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140602_sn2014ab_3,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))

%clf                            
%plot(halphafit20140722_sn2014ab_2,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_3,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))

%clf                            
%plot(halphafit20140722_sn2014ab_5,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_6,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))

%clf                            
%plot(halphafit20140808_sn2014ab_2,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140808_sn2014ab_3,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))


%%created data files from the new fits files (giving the flux values) and the old wavelength values were created from the fits file header crval1 and cd1_1
%
%%new flux values
%floydstempfits20140408_1 = fitsread('Floydsdata_DS/14ab_20140408_redblu_130141.688.fits     ')
%floydstempfits20140409_1 = fitsread('Floydsdata_DS/14ab_20140409_redblu_130138.753a.fits     ')
%floydstempfits20140411_1 = fitsread('Floydsdata_DS/14ab_20140411_redblu_110654.037a.fits     ')
%floydstempfits20140507_1 = fitsread('Floydsdata_DS/PSN134805_20140507_redblu_091056.362a.fits')
%floydstempfits20140507_2 = fitsread('Floydsdata_DS/PSN134805_20140507_redblu_111119.119a.fits')
%floydstempfits20140507_3 = fitsread('Floydsdata_DS/PSN134805_20140507_redblu_115738.671a.fits')
%floydstempfits20140420_1 = fitsread('Floydsdata_DS/sn2014ab_20140420_redblu_135720.950a.fits ')
%floydstempfits20140423_1 = fitsread('Floydsdata_DS/sn2014ab_20140423_redblu_134720.890a.fits ')
%floydstempfits20140522_1 = fitsread('Floydsdata_DS/sn2014ab_20140522_redblu_080229.904a.fits ')
%
%d20140408_sn2014ab_1(2,:) = floydstempfits20140408_1(1,:,1);
%d20140409_sn2014ab_1(2,:) = floydstempfits20140409_1(1,:,1);
%d20140411_sn2014ab_1(2,:) = floydstempfits20140411_1(1,:,1);
%d20140507_sn2014ab_1(2,:) = floydstempfits20140507_1(1,:,1);
%d20140507_sn2014ab_2(2,:) = floydstempfits20140507_2(1,:,1);
%d20140507_sn2014ab_3(2,:) = floydstempfits20140507_3(1,:,1);
%d20140420_sn2014ab_1(2,:) = floydstempfits20140420_1(1,:,1);
%d20140423_sn2014ab_1(2,:) = floydstempfits20140423_1(1,:,1);
%d20140522_sn2014ab_1(2,:) = floydstempfits20140522_1(1,:,1);
%
%%new wavelength values calculation starts here
%crval1_20140408_1 = 3107.5048828125;
%crval1_20140409_1 = 3140.60504615307;
%crval1_20140411_1 = 3145.14919042587;
%crval1_20140507_1 = 3144.84145736694;
%crval1_20140507_2 = 3148.14156913757;
%crval1_20140507_3 = 3147.64153432846;
%crval1_20140420_1 = 3141.87324774265;
%crval1_20140423_1 = 3142.47344684601;
%crval1_20140522_1 = 3144.76488602161;
%
%cd1_1_20140408_1 = 1.7423885324257;
%cd1_1_20140409_1 = 1.74245774745941;
%cd1_1_20140411_1 = 1.73931443691254;
%cd1_1_20140507_1 = 1.74215233325958;
%cd1_1_20140507_2 = 1.74215602874756;
%cd1_1_20140507_3 = 1.74204325675964;
%cd1_1_20140420_1 = 1.73511326313019;
%cd1_1_20140423_1 = 1.73509073257446;
%cd1_1_20140522_1 = 1.7354828119278;
%
%size_20140408_1 = size(floydstempfits20140408_1(1,:,1),2);
%size_20140409_1 = size(floydstempfits20140409_1(1,:,1),2);
%size_20140411_1 = size(floydstempfits20140411_1(1,:,1),2);
%size_20140507_1 = size(floydstempfits20140507_1(1,:,1),2);
%size_20140507_2 = size(floydstempfits20140507_2(1,:,1),2);
%size_20140507_3 = size(floydstempfits20140507_3(1,:,1),2);
%size_20140420_1 = size(floydstempfits20140420_1(1,:,1),2);
%size_20140423_1 = size(floydstempfits20140423_1(1,:,1),2);
%size_20140522_1 = size(floydstempfits20140522_1(1,:,1),2);
%
%floydsmaxwav_20140408_1 = crval1_20140408_1+((size_20140408_1-1)*cd1_1_20140408_1)
%floydsmaxwav_20140409_1 = crval1_20140409_1+((size_20140409_1-1)*cd1_1_20140409_1)
%floydsmaxwav_20140411_1 = crval1_20140411_1+((size_20140411_1-1)*cd1_1_20140411_1)
%floydsmaxwav_20140507_1 = crval1_20140507_1+((size_20140507_1-1)*cd1_1_20140507_1)
%floydsmaxwav_20140507_2 = crval1_20140507_2+((size_20140507_2-1)*cd1_1_20140507_2)
%floydsmaxwav_20140507_3 = crval1_20140507_3+((size_20140507_3-1)*cd1_1_20140507_3)
%floydsmaxwav_20140420_1 = crval1_20140420_1+((size_20140420_1-1)*cd1_1_20140420_1)
%floydsmaxwav_20140423_1 = crval1_20140423_1+((size_20140423_1-1)*cd1_1_20140423_1)
%floydsmaxwav_20140522_1 = crval1_20140522_1+((size_20140522_1-1)*cd1_1_20140522_1)
%
%%new wavelength values constructed from header info
%d20140408_sn2014ab_1(1,:) = linspace(crval1_20140408_1,floydsmaxwav_20140408_1,size_20140408_1);
%d20140409_sn2014ab_1(1,:) = linspace(crval1_20140409_1,floydsmaxwav_20140409_1,size_20140409_1);
%d20140411_sn2014ab_1(1,:) = linspace(crval1_20140411_1,floydsmaxwav_20140411_1,size_20140411_1);
%d20140507_sn2014ab_1(1,:) = linspace(crval1_20140507_1,floydsmaxwav_20140507_1,size_20140507_1);
%d20140507_sn2014ab_2(1,:) = linspace(crval1_20140507_2,floydsmaxwav_20140507_2,size_20140507_2);
%d20140507_sn2014ab_3(1,:) = linspace(crval1_20140507_3,floydsmaxwav_20140507_3,size_20140507_3);
%d20140420_sn2014ab_1(1,:) = linspace(crval1_20140420_1,floydsmaxwav_20140420_1,size_20140420_1);
%d20140423_sn2014ab_1(1,:) = linspace(crval1_20140423_1,floydsmaxwav_20140423_1,size_20140423_1);
%d20140522_sn2014ab_1(1,:) = linspace(crval1_20140522_1,floydsmaxwav_20140522_1,size_20140522_1);








%%use the old wavelengths and the new flux values for the new floyds data
%d20140408_sn2014ab_1(2,:) = floydstempfits20140408_1(1,:,1);
%d20140409_sn2014ab_1(2,:) = floydstempfits20140409_1(1,:,1);
%d20140411_sn2014ab_1(2,:) = floydstempfits20140411_1(1,:,1);
%d20140507_sn2014ab_1(2,:) = floydstempfits20140507_1(1,:,1);
%d20140507_sn2014ab_2(2,:) = floydstempfits20140507_2(1,:,1);
%d20140507_sn2014ab_3(2,:) = floydstempfits20140507_3(1,:,1);
%d20140420_sn2014ab_1(2,:) = floydstempfits20140420_1(1,:,1);
%d20140423_sn2014ab_1(2,:) = floydstempfits20140423_1(1,:,1);
%d20140522_sn2014ab_1(2,:) = floydstempfits20140522_1(1,:,1);


%old wavelength values
%[floydstempwav20140408_1(1,:)  floydstempoldflux20140408_1(2,:)] =textread('Floydsdata_DS/old/14ab_20140408_redblu_130141.688.ascii     ','%f%f','delimiter',' ');
%[floydstempwav20140409_1(1,:)  floydstempoldflux20140409_1(2,:)] =textread('Floydsdata_DS/old/14ab_20140409_redblu_130138.753.ascii     ','%f%f','delimiter',' ');
%[floydstempwav20140411_1(1,:)  floydstempoldflux20140411_1(2,:)] =textread('Floydsdata_DS/old/14ab_20140411_redblu_110654.037.ascii     ','%f%f','delimiter',' ');
%[floydstempwav20140507_1(1,:)  floydstempoldflux20140507_1(2,:)] =textread('Floydsdata_DS/old/PSN134805_20140507_redblu_091056.362.ascii','%f%f','delimiter',' ');
%[floydstempwav20140507_2(1,:)  floydstempoldflux20140507_2(2,:)] =textread('Floydsdata_DS/old/PSN134805_20140507_redblu_111119.119.ascii','%f%f','delimiter',' ');
%[floydstempwav20140507_3(1,:)  floydstempoldflux20140507_3(2,:)] =textread('Floydsdata_DS/old/PSN134805_20140507_redblu_115738.671.ascii','%f%f','delimiter',' ');
%[floydstempwav20140420_1(1,:)  floydstempoldflux20140420_1(2,:)] =textread('Floydsdata_DS/old/sn2014ab_20140420_redblu_135720.950.ascii ','%f%f','delimiter',' ');
%[floydstempwav20140423_1(1,:)  floydstempoldflux20140423_1(2,:)] =textread('Floydsdata_DS/old/sn2014ab_20140423_redblu_134720.890.ascii ','%f%f','delimiter',' ');
%[floydstempwav20140522_1(1,:)  floydstempoldflux20140522_1(2,:)] =textread('Floydsdata_DS/old/sn2014ab_20140522_redblu_080229.904.ascii ','%f%f','delimiter',' ');




%old read in code for FLOYDS
%[d20140408_sn2014ab_1(1,:)  d20140408_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140408_redblu_130141.688.ascii     ','%f%f','delimiter',' ');
%[d20140409_sn2014ab_1(1,:)  d20140409_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140409_redblu_130138.753.ascii     ','%f%f','delimiter',' ');
%[d20140411_sn2014ab_1(1,:)  d20140411_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140411_redblu_110654.037.ascii     ','%f%f','delimiter',' ');
%[d20140507_sn2014ab_1(1,:)  d20140507_sn2014ab_1(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_091056.362.ascii','%f%f','delimiter',' ');
%[d20140507_sn2014ab_2(1,:)  d20140507_sn2014ab_2(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_111119.119.ascii','%f%f','delimiter',' ');
%[d20140507_sn2014ab_3(1,:)  d20140507_sn2014ab_3(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_115738.671.ascii','%f%f','delimiter',' ');
%[d20140420_sn2014ab_1(1,:)  d20140420_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140420_redblu_135720.950.ascii ','%f%f','delimiter',' ');
%[d20140423_sn2014ab_1(1,:)  d20140423_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140423_redblu_134720.890.ascii ','%f%f','delimiter',' ');
%[d20140522_sn2014ab_1(1,:)  d20140522_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140522_redblu_080229.904.ascii ','%f%f','delimiter',' ');



%%%
%%%%Halpha Velocity Plot with Offset
%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
%set(plotting,'Position',[0 0 0.9 1]);
%
%clf
%plot(velHalpha_offset_2_10140310(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[1 0.45 0])
%hold all
%plot(velHalpha_offset_2_10140324(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.8902 0.1020 0.1100])
%plot(velHalpha_offset_2_10140329(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.2 0.6275 0.1725])
%plot(velHalpha_offset_2_10140330(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.1216 0.4706 0.7059])
%plot(velHalpha_offset_2_10140331(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[1 0.4980 0])
%plot(velHalpha_offset_2_10140402(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.4157 0.2392 0.6039])
%plot(velHalpha_offset_2_10140426(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[1 1 0.6])
%plot(velHalpha_offset_2_10140427(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.6941 0.3490 0.1569])
%plot(velHalpha_offset_2_10140428(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.6510 0.8078 0.8902])
%plot(velHalpha_offset_2_10140430(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.6980 0.8745 0.5412])
%plot(velHalpha_offset_2_10140501(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.9843 0.6039 0.6])
%plot(velHalpha_offset_2_10140523(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.9922 0.7490 0.4353])
%plot(velHalpha_offset_2_10140524(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.7922 0.6980 0.8392])
%plot(velHalpha_offset_2_10140526(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0 0 0])
%plot(velHalpha_offset_2_10140528(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.4 0.4 0.4])
%plot(velHalpha_offset_2_10140621(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140622(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140623(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140624(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140626(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140630(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
%line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
%
%xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
%ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%%title('', 'FontSize',25)
%axis([[-8 8] [-0.5 10]])
%
%%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%%set(htext, 'Color',[0 0 0])
%%set(htext, 'FontSize',30)
%htext = text(-7,3.2,'H\alpha ')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
%ax1 = gca;
%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%ylabel(ax2,'','FontSize',32)
%%xlabel(ax2,'')
%%set(ax2,'xtick',[],'YTick',[])
%set(ax1,'FontSize',28)
%%set(ax2,'FontSize',28)
%set(ax1,'XMinorTick','on','YMinorTick','on')
%
%export_fig C:\Users\Sp0okydeath\Desktop\Figures\sn2014ab\HalphaVelocity_offset.pdf -pdf
%
%saveas(plotting, ['C:\Users\Sp0okydeath\Desktop\Figures\sn2014ab\HalphaVelocity_offset.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Sp0okydeath\Desktop\Figures\sn2014ab\HalphaVelocity_offset.eps']);
%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
%
%
%
%%%
































%%%

%clf
%plot(reldate,rightEWHalpha,'LineWidth',3,'Color',[1,0,0])
%errorbar(reldate,rightEWHalpha,rightdEWHalpha,'LineWidth',3,'Color',[1,0,0])
%hold all
%plot(reldate,leftEWHalpha,'LineWidth',3,'Color',[0,0,1])
%errorbar(reldate,leftEWHalpha,leftdEWHalpha,'LineWidth',3,'Color',[0,0,1])
%xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
%ylabel('Equivalent Width of H$\alpha$ ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%htext = text(10,265,'Redshifted Side','interpreter','latex','Color', [1,0,0],'FontSize',22)
%htext = text(10,480,'Blueshifted Side','interpreter','latex','Color', [0,0,1],'FontSize',22)
%
%saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\EQWlvsrHalpha.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\EQWlvsrHalpha.eps']);
%%%




%%%
%%truncate ugly data
%temp1 = d20140526_sn2014ab_2(1,:);
%temp2 = d20140526_sn2014ab_2(2,:);
%clear d20140526_sn2014ab_2;
%d20140526_sn2014ab_2(2,:) = temp2(find(temp1>5500));
%d20140526_sn2014ab_2(1,:) = temp1(find(temp1>5500));
%%%




%old light curve with no template subtraction
%[LCsn2014ab_B(1,:) LCsn2014ab_B(2,:) LCsn2014ab_B(3,:) LCsn2014ab_B(4,:) LCsn2014ab_B(5,:) LCsn2014ab_B(6,:)] =textread('lightcurveB_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');
%[LCsn2014ab_V(1,:) LCsn2014ab_V(2,:) LCsn2014ab_V(3,:) LCsn2014ab_V(4,:) LCsn2014ab_V(5,:) LCsn2014ab_V(6,:)] =textread('lightcurveV_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');
%[LCsn2014ab_R(1,:) LCsn2014ab_R(2,:) LCsn2014ab_R(3,:) LCsn2014ab_R(4,:) LCsn2014ab_R(5,:) LCsn2014ab_R(6,:)] =textread('lightcurveR_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');
%[LCsn2014ab_I(1,:) LCsn2014ab_I(2,:) LCsn2014ab_I(3,:) LCsn2014ab_I(4,:) LCsn2014ab_I(5,:) LCsn2014ab_I(6,:)] =textread('lightcurveI_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');

%convert to absolute magnitude and remove MW extinction
%absmagB_sn2014ab= LCsn2014ab_B(3,:)+redshiftdistancemodulus_2014ab-A_B_sn2014ab;
%absmagV_sn2014ab= LCsn2014ab_V(3,:)+redshiftdistancemodulus_2014ab-A_V_sn2014ab;
%absmagR_sn2014ab= LCsn2014ab_R(3,:)+redshiftdistancemodulus_2014ab-A_R_sn2014ab;
%absmagI_sn2014ab= LCsn2014ab_I(3,:)+redshiftdistancemodulus_2014ab-A_I_sn2014ab;
%
%magerrorB_sn2014ab= LCsn2014ab_B(3,:) - LCsn2014ab_B(4,:);
%magerrorV_sn2014ab= LCsn2014ab_V(3,:) - LCsn2014ab_V(4,:);
%magerrorR_sn2014ab= LCsn2014ab_R(3,:) - LCsn2014ab_R(4,:);
%magerrorI_sn2014ab= LCsn2014ab_I(3,:) - LCsn2014ab_I(4,:);
%
%LCreldateB_sn2014ab= LCsn2014ab_B(1,:) - discoverydatemjd;
%LCreldateV_sn2014ab= LCsn2014ab_V(1,:) - discoverydatemjd;
%LCreldateR_sn2014ab= LCsn2014ab_R(1,:) - discoverydatemjd;
%LCreldateI_sn2014ab= LCsn2014ab_I(1,:) - discoverydatemjd;






%don't use offsets
%offset_20140310 = d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(2,:) == max(d20140310_sn2014ab_1(2,find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140324 = d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(2,:) == max(d20140324_sn2014ab_1(2,find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140329 = d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(2,:) == max(d20140329_sn2014ab_1(2,find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140330 = d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(2,:) == max(d20140330_sn2014ab_1(2,find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140331 = d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(2,:) == max(d20140331_sn2014ab_1(2,find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140402 = d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(2,:) == max(d20140402_sn2014ab_1(2,find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140426 = d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(2,:) == max(d20140426_sn2014ab_1(2,find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140427 = d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(2,:) == max(d20140427_sn2014ab_1(2,find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140428 = d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(2,:) == max(d20140428_sn2014ab_1(2,find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140430 = d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(2,:) == max(d20140430_sn2014ab_1(2,find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140501 = d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(2,:) == max(d20140501_sn2014ab_1(2,find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140523 = d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(2,:) == max(d20140523_sn2014ab_1(2,find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140524 = d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(2,:) == max(d20140524_sn2014ab_1(2,find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140526 = d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(2,:) == max(d20140526_sn2014ab_1(2,find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140528 = d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(2,:) == max(d20140528_sn2014ab_1(2,find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140621 = d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(2,:) == max(d20140621_sn2014ab_1(2,find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140622 = d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(2,:) == max(d20140622_sn2014ab_1(2,find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140623 = d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(2,:) == max(d20140623_sn2014ab_1(2,find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140624 = d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(2,:) == max(d20140624_sn2014ab_1(2,find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140626 = d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(2,:) == max(d20140626_sn2014ab_1(2,find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140630 = d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(2,:) == max(d20140630_sn2014ab_1(2,find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963)))))-6562.81
%
%d20140310_sn2014ab_1(3,:) = d20140310_sn2014ab_1(1,:)-offset_20140310;
%d20140324_sn2014ab_1(3,:) = d20140324_sn2014ab_1(1,:)-offset_20140324;
%d20140329_sn2014ab_1(3,:) = d20140329_sn2014ab_1(1,:)-offset_20140329;
%d20140330_sn2014ab_1(3,:) = d20140330_sn2014ab_1(1,:)-offset_20140330;
%d20140331_sn2014ab_1(3,:) = d20140331_sn2014ab_1(1,:)-offset_20140331;
%d20140402_sn2014ab_1(3,:) = d20140402_sn2014ab_1(1,:)-offset_20140402;
%d20140426_sn2014ab_1(3,:) = d20140426_sn2014ab_1(1,:)-offset_20140426;
%d20140427_sn2014ab_1(3,:) = d20140427_sn2014ab_1(1,:)-offset_20140427;
%d20140428_sn2014ab_1(3,:) = d20140428_sn2014ab_1(1,:)-offset_20140428;
%d20140430_sn2014ab_1(3,:) = d20140430_sn2014ab_1(1,:)-offset_20140430;
%d20140501_sn2014ab_1(3,:) = d20140501_sn2014ab_1(1,:)-offset_20140501;
%d20140523_sn2014ab_1(3,:) = d20140523_sn2014ab_1(1,:)-offset_20140523;
%d20140524_sn2014ab_1(3,:) = d20140524_sn2014ab_1(1,:)-offset_20140524;
%d20140526_sn2014ab_1(3,:) = d20140526_sn2014ab_1(1,:)-offset_20140526;
%d20140528_sn2014ab_1(3,:) = d20140528_sn2014ab_1(1,:)-offset_20140528;
%d20140621_sn2014ab_1(3,:) = d20140621_sn2014ab_1(1,:)-offset_20140621;
%d20140622_sn2014ab_1(3,:) = d20140622_sn2014ab_1(1,:)-offset_20140622;
%d20140623_sn2014ab_1(3,:) = d20140623_sn2014ab_1(1,:)-offset_20140623;
%d20140624_sn2014ab_1(3,:) = d20140624_sn2014ab_1(1,:)-offset_20140624;
%d20140626_sn2014ab_1(3,:) = d20140626_sn2014ab_1(1,:)-offset_20140626;
%d20140630_sn2014ab_1(3,:) = d20140630_sn2014ab_1(1,:)-offset_20140630;








%flux_2014abVLT_ep78_part(1,:) = contscaled20140526_sn2014ab_2(2,:)
%flux_2014abVLT_ep78_part(2,:) = interp1(d20140526_sn2014ab_3(1,:),contscaled20140526_sn2014ab_3(2,:),d20140526_sn2014ab_2(1,:))
%flux_2014abVLT_ep78_part(3,:) = interp1(d20140526_sn2014ab_4(1,:),contscaled20140526_sn2014ab_4(2,:),d20140526_sn2014ab_2(1,:))
%
%flux_2014abVLT_ep78_part(1,:) = contscaled20140602_sn2014ab_1(2,:)
%flux_2014abVLT_ep78_part(2,:) = interp1(d20140602_sn2014ab_2(1,:),contscaled20140602_sn2014ab_2(2,:),d20140602_sn2014ab_1(1,:))
%flux_2014abVLT_ep78_part(3,:) = interp1(d20140602_sn2014ab_3(1,:),contscaled20140602_sn2014ab_3(2,:),d20140602_sn2014ab_1(1,:))





%measure EW on each side

leftEWHalpha(1)  = trapz(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:) >= 6312.81 & d20140310_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6312.81 & d20140310_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(2)  = trapz(d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(1,:) >= 6312.81 & d20140324_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6312.81 & d20140324_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(3)  = trapz(d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(1,:) >= 6312.81 & d20140329_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6312.81 & d20140329_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(4)  = trapz(d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(1,:) >= 6312.81 & d20140330_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6312.81 & d20140330_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(5)  = trapz(d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(1,:) >= 6312.81 & d20140331_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6312.81 & d20140331_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(6)  = trapz(d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(1,:) >= 6312.81 & d20140402_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6312.81 & d20140402_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(7)  = trapz(d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(1,:) >= 6312.81 & d20140426_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6312.81 & d20140426_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(8)  = trapz(d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(1,:) >= 6312.81 & d20140427_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6312.81 & d20140427_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(9)  = trapz(d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(1,:) >= 6312.81 & d20140428_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6312.81 & d20140428_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(10) = trapz(d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(1,:) >= 6312.81 & d20140430_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6312.81 & d20140430_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(11) = trapz(d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(1,:) >= 6312.81 & d20140501_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6312.81 & d20140501_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(12) = trapz(d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(1,:) >= 6312.81 & d20140523_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6312.81 & d20140523_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(13) = trapz(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:) >= 6312.81 & d20140524_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6312.81 & d20140524_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(14) = trapz(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:) >= 6312.81 & d20140526_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6312.81 & d20140526_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(15) = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= 6312.81 & d20140526_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6312.81 & d20140526_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(16) = trapz(d20140526_sn2014ab_3(1,find(d20140526_sn2014ab_3(1,:) >= 6312.81 & d20140526_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6312.81 & d20140526_sn2014ab_3(1,:) <= 6562.81)))
leftEWHalpha(17) = trapz(d20140526_sn2014ab_4(1,find(d20140526_sn2014ab_4(1,:) >= 6312.81 & d20140526_sn2014ab_4(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6312.81 & d20140526_sn2014ab_4(1,:) <= 6562.81)))
leftEWHalpha(18) = trapz(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:) >= 6312.81 & d20140528_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6312.81 & d20140528_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(19) = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= 6312.81 & d20140602_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6312.81 & d20140602_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(20) = trapz(d20140602_sn2014ab_2(1,find(d20140602_sn2014ab_2(1,:) >= 6312.81 & d20140602_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6312.81 & d20140602_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(21) = trapz(d20140602_sn2014ab_3(1,find(d20140602_sn2014ab_3(1,:) >= 6312.81 & d20140602_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6312.81 & d20140602_sn2014ab_3(1,:) <= 6562.81)))
leftEWHalpha(22) = trapz(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:) >= 6312.81 & d20140621_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6312.81 & d20140621_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(23) = trapz(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:) >= 6312.81 & d20140622_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6312.81 & d20140622_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(24) = trapz(d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(1,:) >= 6312.81 & d20140623_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6312.81 & d20140623_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(25) = trapz(d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(1,:) >= 6312.81 & d20140624_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6312.81 & d20140624_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(26) = trapz(d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(1,:) >= 6312.81 & d20140626_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6312.81 & d20140626_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(27) = trapz(d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(1,:) >= 6312.81 & d20140630_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6312.81 & d20140630_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(28) = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= 6312.81 & d20140722_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6312.81 & d20140722_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(29) = trapz(d20140722_sn2014ab_2(1,find(d20140722_sn2014ab_2(1,:) >= 6312.81 & d20140722_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6312.81 & d20140722_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(30) = trapz(d20140722_sn2014ab_3(1,find(d20140722_sn2014ab_3(1,:) >= 6312.81 & d20140722_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6312.81 & d20140722_sn2014ab_3(1,:) <= 6562.81)))
leftEWHalpha(31) = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= 6312.81 & d20140722_sn2014ab_4(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6312.81 & d20140722_sn2014ab_4(1,:) <= 6562.81)))
leftEWHalpha(32) = trapz(d20140722_sn2014ab_5(1,find(d20140722_sn2014ab_5(1,:) >= 6312.81 & d20140722_sn2014ab_5(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6312.81 & d20140722_sn2014ab_5(1,:) <= 6562.81)))
leftEWHalpha(33) = trapz(d20140722_sn2014ab_6(1,find(d20140722_sn2014ab_6(1,:) >= 6312.81 & d20140722_sn2014ab_6(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6312.81 & d20140722_sn2014ab_6(1,:) <= 6562.81)))
leftEWHalpha(34) = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= 6312.81 & d20140808_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6312.81 & d20140808_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(35) = trapz(d20140808_sn2014ab_2(1,find(d20140808_sn2014ab_2(1,:) >= 6312.81 & d20140808_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6312.81 & d20140808_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(36) = trapz(d20140808_sn2014ab_3(1,find(d20140808_sn2014ab_3(1,:) >= 6312.81 & d20140808_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6312.81 & d20140808_sn2014ab_3(1,:) <= 6562.81)))



leftNEWerr(1)  = 5*std(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6000 & d20140310_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(2)  = 5*std(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6000 & d20140324_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(3)  = 5*std(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6000 & d20140329_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(4)  = 5*std(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6000 & d20140330_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(5)  = 5*std(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6000 & d20140331_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(6)  = 5*std(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6000 & d20140402_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(7)  = 5*std(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6000 & d20140426_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(8)  = 5*std(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6000 & d20140427_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(9)  = 5*std(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6000 & d20140428_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(10) = 5*std(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6000 & d20140430_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(11) = 5*std(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6000 & d20140501_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(12) = 5*std(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6000 & d20140523_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(13) = 5*std(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6000 & d20140524_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(14) = 5*std(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6000 & d20140526_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(15) = 5*std(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6000 & d20140526_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(16) = 5*std(halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6000 & d20140526_sn2014ab_3(1,:) <= 6300)));
leftNEWerr(17) = 5*std(halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6000 & d20140526_sn2014ab_4(1,:) <= 6300)));
leftNEWerr(18) = 5*std(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6000 & d20140528_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(19) = 5*std(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6000 & d20140602_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(20) = 5*std(halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6000 & d20140602_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(21) = 5*std(halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6000 & d20140602_sn2014ab_3(1,:) <= 6300)));
leftNEWerr(22) = 5*std(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6000 & d20140621_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(23) = 5*std(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6000 & d20140622_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(24) = 5*std(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6000 & d20140623_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(25) = 5*std(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6000 & d20140624_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(26) = 5*std(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6000 & d20140626_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(27) = 5*std(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6000 & d20140630_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(28) = 5*std(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6000 & d20140722_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(29) = 5*std(halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6000 & d20140722_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(30) = 5*std(halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6000 & d20140722_sn2014ab_3(1,:) <= 6300)));
leftNEWerr(31) = 5*std(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6000 & d20140722_sn2014ab_4(1,:) <= 6300)));
leftNEWerr(32) = 5*std(halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6000 & d20140722_sn2014ab_5(1,:) <= 6300)));
leftNEWerr(33) = 5*std(halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6000 & d20140722_sn2014ab_6(1,:) <= 6300)));
leftNEWerr(34) = 5*std(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6000 & d20140808_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(35) = 5*std(halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6000 & d20140808_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(36) = 5*std(halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6000 & d20140808_sn2014ab_3(1,:) <= 6300)));



leftdEWHalpha(1)  = leftNEWerr(1)  * leftEWHalpha(1) ;
leftdEWHalpha(2)  = leftNEWerr(2)  * leftEWHalpha(2) ;
leftdEWHalpha(3)  = leftNEWerr(3)  * leftEWHalpha(3) ;
leftdEWHalpha(4)  = leftNEWerr(4)  * leftEWHalpha(4) ;
leftdEWHalpha(5)  = leftNEWerr(5)  * leftEWHalpha(5) ;
leftdEWHalpha(6)  = leftNEWerr(6)  * leftEWHalpha(6) ;
leftdEWHalpha(7)  = leftNEWerr(7)  * leftEWHalpha(7) ;
leftdEWHalpha(8)  = leftNEWerr(8)  * leftEWHalpha(8) ;
leftdEWHalpha(9)  = leftNEWerr(9)  * leftEWHalpha(9) ;
leftdEWHalpha(10) = leftNEWerr(10) * leftEWHalpha(10);
leftdEWHalpha(11) = leftNEWerr(11) * leftEWHalpha(11);
leftdEWHalpha(12) = leftNEWerr(12) * leftEWHalpha(12);
leftdEWHalpha(13) = leftNEWerr(13) * leftEWHalpha(13);
leftdEWHalpha(14) = leftNEWerr(14) * leftEWHalpha(14);
leftdEWHalpha(15) = leftNEWerr(15) * leftEWHalpha(15);
leftdEWHalpha(16) = leftNEWerr(16) * leftEWHalpha(16);
leftdEWHalpha(17) = leftNEWerr(17) * leftEWHalpha(17);
leftdEWHalpha(18) = leftNEWerr(18) * leftEWHalpha(18);
leftdEWHalpha(19) = leftNEWerr(19) * leftEWHalpha(19);
leftdEWHalpha(20) = leftNEWerr(20) * leftEWHalpha(20);
leftdEWHalpha(21) = leftNEWerr(21) * leftEWHalpha(21);
leftdEWHalpha(22) = leftNEWerr(22) * leftEWHalpha(22);
leftdEWHalpha(23) = leftNEWerr(23) * leftEWHalpha(23);
leftdEWHalpha(24) = leftNEWerr(24) * leftEWHalpha(24);
leftdEWHalpha(25) = leftNEWerr(25) * leftEWHalpha(25);
leftdEWHalpha(26) = leftNEWerr(26) * leftEWHalpha(26);
leftdEWHalpha(27) = leftNEWerr(27) * leftEWHalpha(27);
leftdEWHalpha(28) = leftNEWerr(28) * leftEWHalpha(28);
leftdEWHalpha(29) = leftNEWerr(29) * leftEWHalpha(29);
leftdEWHalpha(30) = leftNEWerr(30) * leftEWHalpha(30);
leftdEWHalpha(31) = leftNEWerr(31) * leftEWHalpha(31);
leftdEWHalpha(32) = leftNEWerr(32) * leftEWHalpha(32);
leftdEWHalpha(33) = leftNEWerr(33) * leftEWHalpha(33);
leftdEWHalpha(34) = leftNEWerr(34) * leftEWHalpha(34);
leftdEWHalpha(35) = leftNEWerr(35) * leftEWHalpha(35);
leftdEWHalpha(36) = leftNEWerr(36) * leftEWHalpha(36);

rightEWHalpha(1)  = trapz(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:) >= 6562.81 & d20140310_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6562.81 & d20140310_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(2)  = trapz(d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(1,:) >= 6562.81 & d20140324_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6562.81 & d20140324_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(3)  = trapz(d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(1,:) >= 6562.81 & d20140329_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6562.81 & d20140329_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(4)  = trapz(d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(1,:) >= 6562.81 & d20140330_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6562.81 & d20140330_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(5)  = trapz(d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(1,:) >= 6562.81 & d20140331_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6562.81 & d20140331_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(6)  = trapz(d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(1,:) >= 6562.81 & d20140402_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6562.81 & d20140402_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(7)  = trapz(d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(1,:) >= 6562.81 & d20140426_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6562.81 & d20140426_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(8)  = trapz(d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(1,:) >= 6562.81 & d20140427_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6562.81 & d20140427_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(9)  = trapz(d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(1,:) >= 6562.81 & d20140428_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6562.81 & d20140428_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(10) = trapz(d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(1,:) >= 6562.81 & d20140430_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6562.81 & d20140430_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(11) = trapz(d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(1,:) >= 6562.81 & d20140501_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6562.81 & d20140501_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(12) = trapz(d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(1,:) >= 6562.81 & d20140523_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6562.81 & d20140523_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(13) = trapz(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:) >= 6562.81 & d20140524_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6562.81 & d20140524_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(14) = trapz(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:) >= 6562.81 & d20140526_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6562.81 & d20140526_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(15) = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= 6562.81 & d20140526_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6562.81 & d20140526_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(16) = trapz(d20140526_sn2014ab_3(1,find(d20140526_sn2014ab_3(1,:) >= 6562.81 & d20140526_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6562.81 & d20140526_sn2014ab_3(1,:) <= 6812.81)))
rightEWHalpha(17) = trapz(d20140526_sn2014ab_4(1,find(d20140526_sn2014ab_4(1,:) >= 6562.81 & d20140526_sn2014ab_4(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6562.81 & d20140526_sn2014ab_4(1,:) <= 6812.81)))
rightEWHalpha(18) = trapz(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:) >= 6562.81 & d20140528_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6562.81 & d20140528_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(19) = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= 6562.81 & d20140602_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6562.81 & d20140602_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(20) = trapz(d20140602_sn2014ab_2(1,find(d20140602_sn2014ab_2(1,:) >= 6562.81 & d20140602_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6562.81 & d20140602_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(21) = trapz(d20140602_sn2014ab_3(1,find(d20140602_sn2014ab_3(1,:) >= 6562.81 & d20140602_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6562.81 & d20140602_sn2014ab_3(1,:) <= 6812.81)))
rightEWHalpha(22) = trapz(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:) >= 6562.81 & d20140621_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6562.81 & d20140621_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(23) = trapz(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:) >= 6562.81 & d20140622_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6562.81 & d20140622_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(24) = trapz(d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(1,:) >= 6562.81 & d20140623_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6562.81 & d20140623_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(25) = trapz(d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(1,:) >= 6562.81 & d20140624_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6562.81 & d20140624_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(26) = trapz(d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(1,:) >= 6562.81 & d20140626_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6562.81 & d20140626_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(27) = trapz(d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(1,:) >= 6562.81 & d20140630_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6562.81 & d20140630_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(28) = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= 6562.81 & d20140722_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6562.81 & d20140722_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(29) = trapz(d20140722_sn2014ab_2(1,find(d20140722_sn2014ab_2(1,:) >= 6562.81 & d20140722_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6562.81 & d20140722_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(30) = trapz(d20140722_sn2014ab_3(1,find(d20140722_sn2014ab_3(1,:) >= 6562.81 & d20140722_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6562.81 & d20140722_sn2014ab_3(1,:) <= 6812.81)))
rightEWHalpha(31) = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= 6562.81 & d20140722_sn2014ab_4(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6562.81 & d20140722_sn2014ab_4(1,:) <= 6812.81)))
rightEWHalpha(32) = trapz(d20140722_sn2014ab_5(1,find(d20140722_sn2014ab_5(1,:) >= 6562.81 & d20140722_sn2014ab_5(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6562.81 & d20140722_sn2014ab_5(1,:) <= 6812.81)))
rightEWHalpha(33) = trapz(d20140722_sn2014ab_6(1,find(d20140722_sn2014ab_6(1,:) >= 6562.81 & d20140722_sn2014ab_6(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6562.81 & d20140722_sn2014ab_6(1,:) <= 6812.81)))
rightEWHalpha(34) = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= 6562.81 & d20140808_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6562.81 & d20140808_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(35) = trapz(d20140808_sn2014ab_2(1,find(d20140808_sn2014ab_2(1,:) >= 6562.81 & d20140808_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6562.81 & d20140808_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(36) = trapz(d20140808_sn2014ab_3(1,find(d20140808_sn2014ab_3(1,:) >= 6562.81 & d20140808_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6562.81 & d20140808_sn2014ab_3(1,:) <= 6812.81)))


rightNEWerr(1)  = 5*std(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6000 & d20140310_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(2)  = 5*std(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6000 & d20140324_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(3)  = 5*std(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6000 & d20140329_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(4)  = 5*std(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6000 & d20140330_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(5)  = 5*std(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6000 & d20140331_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(6)  = 5*std(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6000 & d20140402_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(7)  = 5*std(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6000 & d20140426_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(8)  = 5*std(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6000 & d20140427_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(9)  = 5*std(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6000 & d20140428_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(10) = 5*std(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6000 & d20140430_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(11) = 5*std(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6000 & d20140501_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(12) = 5*std(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6000 & d20140523_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(13) = 5*std(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6000 & d20140524_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(14) = 5*std(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6000 & d20140526_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(15) = 5*std(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6000 & d20140526_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(16) = 5*std(halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6000 & d20140526_sn2014ab_3(1,:) <= 6300)));
rightNEWerr(17) = 5*std(halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6000 & d20140526_sn2014ab_4(1,:) <= 6300)));
rightNEWerr(18) = 5*std(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6000 & d20140528_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(19) = 5*std(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6000 & d20140602_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(20) = 5*std(halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6000 & d20140602_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(21) = 5*std(halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6000 & d20140602_sn2014ab_3(1,:) <= 6300)));
rightNEWerr(22) = 5*std(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6000 & d20140621_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(23) = 5*std(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6000 & d20140622_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(24) = 5*std(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6000 & d20140623_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(25) = 5*std(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6000 & d20140624_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(26) = 5*std(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6000 & d20140626_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(27) = 5*std(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6000 & d20140630_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(28) = 5*std(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6000 & d20140722_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(29) = 5*std(halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6000 & d20140722_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(30) = 5*std(halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6000 & d20140722_sn2014ab_3(1,:) <= 6300)));
rightNEWerr(31) = 5*std(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6000 & d20140722_sn2014ab_4(1,:) <= 6300)));
rightNEWerr(32) = 5*std(halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6000 & d20140722_sn2014ab_5(1,:) <= 6300)));
rightNEWerr(33) = 5*std(halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6000 & d20140722_sn2014ab_6(1,:) <= 6300)));
rightNEWerr(34) = 5*std(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6000 & d20140808_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(35) = 5*std(halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6000 & d20140808_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(36) = 5*std(halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6000 & d20140808_sn2014ab_3(1,:) <= 6300)));


rightdEWHalpha(1)  = rightNEWerr(1)  * rightEWHalpha(1) 
rightdEWHalpha(2)  = rightNEWerr(2)  * rightEWHalpha(2) 
rightdEWHalpha(3)  = rightNEWerr(3)  * rightEWHalpha(3) 
rightdEWHalpha(4)  = rightNEWerr(4)  * rightEWHalpha(4) 
rightdEWHalpha(5)  = rightNEWerr(5)  * rightEWHalpha(5) 
rightdEWHalpha(6)  = rightNEWerr(6)  * rightEWHalpha(6) 
rightdEWHalpha(7)  = rightNEWerr(7)  * rightEWHalpha(7) 
rightdEWHalpha(8)  = rightNEWerr(8)  * rightEWHalpha(8) 
rightdEWHalpha(9)  = rightNEWerr(9)  * rightEWHalpha(9) 
rightdEWHalpha(10) = rightNEWerr(10) * rightEWHalpha(10)
rightdEWHalpha(11) = rightNEWerr(11) * rightEWHalpha(11)
rightdEWHalpha(12) = rightNEWerr(12) * rightEWHalpha(12)
rightdEWHalpha(13) = rightNEWerr(13) * rightEWHalpha(13)
rightdEWHalpha(14) = rightNEWerr(14) * rightEWHalpha(14)
rightdEWHalpha(15) = rightNEWerr(15) * rightEWHalpha(15)
rightdEWHalpha(16) = rightNEWerr(16) * rightEWHalpha(16)
rightdEWHalpha(17) = rightNEWerr(17) * rightEWHalpha(17)
rightdEWHalpha(18) = rightNEWerr(18) * rightEWHalpha(18)
rightdEWHalpha(19) = rightNEWerr(19) * rightEWHalpha(19)
rightdEWHalpha(20) = rightNEWerr(20) * rightEWHalpha(20)
rightdEWHalpha(21) = rightNEWerr(21) * rightEWHalpha(21)
rightdEWHalpha(22) = rightNEWerr(22) * rightEWHalpha(22)
rightdEWHalpha(23) = rightNEWerr(23) * rightEWHalpha(23)
rightdEWHalpha(24) = rightNEWerr(24) * rightEWHalpha(24)
rightdEWHalpha(25) = rightNEWerr(25) * rightEWHalpha(25)
rightdEWHalpha(26) = rightNEWerr(26) * rightEWHalpha(26)
rightdEWHalpha(27) = rightNEWerr(27) * rightEWHalpha(27)
rightdEWHalpha(28) = rightNEWerr(28) * rightEWHalpha(28)
rightdEWHalpha(29) = rightNEWerr(29) * rightEWHalpha(29)
rightdEWHalpha(30) = rightNEWerr(30) * rightEWHalpha(30)
rightdEWHalpha(31) = rightNEWerr(31) * rightEWHalpha(31)
rightdEWHalpha(32) = rightNEWerr(32) * rightEWHalpha(32)
rightdEWHalpha(33) = rightNEWerr(33) * rightEWHalpha(33)
rightdEWHalpha(34) = rightNEWerr(34) * rightEWHalpha(34)
rightdEWHalpha(35) = rightNEWerr(35) * rightEWHalpha(35)
rightdEWHalpha(36) = rightNEWerr(36) * rightEWHalpha(36)






%set relative dates into one array
reldate(1)  = p20140310_sn2014ab_1(1,1)
reldate(2)  = p20140324_sn2014ab_1(1,1)
reldate(3)  = p20140329_sn2014ab_1(1,1)
reldate(4)  = p20140330_sn2014ab_1(1,1)
reldate(5)  = p20140331_sn2014ab_1(1,1)
reldate(6)  = p20140402_sn2014ab_1(1,1)
reldate(7)  = p20140426_sn2014ab_1(1,1)
reldate(8)  = p20140427_sn2014ab_1(1,1)
reldate(9)  = p20140428_sn2014ab_1(1,1)
reldate(10) = p20140430_sn2014ab_1(1,1)
reldate(11) = p20140501_sn2014ab_1(1,1)
reldate(12) = p20140523_sn2014ab_1(1,1)
reldate(13) = p20140524_sn2014ab_1(1,1)
reldate(14) = p20140526_sn2014ab_1(1,1)
reldate(15) = p20140526_sn2014ab_2(1,1)
reldate(16) = p20140526_sn2014ab_3(1,1)
reldate(17) = p20140526_sn2014ab_4(1,1)
reldate(18) = p20140528_sn2014ab_1(1,1)
reldate(19) = p20140602_sn2014ab_1(1,1)
reldate(20) = p20140602_sn2014ab_2(1,1)
reldate(21) = p20140602_sn2014ab_3(1,1)
reldate(22) = p20140621_sn2014ab_1(1,1)
reldate(23) = p20140622_sn2014ab_1(1,1)
reldate(24) = p20140623_sn2014ab_1(1,1)
reldate(25) = p20140624_sn2014ab_1(1,1)
reldate(26) = p20140626_sn2014ab_1(1,1)
reldate(27) = p20140630_sn2014ab_1(1,1)
reldate(28) = p20140722_sn2014ab_1(1,1)
reldate(29) = p20140722_sn2014ab_2(1,1)
reldate(30) = p20140722_sn2014ab_3(1,1)
reldate(31) = p20140722_sn2014ab_4(1,1)
reldate(32) = p20140722_sn2014ab_5(1,1)
reldate(33) = p20140722_sn2014ab_6(1,1)
reldate(34) = p20140808_sn2014ab_1(1,1)
reldate(35) = p20140808_sn2014ab_2(1,1)
reldate(36) = p20140808_sn2014ab_3(1,1)



%%Blackbody plot1
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf
semilogy(10^-8.*d20140310_sn2014ab_1(1,:),contscaled20140310_sn2014ab_1(2,:),'LineWidth',2,'Color',[1 0 0])
hold on
semilogy(wavetemp11,squeeze(bbodyfit11),'LineWidth',2,'Color',[0 0 0])
semilogy(wavetemp12,squeeze(bbodyfit12),'LineWidth',2,'Color',[0 0 0])
htext = text(7750*10^-8,1,num2str(bestT(1,:)),'interpreter','latex','FontName','CMU Serif');
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3000*10^-8 9150*10^-8] [0.01 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')
saveas(plotting, ['blackbody1.eps'], 'epsc');
eval(['!epstopdf blackbody1.eps']);


	
%%Blackbody plot2
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf
semilogy(10^-8.*d20140808_sn2014ab_3(1,:),contscaled20140808_sn2014ab_3(2,:),'LineWidth',2,'Color',[1 0 0])
hold on
semilogy(wavetemp21,squeeze(bbodyfit21),'LineWidth',2,'Color',[0 0 0])
semilogy(wavetemp22,squeeze(bbodyfit22),'LineWidth',2,'Color',[0 0 0])
htext = text(7750*10^-8,1,num2str(bestT(2,:)),'interpreter','latex','FontName','CMU Serif');
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3000*10^-8 9150*10^-8] [0.001 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')
saveas(plotting, ['blackbody2.eps'], 'epsc');
eval(['!epstopdf blackbody2.eps']);
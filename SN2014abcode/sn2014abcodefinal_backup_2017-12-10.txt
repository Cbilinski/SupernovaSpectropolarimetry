clear all
opengl software
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\altmany-export_fig-2763b78'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\useradded\append_pdfs'))
addpath(genpath('C:\Program Files\MATLAB\R2016b\toolbox\useradded\export_fig'))
plotting = figure;
set(gcf,'color','w');
set(plotting,'units','normalized','outerposition',[0 0 1 1]);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
set(gcf,'renderer','painters')
colormap jet


%define constants
%http://www.rochesterastronomy.org/sn2014/index.html
%http://ned.ipac.caltech.edu/cgi-bin/nph-objsearch?objname=UGC+8728&img_stamp=YES&extend=no&list_limit=9
z_sn2014ab= 0.023226;
discoverydatejd_sn2014ab= juliandate(2014,03,9.43);
jdtomjd=-2400000.5;
discoverydatemjd = discoverydatejd_sn2014ab+jdtomjd;
A_B_sn2014ab= 0.110;
A_V_sn2014ab= 0.083;
A_R_sn2014ab= 0.066;
A_I_sn2014ab= 0.045;
redshiftdistance_2014ab = 104.5; %in Mpc error 7.3
redshiftdistancemodulus_2014ab = -5*(log10(redshiftdistance_2014ab*10^6)-1);
%R.A. = 13:48:05.99, 
%Decl. = +07:23:16.4 





%read in data

%new light curve
[LCsn2014ab(1,:) LCsn2014ab(2,:) LCsn2014ab(3,:) LCsn2014ab(4,:) LCsn2014ab(5,:) LCsn2014ab(6,:) LCsn2014ab(7,:) LCsn2014ab(8,:) LCsn2014ab(9,:) LCsn2014ab(10,:) LCsn2014ab(11,:)] = textread('lightcurve_sn2014ab_nickel_standard_table_readable.dat','%f%f%f%f%f%f%f%f%f%f%f','delimiter',',');

for i=1:size(LCsn2014ab,1)
	for j=1:size(LCsn2014ab,2)
		if(LCsn2014ab(i,j) == 0)
			LCsn2014ab(i,j) = NaN;
		end
	end
end

%CSS light curve 
[LCCSSsn2014abunsort(1,:) LCCSSsn2014abunsort(2,:) LCCSSsn2014abunsort(3,:) LCCSSsn2014abunsort(4,:) LCCSSsn2014abunsort(5,:) LCCSSsn2014abunsort(6,:) LCCSSsn2014abunsort(7,:)] = textread('CSS2014abLightCurve_fromresultweb.txt','%f%f%f%f%f%f%f','delimiter',',');
[CSSsortdate, CSSsortdateindex] = sort(LCCSSsn2014abunsort(6,:));
for i=1:7
	LCCSSsn2014ab(i,:) = LCCSSsn2014abunsort(i,CSSsortdateindex);
end


%convert to absolute magnitude and remove MW extinction
absmagB_sn2014ab = LCsn2014ab(4,:) +redshiftdistancemodulus_2014ab-A_B_sn2014ab;
absmagV_sn2014ab = LCsn2014ab(6,:) +redshiftdistancemodulus_2014ab-A_V_sn2014ab;
absmagR_sn2014ab = LCsn2014ab(8,:) +redshiftdistancemodulus_2014ab-A_R_sn2014ab;
absmagI_sn2014ab = LCsn2014ab(10,:)+redshiftdistancemodulus_2014ab-A_I_sn2014ab;
absmagVCSS_sn2014ab = LCCSSsn2014ab(2,:)+redshiftdistancemodulus_2014ab-A_V_sn2014ab;


magerrorB_sn2014ab= LCsn2014ab(5,:);
magerrorV_sn2014ab= LCsn2014ab(7,:);
magerrorR_sn2014ab= LCsn2014ab(9,:);
magerrorI_sn2014ab= LCsn2014ab(11,:);
magerrorVCSS_sn2014ab = LCCSSsn2014ab(3,:);

LCreldateB_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCreldateV_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCreldateR_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCreldateI_sn2014ab= LCsn2014ab(2,:) - discoverydatemjd;
LCCSSreldateV_sn2014ab = LCCSSsn2014ab(6,:) - discoverydatemjd;


%spectra
%Magellan
[d20140519_sn2014ab_1(1,:)  d20140519_sn2014ab_1(2,:)] =textread('SN2014ab_IMACS_1200_2014-05-19.txt','%f%f','delimiter',' ');


%NTT
[d20140310_sn2014ab_1(1,:)  d20140310_sn2014ab_1(2,:)] =textread('PSJ13480599+0723164_20140309_Gr13_Free_slit1.0_57003_1.dat','%f%f','delimiter',' ');
[d20140310_sn2014ab_2(1,:)  d20140310_sn2014ab_2(2,:)] =textread('tPSJ13480599+0723164_20140309_Gr13_Free_slit1.0_1_f.asci','%f%f','delimiter',' ');

%Lick
[d20140324_sn2014ab_1(1,:)  d20140324_sn2014ab_1(2,:) d20140324_sn2014ab_1(3,:)] =textread('sn2014ab-20140324.533-ui.flm','%f%f%f','delimiter',' ');
[d20140430_sn2014ab_1(1,:)  d20140430_sn2014ab_1(2,:) d20140430_sn2014ab_1(3,:)] =textread('sn2014ab-20140430.405-ui.flm','%f%f%f','delimiter',' ');
[d20140528_sn2014ab_1(1,:)  d20140528_sn2014ab_1(2,:) d20140528_sn2014ab_1(3,:)] =textread('sn2014ab-20140528.350-ui.flm','%f%f%f','delimiter',' ');
[d20140621_sn2014ab_1(1,:)  d20140621_sn2014ab_1(2,:) d20140621_sn2014ab_1(3,:)] =textread('sn2014ab-20140621.267-ui.flm','%f%f%f','delimiter',' ');
[d20140630_sn2014ab_1(1,:)  d20140630_sn2014ab_1(2,:) d20140630_sn2014ab_1(3,:)] =textread('sn2014ab-20140630.275-ui.flm','%f%f%f','delimiter',' ');

%Floyds
[d20140408_sn2014ab_1(1,:)  d20140408_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140408_redblu_130141.688.ascii     ','%f%f','delimiter',' ');
[d20140409_sn2014ab_1(1,:)  d20140409_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140409_redblu_130138.753.ascii     ','%f%f','delimiter',' ');
[d20140411_sn2014ab_1(1,:)  d20140411_sn2014ab_1(2,:)] =textread('Floydsdata_DS/14ab_20140411_redblu_110654.037.ascii     ','%f%f','delimiter',' ');
[d20140507_sn2014ab_1(1,:)  d20140507_sn2014ab_1(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_091056.362.ascii','%f%f','delimiter',' ');
[d20140507_sn2014ab_2(1,:)  d20140507_sn2014ab_2(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_111119.119.ascii','%f%f','delimiter',' ');
[d20140507_sn2014ab_3(1,:)  d20140507_sn2014ab_3(2,:)] =textread('Floydsdata_DS/PSN134805_20140507_redblu_115738.671.ascii','%f%f','delimiter',' ');
[d20140420_sn2014ab_1(1,:)  d20140420_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140420_redblu_135720.950.ascii ','%f%f','delimiter',' ');
[d20140423_sn2014ab_1(1,:)  d20140423_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140423_redblu_134720.890.ascii ','%f%f','delimiter',' ');
[d20140522_sn2014ab_1(1,:)  d20140522_sn2014ab_1(2,:)] =textread('Floydsdata_DS/sn2014ab_20140522_redblu_080229.904.ascii ','%f%f','delimiter',' ');


d20140507datacell1 = {d20140507_sn2014ab_1(1,:) d20140507_sn2014ab_2(1,:) d20140507_sn2014ab_3(1,:)};
d20140507datacell2 = {d20140507_sn2014ab_1(2,:) d20140507_sn2014ab_2(2,:) d20140507_sn2014ab_3(2,:)};


[d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:)] = interpcombinedata(d20140507datacell1,d20140507datacell2);


clf
hold all
plot(d20140507_sn2014ab_1(1,:),d20140507_sn2014ab_1(2,:))
plot(d20140507_sn2014ab_2(1,:),d20140507_sn2014ab_2(2,:))
plot(d20140507_sn2014ab_3(1,:),d20140507_sn2014ab_3(2,:))
plot(d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:))





%VLT-X-Shooter
rawbt20140526_2 =  fitsread('ADP.2014-05-26T15_03_44.393.fits','binarytable');
rawbt20140526_3 =  fitsread('ADP.2014-05-26T15_03_44.407.fits','binarytable');
rawbt20140526_4 =  fitsread('ADP.2014-05-26T15_03_44.607.fits','binarytable');
rawbt20140602_1 =  fitsread('ADP.2014-06-02T12_54_50.840.fits','binarytable');
rawbt20140602_2 =  fitsread('ADP.2014-06-02T12_54_51.460.fits','binarytable');
rawbt20140602_3 =  fitsread('ADP.2014-06-02T12_54_51.513.fits','binarytable');
rawbt20140722_1 =  fitsread('ADP.2014-07-22T07_25_21.390.fits','binarytable');
rawbt20140722_2 =  fitsread('ADP.2014-07-22T07_25_21.403.fits','binarytable');
rawbt20140722_3 =  fitsread('ADP.2014-07-22T07_25_21.717.fits','binarytable');
rawbt20140722_4 =  fitsread('ADP.2014-07-22T07_35_01.203.fits','binarytable');
rawbt20140722_5 =  fitsread('ADP.2014-07-22T07_35_01.463.fits','binarytable');
rawbt20140722_6 =  fitsread('ADP.2014-07-22T07_35_01.713.fits','binarytable');
rawbt20140808_1 =  fitsread('ADP.2014-08-08T10_21_32.763.fits','binarytable');
rawbt20140808_2 =  fitsread('ADP.2014-08-08T10_21_32.777.fits','binarytable');
rawbt20140808_3 =  fitsread('ADP.2014-08-08T10_21_32.977.fits','binarytable');

d20140526_sn2014abtemp_2(1,:) = cell2mat(rawbt20140526_2(1)).*10;
d20140526_sn2014abtemp_3(1,:) = cell2mat(rawbt20140526_3(1)).*10;
d20140526_sn2014abtemp_4(1,:) = cell2mat(rawbt20140526_4(1)).*10;
d20140602_sn2014abtemp_1(1,:) = cell2mat(rawbt20140602_1(1)).*10;
d20140602_sn2014abtemp_2(1,:) = cell2mat(rawbt20140602_2(1)).*10;
d20140602_sn2014abtemp_3(1,:) = cell2mat(rawbt20140602_3(1)).*10;
d20140722_sn2014abtemp_1(1,:) = cell2mat(rawbt20140722_1(1)).*10;
d20140722_sn2014abtemp_2(1,:) = cell2mat(rawbt20140722_2(1)).*10;
d20140722_sn2014abtemp_3(1,:) = cell2mat(rawbt20140722_3(1)).*10;
d20140722_sn2014abtemp_4(1,:) = cell2mat(rawbt20140722_4(1)).*10;
d20140722_sn2014abtemp_5(1,:) = cell2mat(rawbt20140722_5(1)).*10;
d20140722_sn2014abtemp_6(1,:) = cell2mat(rawbt20140722_6(1)).*10;
d20140808_sn2014abtemp_1(1,:) = cell2mat(rawbt20140808_1(1)).*10;
d20140808_sn2014abtemp_2(1,:) = cell2mat(rawbt20140808_2(1)).*10;
d20140808_sn2014abtemp_3(1,:) = cell2mat(rawbt20140808_3(1)).*10;

d20140526_sn2014abtemp_2(2,:) = cell2mat(rawbt20140526_2(2));
d20140526_sn2014abtemp_3(2,:) = cell2mat(rawbt20140526_3(2));
d20140526_sn2014abtemp_4(2,:) = cell2mat(rawbt20140526_4(2));
d20140602_sn2014abtemp_1(2,:) = cell2mat(rawbt20140602_1(2));
d20140602_sn2014abtemp_2(2,:) = cell2mat(rawbt20140602_2(2));
d20140602_sn2014abtemp_3(2,:) = cell2mat(rawbt20140602_3(2));
d20140722_sn2014abtemp_1(2,:) = cell2mat(rawbt20140722_1(2));
d20140722_sn2014abtemp_2(2,:) = cell2mat(rawbt20140722_2(2));
d20140722_sn2014abtemp_3(2,:) = cell2mat(rawbt20140722_3(2));
d20140722_sn2014abtemp_4(2,:) = cell2mat(rawbt20140722_4(2));
d20140722_sn2014abtemp_5(2,:) = cell2mat(rawbt20140722_5(2));
d20140722_sn2014abtemp_6(2,:) = cell2mat(rawbt20140722_6(2));
d20140808_sn2014abtemp_1(2,:) = cell2mat(rawbt20140808_1(2));
d20140808_sn2014abtemp_2(2,:) = cell2mat(rawbt20140808_2(2));
d20140808_sn2014abtemp_3(2,:) = cell2mat(rawbt20140808_3(2));

%stitch together VLT X-Shooter data
d20140526_sn2014ab_2(1,:) = [d20140526_sn2014abtemp_3(1,:) d20140526_sn2014abtemp_2(1,(find(d20140526_sn2014abtemp_2(1,:) > max(d20140526_sn2014abtemp_3(1,:)),1,'first')):length(d20140526_sn2014abtemp_2)) d20140526_sn2014abtemp_4(1,(find(d20140526_sn2014abtemp_4(1,:) > max(d20140526_sn2014abtemp_2(1,:)),1,'first')):length(d20140526_sn2014abtemp_4))];
d20140526_sn2014ab_2(2,:) = [d20140526_sn2014abtemp_3(2,:) d20140526_sn2014abtemp_2(2,(find(d20140526_sn2014abtemp_2(1,:) > max(d20140526_sn2014abtemp_3(1,:)),1,'first')):length(d20140526_sn2014abtemp_2)) d20140526_sn2014abtemp_4(2,(find(d20140526_sn2014abtemp_4(1,:) > max(d20140526_sn2014abtemp_2(1,:)),1,'first')):length(d20140526_sn2014abtemp_4))];

d20140602_sn2014ab_1(1,:) = [d20140602_sn2014abtemp_1(1,:) d20140602_sn2014abtemp_3(1,(find(d20140602_sn2014abtemp_3(1,:) > max(d20140602_sn2014abtemp_1(1,:)),1,'first')):length(d20140602_sn2014abtemp_3)) d20140602_sn2014abtemp_2(1,(find(d20140602_sn2014abtemp_2(1,:) > max(d20140602_sn2014abtemp_3(1,:)),1,'first')):length(d20140602_sn2014abtemp_2))];
d20140602_sn2014ab_1(2,:) = [d20140602_sn2014abtemp_1(2,:) d20140602_sn2014abtemp_3(2,(find(d20140602_sn2014abtemp_3(1,:) > max(d20140602_sn2014abtemp_1(1,:)),1,'first')):length(d20140602_sn2014abtemp_3)) d20140602_sn2014abtemp_2(2,(find(d20140602_sn2014abtemp_2(1,:) > max(d20140602_sn2014abtemp_3(1,:)),1,'first')):length(d20140602_sn2014abtemp_2))];

%321
d20140722_sn2014ab_1(1,:) = [d20140722_sn2014abtemp_3(1,:) d20140722_sn2014abtemp_2(1,(find(d20140722_sn2014abtemp_2(1,:) > max(d20140722_sn2014abtemp_3(1,:)),1,'first')):length(d20140722_sn2014abtemp_2)) d20140722_sn2014abtemp_1(1,(find(d20140722_sn2014abtemp_1(1,:) > max(d20140722_sn2014abtemp_2(1,:)),1,'first')):length(d20140722_sn2014abtemp_1))];
d20140722_sn2014ab_1(2,:) = [d20140722_sn2014abtemp_3(2,:) d20140722_sn2014abtemp_2(2,(find(d20140722_sn2014abtemp_2(1,:) > max(d20140722_sn2014abtemp_3(1,:)),1,'first')):length(d20140722_sn2014abtemp_2)) d20140722_sn2014abtemp_1(2,(find(d20140722_sn2014abtemp_1(1,:) > max(d20140722_sn2014abtemp_2(1,:)),1,'first')):length(d20140722_sn2014abtemp_1))];

%465
d20140722_sn2014ab_4(1,:) = [d20140722_sn2014abtemp_4(1,:) d20140722_sn2014abtemp_6(1,(find(d20140722_sn2014abtemp_6(1,:) > max(d20140722_sn2014abtemp_4(1,:)),1,'first')):length(d20140722_sn2014abtemp_6)) d20140722_sn2014abtemp_5(1,(find(d20140722_sn2014abtemp_5(1,:) > max(d20140722_sn2014abtemp_6(1,:)),1,'first')):length(d20140722_sn2014abtemp_5))];
d20140722_sn2014ab_4(2,:) = [d20140722_sn2014abtemp_4(2,:) d20140722_sn2014abtemp_6(2,(find(d20140722_sn2014abtemp_6(1,:) > max(d20140722_sn2014abtemp_4(1,:)),1,'first')):length(d20140722_sn2014abtemp_6)) d20140722_sn2014abtemp_5(2,(find(d20140722_sn2014abtemp_5(1,:) > max(d20140722_sn2014abtemp_6(1,:)),1,'first')):length(d20140722_sn2014abtemp_5))];

d20140808_sn2014ab_1(1,:) = [d20140808_sn2014abtemp_2(1,:) d20140808_sn2014abtemp_3(1,(find(d20140808_sn2014abtemp_3(1,:) > max(d20140808_sn2014abtemp_2(1,:)),1,'first')):length(d20140808_sn2014abtemp_3)) d20140808_sn2014abtemp_1(1,(find(d20140808_sn2014abtemp_1(1,:) > max(d20140808_sn2014abtemp_3(1,:)),1,'first')):length(d20140808_sn2014abtemp_1))];
d20140808_sn2014ab_1(2,:) = [d20140808_sn2014abtemp_2(2,:) d20140808_sn2014abtemp_3(2,(find(d20140808_sn2014abtemp_3(1,:) > max(d20140808_sn2014abtemp_2(1,:)),1,'first')):length(d20140808_sn2014abtemp_3)) d20140808_sn2014abtemp_1(2,(find(d20140808_sn2014abtemp_1(1,:) > max(d20140808_sn2014abtemp_3(1,:)),1,'first')):length(d20140808_sn2014abtemp_1))];


%clf
%semilogy(d20140722_sn2014abtemp_4(1,:),d20140722_sn2014abtemp_4(2,:))
%hold on 
%semilogy(d20140722_sn2014abtemp_5(1,:),d20140722_sn2014abtemp_5(2,:))
%semilogy(d20140722_sn2014abtemp_6(1,:),d20140722_sn2014abtemp_6(2,:))


%spectropolarimetry
[d20140329_sn2014ab_1(1,:)  d20140329_sn2014ab_1(2,:)] =textread('20140329_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140329_sn2014ab_1(3,:)] =textread('20140329_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140329_sn2014ab_1(4,:)] =textread('20140329_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140329_sn2014ab_1(5,:)] =textread('20140329_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp d20140329_sn2014ab_1(6,:)] =textread('20140329_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140330_sn2014ab_1(1,:)  d20140330_sn2014ab_1(2,:)] =textread('20140330_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140330_sn2014ab_1(3,:)] =textread('20140330_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140330_sn2014ab_1(4,:)] =textread('20140330_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140331_sn2014ab_1(1,:)  d20140331_sn2014ab_1(2,:)] =textread('20140331_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140331_sn2014ab_1(3,:)] =textread('20140331_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140331_sn2014ab_1(4,:)] =textread('20140331_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140402_sn2014ab_1(1,:)  d20140402_sn2014ab_1(2,:)] =textread('20140402_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140402_sn2014ab_1(3,:)] =textread('20140402_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140402_sn2014ab_1(4,:)] =textread('20140402_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140426_sn2014ab_1(1,:)  d20140426_sn2014ab_1(2,:)] =textread('20140426_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140426_sn2014ab_1(3,:)] =textread('20140426_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140426_sn2014ab_1(4,:)] =textread('20140426_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140427_sn2014ab_1(1,:)  d20140427_sn2014ab_1(2,:)] =textread('20140427_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140427_sn2014ab_1(3,:)] =textread('20140427_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140427_sn2014ab_1(4,:)] =textread('20140427_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140428_sn2014ab_1(1,:)  d20140428_sn2014ab_1(2,:)] =textread('20140428_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140428_sn2014ab_1(3,:)] =textread('20140428_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140428_sn2014ab_1(4,:)] =textread('20140428_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140501_sn2014ab_1(1,:)  d20140501_sn2014ab_1(2,:)] =textread('20140501_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140501_sn2014ab_1(3,:)] =textread('20140501_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140501_sn2014ab_1(4,:)] =textread('20140501_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140501_sn2014ab_1(5,:)] =textread('20140501_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp d20140501_sn2014ab_1(6,:)] =textread('20140501_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140523_sn2014ab_1(1,:)  d20140523_sn2014ab_1(2,:)] =textread('20140523_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(3,:)] =textread('20140523_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(4,:)] =textread('20140523_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(5,:)] =textread('20140523_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp  d20140523_sn2014ab_1(6,:)] =textread('20140523_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140524_sn2014ab_1(1,:)  d20140524_sn2014ab_1(2,:)] =textread('20140524_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140524_sn2014ab_1(3,:)] =textread('20140524_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140524_sn2014ab_1(4,:)] =textread('20140524_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140526_sn2014ab_1(1,:)  d20140526_sn2014ab_1(2,:)] =textread('20140526_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140526_sn2014ab_1(3,:)] =textread('20140526_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140526_sn2014ab_1(4,:)] =textread('20140526_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140622_sn2014ab_1(1,:)  d20140622_sn2014ab_1(2,:)] =textread('20140622_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(3,:)] =textread('20140622_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(4,:)] =textread('20140622_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(5,:)] =textread('20140622_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp  d20140622_sn2014ab_1(6,:)] =textread('20140622_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140623_sn2014ab_1(1,:)  d20140623_sn2014ab_1(2,:)] =textread('20140623_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(3,:)] =textread('20140623_sn2014ab_1.q.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(4,:)] =textread('20140623_sn2014ab_1.u.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(5,:)] =textread('20140623_sn2014ab_2.q.txt','%f%f','delimiter',' ');
[temp  d20140623_sn2014ab_1(6,:)] =textread('20140623_sn2014ab_2.u.txt','%f%f','delimiter',' ');

[d20140624_sn2014ab_1(1,:)  d20140624_sn2014ab_1(2,:)] =textread('20140624_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140624_sn2014ab_1(3,:)] =textread('20140624_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140624_sn2014ab_1(4,:)] =textread('20140624_sn2014ab.u.txt','%f%f','delimiter',' ');

[d20140626_sn2014ab_1(1,:)  d20140626_sn2014ab_1(2,:)] =textread('20140626_sn2014ab.flxxx.txt','%f%f','delimiter',' ');
[temp  d20140626_sn2014ab_1(3,:)] =textread('20140626_sn2014ab.q.txt','%f%f','delimiter',' ');
[temp  d20140626_sn2014ab_1(4,:)] =textread('20140626_sn2014ab.u.txt','%f%f','delimiter',' ');


%OTHER SN DATA
%SN 2010jl
z_sn2010jl = 0.0107;

%Spectrum
[d_sn2010jl(1,:) d_sn2010jl(2,:) d_sn2010jl(3,:)] =textread('Hrenorm_sn2010jl-110406.dat','%f%f%f','delimiter',' ');
p_sn2010jl(1,:) = d_sn2010jl(1,:)./(1+z_sn2010jl);

%truncate ugly data
%temp1 = d20140526_sn2014ab_2(1,:);
%temp2 = d20140526_sn2014ab_2(2,:);
%clear d20140526_sn2014ab_2;
%d20140526_sn2014ab_2(2,:) = temp2(find(temp1>5500));
%d20140526_sn2014ab_2(1,:) = temp1(find(temp1>5500));
temp1 = d20140507_sn2014ab_4(1,1:4307);
temp2 = d20140507_sn2014ab_4(2,1:4307);
clear d20140507_sn2014ab_4
d20140507_sn2014ab_4(1,:) = temp1;
d20140507_sn2014ab_4(2,:) = temp2;


clear temp1 temp2;
temp1 = d20140519_sn2014ab_1(1,1:4088);
temp2 = d20140519_sn2014ab_1(2,1:4088);
clear d20140519_sn2014ab_1
d20140519_sn2014ab_1(1,:) = temp1;
d20140519_sn2014ab_1(2,:) = temp2;


clf
plot(d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:))




%calculate relative dates
p20140310_sn2014ab_1(1,1) = round(juliandate(2014,03,10) - discoverydatejd_sn2014ab)
p20140310_sn2014ab_2(1,1) = round(juliandate(2014,03,10) - discoverydatejd_sn2014ab)
p20140324_sn2014ab_1(1,1) = round(juliandate(2014,03,24) - discoverydatejd_sn2014ab)
p20140329_sn2014ab_1(1,1) = round(juliandate(2014,03,29) - discoverydatejd_sn2014ab)
p20140330_sn2014ab_1(1,1) = round(juliandate(2014,03,30) - discoverydatejd_sn2014ab)
p20140331_sn2014ab_1(1,1) = round(juliandate(2014,03,31) - discoverydatejd_sn2014ab)
p20140402_sn2014ab_1(1,1) = round(juliandate(2014,04,02) - discoverydatejd_sn2014ab)
p20140426_sn2014ab_1(1,1) = round(juliandate(2014,04,26) - discoverydatejd_sn2014ab)
p20140427_sn2014ab_1(1,1) = round(juliandate(2014,04,27) - discoverydatejd_sn2014ab)
p20140428_sn2014ab_1(1,1) = round(juliandate(2014,04,28) - discoverydatejd_sn2014ab)
p20140430_sn2014ab_1(1,1) = round(juliandate(2014,04,30) - discoverydatejd_sn2014ab)
p20140501_sn2014ab_1(1,1) = round(juliandate(2014,05,01) - discoverydatejd_sn2014ab)
p20140519_sn2014ab_1(1,1) = round(juliandate(2014,05,19) - discoverydatejd_sn2014ab)
p20140523_sn2014ab_1(1,1) = round(juliandate(2014,05,23) - discoverydatejd_sn2014ab)
p20140524_sn2014ab_1(1,1) = round(juliandate(2014,05,24) - discoverydatejd_sn2014ab)
p20140526_sn2014ab_1(1,1) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
p20140528_sn2014ab_1(1,1) = round(juliandate(2014,05,28) - discoverydatejd_sn2014ab)
p20140621_sn2014ab_1(1,1) = round(juliandate(2014,06,21) - discoverydatejd_sn2014ab)
p20140622_sn2014ab_1(1,1) = round(juliandate(2014,06,22) - discoverydatejd_sn2014ab)
p20140623_sn2014ab_1(1,1) = round(juliandate(2014,06,23) - discoverydatejd_sn2014ab)
p20140624_sn2014ab_1(1,1) = round(juliandate(2014,06,24) - discoverydatejd_sn2014ab)
p20140626_sn2014ab_1(1,1) = round(juliandate(2014,06,26) - discoverydatejd_sn2014ab)
p20140630_sn2014ab_1(1,1) = round(juliandate(2014,06,30) - discoverydatejd_sn2014ab)
p20140526_sn2014ab_2(1,:) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
%p20140526_sn2014ab_3(1,:) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
%p20140526_sn2014ab_4(1,:) = round(juliandate(2014,05,26) - discoverydatejd_sn2014ab)
p20140602_sn2014ab_1(1,:) = round(juliandate(2014,06,02) - discoverydatejd_sn2014ab)
%p20140602_sn2014ab_2(1,:) = round(juliandate(2014,06,02) - discoverydatejd_sn2014ab)
%p20140602_sn2014ab_3(1,:) = round(juliandate(2014,06,02) - discoverydatejd_sn2014ab)
p20140722_sn2014ab_1(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_2(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_3(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
p20140722_sn2014ab_4(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_5(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
%p20140722_sn2014ab_6(1,:) = round(juliandate(2014,07,22) - discoverydatejd_sn2014ab)
p20140808_sn2014ab_1(1,:) = round(juliandate(2014,08,08) - discoverydatejd_sn2014ab)
%p20140808_sn2014ab_2(1,:) = round(juliandate(2014,08,08) - discoverydatejd_sn2014ab)
%p20140808_sn2014ab_3(1,:) = round(juliandate(2014,08,08) - discoverydatejd_sn2014ab)
p20140408_sn2014ab_1(1,:) = round(juliandate(2014,04,08) - discoverydatejd_sn2014ab)
p20140409_sn2014ab_1(1,:) = round(juliandate(2014,04,09) - discoverydatejd_sn2014ab)
p20140411_sn2014ab_1(1,:) = round(juliandate(2014,04,11) - discoverydatejd_sn2014ab)
p20140507_sn2014ab_4(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
%p20140507_sn2014ab_1(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
%p20140507_sn2014ab_2(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
%p20140507_sn2014ab_3(1,:) = round(juliandate(2014,05,07) - discoverydatejd_sn2014ab)
p20140420_sn2014ab_1(1,:) = round(juliandate(2014,04,20) - discoverydatejd_sn2014ab)
p20140423_sn2014ab_1(1,:) = round(juliandate(2014,04,23) - discoverydatejd_sn2014ab)
p20140522_sn2014ab_1(1,:) = round(juliandate(2014,05,22) - discoverydatejd_sn2014ab)



%deredshift
d20140310_sn2014ab_1(1,:) = d20140310_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140310_sn2014ab_2(1,:) = d20140310_sn2014ab_2(1,:)/(1+z_sn2014ab);
d20140324_sn2014ab_1(1,:) = d20140324_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140329_sn2014ab_1(1,:) = d20140329_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140330_sn2014ab_1(1,:) = d20140330_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140331_sn2014ab_1(1,:) = d20140331_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140402_sn2014ab_1(1,:) = d20140402_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140426_sn2014ab_1(1,:) = d20140426_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140427_sn2014ab_1(1,:) = d20140427_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140428_sn2014ab_1(1,:) = d20140428_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140430_sn2014ab_1(1,:) = d20140430_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140501_sn2014ab_1(1,:) = d20140501_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140519_sn2014ab_1(1,:) = d20140519_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140523_sn2014ab_1(1,:) = d20140523_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140524_sn2014ab_1(1,:) = d20140524_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140526_sn2014ab_1(1,:) = d20140526_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140528_sn2014ab_1(1,:) = d20140528_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140621_sn2014ab_1(1,:) = d20140621_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140622_sn2014ab_1(1,:) = d20140622_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140623_sn2014ab_1(1,:) = d20140623_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140624_sn2014ab_1(1,:) = d20140624_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140626_sn2014ab_1(1,:) = d20140626_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140630_sn2014ab_1(1,:) = d20140630_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140526_sn2014ab_2(1,:) = d20140526_sn2014ab_2(1,:)/(1+z_sn2014ab);
%d20140526_sn2014ab_3(1,:) = d20140526_sn2014ab_3(1,:)/(1+z_sn2014ab);
%d20140526_sn2014ab_4(1,:) = d20140526_sn2014ab_4(1,:)/(1+z_sn2014ab);
d20140602_sn2014ab_1(1,:) = d20140602_sn2014ab_1(1,:)/(1+z_sn2014ab);
%d20140602_sn2014ab_2(1,:) = d20140602_sn2014ab_2(1,:)/(1+z_sn2014ab);
%d20140602_sn2014ab_3(1,:) = d20140602_sn2014ab_3(1,:)/(1+z_sn2014ab);
d20140722_sn2014ab_1(1,:) = d20140722_sn2014ab_1(1,:)/(1+z_sn2014ab);
%d20140722_sn2014ab_2(1,:) = d20140722_sn2014ab_2(1,:)/(1+z_sn2014ab);
%d20140722_sn2014ab_3(1,:) = d20140722_sn2014ab_3(1,:)/(1+z_sn2014ab);
d20140722_sn2014ab_4(1,:) = d20140722_sn2014ab_4(1,:)/(1+z_sn2014ab);
%d20140722_sn2014ab_5(1,:) = d20140722_sn2014ab_5(1,:)/(1+z_sn2014ab);
%d20140722_sn2014ab_6(1,:) = d20140722_sn2014ab_6(1,:)/(1+z_sn2014ab);
d20140808_sn2014ab_1(1,:) = d20140808_sn2014ab_1(1,:)/(1+z_sn2014ab);
%d20140808_sn2014ab_2(1,:) = d20140808_sn2014ab_2(1,:)/(1+z_sn2014ab);
%d20140808_sn2014ab_3(1,:) = d20140808_sn2014ab_3(1,:)/(1+z_sn2014ab);
d20140408_sn2014ab_1(1,:) = d20140408_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140409_sn2014ab_1(1,:) = d20140409_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140411_sn2014ab_1(1,:) = d20140411_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140507_sn2014ab_4(1,:) = d20140507_sn2014ab_4(1,:)/(1+z_sn2014ab);
%d20140507_sn2014ab_1(1,:) = d20140507_sn2014ab_1(1,:)/(1+z_sn2014ab);
%d20140507_sn2014ab_2(1,:) = d20140507_sn2014ab_2(1,:)/(1+z_sn2014ab);
%d20140507_sn2014ab_3(1,:) = d20140507_sn2014ab_3(1,:)/(1+z_sn2014ab);
d20140420_sn2014ab_1(1,:) = d20140420_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140423_sn2014ab_1(1,:) = d20140423_sn2014ab_1(1,:)/(1+z_sn2014ab);
d20140522_sn2014ab_1(1,:) = d20140522_sn2014ab_1(1,:)/(1+z_sn2014ab);







%deredden
d20140310_sn2014ab_1(2,:) = deredden(d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:),A_V_sn2014ab);
d20140310_sn2014ab_2(2,:) = deredden(d20140310_sn2014ab_2(1,:),d20140310_sn2014ab_2(2,:),A_V_sn2014ab);
d20140324_sn2014ab_1(2,:) = deredden(d20140324_sn2014ab_1(1,:),d20140324_sn2014ab_1(2,:),A_V_sn2014ab);
d20140329_sn2014ab_1(2,:) = deredden(d20140329_sn2014ab_1(1,:),d20140329_sn2014ab_1(2,:),A_V_sn2014ab);
d20140330_sn2014ab_1(2,:) = deredden(d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(2,:),A_V_sn2014ab);
d20140331_sn2014ab_1(2,:) = deredden(d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(2,:),A_V_sn2014ab);
d20140402_sn2014ab_1(2,:) = deredden(d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(2,:),A_V_sn2014ab);
d20140426_sn2014ab_1(2,:) = deredden(d20140426_sn2014ab_1(1,:),d20140426_sn2014ab_1(2,:),A_V_sn2014ab);
d20140427_sn2014ab_1(2,:) = deredden(d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(2,:),A_V_sn2014ab);
d20140428_sn2014ab_1(2,:) = deredden(d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(2,:),A_V_sn2014ab);
d20140430_sn2014ab_1(2,:) = deredden(d20140430_sn2014ab_1(1,:),d20140430_sn2014ab_1(2,:),A_V_sn2014ab);
d20140501_sn2014ab_1(2,:) = deredden(d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(2,:),A_V_sn2014ab);
d20140519_sn2014ab_1(2,:) = deredden(d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:),A_V_sn2014ab);
d20140523_sn2014ab_1(2,:) = deredden(d20140523_sn2014ab_1(1,:),d20140523_sn2014ab_1(2,:),A_V_sn2014ab);
d20140524_sn2014ab_1(2,:) = deredden(d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(2,:),A_V_sn2014ab);
d20140526_sn2014ab_1(2,:) = deredden(d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:),A_V_sn2014ab);
d20140528_sn2014ab_1(2,:) = deredden(d20140528_sn2014ab_1(1,:),d20140528_sn2014ab_1(2,:),A_V_sn2014ab);
d20140621_sn2014ab_1(2,:) = deredden(d20140621_sn2014ab_1(1,:),d20140621_sn2014ab_1(2,:),A_V_sn2014ab);
d20140622_sn2014ab_1(2,:) = deredden(d20140622_sn2014ab_1(1,:),d20140622_sn2014ab_1(2,:),A_V_sn2014ab);
d20140623_sn2014ab_1(2,:) = deredden(d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(2,:),A_V_sn2014ab);
d20140624_sn2014ab_1(2,:) = deredden(d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(2,:),A_V_sn2014ab);
d20140626_sn2014ab_1(2,:) = deredden(d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(2,:),A_V_sn2014ab);
d20140630_sn2014ab_1(2,:) = deredden(d20140630_sn2014ab_1(1,:),d20140630_sn2014ab_1(2,:),A_V_sn2014ab);
d20140526_sn2014ab_2(2,:) = deredden(d20140526_sn2014ab_2(1,:),d20140526_sn2014ab_2(2,:),A_V_sn2014ab);
%d20140526_sn2014ab_3(2,:) = deredden(d20140526_sn2014ab_3(1,:),d20140526_sn2014ab_3(2,:),A_V_sn2014ab);
%d20140526_sn2014ab_4(2,:) = deredden(d20140526_sn2014ab_4(1,:),d20140526_sn2014ab_4(2,:),A_V_sn2014ab);
d20140602_sn2014ab_1(2,:) = deredden(d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:),A_V_sn2014ab);
%d20140602_sn2014ab_2(2,:) = deredden(d20140602_sn2014ab_2(1,:),d20140602_sn2014ab_2(2,:),A_V_sn2014ab);
%d20140602_sn2014ab_3(2,:) = deredden(d20140602_sn2014ab_3(1,:),d20140602_sn2014ab_3(2,:),A_V_sn2014ab);
d20140722_sn2014ab_1(2,:) = deredden(d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:),A_V_sn2014ab);
%d20140722_sn2014ab_2(2,:) = deredden(d20140722_sn2014ab_2(1,:),d20140722_sn2014ab_2(2,:),A_V_sn2014ab);
%d20140722_sn2014ab_3(2,:) = deredden(d20140722_sn2014ab_3(1,:),d20140722_sn2014ab_3(2,:),A_V_sn2014ab);
d20140722_sn2014ab_4(2,:) = deredden(d20140722_sn2014ab_4(1,:),d20140722_sn2014ab_4(2,:),A_V_sn2014ab);
%d20140722_sn2014ab_5(2,:) = deredden(d20140722_sn2014ab_5(1,:),d20140722_sn2014ab_5(2,:),A_V_sn2014ab);
%d20140722_sn2014ab_6(2,:) = deredden(d20140722_sn2014ab_6(1,:),d20140722_sn2014ab_6(2,:),A_V_sn2014ab);
d20140808_sn2014ab_1(2,:) = deredden(d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:),A_V_sn2014ab);
%d20140808_sn2014ab_2(2,:) = deredden(d20140808_sn2014ab_2(1,:),d20140808_sn2014ab_2(2,:),A_V_sn2014ab);
%d20140808_sn2014ab_3(2,:) = deredden(d20140808_sn2014ab_3(1,:),d20140808_sn2014ab_3(2,:),A_V_sn2014ab);
d20140408_sn2014ab_1(2,:) = deredden(d20140408_sn2014ab_1(1,:),d20140408_sn2014ab_1(2,:),A_V_sn2014ab);
d20140409_sn2014ab_1(2,:) = deredden(d20140409_sn2014ab_1(1,:),d20140409_sn2014ab_1(2,:),A_V_sn2014ab);
d20140411_sn2014ab_1(2,:) = deredden(d20140411_sn2014ab_1(1,:),d20140411_sn2014ab_1(2,:),A_V_sn2014ab);
d20140507_sn2014ab_4(2,:) = deredden(d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:),A_V_sn2014ab);
%d20140507_sn2014ab_1(2,:) = deredden(d20140507_sn2014ab_1(1,:),d20140507_sn2014ab_1(2,:),A_V_sn2014ab);
%d20140507_sn2014ab_2(2,:) = deredden(d20140507_sn2014ab_2(1,:),d20140507_sn2014ab_2(2,:),A_V_sn2014ab);
%d20140507_sn2014ab_3(2,:) = deredden(d20140507_sn2014ab_3(1,:),d20140507_sn2014ab_3(2,:),A_V_sn2014ab);
d20140420_sn2014ab_1(2,:) = deredden(d20140420_sn2014ab_1(1,:),d20140420_sn2014ab_1(2,:),A_V_sn2014ab);
d20140423_sn2014ab_1(2,:) = deredden(d20140423_sn2014ab_1(1,:),d20140423_sn2014ab_1(2,:),A_V_sn2014ab);
d20140522_sn2014ab_1(2,:) = deredden(d20140522_sn2014ab_1(1,:),d20140522_sn2014ab_1(2,:),A_V_sn2014ab);



%d20140408_sn2014ab_1(1,:)
%d20140409_sn2014ab_1(1,:)
%d20140411_sn2014ab_1(1,:)
%d20140507_sn2014ab_1(1,:)
%d20140507_sn2014ab_2(1,:)
%d20140507_sn2014ab_3(1,:)
%d20140420_sn2014ab_1(1,:)
%d20140423_sn2014ab_1(1,:)
%d20140522_sn2014ab_1(1,:)



%find min and max wavelengths for table

wavelengthfile = fopen('spectralwavelengths.txt','w');
fprintf(wavelengthfile,'%5.0f',d20140310_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140310_sn2014ab_1(1,length(d20140310_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140324_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140324_sn2014ab_1(1,length(d20140324_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140329_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140329_sn2014ab_1(1,length(d20140329_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140330_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140330_sn2014ab_1(1,length(d20140330_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140331_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140331_sn2014ab_1(1,length(d20140331_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140402_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140402_sn2014ab_1(1,length(d20140402_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140408_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140408_sn2014ab_1(1,length(d20140408_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140409_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140409_sn2014ab_1(1,length(d20140409_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140411_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140411_sn2014ab_1(1,length(d20140411_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140420_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140420_sn2014ab_1(1,length(d20140420_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140423_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140423_sn2014ab_1(1,length(d20140423_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140426_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140426_sn2014ab_1(1,length(d20140426_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140427_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140427_sn2014ab_1(1,length(d20140427_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140428_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140428_sn2014ab_1(1,length(d20140428_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140430_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140430_sn2014ab_1(1,length(d20140430_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140501_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140501_sn2014ab_1(1,length(d20140501_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_1(1,length(d20140507_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_2(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_2(1,length(d20140507_sn2014ab_2(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_3(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140507_sn2014ab_3(1,length(d20140507_sn2014ab_3(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140519_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140519_sn2014ab_1(1,length(d20140519_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140522_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140522_sn2014ab_1(1,length(d20140522_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140523_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140523_sn2014ab_1(1,length(d20140523_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140524_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140524_sn2014ab_1(1,length(d20140524_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_1(1,length(d20140526_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_2(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140526_sn2014ab_2(1,length(d20140526_sn2014ab_2(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140528_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140528_sn2014ab_1(1,length(d20140528_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140602_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140602_sn2014ab_1(1,length(d20140602_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140621_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140621_sn2014ab_1(1,length(d20140621_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140622_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140622_sn2014ab_1(1,length(d20140622_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140623_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140623_sn2014ab_1(1,length(d20140623_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140624_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140624_sn2014ab_1(1,length(d20140624_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140626_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140626_sn2014ab_1(1,length(d20140626_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140630_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140630_sn2014ab_1(1,length(d20140630_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140722_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140722_sn2014ab_1(1,length(d20140722_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fprintf(wavelengthfile,'%5.0f',d20140808_sn2014ab_1(1,1))
fprintf(wavelengthfile,'-')
fprintf(wavelengthfile,'%5.0f',d20140808_sn2014ab_1(1,length(d20140808_sn2014ab_1(1,:))))
fprintf(wavelengthfile,'\n')
fclose(wavelengthfile);



%maxvaluecontscaling
contscaled20140310_sn2014ab_1(2,:) = d20140310_sn2014ab_1(2,:)/max(d20140310_sn2014ab_1(2,:));
%contscaled20140310_sn2014ab_2(2,:) = d20140310_sn2014ab_2(2,:)/max(d20140310_sn2014ab_2(2,:));
contscaled20140324_sn2014ab_1(2,:) = d20140324_sn2014ab_1(2,:)/max(d20140324_sn2014ab_1(2,:));
contscaled20140329_sn2014ab_1(2,:) = d20140329_sn2014ab_1(2,:)/max(d20140329_sn2014ab_1(2,:));
contscaled20140330_sn2014ab_1(2,:) = d20140330_sn2014ab_1(2,:)/max(d20140330_sn2014ab_1(2,:));
contscaled20140331_sn2014ab_1(2,:) = d20140331_sn2014ab_1(2,:)/max(d20140331_sn2014ab_1(2,:));
contscaled20140402_sn2014ab_1(2,:) = d20140402_sn2014ab_1(2,:)/max(d20140402_sn2014ab_1(2,:));
contscaled20140426_sn2014ab_1(2,:) = d20140426_sn2014ab_1(2,:)/max(d20140426_sn2014ab_1(2,:));
contscaled20140427_sn2014ab_1(2,:) = d20140427_sn2014ab_1(2,:)/max(d20140427_sn2014ab_1(2,:));
contscaled20140428_sn2014ab_1(2,:) = d20140428_sn2014ab_1(2,:)/max(d20140428_sn2014ab_1(2,:));
contscaled20140430_sn2014ab_1(2,:) = d20140430_sn2014ab_1(2,:)/max(d20140430_sn2014ab_1(2,:));
contscaled20140501_sn2014ab_1(2,:) = d20140501_sn2014ab_1(2,:)/max(d20140501_sn2014ab_1(2,:));
contscaled20140519_sn2014ab_1(2,:) = d20140519_sn2014ab_1(2,:)/max(d20140519_sn2014ab_1(2,:));
contscaled20140523_sn2014ab_1(2,:) = d20140523_sn2014ab_1(2,:)/max(d20140523_sn2014ab_1(2,:));
contscaled20140524_sn2014ab_1(2,:) = d20140524_sn2014ab_1(2,:)/max(d20140524_sn2014ab_1(2,:));
contscaled20140526_sn2014ab_1(2,:) = d20140526_sn2014ab_1(2,:)/max(d20140526_sn2014ab_1(2,:));
contscaled20140528_sn2014ab_1(2,:) = d20140528_sn2014ab_1(2,:)/max(d20140528_sn2014ab_1(2,:));
contscaled20140621_sn2014ab_1(2,:) = d20140621_sn2014ab_1(2,:)/max(d20140621_sn2014ab_1(2,:));
contscaled20140622_sn2014ab_1(2,:) = d20140622_sn2014ab_1(2,:)/max(d20140622_sn2014ab_1(2,:));
contscaled20140623_sn2014ab_1(2,:) = d20140623_sn2014ab_1(2,:)/max(d20140623_sn2014ab_1(2,:));
contscaled20140624_sn2014ab_1(2,:) = d20140624_sn2014ab_1(2,:)/max(d20140624_sn2014ab_1(2,:));
contscaled20140626_sn2014ab_1(2,:) = d20140626_sn2014ab_1(2,:)/max(d20140626_sn2014ab_1(2,:));
contscaled20140630_sn2014ab_1(2,:) = d20140630_sn2014ab_1(2,:)/max(d20140630_sn2014ab_1(2,:));
contscaled20140526_sn2014ab_2(2,:) = d20140526_sn2014ab_2(2,:)/max(d20140526_sn2014ab_2(2,:));
%contscaled20140526_sn2014ab_3(2,:) = d20140526_sn2014ab_3(2,:)/max(d20140526_sn2014ab_3(2,:));
%contscaled20140526_sn2014ab_4(2,:) = d20140526_sn2014ab_4(2,:)/max(d20140526_sn2014ab_4(2,:));
contscaled20140602_sn2014ab_1(2,:) = d20140602_sn2014ab_1(2,:)/max(d20140602_sn2014ab_1(2,:));
%contscaled20140602_sn2014ab_2(2,:) = d20140602_sn2014ab_2(2,:)/max(d20140602_sn2014ab_2(2,:));
%contscaled20140602_sn2014ab_3(2,:) = d20140602_sn2014ab_3(2,:)/max(d20140602_sn2014ab_3(2,:));
contscaled20140722_sn2014ab_1(2,:) = d20140722_sn2014ab_1(2,:)/max(d20140722_sn2014ab_1(2,:));
%contscaled20140722_sn2014ab_2(2,:) = d20140722_sn2014ab_2(2,:)/max(d20140722_sn2014ab_2(2,:));
%contscaled20140722_sn2014ab_3(2,:) = d20140722_sn2014ab_3(2,:)/max(d20140722_sn2014ab_3(2,:));
contscaled20140722_sn2014ab_4(2,:) = d20140722_sn2014ab_4(2,:)/max(d20140722_sn2014ab_4(2,:));
%contscaled20140722_sn2014ab_5(2,:) = d20140722_sn2014ab_5(2,:)/max(d20140722_sn2014ab_5(2,:));
%contscaled20140722_sn2014ab_6(2,:) = d20140722_sn2014ab_6(2,:)/max(d20140722_sn2014ab_6(2,:));
contscaled20140808_sn2014ab_1(2,:) = d20140808_sn2014ab_1(2,:)/max(d20140808_sn2014ab_1(2,:));
%contscaled20140808_sn2014ab_2(2,:) = d20140808_sn2014ab_2(2,:)/max(d20140808_sn2014ab_2(2,:));
%contscaled20140808_sn2014ab_3(2,:) = d20140808_sn2014ab_3(2,:)/max(d20140808_sn2014ab_3(2,:));
contscaled20140408_sn2014ab_1(2,:) = d20140408_sn2014ab_1(2,:)./max(d20140408_sn2014ab_1(2,:));
contscaled20140409_sn2014ab_1(2,:) = d20140409_sn2014ab_1(2,:)./max(d20140409_sn2014ab_1(2,:));
contscaled20140411_sn2014ab_1(2,:) = d20140411_sn2014ab_1(2,:)./max(d20140411_sn2014ab_1(2,:));
contscaled20140507_sn2014ab_4(2,:) = d20140507_sn2014ab_4(2,:)./max(d20140507_sn2014ab_4(2,:));
%contscaled20140507_sn2014ab_1(2,:) = d20140507_sn2014ab_1(2,:)./max(d20140507_sn2014ab_1(2,:));
%contscaled20140507_sn2014ab_2(2,:) = d20140507_sn2014ab_2(2,:)./max(d20140507_sn2014ab_2(2,:));
%contscaled20140507_sn2014ab_3(2,:) = d20140507_sn2014ab_3(2,:)./max(d20140507_sn2014ab_3(2,:));
contscaled20140420_sn2014ab_1(2,:) = d20140420_sn2014ab_1(2,:)./max(d20140420_sn2014ab_1(2,:));
contscaled20140423_sn2014ab_1(2,:) = d20140423_sn2014ab_1(2,:)./max(d20140423_sn2014ab_1(2,:));
contscaled20140522_sn2014ab_1(2,:) = d20140522_sn2014ab_1(2,:)./max(d20140522_sn2014ab_1(2,:));








%various continuum fitting regions
%halpha continuum
halphafit20140310_sn2014ab_1= fit(d20140310_sn2014ab_1(1,[find(d20140310_sn2014ab_1(1,:)>6000,3,'first') find(d20140310_sn2014ab_1(1,:)<7125,3,'last')])',d20140310_sn2014ab_1(2,[find(d20140310_sn2014ab_1(1,:)>6000,3,'first') find(d20140310_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140310_sn2014ab_1= mean(halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,(d20140310_sn2014ab_1(1,:)>6462.8 & d20140310_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140310_sn2014ab_1= d20140310_sn2014ab_1(2,:)/halphanormconstant20140310_sn2014ab_1;
halphavarscaledsub20140310_sn2014ab_1= (d20140310_sn2014ab_1(2,:) - halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,:))')./halphafit20140310_sn2014ab_1(d20140310_sn2014ab_1(1,:))';

halphafit20140324_sn2014ab_1= fit(d20140324_sn2014ab_1(1,[find(d20140324_sn2014ab_1(1,:)>6000,3,'first') find(d20140324_sn2014ab_1(1,:)<7125,3,'last')])',d20140324_sn2014ab_1(2,[find(d20140324_sn2014ab_1(1,:)>6000,3,'first') find(d20140324_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140324_sn2014ab_1= mean(halphafit20140324_sn2014ab_1(d20140324_sn2014ab_1(1,(d20140324_sn2014ab_1(1,:)>6462.8 & d20140324_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140324_sn2014ab_1= d20140324_sn2014ab_1(2,:)/halphanormconstant20140324_sn2014ab_1;
halphavarscaledsub20140324_sn2014ab_1= (d20140324_sn2014ab_1(2,:) - halphafit20140324_sn2014ab_1(d20140324_sn2014ab_1(1,:))')./halphafit20140324_sn2014ab_1(d20140324_sn2014ab_1(1,:))';

halphafit20140329_sn2014ab_1= fit(d20140329_sn2014ab_1(1,[find(d20140329_sn2014ab_1(1,:)>6000,3,'first') find(d20140329_sn2014ab_1(1,:)<7125,3,'last')])',d20140329_sn2014ab_1(2,[find(d20140329_sn2014ab_1(1,:)>6000,3,'first') find(d20140329_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140329_sn2014ab_1= mean(halphafit20140329_sn2014ab_1(d20140329_sn2014ab_1(1,(d20140329_sn2014ab_1(1,:)>6462.8 & d20140329_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140329_sn2014ab_1= d20140329_sn2014ab_1(2,:)/halphanormconstant20140329_sn2014ab_1;
halphavarscaledsub20140329_sn2014ab_1= (d20140329_sn2014ab_1(2,:) - halphafit20140329_sn2014ab_1(d20140329_sn2014ab_1(1,:))')./halphafit20140329_sn2014ab_1(d20140329_sn2014ab_1(1,:))';

halphafit20140330_sn2014ab_1= fit(d20140330_sn2014ab_1(1,[find(d20140330_sn2014ab_1(1,:)>6000,3,'first') find(d20140330_sn2014ab_1(1,:)<7125,3,'last')])',d20140330_sn2014ab_1(2,[find(d20140330_sn2014ab_1(1,:)>6000,3,'first') find(d20140330_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140330_sn2014ab_1= mean(halphafit20140330_sn2014ab_1(d20140330_sn2014ab_1(1,(d20140330_sn2014ab_1(1,:)>6462.8 & d20140330_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140330_sn2014ab_1= d20140330_sn2014ab_1(2,:)/halphanormconstant20140330_sn2014ab_1;
halphavarscaledsub20140330_sn2014ab_1= (d20140330_sn2014ab_1(2,:) - halphafit20140330_sn2014ab_1(d20140330_sn2014ab_1(1,:))')./halphafit20140330_sn2014ab_1(d20140330_sn2014ab_1(1,:))';

halphafit20140331_sn2014ab_1= fit(d20140331_sn2014ab_1(1,[find(d20140331_sn2014ab_1(1,:)>6000,3,'first') find(d20140331_sn2014ab_1(1,:)<7125,3,'last')])',d20140331_sn2014ab_1(2,[find(d20140331_sn2014ab_1(1,:)>6000,3,'first') find(d20140331_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140331_sn2014ab_1= mean(halphafit20140331_sn2014ab_1(d20140331_sn2014ab_1(1,(d20140331_sn2014ab_1(1,:)>6462.8 & d20140331_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140331_sn2014ab_1= d20140331_sn2014ab_1(2,:)/halphanormconstant20140331_sn2014ab_1;
halphavarscaledsub20140331_sn2014ab_1= (d20140331_sn2014ab_1(2,:) - halphafit20140331_sn2014ab_1(d20140331_sn2014ab_1(1,:))')./halphafit20140331_sn2014ab_1(d20140331_sn2014ab_1(1,:))';

halphafit20140402_sn2014ab_1= fit(d20140402_sn2014ab_1(1,[find(d20140402_sn2014ab_1(1,:)>6000,3,'first') find(d20140402_sn2014ab_1(1,:)<7125,3,'last')])',d20140402_sn2014ab_1(2,[find(d20140402_sn2014ab_1(1,:)>6000,3,'first') find(d20140402_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140402_sn2014ab_1= mean(halphafit20140402_sn2014ab_1(d20140402_sn2014ab_1(1,(d20140402_sn2014ab_1(1,:)>6462.8 & d20140402_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140402_sn2014ab_1= d20140402_sn2014ab_1(2,:)/halphanormconstant20140402_sn2014ab_1;
halphavarscaledsub20140402_sn2014ab_1= (d20140402_sn2014ab_1(2,:) - halphafit20140402_sn2014ab_1(d20140402_sn2014ab_1(1,:))')./halphafit20140402_sn2014ab_1(d20140402_sn2014ab_1(1,:))';

halphafit20140426_sn2014ab_1= fit(d20140426_sn2014ab_1(1,[find(d20140426_sn2014ab_1(1,:)>6000,3,'first') find(d20140426_sn2014ab_1(1,:)<7125,3,'last')])',d20140426_sn2014ab_1(2,[find(d20140426_sn2014ab_1(1,:)>6000,3,'first') find(d20140426_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140426_sn2014ab_1= mean(halphafit20140426_sn2014ab_1(d20140426_sn2014ab_1(1,(d20140426_sn2014ab_1(1,:)>6462.8 & d20140426_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140426_sn2014ab_1= d20140426_sn2014ab_1(2,:)/halphanormconstant20140426_sn2014ab_1;
halphavarscaledsub20140426_sn2014ab_1= (d20140426_sn2014ab_1(2,:) - halphafit20140426_sn2014ab_1(d20140426_sn2014ab_1(1,:))')./halphafit20140426_sn2014ab_1(d20140426_sn2014ab_1(1,:))';

halphafit20140427_sn2014ab_1= fit(d20140427_sn2014ab_1(1,[find(d20140427_sn2014ab_1(1,:)>6000,3,'first') find(d20140427_sn2014ab_1(1,:)<7125,3,'last')])',d20140427_sn2014ab_1(2,[find(d20140427_sn2014ab_1(1,:)>6000,3,'first') find(d20140427_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140427_sn2014ab_1= mean(halphafit20140427_sn2014ab_1(d20140427_sn2014ab_1(1,(d20140427_sn2014ab_1(1,:)>6462.8 & d20140427_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140427_sn2014ab_1= d20140427_sn2014ab_1(2,:)/halphanormconstant20140427_sn2014ab_1;
halphavarscaledsub20140427_sn2014ab_1= (d20140427_sn2014ab_1(2,:) - halphafit20140427_sn2014ab_1(d20140427_sn2014ab_1(1,:))')./halphafit20140427_sn2014ab_1(d20140427_sn2014ab_1(1,:))';

halphafit20140428_sn2014ab_1= fit(d20140428_sn2014ab_1(1,[find(d20140428_sn2014ab_1(1,:)>6000,3,'first') find(d20140428_sn2014ab_1(1,:)<7125,3,'last')])',d20140428_sn2014ab_1(2,[find(d20140428_sn2014ab_1(1,:)>6000,3,'first') find(d20140428_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140428_sn2014ab_1= mean(halphafit20140428_sn2014ab_1(d20140428_sn2014ab_1(1,(d20140428_sn2014ab_1(1,:)>6462.8 & d20140428_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140428_sn2014ab_1= d20140428_sn2014ab_1(2,:)/halphanormconstant20140428_sn2014ab_1;
halphavarscaledsub20140428_sn2014ab_1= (d20140428_sn2014ab_1(2,:) - halphafit20140428_sn2014ab_1(d20140428_sn2014ab_1(1,:))')./halphafit20140428_sn2014ab_1(d20140428_sn2014ab_1(1,:))';

halphafit20140430_sn2014ab_1= fit(d20140430_sn2014ab_1(1,[find(d20140430_sn2014ab_1(1,:)>6000,3,'first') find(d20140430_sn2014ab_1(1,:)<7125,3,'last')])',d20140430_sn2014ab_1(2,[find(d20140430_sn2014ab_1(1,:)>6000,3,'first') find(d20140430_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140430_sn2014ab_1= mean(halphafit20140430_sn2014ab_1(d20140430_sn2014ab_1(1,(d20140430_sn2014ab_1(1,:)>6462.8 & d20140430_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140430_sn2014ab_1= d20140430_sn2014ab_1(2,:)/halphanormconstant20140430_sn2014ab_1;
halphavarscaledsub20140430_sn2014ab_1= (d20140430_sn2014ab_1(2,:) - halphafit20140430_sn2014ab_1(d20140430_sn2014ab_1(1,:))')./halphafit20140430_sn2014ab_1(d20140430_sn2014ab_1(1,:))';

halphafit20140501_sn2014ab_1= fit(d20140501_sn2014ab_1(1,[find(d20140501_sn2014ab_1(1,:)>6000,3,'first') find(d20140501_sn2014ab_1(1,:)<7125,3,'last')])',d20140501_sn2014ab_1(2,[find(d20140501_sn2014ab_1(1,:)>6000,3,'first') find(d20140501_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140501_sn2014ab_1= mean(halphafit20140501_sn2014ab_1(d20140501_sn2014ab_1(1,(d20140501_sn2014ab_1(1,:)>6462.8 & d20140501_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140501_sn2014ab_1= d20140501_sn2014ab_1(2,:)/halphanormconstant20140501_sn2014ab_1;
halphavarscaledsub20140501_sn2014ab_1= (d20140501_sn2014ab_1(2,:) - halphafit20140501_sn2014ab_1(d20140501_sn2014ab_1(1,:))')./halphafit20140501_sn2014ab_1(d20140501_sn2014ab_1(1,:))';

halphafit20140519_sn2014ab_1= fit(d20140519_sn2014ab_1(1,[find(d20140519_sn2014ab_1(1,:)>6000,3,'first') find(d20140519_sn2014ab_1(1,:)<7125,3,'last')])',d20140519_sn2014ab_1(2,[find(d20140519_sn2014ab_1(1,:)>6000,3,'first') find(d20140519_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140519_sn2014ab_1= mean(halphafit20140519_sn2014ab_1(d20140519_sn2014ab_1(1,(d20140519_sn2014ab_1(1,:)>6462.8 & d20140519_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140519_sn2014ab_1= d20140519_sn2014ab_1(2,:)/halphanormconstant20140519_sn2014ab_1;
halphavarscaledsub20140519_sn2014ab_1= (d20140519_sn2014ab_1(2,:) - halphafit20140519_sn2014ab_1(d20140519_sn2014ab_1(1,:))')./halphafit20140519_sn2014ab_1(d20140519_sn2014ab_1(1,:))';

halphafit20140523_sn2014ab_1= fit(d20140523_sn2014ab_1(1,[find(d20140523_sn2014ab_1(1,:)>6000,3,'first') find(d20140523_sn2014ab_1(1,:)<7125,3,'last')])',d20140523_sn2014ab_1(2,[find(d20140523_sn2014ab_1(1,:)>6000,3,'first') find(d20140523_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140523_sn2014ab_1= mean(halphafit20140523_sn2014ab_1(d20140523_sn2014ab_1(1,(d20140523_sn2014ab_1(1,:)>6462.8 & d20140523_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140523_sn2014ab_1= d20140523_sn2014ab_1(2,:)/halphanormconstant20140523_sn2014ab_1;
halphavarscaledsub20140523_sn2014ab_1= (d20140523_sn2014ab_1(2,:) - halphafit20140523_sn2014ab_1(d20140523_sn2014ab_1(1,:))')./halphafit20140523_sn2014ab_1(d20140523_sn2014ab_1(1,:))';

halphafit20140524_sn2014ab_1= fit(d20140524_sn2014ab_1(1,[find(d20140524_sn2014ab_1(1,:)>6000,3,'first') find(d20140524_sn2014ab_1(1,:)<7125,3,'last')])',d20140524_sn2014ab_1(2,[find(d20140524_sn2014ab_1(1,:)>6000,3,'first') find(d20140524_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140524_sn2014ab_1= mean(halphafit20140524_sn2014ab_1(d20140524_sn2014ab_1(1,(d20140524_sn2014ab_1(1,:)>6462.8 & d20140524_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140524_sn2014ab_1= d20140524_sn2014ab_1(2,:)/halphanormconstant20140524_sn2014ab_1;
halphavarscaledsub20140524_sn2014ab_1= (d20140524_sn2014ab_1(2,:) - halphafit20140524_sn2014ab_1(d20140524_sn2014ab_1(1,:))')./halphafit20140524_sn2014ab_1(d20140524_sn2014ab_1(1,:))';


halphafit20140526_sn2014ab_1= fit(d20140526_sn2014ab_1(1,[find(d20140526_sn2014ab_1(1,:)>6000,3,'first') find(d20140526_sn2014ab_1(1,:)<7125,3,'last')])',d20140526_sn2014ab_1(2,[find(d20140526_sn2014ab_1(1,:)>6000,3,'first') find(d20140526_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140526_sn2014ab_1= mean(halphafit20140526_sn2014ab_1(d20140526_sn2014ab_1(1,(d20140526_sn2014ab_1(1,:)>6462.8 & d20140526_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140526_sn2014ab_1= d20140526_sn2014ab_1(2,:)/halphanormconstant20140526_sn2014ab_1;
halphavarscaledsub20140526_sn2014ab_1= (d20140526_sn2014ab_1(2,:) - halphafit20140526_sn2014ab_1(d20140526_sn2014ab_1(1,:))')./halphafit20140526_sn2014ab_1(d20140526_sn2014ab_1(1,:))';


halphafit20140528_sn2014ab_1= fit(d20140528_sn2014ab_1(1,[find(d20140528_sn2014ab_1(1,:)>6000,3,'first') find(d20140528_sn2014ab_1(1,:)<7125,3,'last')])',d20140528_sn2014ab_1(2,[find(d20140528_sn2014ab_1(1,:)>6000,3,'first') find(d20140528_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140528_sn2014ab_1= mean(halphafit20140528_sn2014ab_1(d20140528_sn2014ab_1(1,(d20140528_sn2014ab_1(1,:)>6462.8 & d20140528_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140528_sn2014ab_1= d20140528_sn2014ab_1(2,:)/halphanormconstant20140528_sn2014ab_1;
halphavarscaledsub20140528_sn2014ab_1= (d20140528_sn2014ab_1(2,:) - halphafit20140528_sn2014ab_1(d20140528_sn2014ab_1(1,:))')./halphafit20140528_sn2014ab_1(d20140528_sn2014ab_1(1,:))';


halphafit20140621_sn2014ab_1= fit(d20140621_sn2014ab_1(1,[find(d20140621_sn2014ab_1(1,:)>6000,3,'first') find(d20140621_sn2014ab_1(1,:)<7125,3,'last')])',d20140621_sn2014ab_1(2,[find(d20140621_sn2014ab_1(1,:)>6000,3,'first') find(d20140621_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140621_sn2014ab_1= mean(halphafit20140621_sn2014ab_1(d20140621_sn2014ab_1(1,(d20140621_sn2014ab_1(1,:)>6462.8 & d20140621_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140621_sn2014ab_1= d20140621_sn2014ab_1(2,:)/halphanormconstant20140621_sn2014ab_1;
halphavarscaledsub20140621_sn2014ab_1= (d20140621_sn2014ab_1(2,:) - halphafit20140621_sn2014ab_1(d20140621_sn2014ab_1(1,:))')./halphafit20140621_sn2014ab_1(d20140621_sn2014ab_1(1,:))';

halphafit20140622_sn2014ab_1= fit(d20140622_sn2014ab_1(1,[find(d20140622_sn2014ab_1(1,:)>6000,3,'first') find(d20140622_sn2014ab_1(1,:)<7125,3,'last')])',d20140622_sn2014ab_1(2,[find(d20140622_sn2014ab_1(1,:)>6000,3,'first') find(d20140622_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140622_sn2014ab_1= mean(halphafit20140622_sn2014ab_1(d20140622_sn2014ab_1(1,(d20140622_sn2014ab_1(1,:)>6462.8 & d20140622_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140622_sn2014ab_1= d20140622_sn2014ab_1(2,:)/halphanormconstant20140622_sn2014ab_1;
halphavarscaledsub20140622_sn2014ab_1= (d20140622_sn2014ab_1(2,:) - halphafit20140622_sn2014ab_1(d20140622_sn2014ab_1(1,:))')./halphafit20140622_sn2014ab_1(d20140622_sn2014ab_1(1,:))';

halphafit20140623_sn2014ab_1= fit(d20140623_sn2014ab_1(1,[find(d20140623_sn2014ab_1(1,:)>6000,3,'first') find(d20140623_sn2014ab_1(1,:)<7125,3,'last')])',d20140623_sn2014ab_1(2,[find(d20140623_sn2014ab_1(1,:)>6000,3,'first') find(d20140623_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140623_sn2014ab_1= mean(halphafit20140623_sn2014ab_1(d20140623_sn2014ab_1(1,(d20140623_sn2014ab_1(1,:)>6462.8 & d20140623_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140623_sn2014ab_1= d20140623_sn2014ab_1(2,:)/halphanormconstant20140623_sn2014ab_1;
halphavarscaledsub20140623_sn2014ab_1= (d20140623_sn2014ab_1(2,:) - halphafit20140623_sn2014ab_1(d20140623_sn2014ab_1(1,:))')./halphafit20140623_sn2014ab_1(d20140623_sn2014ab_1(1,:))';

halphafit20140624_sn2014ab_1= fit(d20140624_sn2014ab_1(1,[find(d20140624_sn2014ab_1(1,:)>6000,3,'first') find(d20140624_sn2014ab_1(1,:)<7125,3,'last')])',d20140624_sn2014ab_1(2,[find(d20140624_sn2014ab_1(1,:)>6000,3,'first') find(d20140624_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140624_sn2014ab_1= mean(halphafit20140624_sn2014ab_1(d20140624_sn2014ab_1(1,(d20140624_sn2014ab_1(1,:)>6462.8 & d20140624_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140624_sn2014ab_1= d20140624_sn2014ab_1(2,:)/halphanormconstant20140624_sn2014ab_1;
halphavarscaledsub20140624_sn2014ab_1= (d20140624_sn2014ab_1(2,:) - halphafit20140624_sn2014ab_1(d20140624_sn2014ab_1(1,:))')./halphafit20140624_sn2014ab_1(d20140624_sn2014ab_1(1,:))';


halphafit20140626_sn2014ab_1= fit(d20140626_sn2014ab_1(1,[find(d20140626_sn2014ab_1(1,:)>6000,3,'first') find(d20140626_sn2014ab_1(1,:)<7125,3,'last')])',d20140626_sn2014ab_1(2,[find(d20140626_sn2014ab_1(1,:)>6000,3,'first') find(d20140626_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140626_sn2014ab_1= mean(halphafit20140626_sn2014ab_1(d20140626_sn2014ab_1(1,(d20140626_sn2014ab_1(1,:)>6462.8 & d20140626_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140626_sn2014ab_1= d20140626_sn2014ab_1(2,:)/halphanormconstant20140626_sn2014ab_1;
halphavarscaledsub20140626_sn2014ab_1= (d20140626_sn2014ab_1(2,:) - halphafit20140626_sn2014ab_1(d20140626_sn2014ab_1(1,:))')./halphafit20140626_sn2014ab_1(d20140626_sn2014ab_1(1,:))';

halphafit20140630_sn2014ab_1= fit(d20140630_sn2014ab_1(1,[find(d20140630_sn2014ab_1(1,:)>6000,3,'first') find(d20140630_sn2014ab_1(1,:)<7125,3,'last')])',d20140630_sn2014ab_1(2,[find(d20140630_sn2014ab_1(1,:)>6000,3,'first') find(d20140630_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140630_sn2014ab_1= mean(halphafit20140630_sn2014ab_1(d20140630_sn2014ab_1(1,(d20140630_sn2014ab_1(1,:)>6462.8 & d20140630_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140630_sn2014ab_1= d20140630_sn2014ab_1(2,:)/halphanormconstant20140630_sn2014ab_1;
halphavarscaledsub20140630_sn2014ab_1= (d20140630_sn2014ab_1(2,:) - halphafit20140630_sn2014ab_1(d20140630_sn2014ab_1(1,:))')./halphafit20140630_sn2014ab_1(d20140630_sn2014ab_1(1,:))';


halphafit20140526_sn2014ab_2= fit(d20140526_sn2014ab_2(1,[find(d20140526_sn2014ab_2(1,:)>6000,3,'first') find(d20140526_sn2014ab_2(1,:)<7125,3,'last')])',d20140526_sn2014ab_2(2,[find(d20140526_sn2014ab_2(1,:)>6000,3,'first') find(d20140526_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140526_sn2014ab_2= mean(halphafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,(d20140526_sn2014ab_2(1,:)>6462.8 & d20140526_sn2014ab_2(1,:)<6662.8))));
halphauniscaled20140526_sn2014ab_2= d20140526_sn2014ab_2(2,:)/halphanormconstant20140526_sn2014ab_2;
halphavarscaledsub20140526_sn2014ab_2= (d20140526_sn2014ab_2(2,:) - halphafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))')./halphafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))';

%halphafit20140526_sn2014ab_3= fit(d20140526_sn2014ab_3(1,[find(d20140526_sn2014ab_3(1,:)>6000,3,'first') find(d20140526_sn2014ab_3(1,:)<7125,3,'last')])',d20140526_sn2014ab_3(2,[find(d20140526_sn2014ab_3(1,:)>6000,3,'first') find(d20140526_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140526_sn2014ab_3= mean(halphafit20140526_sn2014ab_3(d20140526_sn2014ab_3(1,(d20140526_sn2014ab_3(1,:)>6462.8 & d20140526_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140526_sn2014ab_3= d20140526_sn2014ab_3(2,:)/halphanormconstant20140526_sn2014ab_3;
%halphavarscaledsub20140526_sn2014ab_3= (d20140526_sn2014ab_3(2,:) - halphafit20140526_sn2014ab_3(d20140526_sn2014ab_3(1,:))')./halphafit20140526_sn2014ab_3(d20140526_sn2014ab_3(1,:))';

%halphafit20140526_sn2014ab_4= fit(d20140526_sn2014ab_4(1,[find(d20140526_sn2014ab_4(1,:)>6000,3,'first') find(d20140526_sn2014ab_4(1,:)<7125,3,'last')])',d20140526_sn2014ab_4(2,[find(d20140526_sn2014ab_4(1,:)>6000,3,'first') find(d20140526_sn2014ab_4(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140526_sn2014ab_4= mean(halphafit20140526_sn2014ab_4(d20140526_sn2014ab_4(1,(d20140526_sn2014ab_4(1,:)>6462.8 & d20140526_sn2014ab_4(1,:)<6662.8))));
%halphauniscaled20140526_sn2014ab_4= d20140526_sn2014ab_4(2,:)/halphanormconstant20140526_sn2014ab_4;
%halphavarscaledsub20140526_sn2014ab_4= (d20140526_sn2014ab_4(2,:) - halphafit20140526_sn2014ab_4(d20140526_sn2014ab_4(1,:))')./halphafit20140526_sn2014ab_4(d20140526_sn2014ab_4(1,:))';


halphafit20140602_sn2014ab_1= fit(d20140602_sn2014ab_1(1,[find(d20140602_sn2014ab_1(1,:)>6000,3,'first') find(d20140602_sn2014ab_1(1,:)<7125,3,'last')])',d20140602_sn2014ab_1(2,[find(d20140602_sn2014ab_1(1,:)>6000,3,'first') find(d20140602_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140602_sn2014ab_1= mean(halphafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,(d20140602_sn2014ab_1(1,:)>6462.8 & d20140602_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140602_sn2014ab_1= d20140602_sn2014ab_1(2,:)/halphanormconstant20140602_sn2014ab_1;
halphavarscaledsub20140602_sn2014ab_1= (d20140602_sn2014ab_1(2,:) - halphafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))')./halphafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))';

%halphafit20140602_sn2014ab_2= fit(d20140602_sn2014ab_2(1,[find(d20140602_sn2014ab_2(1,:)>6000,3,'first') find(d20140602_sn2014ab_2(1,:)<7125,3,'last')])',d20140602_sn2014ab_2(2,[find(d20140602_sn2014ab_2(1,:)>6000,3,'first') find(d20140602_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140602_sn2014ab_2= mean(halphafit20140602_sn2014ab_2(d20140602_sn2014ab_2(1,(d20140602_sn2014ab_2(1,:)>6462.8 & d20140602_sn2014ab_2(1,:)<6662.8))));
%halphauniscaled20140602_sn2014ab_2= d20140602_sn2014ab_2(2,:)/halphanormconstant20140602_sn2014ab_2;
%halphavarscaledsub20140602_sn2014ab_2= (d20140602_sn2014ab_2(2,:) - halphafit20140602_sn2014ab_2(d20140602_sn2014ab_2(1,:))')./halphafit20140602_sn2014ab_2(d20140602_sn2014ab_2(1,:))';

%halphafit20140602_sn2014ab_3= fit(d20140602_sn2014ab_3(1,[find(d20140602_sn2014ab_3(1,:)>6000,3,'first') find(d20140602_sn2014ab_3(1,:)<7125,3,'last')])',d20140602_sn2014ab_3(2,[find(d20140602_sn2014ab_3(1,:)>6000,3,'first') find(d20140602_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140602_sn2014ab_3= mean(halphafit20140602_sn2014ab_3(d20140602_sn2014ab_3(1,(d20140602_sn2014ab_3(1,:)>6462.8 & d20140602_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140602_sn2014ab_3= d20140602_sn2014ab_3(2,:)/halphanormconstant20140602_sn2014ab_3;
%halphavarscaledsub20140602_sn2014ab_3= (d20140602_sn2014ab_3(2,:) - halphafit20140602_sn2014ab_3(d20140602_sn2014ab_3(1,:))')./halphafit20140602_sn2014ab_3(d20140602_sn2014ab_3(1,:))';


halphafit20140722_sn2014ab_1= fit(d20140722_sn2014ab_1(1,[find(d20140722_sn2014ab_1(1,:)>6000,3,'first') find(d20140722_sn2014ab_1(1,:)<7125,3,'last')])',d20140722_sn2014ab_1(2,[find(d20140722_sn2014ab_1(1,:)>6000,3,'first') find(d20140722_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140722_sn2014ab_1= mean(halphafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,(d20140722_sn2014ab_1(1,:)>6462.8 & d20140722_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140722_sn2014ab_1= d20140722_sn2014ab_1(2,:)/halphanormconstant20140722_sn2014ab_1;
halphavarscaledsub20140722_sn2014ab_1= (d20140722_sn2014ab_1(2,:) - halphafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))')./halphafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))';

%halphafit20140722_sn2014ab_2= fit(d20140722_sn2014ab_2(1,[find(d20140722_sn2014ab_2(1,:)>6000,3,'first') find(d20140722_sn2014ab_2(1,:)<7125,3,'last')])',d20140722_sn2014ab_2(2,[find(d20140722_sn2014ab_2(1,:)>6000,3,'first') find(d20140722_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_2= mean(halphafit20140722_sn2014ab_2(d20140722_sn2014ab_2(1,(d20140722_sn2014ab_2(1,:)>6462.8 & d20140722_sn2014ab_2(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_2= d20140722_sn2014ab_2(2,:)/halphanormconstant20140722_sn2014ab_2;
%halphavarscaledsub20140722_sn2014ab_2= (d20140722_sn2014ab_2(2,:) - halphafit20140722_sn2014ab_2(d20140722_sn2014ab_2(1,:))')./halphafit20140722_sn2014ab_2(d20140722_sn2014ab_2(1,:))';

%halphafit20140722_sn2014ab_3= fit(d20140722_sn2014ab_3(1,[find(d20140722_sn2014ab_3(1,:)>6000,3,'first') find(d20140722_sn2014ab_3(1,:)<7125,3,'last')])',d20140722_sn2014ab_3(2,[find(d20140722_sn2014ab_3(1,:)>6000,3,'first') find(d20140722_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_3= mean(halphafit20140722_sn2014ab_3(d20140722_sn2014ab_3(1,(d20140722_sn2014ab_3(1,:)>6462.8 & d20140722_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_3= d20140722_sn2014ab_3(2,:)/halphanormconstant20140722_sn2014ab_3;
%halphavarscaledsub20140722_sn2014ab_3= (d20140722_sn2014ab_3(2,:) - halphafit20140722_sn2014ab_3(d20140722_sn2014ab_3(1,:))')./halphafit20140722_sn2014ab_3(d20140722_sn2014ab_3(1,:))';


halphafit20140722_sn2014ab_4= fit(d20140722_sn2014ab_4(1,[find(d20140722_sn2014ab_4(1,:)>6000,3,'first') find(d20140722_sn2014ab_4(1,:)<7125,3,'last')])',d20140722_sn2014ab_4(2,[find(d20140722_sn2014ab_4(1,:)>6000,3,'first') find(d20140722_sn2014ab_4(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140722_sn2014ab_4= mean(halphafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,(d20140722_sn2014ab_4(1,:)>6462.8 & d20140722_sn2014ab_4(1,:)<6662.8))));
halphauniscaled20140722_sn2014ab_4= d20140722_sn2014ab_4(2,:)/halphanormconstant20140722_sn2014ab_4;
halphavarscaledsub20140722_sn2014ab_4= (d20140722_sn2014ab_4(2,:) - halphafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,:))')./halphafit20140722_sn2014ab_4(d20140722_sn2014ab_4(1,:))';

%halphafit20140722_sn2014ab_5= fit(d20140722_sn2014ab_5(1,[find(d20140722_sn2014ab_5(1,:)>6000,3,'first') find(d20140722_sn2014ab_5(1,:)<7125,3,'last')])',d20140722_sn2014ab_5(2,[find(d20140722_sn2014ab_5(1,:)>6000,3,'first') find(d20140722_sn2014ab_5(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_5= mean(halphafit20140722_sn2014ab_5(d20140722_sn2014ab_5(1,(d20140722_sn2014ab_5(1,:)>6462.8 & d20140722_sn2014ab_5(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_5= d20140722_sn2014ab_5(2,:)/halphanormconstant20140722_sn2014ab_5;
%halphavarscaledsub20140722_sn2014ab_5= (d20140722_sn2014ab_5(2,:) - halphafit20140722_sn2014ab_5(d20140722_sn2014ab_5(1,:))')./halphafit20140722_sn2014ab_5(d20140722_sn2014ab_5(1,:))';

%halphafit20140722_sn2014ab_6= fit(d20140722_sn2014ab_6(1,[find(d20140722_sn2014ab_6(1,:)>6000,3,'first') find(d20140722_sn2014ab_6(1,:)<7125,3,'last')])',d20140722_sn2014ab_6(2,[find(d20140722_sn2014ab_6(1,:)>6000,3,'first') find(d20140722_sn2014ab_6(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140722_sn2014ab_6= mean(halphafit20140722_sn2014ab_6(d20140722_sn2014ab_6(1,(d20140722_sn2014ab_6(1,:)>6462.8 & d20140722_sn2014ab_6(1,:)<6662.8))));
%halphauniscaled20140722_sn2014ab_6= d20140722_sn2014ab_6(2,:)/halphanormconstant20140722_sn2014ab_6;
%halphavarscaledsub20140722_sn2014ab_6= (d20140722_sn2014ab_6(2,:) - halphafit20140722_sn2014ab_6(d20140722_sn2014ab_6(1,:))')./halphafit20140722_sn2014ab_6(d20140722_sn2014ab_6(1,:))';


halphafit20140808_sn2014ab_1= fit(d20140808_sn2014ab_1(1,[find(d20140808_sn2014ab_1(1,:)>6000,3,'first') find(d20140808_sn2014ab_1(1,:)<7125,3,'last')])',d20140808_sn2014ab_1(2,[find(d20140808_sn2014ab_1(1,:)>6000,3,'first') find(d20140808_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140808_sn2014ab_1= mean(halphafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,(d20140808_sn2014ab_1(1,:)>6462.8 & d20140808_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140808_sn2014ab_1= d20140808_sn2014ab_1(2,:)/halphanormconstant20140808_sn2014ab_1;
halphavarscaledsub20140808_sn2014ab_1= (d20140808_sn2014ab_1(2,:) - halphafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))')./halphafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))';

%halphafit20140808_sn2014ab_2= fit(d20140808_sn2014ab_2(1,[find(d20140808_sn2014ab_2(1,:)>6000,3,'first') find(d20140808_sn2014ab_2(1,:)<7125,3,'last')])',d20140808_sn2014ab_2(2,[find(d20140808_sn2014ab_2(1,:)>6000,3,'first') find(d20140808_sn2014ab_2(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140808_sn2014ab_2= mean(halphafit20140808_sn2014ab_2(d20140808_sn2014ab_2(1,(d20140808_sn2014ab_2(1,:)>6462.8 & d20140808_sn2014ab_2(1,:)<6662.8))));
%halphauniscaled20140808_sn2014ab_2= d20140808_sn2014ab_2(2,:)/halphanormconstant20140808_sn2014ab_2;
%halphavarscaledsub20140808_sn2014ab_2= (d20140808_sn2014ab_2(2,:) - halphafit20140808_sn2014ab_2(d20140808_sn2014ab_2(1,:))')./halphafit20140808_sn2014ab_2(d20140808_sn2014ab_2(1,:))';

%halphafit20140808_sn2014ab_3= fit(d20140808_sn2014ab_3(1,[find(d20140808_sn2014ab_3(1,:)>6000,3,'first') find(d20140808_sn2014ab_3(1,:)<7125,3,'last')])',d20140808_sn2014ab_3(2,[find(d20140808_sn2014ab_3(1,:)>6000,3,'first') find(d20140808_sn2014ab_3(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
%halphanormconstant20140808_sn2014ab_3= mean(halphafit20140808_sn2014ab_3(d20140808_sn2014ab_3(1,(d20140808_sn2014ab_3(1,:)>6462.8 & d20140808_sn2014ab_3(1,:)<6662.8))));
%halphauniscaled20140808_sn2014ab_3= d20140808_sn2014ab_3(2,:)/halphanormconstant20140808_sn2014ab_3;
%halphavarscaledsub20140808_sn2014ab_3= (d20140808_sn2014ab_3(2,:) - halphafit20140808_sn2014ab_3(d20140808_sn2014ab_3(1,:))')./halphafit20140808_sn2014ab_3(d20140808_sn2014ab_3(1,:))';

halphafit20140408_sn2014ab_1= fit(d20140408_sn2014ab_1(1,[find(d20140408_sn2014ab_1(1,:)>6000,3,'first') find(d20140408_sn2014ab_1(1,:)<7125,3,'last')])',d20140408_sn2014ab_1(2,[find(d20140408_sn2014ab_1(1,:)>6000,3,'first') find(d20140408_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140408_sn2014ab_1= mean(halphafit20140408_sn2014ab_1(d20140408_sn2014ab_1(1,(d20140408_sn2014ab_1(1,:)>6462.8 & d20140408_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140408_sn2014ab_1= d20140408_sn2014ab_1(2,:)/halphanormconstant20140408_sn2014ab_1;
halphavarscaledsub20140408_sn2014ab_1= (d20140408_sn2014ab_1(2,:) - halphafit20140408_sn2014ab_1(d20140408_sn2014ab_1(1,:))')./halphafit20140408_sn2014ab_1(d20140408_sn2014ab_1(1,:))';

halphafit20140409_sn2014ab_1= fit(d20140409_sn2014ab_1(1,[find(d20140409_sn2014ab_1(1,:)>6000,3,'first') find(d20140409_sn2014ab_1(1,:)<7125,3,'last')])',d20140409_sn2014ab_1(2,[find(d20140409_sn2014ab_1(1,:)>6000,3,'first') find(d20140409_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140409_sn2014ab_1= mean(halphafit20140409_sn2014ab_1(d20140409_sn2014ab_1(1,(d20140409_sn2014ab_1(1,:)>6462.8 & d20140409_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140409_sn2014ab_1= d20140409_sn2014ab_1(2,:)/halphanormconstant20140409_sn2014ab_1;
halphavarscaledsub20140409_sn2014ab_1= (d20140409_sn2014ab_1(2,:) - halphafit20140409_sn2014ab_1(d20140409_sn2014ab_1(1,:))')./halphafit20140409_sn2014ab_1(d20140409_sn2014ab_1(1,:))';

halphafit20140411_sn2014ab_1= fit(d20140411_sn2014ab_1(1,[find(d20140411_sn2014ab_1(1,:)>6000,3,'first') find(d20140411_sn2014ab_1(1,:)<7125,3,'last')])',d20140411_sn2014ab_1(2,[find(d20140411_sn2014ab_1(1,:)>6000,3,'first') find(d20140411_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140411_sn2014ab_1= mean(halphafit20140411_sn2014ab_1(d20140411_sn2014ab_1(1,(d20140411_sn2014ab_1(1,:)>6462.8 & d20140411_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140411_sn2014ab_1= d20140411_sn2014ab_1(2,:)/halphanormconstant20140411_sn2014ab_1;
halphavarscaledsub20140411_sn2014ab_1= (d20140411_sn2014ab_1(2,:) - halphafit20140411_sn2014ab_1(d20140411_sn2014ab_1(1,:))')./halphafit20140411_sn2014ab_1(d20140411_sn2014ab_1(1,:))';

halphafit20140507_sn2014ab_4= fit(d20140507_sn2014ab_4(1,[find(d20140507_sn2014ab_4(1,:)>6000,3,'first') find(d20140507_sn2014ab_4(1,:)<7125,3,'last')])',d20140507_sn2014ab_4(2,[find(d20140507_sn2014ab_4(1,:)>6000,3,'first') find(d20140507_sn2014ab_4(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140507_sn2014ab_4= mean(halphafit20140507_sn2014ab_4(d20140507_sn2014ab_4(1,(d20140507_sn2014ab_4(1,:)>6462.8 & d20140507_sn2014ab_4(1,:)<6662.8))));
halphauniscaled20140507_sn2014ab_4= d20140507_sn2014ab_4(2,:)/halphanormconstant20140507_sn2014ab_4;
halphavarscaledsub20140507_sn2014ab_4= (d20140507_sn2014ab_4(2,:) - halphafit20140507_sn2014ab_4(d20140507_sn2014ab_4(1,:))')./halphafit20140507_sn2014ab_4(d20140507_sn2014ab_4(1,:))';

halphafit20140420_sn2014ab_1= fit(d20140420_sn2014ab_1(1,[find(d20140420_sn2014ab_1(1,:)>6000,3,'first') find(d20140420_sn2014ab_1(1,:)<7125,3,'last')])',d20140420_sn2014ab_1(2,[find(d20140420_sn2014ab_1(1,:)>6000,3,'first') find(d20140420_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140420_sn2014ab_1= mean(halphafit20140420_sn2014ab_1(d20140420_sn2014ab_1(1,(d20140420_sn2014ab_1(1,:)>6462.8 & d20140420_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140420_sn2014ab_1= d20140420_sn2014ab_1(2,:)/halphanormconstant20140420_sn2014ab_1;
halphavarscaledsub20140420_sn2014ab_1= (d20140420_sn2014ab_1(2,:) - halphafit20140420_sn2014ab_1(d20140420_sn2014ab_1(1,:))')./halphafit20140420_sn2014ab_1(d20140420_sn2014ab_1(1,:))';

halphafit20140423_sn2014ab_1= fit(d20140423_sn2014ab_1(1,[find(d20140423_sn2014ab_1(1,:)>6000,3,'first') find(d20140423_sn2014ab_1(1,:)<7125,3,'last')])',d20140423_sn2014ab_1(2,[find(d20140423_sn2014ab_1(1,:)>6000,3,'first') find(d20140423_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140423_sn2014ab_1= mean(halphafit20140423_sn2014ab_1(d20140423_sn2014ab_1(1,(d20140423_sn2014ab_1(1,:)>6462.8 & d20140423_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140423_sn2014ab_1= d20140423_sn2014ab_1(2,:)/halphanormconstant20140423_sn2014ab_1;
halphavarscaledsub20140423_sn2014ab_1= (d20140423_sn2014ab_1(2,:) - halphafit20140423_sn2014ab_1(d20140423_sn2014ab_1(1,:))')./halphafit20140423_sn2014ab_1(d20140423_sn2014ab_1(1,:))';

halphafit20140522_sn2014ab_1= fit(d20140522_sn2014ab_1(1,[find(d20140522_sn2014ab_1(1,:)>6000,3,'first') find(d20140522_sn2014ab_1(1,:)<7125,3,'last')])',d20140522_sn2014ab_1(2,[find(d20140522_sn2014ab_1(1,:)>6000,3,'first') find(d20140522_sn2014ab_1(1,:)<7125,3,'last')])','poly1','Robust','Bisquare');
halphanormconstant20140522_sn2014ab_1= mean(halphafit20140522_sn2014ab_1(d20140522_sn2014ab_1(1,(d20140522_sn2014ab_1(1,:)>6462.8 & d20140522_sn2014ab_1(1,:)<6662.8))));
halphauniscaled20140522_sn2014ab_1= d20140522_sn2014ab_1(2,:)/halphanormconstant20140522_sn2014ab_1;
halphavarscaledsub20140522_sn2014ab_1= (d20140522_sn2014ab_1(2,:) - halphafit20140522_sn2014ab_1(d20140522_sn2014ab_1(1,:))')./halphafit20140522_sn2014ab_1(d20140522_sn2014ab_1(1,:))';








%%% test the plot here for 20140519


clf
plot(halphafit20140310_sn2014ab_1,d20140310_sn2014ab_1(1,:),d20140310_sn2014ab_1(2,:))

clf
plot(halphafit20140324_sn2014ab_1,d20140324_sn2014ab_1(1,:),d20140324_sn2014ab_1(2,:))

clf
plot(halphafit20140329_sn2014ab_1,d20140329_sn2014ab_1(1,:),d20140329_sn2014ab_1(2,:))

clf
plot(halphafit20140330_sn2014ab_1,d20140330_sn2014ab_1(1,:),d20140330_sn2014ab_1(2,:))

clf
plot(halphafit20140331_sn2014ab_1,d20140331_sn2014ab_1(1,:),d20140331_sn2014ab_1(2,:))

clf
plot(halphafit20140402_sn2014ab_1,d20140402_sn2014ab_1(1,:),d20140402_sn2014ab_1(2,:))

clf
plot(halphafit20140426_sn2014ab_1,d20140426_sn2014ab_1(1,:),d20140426_sn2014ab_1(2,:))

clf
plot(halphafit20140427_sn2014ab_1,d20140427_sn2014ab_1(1,:),d20140427_sn2014ab_1(2,:))

clf
plot(halphafit20140428_sn2014ab_1,d20140428_sn2014ab_1(1,:),d20140428_sn2014ab_1(2,:))

clf
plot(halphafit20140430_sn2014ab_1,d20140430_sn2014ab_1(1,:),d20140430_sn2014ab_1(2,:))

clf
plot(halphafit20140501_sn2014ab_1,d20140501_sn2014ab_1(1,:),d20140501_sn2014ab_1(2,:))

clf
plot(halphafit20140519_sn2014ab_1,d20140519_sn2014ab_1(1,:),d20140519_sn2014ab_1(2,:))

clf
plot(halphafit20140523_sn2014ab_1,d20140523_sn2014ab_1(1,:),d20140523_sn2014ab_1(2,:))

clf
plot(halphafit20140524_sn2014ab_1,d20140524_sn2014ab_1(1,:),d20140524_sn2014ab_1(2,:))

clf
plot(halphafit20140526_sn2014ab_1,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))

clf
plot(halphafit20140528_sn2014ab_1,d20140528_sn2014ab_1(1,:),d20140528_sn2014ab_1(2,:))

clf
plot(halphafit20140621_sn2014ab_1,d20140621_sn2014ab_1(1,:),d20140621_sn2014ab_1(2,:))

clf
plot(halphafit20140622_sn2014ab_1,d20140622_sn2014ab_1(1,:),d20140622_sn2014ab_1(2,:))

clf
plot(halphafit20140623_sn2014ab_1,d20140623_sn2014ab_1(1,:),d20140623_sn2014ab_1(2,:))

clf
plot(halphafit20140624_sn2014ab_1,d20140624_sn2014ab_1(1,:),d20140624_sn2014ab_1(2,:))

clf
plot(halphafit20140626_sn2014ab_1,d20140626_sn2014ab_1(1,:),d20140626_sn2014ab_1(2,:))

clf
plot(halphafit20140630_sn2014ab_1,d20140630_sn2014ab_1(1,:),d20140630_sn2014ab_1(2,:))


clf
plot(halphafit20140408_sn2014ab_1,d20140408_sn2014ab_1(1,:),d20140408_sn2014ab_1(2,:))

clf
plot(halphafit20140409_sn2014ab_1,d20140409_sn2014ab_1(1,:),d20140409_sn2014ab_1(2,:))

clf
plot(halphafit20140411_sn2014ab_1,d20140411_sn2014ab_1(1,:),d20140411_sn2014ab_1(2,:))

clf
plot(halphafit20140507_sn2014ab_4,d20140507_sn2014ab_4(1,:),d20140507_sn2014ab_4(2,:))

clf
plot(halphafit20140420_sn2014ab_1,d20140420_sn2014ab_1(1,:),d20140420_sn2014ab_1(2,:))

clf
plot(halphafit20140423_sn2014ab_1,d20140423_sn2014ab_1(1,:),d20140423_sn2014ab_1(2,:))

clf
plot(halphafit20140522_sn2014ab_1,d20140522_sn2014ab_1(1,:),d20140522_sn2014ab_1(2,:))






clf
plot(halphafit20140526_sn2014ab_2,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
%clf
%plot(halphafit20140526_sn2014ab_3,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
%clf
%plot(halphafit20140526_sn2014ab_4,d20140526_sn2014ab_1(1,:),d20140526_sn2014ab_1(2,:))
clf
plot(halphafit20140602_sn2014ab_1,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140602_sn2014ab_2,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140602_sn2014ab_3,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
clf
plot(halphafit20140722_sn2014ab_1,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_2,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_3,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
clf
plot(halphafit20140722_sn2014ab_4,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_5,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140722_sn2014ab_6,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
clf
plot(halphafit20140808_sn2014ab_1,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140808_sn2014ab_2,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
%clf                            
%plot(halphafit20140808_sn2014ab_3,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))



















%axis conversion to velocity relative to Halpha
%velocity in km/s
lambdaHalpha = 6562.81;
c=3*10^10;
velHalpha_20140310_1 = 10^-5 .* c.* (d20140310_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140324_1 = 10^-5 .* c.* (d20140324_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140329_1 = 10^-5 .* c.* (d20140329_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140330_1 = 10^-5 .* c.* (d20140330_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140331_1 = 10^-5 .* c.* (d20140331_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140402_1 = 10^-5 .* c.* (d20140402_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140426_1 = 10^-5 .* c.* (d20140426_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140427_1 = 10^-5 .* c.* (d20140427_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140428_1 = 10^-5 .* c.* (d20140428_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140430_1 = 10^-5 .* c.* (d20140430_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140501_1 = 10^-5 .* c.* (d20140501_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140519_1 = 10^-5 .* c.* (d20140519_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140523_1 = 10^-5 .* c.* (d20140523_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140524_1 = 10^-5 .* c.* (d20140524_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140526_1 = 10^-5 .* c.* (d20140526_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140528_1 = 10^-5 .* c.* (d20140528_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140621_1 = 10^-5 .* c.* (d20140621_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140622_1 = 10^-5 .* c.* (d20140622_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140623_1 = 10^-5 .* c.* (d20140623_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140624_1 = 10^-5 .* c.* (d20140624_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140626_1 = 10^-5 .* c.* (d20140626_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140630_1 = 10^-5 .* c.* (d20140630_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140526_3 = 10^-5 .* c.* (d20140526_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140526_4 = 10^-5 .* c.* (d20140526_sn2014ab_4(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140602_2 = 10^-5 .* c.* (d20140602_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140602_3 = 10^-5 .* c.* (d20140602_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_2 = 10^-5 .* c.* (d20140722_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_3 = 10^-5 .* c.* (d20140722_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140722_4 = 10^-5 .* c.* (d20140722_sn2014ab_4(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_5 = 10^-5 .* c.* (d20140722_sn2014ab_5(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140722_6 = 10^-5 .* c.* (d20140722_sn2014ab_6(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140808_2 = 10^-5 .* c.* (d20140808_sn2014ab_2(1,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_20140808_3 = 10^-5 .* c.* (d20140808_sn2014ab_3(1,:)-lambdaHalpha)./lambdaHalpha;

velHalpha_20140408_1 = 10^-5 .* c.* (d20140408_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140409_1 = 10^-5 .* c.* (d20140409_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140411_1 = 10^-5 .* c.* (d20140411_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140507_4 = 10^-5 .* c.* (d20140507_sn2014ab_4(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140420_1 = 10^-5 .* c.* (d20140420_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140423_1 = 10^-5 .* c.* (d20140423_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;
velHalpha_20140522_1 = 10^-5 .* c.* (d20140522_sn2014ab_1(1,:)-lambdaHalpha)./lambdaHalpha;









%velHalpha_offset_2_10140310 = 10^-5 .* c.* (d20140310_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140324 = 10^-5 .* c.* (d20140324_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140329 = 10^-5 .* c.* (d20140329_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140330 = 10^-5 .* c.* (d20140330_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140331 = 10^-5 .* c.* (d20140331_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140402 = 10^-5 .* c.* (d20140402_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140426 = 10^-5 .* c.* (d20140426_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140427 = 10^-5 .* c.* (d20140427_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140428 = 10^-5 .* c.* (d20140428_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140430 = 10^-5 .* c.* (d20140430_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140501 = 10^-5 .* c.* (d20140501_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140523 = 10^-5 .* c.* (d20140523_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140524 = 10^-5 .* c.* (d20140524_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140526 = 10^-5 .* c.* (d20140526_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140528 = 10^-5 .* c.* (d20140528_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140621 = 10^-5 .* c.* (d20140621_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140622 = 10^-5 .* c.* (d20140622_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140623 = 10^-5 .* c.* (d20140623_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140624 = 10^-5 .* c.* (d20140624_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140626 = 10^-5 .* c.* (d20140626_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;
%velHalpha_offset_2_10140630 = 10^-5 .* c.* (d20140630_sn2014ab_1(3,:)-lambdaHalpha)./lambdaHalpha;





%axis conversion to velocity relative to Hbeta
lambdaHbeta = 4861.363;
velHbeta_20140310_1 = 10^-5 .* c.* (d20140310_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140324_1 = 10^-5 .* c.* (d20140324_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140329_1 = 10^-5 .* c.* (d20140329_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140330_1 = 10^-5 .* c.* (d20140330_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140331_1 = 10^-5 .* c.* (d20140331_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140402_1 = 10^-5 .* c.* (d20140402_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140426_1 = 10^-5 .* c.* (d20140426_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140427_1 = 10^-5 .* c.* (d20140427_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140428_1 = 10^-5 .* c.* (d20140428_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140430_1 = 10^-5 .* c.* (d20140430_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140501_1 = 10^-5 .* c.* (d20140501_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140519_1 = 10^-5 .* c.* (d20140519_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140523_1 = 10^-5 .* c.* (d20140523_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140524_1 = 10^-5 .* c.* (d20140524_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140526_1 = 10^-5 .* c.* (d20140526_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140528_1 = 10^-5 .* c.* (d20140528_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140621_1 = 10^-5 .* c.* (d20140621_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140622_1 = 10^-5 .* c.* (d20140622_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140623_1 = 10^-5 .* c.* (d20140623_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140624_1 = 10^-5 .* c.* (d20140624_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140626_1 = 10^-5 .* c.* (d20140626_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140630_1 = 10^-5 .* c.* (d20140630_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140526_3 = 10^-5 .* c.* (d20140526_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140526_4 = 10^-5 .* c.* (d20140526_sn2014ab_4(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140602_2 = 10^-5 .* c.* (d20140602_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140602_3 = 10^-5 .* c.* (d20140602_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_2 = 10^-5 .* c.* (d20140722_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_3 = 10^-5 .* c.* (d20140722_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140722_4 = 10^-5 .* c.* (d20140722_sn2014ab_4(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_5 = 10^-5 .* c.* (d20140722_sn2014ab_5(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140722_6 = 10^-5 .* c.* (d20140722_sn2014ab_6(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140808_2 = 10^-5 .* c.* (d20140808_sn2014ab_2(1,:)-lambdaHbeta)./lambdaHbeta;
%velHbeta_20140808_3 = 10^-5 .* c.* (d20140808_sn2014ab_3(1,:)-lambdaHbeta)./lambdaHbeta;


velHbeta_20140408_1 = 10^-5 .* c.* (d20140408_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140409_1 = 10^-5 .* c.* (d20140409_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140411_1 = 10^-5 .* c.* (d20140411_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140507_4 = 10^-5 .* c.* (d20140507_sn2014ab_4(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140420_1 = 10^-5 .* c.* (d20140420_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140423_1 = 10^-5 .* c.* (d20140423_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;
velHbeta_20140522_1 = 10^-5 .* c.* (d20140522_sn2014ab_1(1,:)-lambdaHbeta)./lambdaHbeta;



20140310
20140324
20140329
20140330
20140331
20140402
20140426
20140427
20140428
20140430
20140501
20140523
20140524
20140526
20140528
20140602
20140621
20140622
20140623
20140624
20140626
20140630
20140722
20140808



%measure EW on each side

leftEWHalpha(1)  = trapz(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:) >= 6312.81 & d20140310_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6312.81 & d20140310_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(2)  = trapz(d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(1,:) >= 6312.81 & d20140324_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6312.81 & d20140324_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(3)  = trapz(d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(1,:) >= 6312.81 & d20140329_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6312.81 & d20140329_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(4)  = trapz(d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(1,:) >= 6312.81 & d20140330_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6312.81 & d20140330_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(5)  = trapz(d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(1,:) >= 6312.81 & d20140331_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6312.81 & d20140331_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(6)  = trapz(d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(1,:) >= 6312.81 & d20140402_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6312.81 & d20140402_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(7)  = trapz(d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(1,:) >= 6312.81 & d20140426_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6312.81 & d20140426_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(8)  = trapz(d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(1,:) >= 6312.81 & d20140427_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6312.81 & d20140427_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(9)  = trapz(d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(1,:) >= 6312.81 & d20140428_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6312.81 & d20140428_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(10) = trapz(d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(1,:) >= 6312.81 & d20140430_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6312.81 & d20140430_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(11) = trapz(d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(1,:) >= 6312.81 & d20140501_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6312.81 & d20140501_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(12) = trapz(d20140519_sn2014ab_1(1,find(d20140519_sn2014ab_1(1,:) >= 6312.81 & d20140519_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:) >= 6312.81 & d20140519_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(13) = trapz(d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(1,:) >= 6312.81 & d20140523_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6312.81 & d20140523_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(14) = trapz(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:) >= 6312.81 & d20140524_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6312.81 & d20140524_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(15) = trapz(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:) >= 6312.81 & d20140526_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6312.81 & d20140526_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(16) = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= 6312.81 & d20140526_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6312.81 & d20140526_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(17) = trapz(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:) >= 6312.81 & d20140528_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6312.81 & d20140528_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(18) = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= 6312.81 & d20140602_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6312.81 & d20140602_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(19) = trapz(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:) >= 6312.81 & d20140621_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6312.81 & d20140621_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(20) = trapz(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:) >= 6312.81 & d20140622_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6312.81 & d20140622_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(21) = trapz(d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(1,:) >= 6312.81 & d20140623_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6312.81 & d20140623_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(22) = trapz(d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(1,:) >= 6312.81 & d20140624_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6312.81 & d20140624_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(23) = trapz(d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(1,:) >= 6312.81 & d20140626_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6312.81 & d20140626_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(24) = trapz(d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(1,:) >= 6312.81 & d20140630_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6312.81 & d20140630_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(25) = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= 6312.81 & d20140722_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6312.81 & d20140722_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(26) = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= 6312.81 & d20140722_sn2014ab_4(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6312.81 & d20140722_sn2014ab_4(1,:) <= 6562.81)))
leftEWHalpha(27) = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= 6312.81 & d20140808_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6312.81 & d20140808_sn2014ab_1(1,:) <= 6562.81)))



leftNEWerr(1)  = 5*std(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6000 & d20140310_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(2)  = 5*std(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6000 & d20140324_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(3)  = 5*std(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6000 & d20140329_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(4)  = 5*std(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6000 & d20140330_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(5)  = 5*std(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6000 & d20140331_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(6)  = 5*std(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6000 & d20140402_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(7)  = 5*std(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6000 & d20140426_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(8)  = 5*std(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6000 & d20140427_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(9)  = 5*std(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6000 & d20140428_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(10) = 5*std(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6000 & d20140430_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(11) = 5*std(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6000 & d20140501_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(12) = 5*std(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:) >= 6000 & d20140519_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(13) = 5*std(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6000 & d20140523_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(14) = 5*std(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6000 & d20140524_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(15) = 5*std(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6000 & d20140526_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(16) = 5*std(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6000 & d20140526_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(17) = 5*std(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6000 & d20140528_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(18) = 5*std(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6000 & d20140602_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(19) = 5*std(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6000 & d20140621_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(20) = 5*std(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6000 & d20140622_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(21) = 5*std(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6000 & d20140623_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(22) = 5*std(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6000 & d20140624_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(23) = 5*std(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6000 & d20140626_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(24) = 5*std(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6000 & d20140630_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(25) = 5*std(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6000 & d20140722_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(26) = 5*std(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6000 & d20140722_sn2014ab_4(1,:) <= 6300)));
leftNEWerr(27) = 5*std(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6000 & d20140808_sn2014ab_1(1,:) <= 6300)));

leftdEWHalpha(1)  = leftNEWerr(1)  * leftEWHalpha(1) ;
leftdEWHalpha(2)  = leftNEWerr(2)  * leftEWHalpha(2) ;
leftdEWHalpha(3)  = leftNEWerr(3)  * leftEWHalpha(3) ;
leftdEWHalpha(4)  = leftNEWerr(4)  * leftEWHalpha(4) ;
leftdEWHalpha(5)  = leftNEWerr(5)  * leftEWHalpha(5) ;
leftdEWHalpha(6)  = leftNEWerr(6)  * leftEWHalpha(6) ;
leftdEWHalpha(7)  = leftNEWerr(7)  * leftEWHalpha(7) ;
leftdEWHalpha(8)  = leftNEWerr(8)  * leftEWHalpha(8) ;
leftdEWHalpha(9)  = leftNEWerr(9)  * leftEWHalpha(9) ;
leftdEWHalpha(10) = leftNEWerr(10) * leftEWHalpha(10);
leftdEWHalpha(11) = leftNEWerr(11) * leftEWHalpha(11);
leftdEWHalpha(12) = leftNEWerr(12) * leftEWHalpha(12);
leftdEWHalpha(13) = leftNEWerr(13) * leftEWHalpha(13);
leftdEWHalpha(14) = leftNEWerr(14) * leftEWHalpha(14);
leftdEWHalpha(15) = leftNEWerr(15) * leftEWHalpha(15);
leftdEWHalpha(16) = leftNEWerr(16) * leftEWHalpha(16);
leftdEWHalpha(17) = leftNEWerr(17) * leftEWHalpha(17);
leftdEWHalpha(18) = leftNEWerr(18) * leftEWHalpha(18);
leftdEWHalpha(19) = leftNEWerr(19) * leftEWHalpha(19);
leftdEWHalpha(20) = leftNEWerr(20) * leftEWHalpha(20);
leftdEWHalpha(21) = leftNEWerr(21) * leftEWHalpha(21);
leftdEWHalpha(22) = leftNEWerr(22) * leftEWHalpha(22);
leftdEWHalpha(23) = leftNEWerr(23) * leftEWHalpha(23);
leftdEWHalpha(24) = leftNEWerr(24) * leftEWHalpha(24);
leftdEWHalpha(25) = leftNEWerr(25) * leftEWHalpha(25);
leftdEWHalpha(26) = leftNEWerr(26) * leftEWHalpha(26);
leftdEWHalpha(27) = leftNEWerr(27) * leftEWHalpha(27);

rightEWHalpha(1)  = trapz(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:) >= 6562.81 & d20140310_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6562.81 & d20140310_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(2)  = trapz(d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(1,:) >= 6562.81 & d20140324_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6562.81 & d20140324_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(3)  = trapz(d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(1,:) >= 6562.81 & d20140329_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6562.81 & d20140329_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(4)  = trapz(d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(1,:) >= 6562.81 & d20140330_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6562.81 & d20140330_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(5)  = trapz(d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(1,:) >= 6562.81 & d20140331_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6562.81 & d20140331_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(6)  = trapz(d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(1,:) >= 6562.81 & d20140402_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6562.81 & d20140402_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(7)  = trapz(d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(1,:) >= 6562.81 & d20140426_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6562.81 & d20140426_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(8)  = trapz(d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(1,:) >= 6562.81 & d20140427_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6562.81 & d20140427_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(9)  = trapz(d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(1,:) >= 6562.81 & d20140428_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6562.81 & d20140428_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(10) = trapz(d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(1,:) >= 6562.81 & d20140430_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6562.81 & d20140430_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(11) = trapz(d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(1,:) >= 6562.81 & d20140501_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6562.81 & d20140501_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(12) = trapz(d20140519_sn2014ab_1(1,find(d20140519_sn2014ab_1(1,:) >= 6562.81 & d20140519_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:) >= 6562.81 & d20140519_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(13) = trapz(d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(1,:) >= 6562.81 & d20140523_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6562.81 & d20140523_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(14) = trapz(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:) >= 6562.81 & d20140524_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6562.81 & d20140524_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(15) = trapz(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:) >= 6562.81 & d20140526_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6562.81 & d20140526_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(16) = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= 6562.81 & d20140526_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6562.81 & d20140526_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(17) = trapz(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:) >= 6562.81 & d20140528_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6562.81 & d20140528_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(18) = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= 6562.81 & d20140602_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6562.81 & d20140602_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(19) = trapz(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:) >= 6562.81 & d20140621_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6562.81 & d20140621_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(20) = trapz(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:) >= 6562.81 & d20140622_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6562.81 & d20140622_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(21) = trapz(d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(1,:) >= 6562.81 & d20140623_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6562.81 & d20140623_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(22) = trapz(d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(1,:) >= 6562.81 & d20140624_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6562.81 & d20140624_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(23) = trapz(d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(1,:) >= 6562.81 & d20140626_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6562.81 & d20140626_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(24) = trapz(d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(1,:) >= 6562.81 & d20140630_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6562.81 & d20140630_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(25) = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= 6562.81 & d20140722_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6562.81 & d20140722_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(26) = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= 6562.81 & d20140722_sn2014ab_4(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6562.81 & d20140722_sn2014ab_4(1,:) <= 6812.81)))
rightEWHalpha(27) = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= 6562.81 & d20140808_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6562.81 & d20140808_sn2014ab_1(1,:) <= 6812.81)))




rightNEWerr(1)  = 5*std(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6000 & d20140310_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(2)  = 5*std(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6000 & d20140324_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(3)  = 5*std(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6000 & d20140329_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(4)  = 5*std(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6000 & d20140330_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(5)  = 5*std(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6000 & d20140331_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(6)  = 5*std(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6000 & d20140402_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(7)  = 5*std(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6000 & d20140426_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(8)  = 5*std(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6000 & d20140427_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(9)  = 5*std(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6000 & d20140428_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(10) = 5*std(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6000 & d20140430_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(11) = 5*std(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6000 & d20140501_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(12) = 5*std(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:) >= 6000 & d20140519_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(13) = 5*std(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6000 & d20140523_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(14) = 5*std(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6000 & d20140524_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(15) = 5*std(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6000 & d20140526_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(16) = 5*std(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6000 & d20140526_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(17) = 5*std(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6000 & d20140528_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(18) = 5*std(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6000 & d20140602_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(19) = 5*std(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6000 & d20140621_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(20) = 5*std(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6000 & d20140622_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(21) = 5*std(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6000 & d20140623_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(22) = 5*std(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6000 & d20140624_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(23) = 5*std(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6000 & d20140626_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(24) = 5*std(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6000 & d20140630_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(25) = 5*std(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6000 & d20140722_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(26) = 5*std(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6000 & d20140722_sn2014ab_4(1,:) <= 6300)));
rightNEWerr(27) = 5*std(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6000 & d20140808_sn2014ab_1(1,:) <= 6300)));


rightdEWHalpha(1)  = rightNEWerr(1)  * rightEWHalpha(1) 
rightdEWHalpha(2)  = rightNEWerr(2)  * rightEWHalpha(2) 
rightdEWHalpha(3)  = rightNEWerr(3)  * rightEWHalpha(3) 
rightdEWHalpha(4)  = rightNEWerr(4)  * rightEWHalpha(4) 
rightdEWHalpha(5)  = rightNEWerr(5)  * rightEWHalpha(5) 
rightdEWHalpha(6)  = rightNEWerr(6)  * rightEWHalpha(6) 
rightdEWHalpha(7)  = rightNEWerr(7)  * rightEWHalpha(7) 
rightdEWHalpha(8)  = rightNEWerr(8)  * rightEWHalpha(8) 
rightdEWHalpha(9)  = rightNEWerr(9)  * rightEWHalpha(9) 
rightdEWHalpha(10) = rightNEWerr(10) * rightEWHalpha(10)
rightdEWHalpha(11) = rightNEWerr(11) * rightEWHalpha(11)
rightdEWHalpha(12) = rightNEWerr(12) * rightEWHalpha(12)
rightdEWHalpha(13) = rightNEWerr(13) * rightEWHalpha(13)
rightdEWHalpha(14) = rightNEWerr(14) * rightEWHalpha(14)
rightdEWHalpha(15) = rightNEWerr(15) * rightEWHalpha(15)
rightdEWHalpha(16) = rightNEWerr(16) * rightEWHalpha(16)
rightdEWHalpha(17) = rightNEWerr(17) * rightEWHalpha(17)
rightdEWHalpha(18) = rightNEWerr(18) * rightEWHalpha(18)
rightdEWHalpha(19) = rightNEWerr(19) * rightEWHalpha(19)
rightdEWHalpha(20) = rightNEWerr(20) * rightEWHalpha(20)
rightdEWHalpha(21) = rightNEWerr(21) * rightEWHalpha(21)
rightdEWHalpha(22) = rightNEWerr(22) * rightEWHalpha(22)
rightdEWHalpha(23) = rightNEWerr(23) * rightEWHalpha(23)
rightdEWHalpha(24) = rightNEWerr(24) * rightEWHalpha(24)
rightdEWHalpha(25) = rightNEWerr(25) * rightEWHalpha(25)
rightdEWHalpha(26) = rightNEWerr(26) * rightEWHalpha(26)
rightdEWHalpha(27) = rightNEWerr(27) * rightEWHalpha(27)




%set relative dates into one array
reldate(1)  = p20140310_sn2014ab_1(1,1)
reldate(2)  = p20140324_sn2014ab_1(1,1)
reldate(3)  = p20140329_sn2014ab_1(1,1)
reldate(4)  = p20140330_sn2014ab_1(1,1)
reldate(5)  = p20140331_sn2014ab_1(1,1)
reldate(6)  = p20140402_sn2014ab_1(1,1)
reldate(7)  = p20140426_sn2014ab_1(1,1)
reldate(8)  = p20140427_sn2014ab_1(1,1)
reldate(9)  = p20140428_sn2014ab_1(1,1)
reldate(10) = p20140430_sn2014ab_1(1,1)
reldate(11) = p20140501_sn2014ab_1(1,1)
reldate(12) = p20140519_sn2014ab_1(1,1)
reldate(13) = p20140523_sn2014ab_1(1,1)
reldate(14) = p20140524_sn2014ab_1(1,1)
reldate(15) = p20140526_sn2014ab_1(1,1)
reldate(16) = p20140526_sn2014ab_2(1,1)
reldate(17) = p20140528_sn2014ab_1(1,1)
reldate(18) = p20140602_sn2014ab_1(1,1)
reldate(19) = p20140621_sn2014ab_1(1,1)
reldate(20) = p20140622_sn2014ab_1(1,1)
reldate(21) = p20140623_sn2014ab_1(1,1)
reldate(22) = p20140624_sn2014ab_1(1,1)
reldate(23) = p20140626_sn2014ab_1(1,1)
reldate(24) = p20140630_sn2014ab_1(1,1)
reldate(25) = p20140722_sn2014ab_1(1,1)
reldate(26) = p20140722_sn2014ab_4(1,1)
reldate(27) = p20140808_sn2014ab_1(1,1)


%%%check 0519 if it needs a new name here


%interpolate all groups of spectra
%parts created here


flux_2014ab_Bok_ep20_24_part(1,:)   = contscaled20140329_sn2014ab_1(2,:);
flux_2014ab_Bok_ep20_24_part(2,:)   = interp1(d20140330_sn2014ab_1(1,:),contscaled20140330_sn2014ab_1(2,:),d20140329_sn2014ab_1(1,:));
flux_2014ab_Bok_ep20_24_part(3,:)   = interp1(d20140331_sn2014ab_1(1,:),contscaled20140331_sn2014ab_1(2,:),d20140329_sn2014ab_1(1,:));
flux_2014ab_Bok_ep20_24_part(4,:)   = interp1(d20140402_sn2014ab_1(1,:),contscaled20140402_sn2014ab_1(2,:),d20140329_sn2014ab_1(1,:));
                                    
flux_2014ab_Kui_ep48_50_part(1,:)   = contscaled20140426_sn2014ab_1(2,:);
flux_2014ab_Kui_ep48_50_part(2,:)   = interp1(d20140427_sn2014ab_1(1,:),contscaled20140427_sn2014ab_1(2,:),d20140426_sn2014ab_1(1,:));
flux_2014ab_Kui_ep48_50_part(3,:)   = interp1(d20140428_sn2014ab_1(1,:),contscaled20140428_sn2014ab_1(2,:),d20140426_sn2014ab_1(1,:));
                                    
flux_2014ab_Bok_ep75_78_part(1,:)   = contscaled20140523_sn2014ab_1(2,:);
flux_2014ab_Bok_ep75_78_part(2,:)   = interp1(d20140524_sn2014ab_1(1,:),contscaled20140524_sn2014ab_1(2,:),d20140523_sn2014ab_1(1,:));
flux_2014ab_Bok_ep75_78_part(3,:)   = interp1(d20140526_sn2014ab_1(1,:),contscaled20140526_sn2014ab_1(2,:),d20140523_sn2014ab_1(1,:));

flux_2014ab_Kui_ep105_109_part(1,:) = contscaled20140622_sn2014ab_1(2,:);
flux_2014ab_Kui_ep105_109_part(2,:) = interp1(d20140623_sn2014ab_1(1,:),contscaled20140623_sn2014ab_1(2,:),d20140622_sn2014ab_1(1,:));
flux_2014ab_Kui_ep105_109_part(3,:) = interp1(d20140624_sn2014ab_1(1,:),contscaled20140624_sn2014ab_1(2,:),d20140622_sn2014ab_1(1,:));
flux_2014ab_Kui_ep105_109_part(4,:) = interp1(d20140626_sn2014ab_1(1,:),contscaled20140626_sn2014ab_1(2,:),d20140622_sn2014ab_1(1,:));

flux_2014ab_VLT_ep135_part(1,:)     = d20140722_sn2014ab_1(2,:);
flux_2014ab_VLT_ep135_part(2,:)     = interp1(d20140722_sn2014ab_4(1,:),contscaled20140722_sn2014ab_4(2,:),d20140722_sn2014ab_1(1,:));

%median values stored here

wave_2014ab_NTT_ep1       = d20140310_sn2014ab_1(1,:);
flux_2014ab_NTT_ep1       = contscaled20140310_sn2014ab_1(2,:);
wave_2014ab_Lic_ep15      = d20140324_sn2014ab_1(1,:);
flux_2014ab_Lic_ep15      = contscaled20140324_sn2014ab_1(2,:);
wave_2014ab_Bok_ep20_24   = d20140329_sn2014ab_1(1,:);
flux_2014ab_Bok_ep20_24   = median(flux_2014ab_Bok_ep20_24_part,1);
wave_2014ab_Kui_ep48_50   = d20140426_sn2014ab_1(1,:);
flux_2014ab_Kui_ep48_50   = median(flux_2014ab_Kui_ep48_50_part,1);
wave_2014ab_Lic_ep52      = d20140430_sn2014ab_1(1,:);
flux_2014ab_Lic_ep52      = contscaled20140430_sn2014ab_1(2,:);
wave_2014ab_Kui_ep53      = d20140501_sn2014ab_1(1,:);
flux_2014ab_Kui_ep53      = contscaled20140501_sn2014ab_1(2,:);
wave_2014ab_Mag_ep71      = d20140519_sn2014ab_1(1,:);
flux_2014ab_Mag_ep71      = contscaled20140519_sn2014ab_1(2,:);
wave_2014ab_Bok_ep75_78   = d20140523_sn2014ab_1(1,:);
flux_2014ab_Bok_ep75_78   = median(flux_2014ab_Bok_ep75_78_part,1);
wave_2014ab_VLT_ep78      = d20140526_sn2014ab_2(1,:);
flux_2014ab_VLT_ep78      = contscaled20140526_sn2014ab_2(2,:);
wave_2014ab_Lic_ep80      = d20140528_sn2014ab_1(1,:);
flux_2014ab_Lic_ep80      = contscaled20140528_sn2014ab_1(2,:);
wave_2014ab_VLT_ep85      = d20140602_sn2014ab_1(1,:);
flux_2014ab_VLT_ep85      = contscaled20140602_sn2014ab_1(2,:);
wave_2014ab_Lic_ep104     = d20140621_sn2014ab_1(1,:);
flux_2014ab_Lic_ep104     = contscaled20140621_sn2014ab_1(2,:);
wave_2014ab_Kui_ep105_109 = d20140622_sn2014ab_1(1,:);
flux_2014ab_Kui_ep105_109 = median(flux_2014ab_Kui_ep105_109_part,1);
wave_2014ab_Lic_ep113     = d20140630_sn2014ab_1(1,:);
flux_2014ab_Lic_ep113     = contscaled20140630_sn2014ab_1(2,:);
wave_2014ab_VLT_ep135     = d20140722_sn2014ab_1(1,:);
flux_2014ab_VLT_ep135     = median(flux_2014ab_VLT_ep135_part,1);
wave_2014ab_VLT_ep152     = d20140808_sn2014ab_1(1,:);
flux_2014ab_VLT_ep152     = contscaled20140808_sn2014ab_1(2,:);

%axis conversion to velocity relative to Paschen Beta
%velocity in km/s
%lambdaPabeta = 12822;
%velPabeta_20140526 = 10^-5 .* c.* (wave_2014ab_VLT_ep78-lambdaPabeta)./lambdaPabeta;
%velPabeta_20140602 = 10^-5 .* c.* (wave_2014ab_VLT_ep85-lambdaPabeta)./lambdaPabeta;
%velPabeta_20140722 = 10^-5 .* c.* (wave_2014ab_VLT_ep135-lambdaPabeta)./lambdaPabeta;
%velPabeta_20140808 = 10^-5 .* c.* (wave_2014ab_VLT_ep152-lambdaPabeta)./lambdaPabeta;


%Pabetafit2014ab_VLT_ep78= fit(wave_2014ab_VLT_ep78(1,[find(wave_2014ab_VLT_ep78(1,:)>12522,3,'first') find(wave_2014ab_VLT_ep78(1,:)<13122,3,'last')])',flux_2014ab_VLT_ep78([find(wave_2014ab_VLT_ep78(1,:)>12522,3,'first') find(wave_2014ab_VLT_ep78(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant2014ab_VLT_ep78= mean(Pabetafit2014ab_VLT_ep78(wave_2014ab_VLT_ep78(1,(wave_2014ab_VLT_ep78(1,:)>12722 & wave_2014ab_VLT_ep78(1,:)<12922))));
%Pabetauniscale2014ab_VLT_ep78= flux_2014ab_VLT_ep78/Pabetanormconstant2014ab_VLT_ep78;
%Pabetavarscaledsub2014ab_VLT_ep78= (flux_2014ab_VLT_ep78 - Pabetafit2014ab_VLT_ep78(wave_2014ab_VLT_ep78(1,:))')./Pabetafit2014ab_VLT_ep78(wave_2014ab_VLT_ep78(1,:))';
%
%Pabetafit20140602_sn2014ab= fit(d20140602_sn2014ab(1,[find(d20140602_sn2014ab(1,:)>12522,3,'first') find(d20140602_sn2014ab(1,:)<13122,3,'last')])',d20140602_sn2014ab(2,[find(d20140602_sn2014ab(1,:)>12522,3,'first') find(d20140602_sn2014ab(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant20140602_sn2014ab= mean(Pabetafit20140602_sn2014ab(d20140602_sn2014ab(1,(d20140602_sn2014ab(1,:)>12722 & d20140602_sn2014ab(1,:)<12922))));
%Pabetauniscaled20140602_sn2014ab= d20140602_sn2014ab(2,:)/Pabetanormconstant20140602_sn2014ab;
%Pabetavarscaledsub20140602_sn2014ab= (d20140602_sn2014ab(2,:) - Pabetafit20140602_sn2014ab(d20140602_sn2014ab(1,:))')./Pabetafit20140602_sn2014ab(d20140602_sn2014ab(1,:))';
%
%Pabetafit20140722_sn2014ab= fit(d20140722_sn2014ab(1,[find(d20140722_sn2014ab(1,:)>12522,3,'first') find(d20140722_sn2014ab(1,:)<13122,3,'last')])',d20140722_sn2014ab(2,[find(d20140722_sn2014ab(1,:)>12522,3,'first') find(d20140722_sn2014ab(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant20140722_sn2014ab= mean(Pabetafit20140722_sn2014ab(d20140722_sn2014ab(1,(d20140722_sn2014ab(1,:)>12722 & d20140722_sn2014ab(1,:)<12922))));
%Pabetauniscaled20140722_sn2014ab= d20140722_sn2014ab(2,:)/Pabetanormconstant20140722_sn2014ab;
%Pabetavarscaledsub20140722_sn2014ab= (d20140722_sn2014ab(2,:) - Pabetafit20140722_sn2014ab(d20140722_sn2014ab(1,:))')./Pabetafit20140722_sn2014ab(d20140722_sn2014ab(1,:))';
%
%Pabetafit20140808_sn2014ab= fit(d20140808_sn2014ab(1,[find(d20140808_sn2014ab(1,:)>12522,3,'first') find(d20140808_sn2014ab(1,:)<13122,3,'last')])',d20140808_sn2014ab(2,[find(d20140808_sn2014ab(1,:)>12522,3,'first') find(d20140808_sn2014ab(1,:)<13122,3,'last')])','poly1','Robust','Bisquare');
%Pabetanormconstant20140808_sn2014ab= mean(Pabetafit20140808_sn2014ab(d20140808_sn2014ab(1,(d20140808_sn2014ab(1,:)>12722 & d20140808_sn2014ab(1,:)<12922))));
%Pabetauniscaled20140808_sn2014ab= d20140808_sn2014ab(2,:)/Pabetanormconstant20140808_sn2014ab;
%Pabetavarscaledsub20140808_sn2014ab= (d20140808_sn2014ab(2,:) - Pabetafit20140808_sn2014ab(d20140808_sn2014ab(1,:))')./Pabetafit20140808_sn2014ab(d20140808_sn2014ab(1,:))';
%
%
%clf
%plot(Pabetafit2014ab_VLT_ep78,wave_2014ab_VLT_ep78,flux_2014ab_VLT_ep78)
%axis



%ratio calcs

roverbratio = rightEWHalpha./leftEWHalpha
roverbratioerr = roverbratio  .* sqrt((rightdEWHalpha./rightEWHalpha).^2 + (leftdEWHalpha./leftEWHalpha).^2)



%change if we change the reldate system
medianCSSfluxwithnoSN = median(10.^(absmagVCSS_sn2014ab(find( (LCCSSreldateV_sn2014ab<-75) | (LCCSSreldateV_sn2014ab>200) ))./-2.5))
medianCSSmagwithnoSN = -2.5*log10(median(10.^(absmagVCSS_sn2014ab(find( (LCCSSreldateV_sn2014ab<-75) | (LCCSSreldateV_sn2014ab>200) ))./-2.5)))
absmagVCSS_sn2014ab_mediansubtracted = -2.5.*log10(10.^(absmagVCSS_sn2014ab./-2.5) - medianCSSfluxwithnoSN);



%%%zzz need to add in the 2nd ESO data on the 2nd to last date


%12822
%1
Paschenbetafit20140526_sn2014ab_2= fit(d20140526_sn2014ab_2(1,[find(d20140526_sn2014ab_2(1,:)>12400,25,'first') find(d20140526_sn2014ab_2(1,:)<15000,25,'last')])',d20140526_sn2014ab_2(2,[find(d20140526_sn2014ab_2(1,:)>12400,25,'first') find(d20140526_sn2014ab_2(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140526_sn2014ab_2= mean(Paschenbetafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,(d20140526_sn2014ab_2(1,:)>(12822-300) & d20140526_sn2014ab_2(1,:)<(12822+300)))));
Paschenbetauniscaled20140526_sn2014ab_2= d20140526_sn2014ab_2(2,:)/Paschenbetanormconstant20140526_sn2014ab_2;
Paschenbetavarscaledsub20140526_sn2014ab_2= (d20140526_sn2014ab_2(2,:) - Paschenbetafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))')./Paschenbetafit20140526_sn2014ab_2(d20140526_sn2014ab_2(1,:))';

clf
plot(Paschenbetafit20140526_sn2014ab_2,d20140526_sn2014ab_2(1,:),d20140526_sn2014ab_2(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140526_2 = 10^-5 .* c.* (d20140526_sn2014ab_2(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(1)  = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= (12822-300) & d20140526_sn2014ab_2(1,:) <= (12822))),Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= (12822-300) & d20140526_sn2014ab_2(1,:) <= (12822))))
PabetaleftNEWerr(1)  = 5*std(Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 12000 & d20140526_sn2014ab_2(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(1)  = PabetaleftNEWerr(1)  * PabetaleftEWPaschenbeta(1) ;
PabetarightEWPaschenbeta(1)  = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= (12822) & d20140526_sn2014ab_2(1,:) <= (12822+300))),Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= (12822) & d20140526_sn2014ab_2(1,:) <= (12822+300))))
PabetarightNEWerr(1)  = 5*std(Paschenbetavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 13150 & d20140526_sn2014ab_2(1,:) <= 13200)));
PabetarightdEWPaschenbeta(1)  = PabetarightNEWerr(1)  * PabetarightEWPaschenbeta(1) 

%2
Paschenbetafit20140602_sn2014ab_1= fit(d20140602_sn2014ab_1(1,[find(d20140602_sn2014ab_1(1,:)>12400,25,'first') find(d20140602_sn2014ab_1(1,:)<15000,25,'last')])',d20140602_sn2014ab_1(2,[find(d20140602_sn2014ab_1(1,:)>12400,25,'first') find(d20140602_sn2014ab_1(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140602_sn2014ab_1= mean(Paschenbetafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,(d20140602_sn2014ab_1(1,:)>(12822-300) & d20140602_sn2014ab_1(1,:)<(12822+300)))));
Paschenbetauniscaled20140602_sn2014ab_1= d20140602_sn2014ab_1(2,:)/Paschenbetanormconstant20140602_sn2014ab_1;
Paschenbetavarscaledsub20140602_sn2014ab_1= (d20140602_sn2014ab_1(2,:) - Paschenbetafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))')./Paschenbetafit20140602_sn2014ab_1(d20140602_sn2014ab_1(1,:))';

clf
plot(Paschenbetafit20140602_sn2014ab_1,d20140602_sn2014ab_1(1,:),d20140602_sn2014ab_1(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140602_1 = 10^-5 .* c.* (d20140602_sn2014ab_1(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(2)  = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= (12822-300) & d20140602_sn2014ab_1(1,:) <= (12822))),Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= (12822-300) & d20140602_sn2014ab_1(1,:) <= (12822))))
PabetaleftNEWerr(2)  = 5*std(Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 12000 & d20140602_sn2014ab_1(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(2)  = PabetaleftNEWerr(2)  * PabetaleftEWPaschenbeta(2) ;
PabetarightEWPaschenbeta(2)  = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= (12822) & d20140602_sn2014ab_1(1,:) <= (12822+300))),Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= (12822) & d20140602_sn2014ab_1(1,:) <= (12822+300))))
PabetarightNEWerr(2)  = 5*std(Paschenbetavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 13150 & d20140602_sn2014ab_1(1,:) <= 13200)));
PabetarightdEWPaschenbeta(2)  = PabetarightNEWerr(2)  * PabetarightEWPaschenbeta(2) 


%3
Paschenbetafit20140722_sn2014ab_1= fit(d20140722_sn2014ab_1(1,[find(d20140722_sn2014ab_1(1,:)>12400,25,'first') find(d20140722_sn2014ab_1(1,:)<15000,25,'last')])',d20140722_sn2014ab_1(2,[find(d20140722_sn2014ab_1(1,:)>12400,25,'first') find(d20140722_sn2014ab_1(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140722_sn2014ab_1= mean(Paschenbetafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,(d20140722_sn2014ab_1(1,:)>(12822-300) & d20140722_sn2014ab_1(1,:)<(12822+300)))));
Paschenbetauniscaled20140722_sn2014ab_1= d20140722_sn2014ab_1(2,:)/Paschenbetanormconstant20140722_sn2014ab_1;
Paschenbetavarscaledsub20140722_sn2014ab_1= (d20140722_sn2014ab_1(2,:) - Paschenbetafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))')./Paschenbetafit20140722_sn2014ab_1(d20140722_sn2014ab_1(1,:))';

clf
plot(Paschenbetafit20140722_sn2014ab_1,d20140722_sn2014ab_1(1,:),d20140722_sn2014ab_1(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140722_1 = 10^-5 .* c.* (d20140722_sn2014ab_1(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(3)  = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= (12822-300) & d20140722_sn2014ab_1(1,:) <= (12822))),Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= (12822-300) & d20140722_sn2014ab_1(1,:) <= (12822))))
PabetaleftNEWerr(3)  = 5*std(Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 12000 & d20140722_sn2014ab_1(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(3)  = PabetaleftNEWerr(3)  * PabetaleftEWPaschenbeta(3) ;
PabetarightEWPaschenbeta(3)  = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= (12822) & d20140722_sn2014ab_1(1,:) <= (12822+300))),Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= (12822) & d20140722_sn2014ab_1(1,:) <= (12822+300))))
PabetarightNEWerr(3)  = 5*std(Paschenbetavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 13150 & d20140722_sn2014ab_1(1,:) <= 13200)));
PabetarightdEWPaschenbeta(3)  = PabetarightNEWerr(3)  * PabetarightEWPaschenbeta(3) 


%4
Paschenbetafit20140808_sn2014ab_1= fit(d20140808_sn2014ab_1(1,[find(d20140808_sn2014ab_1(1,:)>12400,25,'first') find(d20140808_sn2014ab_1(1,:)<15000,25,'last')])',d20140808_sn2014ab_1(2,[find(d20140808_sn2014ab_1(1,:)>12400,25,'first') find(d20140808_sn2014ab_1(1,:)<15000,25,'last')])','poly1','Robust','Bisquare');
Paschenbetanormconstant20140808_sn2014ab_1= mean(Paschenbetafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,(d20140808_sn2014ab_1(1,:)>(12822-300) & d20140808_sn2014ab_1(1,:)<(12822+300)))));
Paschenbetauniscaled20140808_sn2014ab_1= d20140808_sn2014ab_1(2,:)/Paschenbetanormconstant20140808_sn2014ab_1;
Paschenbetavarscaledsub20140808_sn2014ab_1= (d20140808_sn2014ab_1(2,:) - Paschenbetafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))')./Paschenbetafit20140808_sn2014ab_1(d20140808_sn2014ab_1(1,:))';

clf
plot(Paschenbetafit20140808_sn2014ab_1,d20140808_sn2014ab_1(1,:),d20140808_sn2014ab_1(2,:))
axis([[10000 16000] [-0.1*10^-14 0.1 *10^-14]])
line([12822 12822],[-1 1],'LineStyle','--','Color',[0 0 0],'LineWidth',1)

%axis conversion to velocity relative to Paschenbeta
%velocity in km/s
lambdaPaschenbeta = 12822;
c=3*10^10;
velPaschenbeta_20140808_1 = 10^-5 .* c.* (d20140808_sn2014ab_1(1,:)-lambdaPaschenbeta)./lambdaPaschenbeta;

PabetaleftEWPaschenbeta(4)  = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= (12822-300) & d20140808_sn2014ab_1(1,:) <= (12822))),Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= (12822-300) & d20140808_sn2014ab_1(1,:) <= (12822))))
PabetaleftNEWerr(4)  = 5*std(Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 12000 & d20140808_sn2014ab_1(1,:) <= 12500)));
PabetaleftdEWPaschenbeta(4)  = PabetaleftNEWerr(4)  * PabetaleftEWPaschenbeta(4)
PabetarightEWPaschenbeta(4)  = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= (12822) & d20140808_sn2014ab_1(1,:) <= (12822+300))),Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= (12822) & d20140808_sn2014ab_1(1,:) <= (12822+300))))
PabetarightNEWerr(4)  = 5*std(Paschenbetavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 13150 & d20140808_sn2014ab_1(1,:) <= 13200)));
PabetarightdEWPaschenbeta(4)  = PabetarightNEWerr(4)  * PabetarightEWPaschenbeta(4) 



Pabetaroverbratio = PabetarightEWPaschenbeta./PabetaleftEWPaschenbeta
Pabetaroverbratioerr = Pabetaroverbratio  .* sqrt((PabetarightdEWPaschenbeta./PabetarightEWPaschenbeta).^2 + (PabetaleftdEWPaschenbeta./PabetaleftEWPaschenbeta).^2)











[bbodyfit11 , wavetemp11  ,bestT(1 ,1), bestalpha(1 ,1)] = blackbodyfit(d20140310_sn2014ab_1(1,:),contscaled20140310_sn2014ab_1(2,:),3000,6400)
[bbodyfit12 , wavetemp12  ,bestT(1 ,2), bestalpha(1 ,2)] = blackbodyfit(d20140310_sn2014ab_1(1,:),contscaled20140310_sn2014ab_1(2,:),7000,8200)
[bbodyfit21 , wavetemp21  ,bestT(2 ,1), bestalpha(2 ,1)] = blackbodyfit(d20140808_sn2014ab_3(1,:),contscaled20140808_sn2014ab_3(2,:),5400,6400)
[bbodyfit22 , wavetemp22  ,bestT(2 ,2), bestalpha(2 ,2)] = blackbodyfit(d20140808_sn2014ab_3(1,:),contscaled20140808_sn2014ab_3(2,:),7000,8200)



%plots



%%%
SPOLPlotter(d20140329_sn2014ab_1(1,:),d20140329_sn2014ab_1(2,:),d20140329_sn2014ab_1(3,:),d20140329_sn2014ab_1(4,:),'20140329',reldate(3),'SN2014ab','Bok')





%%%light curve plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
p1 = scatter(LCreldateB_sn2014ab,absmagB_sn2014ab,50,[0.0000 0.0000 1.0000],'filled')
errorbar(LCreldateB_sn2014ab,absmagB_sn2014ab,magerrorB_sn2014ab,'Color',[0.0000 0.0000 1.0000])
p2 = scatter(LCreldateV_sn2014ab,absmagV_sn2014ab,50,[0.0000 0.7255 0.0902],'filled')
errorbar(LCreldateV_sn2014ab,absmagV_sn2014ab,magerrorV_sn2014ab,'Color',[0.0000 0.7255 0.0902])
p3 = scatter(LCreldateR_sn2014ab,absmagR_sn2014ab,50,[1.0000 0.0000 0.0000],'filled')
errorbar(LCreldateR_sn2014ab,absmagR_sn2014ab,magerrorR_sn2014ab,'Color',[1.0000 0.0000 0.0000])
p4 = scatter(LCreldateI_sn2014ab,absmagI_sn2014ab,50,[0 0 0],'filled')
errorbar(LCreldateI_sn2014ab,absmagI_sn2014ab,magerrorI_sn2014ab,'Color',[0 0 0])
p5 = scatter(LCCSSreldateV_sn2014ab(find((LCCSSreldateV_sn2014ab>-75) & (LCCSSreldateV_sn2014ab<200))),absmagVCSS_sn2014ab_mediansubtracted(find((LCCSSreldateV_sn2014ab>-75) & (LCCSSreldateV_sn2014ab<200))),50,[0.0000 0.3922 0.0039],'filled')
errorbar(LCCSSreldateV_sn2014ab(find((LCCSSreldateV_sn2014ab>-75) & (LCCSSreldateV_sn2014ab<200))),absmagVCSS_sn2014ab_mediansubtracted(find((LCCSSreldateV_sn2014ab>-75) & (LCCSSreldateV_sn2014ab<200))),magerrorVCSS_sn2014ab(find((LCCSSreldateV_sn2014ab>-75) & (LCCSSreldateV_sn2014ab<200))),'Color',[0.0000 0.3922 0.0039])
p6 = scatter(LCCSSreldateV_sn2014ab,absmagVCSS_sn2014ab,50,[0.65 0.65 0.65],'filled')
errorbar(LCCSSreldateV_sn2014ab,absmagVCSS_sn2014ab,magerrorVCSS_sn2014ab,'Color',[0.65 0.65 0.65],'LineStyle',':')
line([1,1],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([15,15],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([20,20],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([21,21],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([22,22],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([24,24],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([48,48],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([49,49],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([50,50],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([52,52],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([53,53],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([75,75],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([76,76],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([78,78],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([80,80],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([104,104],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([105,105],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([106,106],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([107,107],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([109,109],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
line([113,113],[-17.75 -17.6],'LineStyle','--','Color',[0 0 0],'LineWidth',1)
htext = text(200,-19.55,'SN 2014ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',22)
htext = text(20,-18.48,'B','interpreter','latex')
set(htext, 'Color', [0.0000 0.0000 1.0000])
set(htext, 'FontSize',22)
htext = text(20,-18.84,'V','interpreter','latex')
set(htext, 'Color', [0.0000 0.7255 0.0902])
set(htext, 'FontSize',22)
htext = text(20,-19.37,'R','interpreter','latex')
set(htext, 'Color', [1.0000 0.0000 0.0000])
set(htext, 'FontSize',22)
htext = text(20,-19.50,'I','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',22)
htext = text(-65,-19.45,'CSS (V) ','interpreter','latex')
set(htext, 'Color',[0.0000 0.3922 0.0039])
set(htext, 'FontSize',22)
htext = text(100,-19.85,'CSS (V) host galaxy included','interpreter','latex')
set(htext, 'Color',[0.65 0.65 0.65])
set(htext, 'FontSize',22)
xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('Absolute Magnitude','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[-400 400] [-20 -17.5]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
set(ax1,'xtick',linspace(-400,400,17),'YTick',linspace(-20,-15,6))
atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%set(ax2,'xtick',get(ax1,'xtick'),'xticklab',get(ax1,'xticklab'))
ylabel(ax2,'')
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
annotation('textarrow',[0.535 0.535],[0.25 0.2],'String','Spectra','FontSize',22)
%legend([p1 p2 p3 p4],'B','V','R','I')

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Photometry.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Photometry.eps']);

export_fig Photometry.pdf

%%CSS full range plot

set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.7 0.9]);
clf
hold all
p5 = scatter(LCCSSreldateV_sn2014ab,absmagVCSS_sn2014ab,50,[0 0 0],'filled')
errorbar(LCCSSreldateV_sn2014ab,absmagVCSS_sn2014ab,magerrorVCSS_sn2014ab,'Color',[0 0 0])

htext = text(100,-19.80,'CSS (V)','interpreter','latex')
set(htext, 'Color',[0 0 0])
set(htext, 'FontSize',22)
xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('Absolute Magnitude','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
%title('', 'FontSize', 22)
axis([[-3300 800] [-20 -18.5]])
ax1 = gca;
set(gca,'XMinorTick','on','YMinorTick','on')
set(ax1,'xtick',-3500:500:1000,'YTick',linspace(-20,-15,6))
atick=get(gca,'TickLength');
atick(1) = atick(1)*5;
set(gca,'YDir','reverse');
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%set(ax2,'xtick',get(ax1,'xtick'),'xticklab',get(ax1,'xticklab'))
ylabel(ax2,'')
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',20)
set(ax2,'FontSize',20)
%annotation('textarrow',[0.535 0.535],[0.25 0.2],'String','Spectra','FontSize',22)
%legend([p1 p2 p3 p4],'B','V','R','I')

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\CSSFullRange.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\CSSFullRange.eps']);

export_fig CSSFullRange.pdf




%Condensed Full Spectrum Plot
clf
l1  = semilogy(wave_2014ab_NTT_ep1,      flux_2014ab_NTT_ep1,                'LineWidth',2,'Color',[0.0000 0.3922 0.0039])
hold on
l2  = semilogy(wave_2014ab_Lic_ep15,     6^-1 *   1 * flux_2014ab_Lic_ep15,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l3  = semilogy(wave_2014ab_Bok_ep20_24,  6^-2 *   1 * flux_2014ab_Bok_ep20_24,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l4  = semilogy(wave_2014ab_Kui_ep48_50,  6^-3 *   1 * flux_2014ab_Kui_ep48_50,  'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l5  = semilogy(wave_2014ab_Lic_ep52,     6^-4 *   1 * flux_2014ab_Lic_ep52,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l6  = semilogy(wave_2014ab_Kui_ep53 ,    6^-5 *   1 * flux_2014ab_Kui_ep53,     'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l7  = semilogy(wave_2014ab_Mag_ep71 ,    6^-6 *2* 1 * flux_2014ab_Mag_ep71,     'LineWidth',2,'Color',[0.4941 0.1765 0.8235])
l8  = semilogy(wave_2014ab_Bok_ep75_78,  6^-7 *2* 1 * flux_2014ab_Bok_ep75_78,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l9  = semilogy(wave_2014ab_VLT_ep78,     6^-8 *2* 15* flux_2014ab_VLT_ep78,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l10 = semilogy(wave_2014ab_Lic_ep80,     6^-9 *2* 1 * flux_2014ab_Lic_ep80,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l11 = semilogy(wave_2014ab_VLT_ep85,     6^-10*2* 15* flux_2014ab_VLT_ep85,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l12 = semilogy(wave_2014ab_Lic_ep104,    6^-11*2* 1 * flux_2014ab_Lic_ep104,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l13 = semilogy(wave_2014ab_Kui_ep105_109,6^-12*2* 1 * flux_2014ab_Kui_ep105_109,'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l14 = semilogy(wave_2014ab_Lic_ep113,    6^-13*2* 1 * flux_2014ab_Lic_ep113,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l15 = semilogy(wave_2014ab_VLT_ep135,    6^-14*2* 25* flux_2014ab_VLT_ep135,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l16 = semilogy(wave_2014ab_VLT_ep152,    6^-15*2* 1 * flux_2014ab_VLT_ep152,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
  
legend([l1, l2, l3, l4, l7, l9],'ESO-NTT','Lick','Bok','Kuiper', 'Magellan', 'ESO-VLT')
line([4101 4101],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4340 4340],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4861 4861],[0.55 0.85],'LineStyle','-','Color',[0 0 0])
line([4959 4959],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5007 5007],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5876 5876],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
line([5896 5896],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
%line([6548 6548],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
line([6562.81 6562.81],[1.3 2.3],'LineStyle','-','Color',[0 0 0])
%line([6583 6583],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
%line([6717 6717],[0.5 1],'LineStyle','-','Color',[0 0 0])
%line([6731 6731],[0.5 1],'LineStyle','-','Color',[0 0 0])
htext = text(4101,0.9,'H\delta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4340,0.9,'H\gamma','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4861,0.95,'H\beta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4983,0.9,'[OIII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5876-22,0.4,'HeI\lambda5876','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5896+22,0.4,'NaID','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6565.5,11.5,'[NII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6562.81,2.5,'H\alpha','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6724,1.1,'[SII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6754,0.22,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(7050,5,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(7100,0.8 *2*6^-1 ,'day 1'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.3922 0.0039])
htext = text(7100,0.8 *2*6^-2 ,'day 15'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.8 *2*6^-3 ,'days 20-24'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext = text(7100,0.7 *2*6^-4 ,'days 48-50'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,0.65*2*6^-5 ,'day 52'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.8 *2*6^-6 ,'day 53'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,0.9 *2*6^-7 ,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.4941 0.1765 0.8235])
htext = text(7100,1.2 *2*6^-8 ,'days 75-78'  ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext = text(7100,1.6 *2*6^-9 ,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,1.5 *2*6^-10,'day 80'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,1.5 *2*6^-11,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,1.05*2*6^-12,'day 104'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,1.05*2*6^-13,'days 105-109','FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,1.0 *2*6^-14,'day 113'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.55*2*6^-15,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,0.18*2*6^-16,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])


xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3400 10000] [10^-14*2 25]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\FullSpectrum.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\FullSpectrum.eps']);

export_fig FullSpectrum.pdf



%Condensed Full Spectrum Plot in nonlog
clf
l1  = plot(wave_2014ab_NTT_ep1,      25* flux_2014ab_NTT_ep1,                'LineWidth',2,'Color',[0.0000 0.3922 0.0039])
hold on
l2  = plot(wave_2014ab_Lic_ep15,     2 *   1 * flux_2014ab_Lic_ep15,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l3  = plot(wave_2014ab_Bok_ep20_24,  6^-2 *   1 * flux_2014ab_Bok_ep20_24,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l4  = plot(wave_2014ab_Kui_ep48_50,  6^-3 *   1 * flux_2014ab_Kui_ep48_50,  'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l5  = plot(wave_2014ab_Lic_ep52,     6^-4 *   1 * flux_2014ab_Lic_ep52,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l6  = plot(wave_2014ab_Kui_ep53 ,    6^-5 *   1 * flux_2014ab_Kui_ep53,     'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l7  = plot(wave_2014ab_Mag_ep71 ,    6^-6 *2* 1 * flux_2014ab_Mag_ep71,     'LineWidth',2,'Color',[0.4941 0.1765 0.8235])
l8  = plot(wave_2014ab_Bok_ep75_78,  6^-7 *2* 1 * flux_2014ab_Bok_ep75_78,  'LineWidth',2,'Color',[1.0000 0.0000 0.0000])
l9  = plot(wave_2014ab_VLT_ep78,     6^-8 *2* 15* flux_2014ab_VLT_ep78,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l10 = plot(wave_2014ab_Lic_ep80,     6^-9 *2* 1 * flux_2014ab_Lic_ep80,     'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l11 = plot(wave_2014ab_VLT_ep85,     6^-10*2* 15* flux_2014ab_VLT_ep85,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l12 = plot(wave_2014ab_Lic_ep104,    6^-11*2* 1 * flux_2014ab_Lic_ep104,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l13 = plot(wave_2014ab_Kui_ep105_109,6^-12*2* 1 * flux_2014ab_Kui_ep105_109,'LineWidth',2,'Color',[0.0000 0.7255 0.0902])
l14 = plot(wave_2014ab_Lic_ep113,    6^-13*2* 1 * flux_2014ab_Lic_ep113,    'LineWidth',2,'Color',[0.0000 0.0000 1.0000])
l15 = plot(wave_2014ab_VLT_ep135,    15*2* 25* flux_2014ab_VLT_ep135,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l16 = plot(wave_2014ab_VLT_ep152,    6^-15*2* 1 * flux_2014ab_VLT_ep152,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
  
legend([l1, l2, l3, l4, l7, l9],'ESO-NTT','Lick','Bok','Kuiper', 'Magellan', 'ESO-VLT')
line([4101 4101],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4340 4340],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([4861 4861],[0.55 0.85],'LineStyle','-','Color',[0 0 0])
line([4959 4959],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5007 5007],[0.5 0.8],'LineStyle','-','Color',[0 0 0])
line([5876 5876],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
line([5896 5896],[0.2 0.35],'LineStyle','-','Color',[0 0 0])
%line([6548 6548],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
line([6562.81 6562.81],[1.3 2.3],'LineStyle','-','Color',[0 0 0])
%line([6583 6583],[9.5 11.5],'LineStyle','-','Color',[0 0 0])
%line([6717 6717],[0.5 1],'LineStyle','-','Color',[0 0 0])
%line([6731 6731],[0.5 1],'LineStyle','-','Color',[0 0 0])
htext = text(4101,0.9,'H\delta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4340,0.9,'H\gamma','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4861,0.95,'H\beta','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(4983,0.9,'[OIII]','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5876-22,0.4,'HeI\lambda5876','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
htext = text(5896+22,0.4,'NaID','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6565.5,11.5,'[NII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6562.81,2.5,'H\alpha','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',15)
%htext = text(6724,1.1,'[SII]','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',15)
htext = text(6754,0.22,'$\bigoplus$','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'rotation', 90)
set(htext, 'FontSize',12)
htext = text(7050,5,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(7100,0.8 *2*6^-1 ,'day 1'       ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.3922 0.0039])
htext = text(7100,0.8 *2*6^-2 ,'day 15'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.8 *2*6^-3 ,'days 20-24'  ,'FontName','CMU Serif Roman','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext = text(7100,0.7 *2*6^-4 ,'days 48-50'  ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,0.65*2*6^-5 ,'day 52'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.8 *2*6^-6 ,'day 53'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,0.9 *2*6^-7 ,'day 71'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.4941 0.1765 0.8235])
htext = text(7100,1.2 *2*6^-8 ,'days 75-78'  ,'FontName','CMU Serif Roman','FontSize',15,'Color',[1.0000 0.0000 0.0000])
htext = text(7100,1.6 *2*6^-9 ,'day 78'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,1.5 *2*6^-10,'day 80'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,1.5 *2*6^-11,'day 85'      ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,1.05*2*6^-12,'day 104'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,1.05*2*6^-13,'days 105-109','FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.7255 0.0902])
htext = text(7100,1.0 *2*6^-14,'day 113'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.0000 0.0000 1.0000])
htext = text(7100,0.55*2*6^-15,'day 135'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(7100,0.18*2*6^-16,'day 152'     ,'FontName','CMU Serif Roman','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
set(htext, 'Color',[0.8 0.8 0.8])


xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3400 10000] [10^-14*2 25]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')


saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Spectrumnonlog.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Spectrumnonlog.eps']);





















%%IR Spectra Plot
%clf
%l1  = semilogy(wave_2014ab_VLT_ep78./10000,     6^0  *10* flux_2014ab_VLT_ep78,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%hold on                            
%l2 = semilogy(wave_2014ab_VLT_ep85 ./10000,     6^-1 *18  * flux_2014ab_VLT_ep85,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l3 = semilogy(wave_2014ab_VLT_ep135./10000,     6^-2 *45  * flux_2014ab_VLT_ep135,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l4 = semilogy(wave_2014ab_VLT_ep152./10000,     6^-3 *5   * flux_2014ab_VLT_ep152,    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%  
%legend([l1], 'ESO-VLT')
%
%
%%line([6731 6731],[0.5 1],'LineStyle','-','Color',[0 0 0])
%
%htext = text(1.2822,0.25,'Pa $\beta$','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'rotation', 90)
%set(htext, 'FontSize',18)
%htext = text(1.3500,0.3,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
%set(htext, 'Color', 'black')	
%set(htext, 'FontSize',26)
%
%htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman')
%set(htext, 'Color',[0.8 0.8 0.8])
%
%
%xlabel('Rest Wavelength ($\mu$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%axis([[1 1.5] [10^-5*2 1]])
%ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',22)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
%set(ax1,'FontSize',22)
%set(ax2,'FontSize',22)
%set(ax1,'XMinorTick','on','YMinorTick','on')
%
%saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrum.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrum.eps']);







%IR Spectra Plot full
clf
l1j  = semilogy(wave_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13250))./10000,     6^0  *10* smooth(flux_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
hold on  
l1h  = semilogy(wave_2014ab_VLT_ep78(((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)))./10000,     6^0  *10* smooth(flux_2014ab_VLT_ep78(((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l1k  = semilogy(wave_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 > 19000))./10000,     6^0  *10* smooth(flux_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l2j  = semilogy(wave_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13250))./10000,     6^-1 *18* smooth(flux_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
l2h  = semilogy(wave_2014ab_VLT_ep85(((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)))./10000,     6^-1 *18* smooth(flux_2014ab_VLT_ep85(((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l2k  = semilogy(wave_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 > 19000))./10000,     6^-1 *18* smooth(flux_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l3j  = semilogy(wave_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13250))./10000,     6^-2 *45* smooth(flux_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000]) 
l3h  = semilogy(wave_2014ab_VLT_ep135(((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)))./10000,     6^-2 *45* smooth(flux_2014ab_VLT_ep135(((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l3k  = semilogy(wave_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 > 19000))./10000,     6^-2 *45* smooth(flux_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l4j  = semilogy(wave_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13250))./10000,     6^-3 *5* smooth(flux_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13250))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000]) 
l4h  = semilogy(wave_2014ab_VLT_ep152(((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)))./10000,     6^-3 *5* smooth(flux_2014ab_VLT_ep152(((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)))),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        
l4k  = semilogy(wave_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 > 19000))./10000,     6^-3 *5* smooth(flux_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 > 19000)))   ,     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])                                                                        

l5_sn2010jl = semilogy(p_sn2010jl(1,:)./10000,2*10^-4*d_sn2010jl(2,:)./max(d_sn2010jl(2,:)),'LineWidth',2,'Color',[0.0000 0.6824 0.4941]);

legend([l1j, l5_sn2010jl], 'ESO-VLT','APO TripleSpec')

htext = text(1.077,0.25,'He I 1.0830','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.0830 1.0830],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.1,0.25,'Pa $\gamma$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.094 1.094],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.1287,0.25,'O I 1.1287','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.1287 1.1287],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.2822,0.25,'Pa $\beta$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.2822 1.2822],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.64117,0.25,'Br 12-4','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.64117 1.64117],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.68111,0.25,'Br 11-4','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.68111 1.68111],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.73669,0.25,'Br 10-4','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.73669 1.73669],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.9451,0.25,'Br $\delta$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([1.9451 1.9451],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(2.0589,0.25,'He I 2.0589','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([2.0589 2.0589],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(2.1661,0.25,'Br $\gamma$','interpreter','latex','FontName','CMU Serif Roman','rotation', 90,'FontSize',18)
line([2.1661 2.1661],[0.000001 0.24],'LineStyle','--','Color',[0.4 0.4 0.4],'LineWidth',1)

htext = text(1.3500,0.3,'SN 2014ab','interpreter','latex','FontName','CMU Serif')
set(htext, 'Color', [0.9961 0.5373 0.0000])	
set(htext, 'FontSize',26)

htext = text(1.55,0.035 ,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(1.55,0.007 ,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(1.55,0.0012,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])
htext = text(1.55,0.000175,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.9961 0.5373 0.0000])

htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman','interpreter','latex')
set(htext, 'Color',[0.8 0.8 0.8])

htext = text(1.46,0.0000325,'day 178 SN 2010jl','FontName','CMU Serif Roman','interpreter','latex','FontSize',15,'Color',[0.0000 0.6824 0.4941])


xlabel('Rest Wavelength ($\mu$m) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[1 2.5] [7*10^-6 1.6]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig IRSpectrumfull.pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrumfull.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\IRSpectrumfull.eps']);

%backup old numbers that line up exactly with J H K 
%clf
%l1  = semilogy(wave_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13680) | ((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)) | (wave_2014ab_VLT_ep78 > 19550))./10000,     smooth(6^0  *10* flux_2014ab_VLT_ep78((wave_2014ab_VLT_ep78 < 13680) | ((wave_2014ab_VLT_ep78 > 14660) & (wave_2014ab_VLT_ep78 < 17590)) | (wave_2014ab_VLT_ep78 > 19550))   ),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%hold on                                                                          
%l2 = semilogy(wave_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13680) | ((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)) | (wave_2014ab_VLT_ep85 > 19550)) ./10000,     smooth(6^-1 *18  * flux_2014ab_VLT_ep85((wave_2014ab_VLT_ep85 < 13680) | ((wave_2014ab_VLT_ep85 > 14660) & (wave_2014ab_VLT_ep85 < 17590)) | (wave_2014ab_VLT_ep85 > 19550)) ),     'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l3 = semilogy(wave_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13680) | ((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)) | (wave_2014ab_VLT_ep135 > 19550))./10000,     smooth(6^-2 *45  * flux_2014ab_VLT_ep135((wave_2014ab_VLT_ep135 < 13680) | ((wave_2014ab_VLT_ep135 > 14660) & (wave_2014ab_VLT_ep135 < 17590)) | (wave_2014ab_VLT_ep135 > 19550))),    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])
%l4 = semilogy(wave_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13680) | ((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)) | (wave_2014ab_VLT_ep152 > 19550))./10000,     smooth(6^-3 *5   * flux_2014ab_VLT_ep152((wave_2014ab_VLT_ep152 < 13680) | ((wave_2014ab_VLT_ep152 > 14660) & (wave_2014ab_VLT_ep152 < 17590)) | (wave_2014ab_VLT_ep152 > 19550))),    'LineWidth',2,'Color',[0.9961 0.5373 0.0000])


%line([1.075 1.075],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%line([1.368 1.368],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%
%line([1.466 1.466],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%line([1.759 1.759],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%
%line([1.955 1.955],[0.00001 1],'LineStyle','-','Color',[0 0 0])
%line([2.346 2.346],[0.00001 1],'LineStyle','-','Color',[0 0 0])



         0    1.0000         0
         0    1.0000    0.2000
         0    1.0000    0.4000
         0    1.0000    0.6000
         0    1.0000    0.8000
         0    1.0000    1.0000
         0    0.8000    1.0000
         0    0.6000    1.0000
         0    0.4000    1.0000
         0    0.2000    1.0000
         0         0    1.0000
    0.2000         0    1.0000
    0.4000         0    1.0000
    0.6000         0    1.0000
    0.8000         0    1.0000
    1.0000         0    1.0000
    1.0000         0    0.8000
    1.0000         0    0.6000
    1.0000         0    0.4000
    1.0000         0    0.2000
    1.0000         0         0
    0.8000         0         0
    0.6000         0         0
    0.4000         0         0
    0.2000         0         0
         0         0         0

































%%%Halpha Velocity Plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velHalpha_20140310_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))/10^3,    halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color', [     0    1.0000         0])
hold all                                                                                                                                                                                                                                                                                                                        )                                
plot(velHalpha_20140324_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.2000])
plot(velHalpha_20140329_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.4000])
plot(velHalpha_20140330_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.6000])
plot(velHalpha_20140331_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    0.8000])
plot(velHalpha_20140402_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    1.0000    1.0000])
plot(velHalpha_20140426_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.8000    1.0000])
plot(velHalpha_20140427_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.6000    1.0000])
plot(velHalpha_20140428_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.4000    1.0000])
plot(velHalpha_20140430_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0    0.2000    1.0000])
plot(velHalpha_20140501_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0    1.0000])
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.2000         0    1.0000])
plot(velHalpha_20140523_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.4000         0    1.0000])
plot(velHalpha_20140524_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.6000         0    1.0000])
plot(velHalpha_20140526_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.8000         0    1.0000])
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    1.0000])
plot(velHalpha_20140528_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.8000])
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,1.80*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.6000])
plot(velHalpha_20140621_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.4000])
plot(velHalpha_20140622_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0    0.2000])
plot(velHalpha_20140623_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[1.0000         0         0])
plot(velHalpha_20140624_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.8000         0         0])
plot(velHalpha_20140626_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.6000         0         0])
plot(velHalpha_20140630_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))/10^3,     halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.4000         0         0])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,1.60*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.2000         0         0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.50*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[     0         0         0])
line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1]])

htext = text(-7,0.9,'day 1'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000         0])
htext = text(-7,0.8,'day 15'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.2000])
htext = text(-7,0.7,'day 20'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.4000])
htext = text(-7,0.6,'day 21'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.6000])
htext = text(-7,0.5,'day 22'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    0.8000])
htext = text(-7,0.4,'day 24'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    1.0000    1.0000])
htext = text(-5,0.9,'day 48'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.8000    1.0000])
htext = text(-5,0.8,'day 49'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.6000    1.0000])
htext = text(-5,0.7,'day 50'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.4000    1.0000])
htext = text(-5,0.6,'day 52'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0    0.2000    1.0000])
htext = text(-5,0.5,'day 53'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0    1.0000])
htext = text(-5,0.4,'day 71'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2000         0    1.0000])
htext = text(-3,0.9,'day 75'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4000         0    1.0000])
htext = text(2,0.9,'day 76'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.6000         0    1.0000])
htext = text(4,0.9,'day 78'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8000         0    1.0000])
htext = text(4,0.8,'day 78'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    1.0000])
htext = text(4,0.7,'day 80'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.8000])
htext = text(4,0.6,'day 85'       ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.6000])
htext = text(4,0.5,'day 104'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.4000])
htext = text(4,0.4,'day 105'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0    0.2000])
htext = text(6,0.9,'day 106'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1.0000         0         0])
htext = text(6,0.8,'day 107'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8000         0         0])
htext = text(6,0.7,'day 109'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.6000         0         0])
htext = text(6,0.6,'day 113'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.4000         0         0])
htext = text(6,0.5,'day 135'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2000         0         0])
htext = text(6,0.4,'day 152'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[     0         0         0])

%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%set(htext, 'Color',[0 0 0])
%set(htext, 'FontSize',30)
htext = text(-7,3.2,'H\alpha ')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
set(htext, 'Color', 'black')
set(htext, 'FontSize',32)
htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig HalphaVelocity.pdf

export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocity.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\HalphaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);



%paschen beta velocity plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velPaschenbeta_20140526_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))/10^3,4.1*smooth(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322)))./max(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))),'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
hold all
plot(velPaschenbeta_20140602_1(find(wave_2014ab_VLT_ep85>12322 & wave_2014ab_VLT_ep85<13322))/10^3,4.4 *smooth(Paschenbetavarscaledsub20140602_sn2014ab_1(find(wave_2014ab_VLT_ep85>12322 & wave_2014ab_VLT_ep85<13322)))./max(Paschenbetavarscaledsub20140602_sn2014ab_1(find(wave_2014ab_VLT_ep85>12322 & wave_2014ab_VLT_ep85<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.8902 0.1020 0.1100])
plot(velPaschenbeta_20140722_1(find(wave_2014ab_VLT_ep135>12322 & wave_2014ab_VLT_ep135<13322))/10^3,4.3 *smooth(Paschenbetavarscaledsub20140722_sn2014ab_1(find(wave_2014ab_VLT_ep135>12322 & wave_2014ab_VLT_ep135<13322)))./max(Paschenbetavarscaledsub20140722_sn2014ab_1(find(wave_2014ab_VLT_ep135>12322 & wave_2014ab_VLT_ep135<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.2 0.6275 0.1725])
plot(velPaschenbeta_20140808_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))/10^3,1.5 *smooth(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322)))./max(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1]])

htext = text(-6,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.6,'Pa$\beta$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,0.8,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
htext = text(4,0.7,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
htext = text(4,0.6,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.5,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])


htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig PabetaVelocity.pdf
export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);





%halpha velocity plot limited to 5 high-res spectra
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
clf
plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
hold all                                                                                                                                                                                                                                                                                                                                                -
plot(velHalpha_20140602_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))/10^3,1.8*halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:)>6163 & d20140602_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.8902 0.1020 0.1100])
plot(velHalpha_20140722_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))/10^3,1.6*halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:)>6163 & d20140722_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.2 0.6275 0.1725])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])
plot(velHalpha_20140519_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))/10^3,1.54*halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140519_sn2014ab_1(find(d20140519_sn2014ab_1(1,:)>6163 & d20140519_sn2014ab_1(1,:)<6963))),'LineWidth',3,'Color',[0.9843 0.6039 0.6])

line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1]])

htext = text(-6,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-6,0.6,'H$\alpha$','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,0.9,'day 71 Magellan'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.9843 0.6039 0.6])
htext = text(4,0.8,'day 78 Xshooter'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
htext = text(4,0.7,'day 85 Xshooter'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
htext = text(4,0.6,'day 135 Xshooter'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.5,'day 152 Xshooter'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])

htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig HalphaVelocityHighRes.pdf


saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);




%halpha vs paschen beta comparison plot
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);

clf
plot(velPaschenbeta_20140526_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))/10^3,4.1*smooth(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322)))./max(Paschenbetavarscaledsub20140526_sn2014ab_2(find(wave_2014ab_VLT_ep78>12322 & wave_2014ab_VLT_ep78<13322))),'LineStyle','-','LineWidth',3,'Color',[1 0.45 0])
hold all
plot(velPaschenbeta_20140808_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))/10^3,1.5 *smooth(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322)))./max(Paschenbetavarscaledsub20140808_sn2014ab_1(find(wave_2014ab_VLT_ep152>12322 & wave_2014ab_VLT_ep152<13322))), 'LineStyle','-','LineWidth',3,'Color',[0.1216 0.4706 0.7059])

plot(velHalpha_20140526_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))/10^3,2.03*halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))./max(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:)>6163 & d20140526_sn2014ab_2(1,:)<6963))),'LineStyle','--','LineWidth',3,'Color',[1 0.45 0])
plot(velHalpha_20140808_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))/10^3,1.5*halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))./max(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:)>6163 & d20140808_sn2014ab_1(1,:)<6963))), 'LineStyle','--','LineWidth',3,'Color',[0.1216 0.4706 0.7059])


line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)

xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%title('', 'FontSize',25)
axis([[-8 8] [-0.1 1]])

htext = text(-7.5,0.8,'SN 2014ab','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])
htext = text(-7.5,0.6,'Pa$\beta$ (solid) vs. H$\alpha$ (dashed)','FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0 0 0])

htext = text(4,0.8,'day 78'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[1 0.45 0])
%htext = text(4,0.7,'day 85'      ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.8902 0.1020 0.1100])
%htext = text(4,0.6,'day 135'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.2 0.6275 0.1725])
htext = text(4,0.7,'day 152'     ,'FontName','CMU Serif Roman','interpreter','latex','FontSize',24,'Color',[0.1216 0.4706 0.7059])


htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
ax1 = gca;
%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%ylabel(ax2,'','FontSize',32)
%xlabel(ax2,'')
%set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',28)
%set(ax2,'FontSize',28)
set(ax1,'XMinorTick','on','YMinorTick','on')

export_fig PabetavsHalphaVelocity.pdf
export_fig C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.pdf -pdf

saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\PabetaVelocity.eps']);
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);


















%blue vs red line equivalent width plot for Halpha



clf
hold all
plt1 = scatter(reldate,roverbratio,75,[0.0000 0.0000 1.0000],'x')
errorbar(reldate,roverbratio,roverbratioerr,'.','Color','k')


%hL = legend([plt1 plt2],'','Location','Southeast')
htext = text(100,1.075,'Red side stronger','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(100,0.925,'Blue side stronger','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
line([-5 1000],[1 1],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Ratio of Red/Blue Flux','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 160],[0 1.2]])
box on
saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\bvsrratiored.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\bvsrratiored.eps']);



%blue vs red line equivalent width plot for Paschen beta

clf
hold all
plt1 = scatter(reldate([16 18 26:27]),Pabetaroverbratio,75,[0.0000 0.0000 1.0000],'x')
errorbar(reldate([16 18 26:27]),Pabetaroverbratio,PabetaleftdEWPaschenbeta./PabetaleftEWPaschenbeta,'.','Color','k')

%Pabetaroverbratioerr

%hL = legend([plt1 plt2],'','Location','Southeast')
htext = text(100,1.075,'Red side stronger','interpreter','latex')
set(htext, 'Color', [1 0 0])
set(htext, 'FontSize',22)
htext = text(100,0.925,'Blue side stronger','interpreter','latex')
set(htext, 'Color', [0 0 1])
set(htext, 'FontSize',22)
line([-5 1000],[1 1],'LineStyle','--','Color',[0.5 0.5 0.5],'LineWidth',3)

ax1 = gca;
set(ax1,'FontSize',32)
xlabel('Days Relative to Discovery','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
ylabel('Ratio of Red/Blue Flux','interpreter','latex','FontSize',36,'FontName','CMU Serif Roman')
set(gca,'XMinorTick','on','YMinorTick','on')
axis([[0 160],[0 1.2]])
box on
saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Pabetabvsrratiored.eps'], 'epsc');
eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\Pabetabvsrratiored.eps']);

















%%%%%
OLD CODE
%%%%%




%%%
%%%%Halpha Velocity Plot with Offset
%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 2.5 1.25]);
%set(plotting,'Position',[0 0 0.9 1]);
%
%clf
%plot(velHalpha_offset_2_10140310(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[1 0.45 0])
%hold all
%plot(velHalpha_offset_2_10140324(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.8902 0.1020 0.1100])
%plot(velHalpha_offset_2_10140329(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.2 0.6275 0.1725])
%plot(velHalpha_offset_2_10140330(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.1216 0.4706 0.7059])
%plot(velHalpha_offset_2_10140331(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[1 0.4980 0])
%plot(velHalpha_offset_2_10140402(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.4157 0.2392 0.6039])
%plot(velHalpha_offset_2_10140426(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[1 1 0.6])
%plot(velHalpha_offset_2_10140427(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.6941 0.3490 0.1569])
%plot(velHalpha_offset_2_10140428(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.6510 0.8078 0.8902])
%plot(velHalpha_offset_2_10140430(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.6980 0.8745 0.5412])
%plot(velHalpha_offset_2_10140501(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.9843 0.6039 0.6])
%plot(velHalpha_offset_2_10140523(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.9922 0.7490 0.4353])
%plot(velHalpha_offset_2_10140524(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.7922 0.6980 0.8392])
%plot(velHalpha_offset_2_10140526(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0 0 0])
%plot(velHalpha_offset_2_10140528(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963)),'LineWidth',3,'Color',[0.4 0.4 0.4])
%plot(velHalpha_offset_2_10140621(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140622(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140623(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140624(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140626(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%plot(velHalpha_offset_2_10140630(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963))/10^3,halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963)),'LineWidth',3)
%line([-20 20],[0 0],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
%line([0 0],[-1 10],'LineStyle','--','Color',[0 0 0],'LineWidth',3)
%
%xlabel('Doppler velocity (10^3 km/s)','FontSize',32,'FontName','CMU Serif Roman')
%ylabel('F_{\lambda}(Scaled)','interpreter','tex','FontSize',32,'FontName','CMU Serif Roman')
%%title('', 'FontSize',25)
%axis([[-8 8] [-0.5 10]])
%
%%htext = text(4.3,2.6,'day 289---','interpreter','latex')
%%set(htext, 'Color',[0 0 0])
%%set(htext, 'FontSize',30)
%htext = text(-7,3.2,'H\alpha ')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-7,3.6,'SN 2014ab','interpreter','latex')
%set(htext, 'Color', 'black')
%set(htext, 'FontSize',32)
%htext = text(-18.3,1.5,'.','interpreter','latex','Color',[0.8 0.8 0.8])
%ax1 = gca;
%%ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
%%ylabel(ax2,'','FontSize',32)
%%xlabel(ax2,'')
%%set(ax2,'xtick',[],'YTick',[])
%set(ax1,'FontSize',28)
%%set(ax2,'FontSize',28)
%set(ax1,'XMinorTick','on','YMinorTick','on')
%
%export_fig C:\Users\Sp0okydeath\Desktop\Figures\sn2014ab\HalphaVelocity_offset.pdf -pdf
%
%saveas(plotting, ['C:\Users\Sp0okydeath\Desktop\Figures\sn2014ab\HalphaVelocity_offset.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Sp0okydeath\Desktop\Figures\sn2014ab\HalphaVelocity_offset.eps']);
%set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1]);
%
%
%
%%%
































%%%

%clf
%plot(reldate,rightEWHalpha,'LineWidth',3,'Color',[1,0,0])
%errorbar(reldate,rightEWHalpha,rightdEWHalpha,'LineWidth',3,'Color',[1,0,0])
%hold all
%plot(reldate,leftEWHalpha,'LineWidth',3,'Color',[0,0,1])
%errorbar(reldate,leftEWHalpha,leftdEWHalpha,'LineWidth',3,'Color',[0,0,1])
%xlabel('Days Relative to Discovery Date','interpreter','tex','FontSize',24,'FontName','CMU Serif Roman')
%ylabel('Equivalent Width of H$\alpha$ ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
%htext = text(10,265,'Redshifted Side','interpreter','latex','Color', [1,0,0],'FontSize',22)
%htext = text(10,480,'Blueshifted Side','interpreter','latex','Color', [0,0,1],'FontSize',22)
%
%saveas(plotting, ['C:\Users\Cbilinski\Desktop\Figures\SN2014ab\EQWlvsrHalpha.eps'], 'epsc');
%eval(['!epstopdf C:\Users\Cbilinski\Desktop\Figures\SN2014ab\EQWlvsrHalpha.eps']);
%%%




%%%
%%truncate ugly data
%temp1 = d20140526_sn2014ab_2(1,:);
%temp2 = d20140526_sn2014ab_2(2,:);
%clear d20140526_sn2014ab_2;
%d20140526_sn2014ab_2(2,:) = temp2(find(temp1>5500));
%d20140526_sn2014ab_2(1,:) = temp1(find(temp1>5500));
%%%




%old light curve with no template subtraction
%[LCsn2014ab_B(1,:) LCsn2014ab_B(2,:) LCsn2014ab_B(3,:) LCsn2014ab_B(4,:) LCsn2014ab_B(5,:) LCsn2014ab_B(6,:)] =textread('lightcurveB_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');
%[LCsn2014ab_V(1,:) LCsn2014ab_V(2,:) LCsn2014ab_V(3,:) LCsn2014ab_V(4,:) LCsn2014ab_V(5,:) LCsn2014ab_V(6,:)] =textread('lightcurveV_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');
%[LCsn2014ab_R(1,:) LCsn2014ab_R(2,:) LCsn2014ab_R(3,:) LCsn2014ab_R(4,:) LCsn2014ab_R(5,:) LCsn2014ab_R(6,:)] =textread('lightcurveR_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');
%[LCsn2014ab_I(1,:) LCsn2014ab_I(2,:) LCsn2014ab_I(3,:) LCsn2014ab_I(4,:) LCsn2014ab_I(5,:) LCsn2014ab_I(6,:)] =textread('lightcurveI_sn2014ab.dat','%f%f%f%f%f%f','delimiter',' ');

%convert to absolute magnitude and remove MW extinction
%absmagB_sn2014ab= LCsn2014ab_B(3,:)+redshiftdistancemodulus_2014ab-A_B_sn2014ab;
%absmagV_sn2014ab= LCsn2014ab_V(3,:)+redshiftdistancemodulus_2014ab-A_V_sn2014ab;
%absmagR_sn2014ab= LCsn2014ab_R(3,:)+redshiftdistancemodulus_2014ab-A_R_sn2014ab;
%absmagI_sn2014ab= LCsn2014ab_I(3,:)+redshiftdistancemodulus_2014ab-A_I_sn2014ab;
%
%magerrorB_sn2014ab= LCsn2014ab_B(3,:) - LCsn2014ab_B(4,:);
%magerrorV_sn2014ab= LCsn2014ab_V(3,:) - LCsn2014ab_V(4,:);
%magerrorR_sn2014ab= LCsn2014ab_R(3,:) - LCsn2014ab_R(4,:);
%magerrorI_sn2014ab= LCsn2014ab_I(3,:) - LCsn2014ab_I(4,:);
%
%LCreldateB_sn2014ab= LCsn2014ab_B(1,:) - discoverydatemjd;
%LCreldateV_sn2014ab= LCsn2014ab_V(1,:) - discoverydatemjd;
%LCreldateR_sn2014ab= LCsn2014ab_R(1,:) - discoverydatemjd;
%LCreldateI_sn2014ab= LCsn2014ab_I(1,:) - discoverydatemjd;






%don't use offsets
%offset_20140310 = d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(2,:) == max(d20140310_sn2014ab_1(2,find(d20140310_sn2014ab_1(1,:)>6163 & d20140310_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140324 = d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(2,:) == max(d20140324_sn2014ab_1(2,find(d20140324_sn2014ab_1(1,:)>6163 & d20140324_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140329 = d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(2,:) == max(d20140329_sn2014ab_1(2,find(d20140329_sn2014ab_1(1,:)>6163 & d20140329_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140330 = d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(2,:) == max(d20140330_sn2014ab_1(2,find(d20140330_sn2014ab_1(1,:)>6163 & d20140330_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140331 = d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(2,:) == max(d20140331_sn2014ab_1(2,find(d20140331_sn2014ab_1(1,:)>6163 & d20140331_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140402 = d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(2,:) == max(d20140402_sn2014ab_1(2,find(d20140402_sn2014ab_1(1,:)>6163 & d20140402_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140426 = d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(2,:) == max(d20140426_sn2014ab_1(2,find(d20140426_sn2014ab_1(1,:)>6163 & d20140426_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140427 = d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(2,:) == max(d20140427_sn2014ab_1(2,find(d20140427_sn2014ab_1(1,:)>6163 & d20140427_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140428 = d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(2,:) == max(d20140428_sn2014ab_1(2,find(d20140428_sn2014ab_1(1,:)>6163 & d20140428_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140430 = d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(2,:) == max(d20140430_sn2014ab_1(2,find(d20140430_sn2014ab_1(1,:)>6163 & d20140430_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140501 = d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(2,:) == max(d20140501_sn2014ab_1(2,find(d20140501_sn2014ab_1(1,:)>6163 & d20140501_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140523 = d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(2,:) == max(d20140523_sn2014ab_1(2,find(d20140523_sn2014ab_1(1,:)>6163 & d20140523_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140524 = d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(2,:) == max(d20140524_sn2014ab_1(2,find(d20140524_sn2014ab_1(1,:)>6163 & d20140524_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140526 = d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(2,:) == max(d20140526_sn2014ab_1(2,find(d20140526_sn2014ab_1(1,:)>6163 & d20140526_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140528 = d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(2,:) == max(d20140528_sn2014ab_1(2,find(d20140528_sn2014ab_1(1,:)>6163 & d20140528_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140621 = d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(2,:) == max(d20140621_sn2014ab_1(2,find(d20140621_sn2014ab_1(1,:)>6163 & d20140621_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140622 = d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(2,:) == max(d20140622_sn2014ab_1(2,find(d20140622_sn2014ab_1(1,:)>6163 & d20140622_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140623 = d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(2,:) == max(d20140623_sn2014ab_1(2,find(d20140623_sn2014ab_1(1,:)>6163 & d20140623_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140624 = d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(2,:) == max(d20140624_sn2014ab_1(2,find(d20140624_sn2014ab_1(1,:)>6163 & d20140624_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140626 = d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(2,:) == max(d20140626_sn2014ab_1(2,find(d20140626_sn2014ab_1(1,:)>6163 & d20140626_sn2014ab_1(1,:)<6963)))))-6562.81
%offset_20140630 = d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(2,:) == max(d20140630_sn2014ab_1(2,find(d20140630_sn2014ab_1(1,:)>6163 & d20140630_sn2014ab_1(1,:)<6963)))))-6562.81
%
%d20140310_sn2014ab_1(3,:) = d20140310_sn2014ab_1(1,:)-offset_20140310;
%d20140324_sn2014ab_1(3,:) = d20140324_sn2014ab_1(1,:)-offset_20140324;
%d20140329_sn2014ab_1(3,:) = d20140329_sn2014ab_1(1,:)-offset_20140329;
%d20140330_sn2014ab_1(3,:) = d20140330_sn2014ab_1(1,:)-offset_20140330;
%d20140331_sn2014ab_1(3,:) = d20140331_sn2014ab_1(1,:)-offset_20140331;
%d20140402_sn2014ab_1(3,:) = d20140402_sn2014ab_1(1,:)-offset_20140402;
%d20140426_sn2014ab_1(3,:) = d20140426_sn2014ab_1(1,:)-offset_20140426;
%d20140427_sn2014ab_1(3,:) = d20140427_sn2014ab_1(1,:)-offset_20140427;
%d20140428_sn2014ab_1(3,:) = d20140428_sn2014ab_1(1,:)-offset_20140428;
%d20140430_sn2014ab_1(3,:) = d20140430_sn2014ab_1(1,:)-offset_20140430;
%d20140501_sn2014ab_1(3,:) = d20140501_sn2014ab_1(1,:)-offset_20140501;
%d20140523_sn2014ab_1(3,:) = d20140523_sn2014ab_1(1,:)-offset_20140523;
%d20140524_sn2014ab_1(3,:) = d20140524_sn2014ab_1(1,:)-offset_20140524;
%d20140526_sn2014ab_1(3,:) = d20140526_sn2014ab_1(1,:)-offset_20140526;
%d20140528_sn2014ab_1(3,:) = d20140528_sn2014ab_1(1,:)-offset_20140528;
%d20140621_sn2014ab_1(3,:) = d20140621_sn2014ab_1(1,:)-offset_20140621;
%d20140622_sn2014ab_1(3,:) = d20140622_sn2014ab_1(1,:)-offset_20140622;
%d20140623_sn2014ab_1(3,:) = d20140623_sn2014ab_1(1,:)-offset_20140623;
%d20140624_sn2014ab_1(3,:) = d20140624_sn2014ab_1(1,:)-offset_20140624;
%d20140626_sn2014ab_1(3,:) = d20140626_sn2014ab_1(1,:)-offset_20140626;
%d20140630_sn2014ab_1(3,:) = d20140630_sn2014ab_1(1,:)-offset_20140630;








%flux_2014abVLT_ep78_part(1,:) = contscaled20140526_sn2014ab_2(2,:)
%flux_2014abVLT_ep78_part(2,:) = interp1(d20140526_sn2014ab_3(1,:),contscaled20140526_sn2014ab_3(2,:),d20140526_sn2014ab_2(1,:))
%flux_2014abVLT_ep78_part(3,:) = interp1(d20140526_sn2014ab_4(1,:),contscaled20140526_sn2014ab_4(2,:),d20140526_sn2014ab_2(1,:))
%
%flux_2014abVLT_ep78_part(1,:) = contscaled20140602_sn2014ab_1(2,:)
%flux_2014abVLT_ep78_part(2,:) = interp1(d20140602_sn2014ab_2(1,:),contscaled20140602_sn2014ab_2(2,:),d20140602_sn2014ab_1(1,:))
%flux_2014abVLT_ep78_part(3,:) = interp1(d20140602_sn2014ab_3(1,:),contscaled20140602_sn2014ab_3(2,:),d20140602_sn2014ab_1(1,:))





%measure EW on each side

leftEWHalpha(1)  = trapz(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:) >= 6312.81 & d20140310_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6312.81 & d20140310_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(2)  = trapz(d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(1,:) >= 6312.81 & d20140324_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6312.81 & d20140324_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(3)  = trapz(d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(1,:) >= 6312.81 & d20140329_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6312.81 & d20140329_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(4)  = trapz(d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(1,:) >= 6312.81 & d20140330_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6312.81 & d20140330_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(5)  = trapz(d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(1,:) >= 6312.81 & d20140331_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6312.81 & d20140331_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(6)  = trapz(d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(1,:) >= 6312.81 & d20140402_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6312.81 & d20140402_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(7)  = trapz(d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(1,:) >= 6312.81 & d20140426_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6312.81 & d20140426_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(8)  = trapz(d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(1,:) >= 6312.81 & d20140427_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6312.81 & d20140427_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(9)  = trapz(d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(1,:) >= 6312.81 & d20140428_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6312.81 & d20140428_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(10) = trapz(d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(1,:) >= 6312.81 & d20140430_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6312.81 & d20140430_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(11) = trapz(d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(1,:) >= 6312.81 & d20140501_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6312.81 & d20140501_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(12) = trapz(d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(1,:) >= 6312.81 & d20140523_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6312.81 & d20140523_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(13) = trapz(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:) >= 6312.81 & d20140524_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6312.81 & d20140524_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(14) = trapz(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:) >= 6312.81 & d20140526_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6312.81 & d20140526_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(15) = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= 6312.81 & d20140526_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6312.81 & d20140526_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(16) = trapz(d20140526_sn2014ab_3(1,find(d20140526_sn2014ab_3(1,:) >= 6312.81 & d20140526_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6312.81 & d20140526_sn2014ab_3(1,:) <= 6562.81)))
leftEWHalpha(17) = trapz(d20140526_sn2014ab_4(1,find(d20140526_sn2014ab_4(1,:) >= 6312.81 & d20140526_sn2014ab_4(1,:) <= 6562.81)),halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6312.81 & d20140526_sn2014ab_4(1,:) <= 6562.81)))
leftEWHalpha(18) = trapz(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:) >= 6312.81 & d20140528_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6312.81 & d20140528_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(19) = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= 6312.81 & d20140602_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6312.81 & d20140602_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(20) = trapz(d20140602_sn2014ab_2(1,find(d20140602_sn2014ab_2(1,:) >= 6312.81 & d20140602_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6312.81 & d20140602_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(21) = trapz(d20140602_sn2014ab_3(1,find(d20140602_sn2014ab_3(1,:) >= 6312.81 & d20140602_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6312.81 & d20140602_sn2014ab_3(1,:) <= 6562.81)))
leftEWHalpha(22) = trapz(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:) >= 6312.81 & d20140621_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6312.81 & d20140621_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(23) = trapz(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:) >= 6312.81 & d20140622_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6312.81 & d20140622_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(24) = trapz(d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(1,:) >= 6312.81 & d20140623_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6312.81 & d20140623_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(25) = trapz(d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(1,:) >= 6312.81 & d20140624_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6312.81 & d20140624_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(26) = trapz(d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(1,:) >= 6312.81 & d20140626_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6312.81 & d20140626_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(27) = trapz(d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(1,:) >= 6312.81 & d20140630_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6312.81 & d20140630_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(28) = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= 6312.81 & d20140722_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6312.81 & d20140722_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(29) = trapz(d20140722_sn2014ab_2(1,find(d20140722_sn2014ab_2(1,:) >= 6312.81 & d20140722_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6312.81 & d20140722_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(30) = trapz(d20140722_sn2014ab_3(1,find(d20140722_sn2014ab_3(1,:) >= 6312.81 & d20140722_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6312.81 & d20140722_sn2014ab_3(1,:) <= 6562.81)))
leftEWHalpha(31) = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= 6312.81 & d20140722_sn2014ab_4(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6312.81 & d20140722_sn2014ab_4(1,:) <= 6562.81)))
leftEWHalpha(32) = trapz(d20140722_sn2014ab_5(1,find(d20140722_sn2014ab_5(1,:) >= 6312.81 & d20140722_sn2014ab_5(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6312.81 & d20140722_sn2014ab_5(1,:) <= 6562.81)))
leftEWHalpha(33) = trapz(d20140722_sn2014ab_6(1,find(d20140722_sn2014ab_6(1,:) >= 6312.81 & d20140722_sn2014ab_6(1,:) <= 6562.81)),halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6312.81 & d20140722_sn2014ab_6(1,:) <= 6562.81)))
leftEWHalpha(34) = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= 6312.81 & d20140808_sn2014ab_1(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6312.81 & d20140808_sn2014ab_1(1,:) <= 6562.81)))
leftEWHalpha(35) = trapz(d20140808_sn2014ab_2(1,find(d20140808_sn2014ab_2(1,:) >= 6312.81 & d20140808_sn2014ab_2(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6312.81 & d20140808_sn2014ab_2(1,:) <= 6562.81)))
leftEWHalpha(36) = trapz(d20140808_sn2014ab_3(1,find(d20140808_sn2014ab_3(1,:) >= 6312.81 & d20140808_sn2014ab_3(1,:) <= 6562.81)),halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6312.81 & d20140808_sn2014ab_3(1,:) <= 6562.81)))



leftNEWerr(1)  = 5*std(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6000 & d20140310_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(2)  = 5*std(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6000 & d20140324_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(3)  = 5*std(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6000 & d20140329_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(4)  = 5*std(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6000 & d20140330_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(5)  = 5*std(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6000 & d20140331_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(6)  = 5*std(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6000 & d20140402_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(7)  = 5*std(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6000 & d20140426_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(8)  = 5*std(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6000 & d20140427_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(9)  = 5*std(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6000 & d20140428_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(10) = 5*std(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6000 & d20140430_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(11) = 5*std(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6000 & d20140501_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(12) = 5*std(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6000 & d20140523_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(13) = 5*std(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6000 & d20140524_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(14) = 5*std(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6000 & d20140526_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(15) = 5*std(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6000 & d20140526_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(16) = 5*std(halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6000 & d20140526_sn2014ab_3(1,:) <= 6300)));
leftNEWerr(17) = 5*std(halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6000 & d20140526_sn2014ab_4(1,:) <= 6300)));
leftNEWerr(18) = 5*std(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6000 & d20140528_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(19) = 5*std(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6000 & d20140602_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(20) = 5*std(halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6000 & d20140602_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(21) = 5*std(halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6000 & d20140602_sn2014ab_3(1,:) <= 6300)));
leftNEWerr(22) = 5*std(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6000 & d20140621_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(23) = 5*std(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6000 & d20140622_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(24) = 5*std(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6000 & d20140623_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(25) = 5*std(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6000 & d20140624_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(26) = 5*std(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6000 & d20140626_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(27) = 5*std(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6000 & d20140630_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(28) = 5*std(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6000 & d20140722_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(29) = 5*std(halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6000 & d20140722_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(30) = 5*std(halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6000 & d20140722_sn2014ab_3(1,:) <= 6300)));
leftNEWerr(31) = 5*std(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6000 & d20140722_sn2014ab_4(1,:) <= 6300)));
leftNEWerr(32) = 5*std(halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6000 & d20140722_sn2014ab_5(1,:) <= 6300)));
leftNEWerr(33) = 5*std(halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6000 & d20140722_sn2014ab_6(1,:) <= 6300)));
leftNEWerr(34) = 5*std(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6000 & d20140808_sn2014ab_1(1,:) <= 6300)));
leftNEWerr(35) = 5*std(halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6000 & d20140808_sn2014ab_2(1,:) <= 6300)));
leftNEWerr(36) = 5*std(halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6000 & d20140808_sn2014ab_3(1,:) <= 6300)));



leftdEWHalpha(1)  = leftNEWerr(1)  * leftEWHalpha(1) ;
leftdEWHalpha(2)  = leftNEWerr(2)  * leftEWHalpha(2) ;
leftdEWHalpha(3)  = leftNEWerr(3)  * leftEWHalpha(3) ;
leftdEWHalpha(4)  = leftNEWerr(4)  * leftEWHalpha(4) ;
leftdEWHalpha(5)  = leftNEWerr(5)  * leftEWHalpha(5) ;
leftdEWHalpha(6)  = leftNEWerr(6)  * leftEWHalpha(6) ;
leftdEWHalpha(7)  = leftNEWerr(7)  * leftEWHalpha(7) ;
leftdEWHalpha(8)  = leftNEWerr(8)  * leftEWHalpha(8) ;
leftdEWHalpha(9)  = leftNEWerr(9)  * leftEWHalpha(9) ;
leftdEWHalpha(10) = leftNEWerr(10) * leftEWHalpha(10);
leftdEWHalpha(11) = leftNEWerr(11) * leftEWHalpha(11);
leftdEWHalpha(12) = leftNEWerr(12) * leftEWHalpha(12);
leftdEWHalpha(13) = leftNEWerr(13) * leftEWHalpha(13);
leftdEWHalpha(14) = leftNEWerr(14) * leftEWHalpha(14);
leftdEWHalpha(15) = leftNEWerr(15) * leftEWHalpha(15);
leftdEWHalpha(16) = leftNEWerr(16) * leftEWHalpha(16);
leftdEWHalpha(17) = leftNEWerr(17) * leftEWHalpha(17);
leftdEWHalpha(18) = leftNEWerr(18) * leftEWHalpha(18);
leftdEWHalpha(19) = leftNEWerr(19) * leftEWHalpha(19);
leftdEWHalpha(20) = leftNEWerr(20) * leftEWHalpha(20);
leftdEWHalpha(21) = leftNEWerr(21) * leftEWHalpha(21);
leftdEWHalpha(22) = leftNEWerr(22) * leftEWHalpha(22);
leftdEWHalpha(23) = leftNEWerr(23) * leftEWHalpha(23);
leftdEWHalpha(24) = leftNEWerr(24) * leftEWHalpha(24);
leftdEWHalpha(25) = leftNEWerr(25) * leftEWHalpha(25);
leftdEWHalpha(26) = leftNEWerr(26) * leftEWHalpha(26);
leftdEWHalpha(27) = leftNEWerr(27) * leftEWHalpha(27);
leftdEWHalpha(28) = leftNEWerr(28) * leftEWHalpha(28);
leftdEWHalpha(29) = leftNEWerr(29) * leftEWHalpha(29);
leftdEWHalpha(30) = leftNEWerr(30) * leftEWHalpha(30);
leftdEWHalpha(31) = leftNEWerr(31) * leftEWHalpha(31);
leftdEWHalpha(32) = leftNEWerr(32) * leftEWHalpha(32);
leftdEWHalpha(33) = leftNEWerr(33) * leftEWHalpha(33);
leftdEWHalpha(34) = leftNEWerr(34) * leftEWHalpha(34);
leftdEWHalpha(35) = leftNEWerr(35) * leftEWHalpha(35);
leftdEWHalpha(36) = leftNEWerr(36) * leftEWHalpha(36);

rightEWHalpha(1)  = trapz(d20140310_sn2014ab_1(1,find(d20140310_sn2014ab_1(1,:) >= 6562.81 & d20140310_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6562.81 & d20140310_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(2)  = trapz(d20140324_sn2014ab_1(1,find(d20140324_sn2014ab_1(1,:) >= 6562.81 & d20140324_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6562.81 & d20140324_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(3)  = trapz(d20140329_sn2014ab_1(1,find(d20140329_sn2014ab_1(1,:) >= 6562.81 & d20140329_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6562.81 & d20140329_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(4)  = trapz(d20140330_sn2014ab_1(1,find(d20140330_sn2014ab_1(1,:) >= 6562.81 & d20140330_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6562.81 & d20140330_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(5)  = trapz(d20140331_sn2014ab_1(1,find(d20140331_sn2014ab_1(1,:) >= 6562.81 & d20140331_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6562.81 & d20140331_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(6)  = trapz(d20140402_sn2014ab_1(1,find(d20140402_sn2014ab_1(1,:) >= 6562.81 & d20140402_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6562.81 & d20140402_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(7)  = trapz(d20140426_sn2014ab_1(1,find(d20140426_sn2014ab_1(1,:) >= 6562.81 & d20140426_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6562.81 & d20140426_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(8)  = trapz(d20140427_sn2014ab_1(1,find(d20140427_sn2014ab_1(1,:) >= 6562.81 & d20140427_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6562.81 & d20140427_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(9)  = trapz(d20140428_sn2014ab_1(1,find(d20140428_sn2014ab_1(1,:) >= 6562.81 & d20140428_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6562.81 & d20140428_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(10) = trapz(d20140430_sn2014ab_1(1,find(d20140430_sn2014ab_1(1,:) >= 6562.81 & d20140430_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6562.81 & d20140430_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(11) = trapz(d20140501_sn2014ab_1(1,find(d20140501_sn2014ab_1(1,:) >= 6562.81 & d20140501_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6562.81 & d20140501_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(12) = trapz(d20140523_sn2014ab_1(1,find(d20140523_sn2014ab_1(1,:) >= 6562.81 & d20140523_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6562.81 & d20140523_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(13) = trapz(d20140524_sn2014ab_1(1,find(d20140524_sn2014ab_1(1,:) >= 6562.81 & d20140524_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6562.81 & d20140524_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(14) = trapz(d20140526_sn2014ab_1(1,find(d20140526_sn2014ab_1(1,:) >= 6562.81 & d20140526_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6562.81 & d20140526_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(15) = trapz(d20140526_sn2014ab_2(1,find(d20140526_sn2014ab_2(1,:) >= 6562.81 & d20140526_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6562.81 & d20140526_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(16) = trapz(d20140526_sn2014ab_3(1,find(d20140526_sn2014ab_3(1,:) >= 6562.81 & d20140526_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6562.81 & d20140526_sn2014ab_3(1,:) <= 6812.81)))
rightEWHalpha(17) = trapz(d20140526_sn2014ab_4(1,find(d20140526_sn2014ab_4(1,:) >= 6562.81 & d20140526_sn2014ab_4(1,:) <= 6812.81)),halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6562.81 & d20140526_sn2014ab_4(1,:) <= 6812.81)))
rightEWHalpha(18) = trapz(d20140528_sn2014ab_1(1,find(d20140528_sn2014ab_1(1,:) >= 6562.81 & d20140528_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6562.81 & d20140528_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(19) = trapz(d20140602_sn2014ab_1(1,find(d20140602_sn2014ab_1(1,:) >= 6562.81 & d20140602_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6562.81 & d20140602_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(20) = trapz(d20140602_sn2014ab_2(1,find(d20140602_sn2014ab_2(1,:) >= 6562.81 & d20140602_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6562.81 & d20140602_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(21) = trapz(d20140602_sn2014ab_3(1,find(d20140602_sn2014ab_3(1,:) >= 6562.81 & d20140602_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6562.81 & d20140602_sn2014ab_3(1,:) <= 6812.81)))
rightEWHalpha(22) = trapz(d20140621_sn2014ab_1(1,find(d20140621_sn2014ab_1(1,:) >= 6562.81 & d20140621_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6562.81 & d20140621_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(23) = trapz(d20140622_sn2014ab_1(1,find(d20140622_sn2014ab_1(1,:) >= 6562.81 & d20140622_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6562.81 & d20140622_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(24) = trapz(d20140623_sn2014ab_1(1,find(d20140623_sn2014ab_1(1,:) >= 6562.81 & d20140623_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6562.81 & d20140623_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(25) = trapz(d20140624_sn2014ab_1(1,find(d20140624_sn2014ab_1(1,:) >= 6562.81 & d20140624_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6562.81 & d20140624_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(26) = trapz(d20140626_sn2014ab_1(1,find(d20140626_sn2014ab_1(1,:) >= 6562.81 & d20140626_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6562.81 & d20140626_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(27) = trapz(d20140630_sn2014ab_1(1,find(d20140630_sn2014ab_1(1,:) >= 6562.81 & d20140630_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6562.81 & d20140630_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(28) = trapz(d20140722_sn2014ab_1(1,find(d20140722_sn2014ab_1(1,:) >= 6562.81 & d20140722_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6562.81 & d20140722_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(29) = trapz(d20140722_sn2014ab_2(1,find(d20140722_sn2014ab_2(1,:) >= 6562.81 & d20140722_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6562.81 & d20140722_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(30) = trapz(d20140722_sn2014ab_3(1,find(d20140722_sn2014ab_3(1,:) >= 6562.81 & d20140722_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6562.81 & d20140722_sn2014ab_3(1,:) <= 6812.81)))
rightEWHalpha(31) = trapz(d20140722_sn2014ab_4(1,find(d20140722_sn2014ab_4(1,:) >= 6562.81 & d20140722_sn2014ab_4(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6562.81 & d20140722_sn2014ab_4(1,:) <= 6812.81)))
rightEWHalpha(32) = trapz(d20140722_sn2014ab_5(1,find(d20140722_sn2014ab_5(1,:) >= 6562.81 & d20140722_sn2014ab_5(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6562.81 & d20140722_sn2014ab_5(1,:) <= 6812.81)))
rightEWHalpha(33) = trapz(d20140722_sn2014ab_6(1,find(d20140722_sn2014ab_6(1,:) >= 6562.81 & d20140722_sn2014ab_6(1,:) <= 6812.81)),halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6562.81 & d20140722_sn2014ab_6(1,:) <= 6812.81)))
rightEWHalpha(34) = trapz(d20140808_sn2014ab_1(1,find(d20140808_sn2014ab_1(1,:) >= 6562.81 & d20140808_sn2014ab_1(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6562.81 & d20140808_sn2014ab_1(1,:) <= 6812.81)))
rightEWHalpha(35) = trapz(d20140808_sn2014ab_2(1,find(d20140808_sn2014ab_2(1,:) >= 6562.81 & d20140808_sn2014ab_2(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6562.81 & d20140808_sn2014ab_2(1,:) <= 6812.81)))
rightEWHalpha(36) = trapz(d20140808_sn2014ab_3(1,find(d20140808_sn2014ab_3(1,:) >= 6562.81 & d20140808_sn2014ab_3(1,:) <= 6812.81)),halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6562.81 & d20140808_sn2014ab_3(1,:) <= 6812.81)))


rightNEWerr(1)  = 5*std(halphavarscaledsub20140310_sn2014ab_1(find(d20140310_sn2014ab_1(1,:) >= 6000 & d20140310_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(2)  = 5*std(halphavarscaledsub20140324_sn2014ab_1(find(d20140324_sn2014ab_1(1,:) >= 6000 & d20140324_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(3)  = 5*std(halphavarscaledsub20140329_sn2014ab_1(find(d20140329_sn2014ab_1(1,:) >= 6000 & d20140329_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(4)  = 5*std(halphavarscaledsub20140330_sn2014ab_1(find(d20140330_sn2014ab_1(1,:) >= 6000 & d20140330_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(5)  = 5*std(halphavarscaledsub20140331_sn2014ab_1(find(d20140331_sn2014ab_1(1,:) >= 6000 & d20140331_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(6)  = 5*std(halphavarscaledsub20140402_sn2014ab_1(find(d20140402_sn2014ab_1(1,:) >= 6000 & d20140402_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(7)  = 5*std(halphavarscaledsub20140426_sn2014ab_1(find(d20140426_sn2014ab_1(1,:) >= 6000 & d20140426_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(8)  = 5*std(halphavarscaledsub20140427_sn2014ab_1(find(d20140427_sn2014ab_1(1,:) >= 6000 & d20140427_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(9)  = 5*std(halphavarscaledsub20140428_sn2014ab_1(find(d20140428_sn2014ab_1(1,:) >= 6000 & d20140428_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(10) = 5*std(halphavarscaledsub20140430_sn2014ab_1(find(d20140430_sn2014ab_1(1,:) >= 6000 & d20140430_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(11) = 5*std(halphavarscaledsub20140501_sn2014ab_1(find(d20140501_sn2014ab_1(1,:) >= 6000 & d20140501_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(12) = 5*std(halphavarscaledsub20140523_sn2014ab_1(find(d20140523_sn2014ab_1(1,:) >= 6000 & d20140523_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(13) = 5*std(halphavarscaledsub20140524_sn2014ab_1(find(d20140524_sn2014ab_1(1,:) >= 6000 & d20140524_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(14) = 5*std(halphavarscaledsub20140526_sn2014ab_1(find(d20140526_sn2014ab_1(1,:) >= 6000 & d20140526_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(15) = 5*std(halphavarscaledsub20140526_sn2014ab_2(find(d20140526_sn2014ab_2(1,:) >= 6000 & d20140526_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(16) = 5*std(halphavarscaledsub20140526_sn2014ab_3(find(d20140526_sn2014ab_3(1,:) >= 6000 & d20140526_sn2014ab_3(1,:) <= 6300)));
rightNEWerr(17) = 5*std(halphavarscaledsub20140526_sn2014ab_4(find(d20140526_sn2014ab_4(1,:) >= 6000 & d20140526_sn2014ab_4(1,:) <= 6300)));
rightNEWerr(18) = 5*std(halphavarscaledsub20140528_sn2014ab_1(find(d20140528_sn2014ab_1(1,:) >= 6000 & d20140528_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(19) = 5*std(halphavarscaledsub20140602_sn2014ab_1(find(d20140602_sn2014ab_1(1,:) >= 6000 & d20140602_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(20) = 5*std(halphavarscaledsub20140602_sn2014ab_2(find(d20140602_sn2014ab_2(1,:) >= 6000 & d20140602_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(21) = 5*std(halphavarscaledsub20140602_sn2014ab_3(find(d20140602_sn2014ab_3(1,:) >= 6000 & d20140602_sn2014ab_3(1,:) <= 6300)));
rightNEWerr(22) = 5*std(halphavarscaledsub20140621_sn2014ab_1(find(d20140621_sn2014ab_1(1,:) >= 6000 & d20140621_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(23) = 5*std(halphavarscaledsub20140622_sn2014ab_1(find(d20140622_sn2014ab_1(1,:) >= 6000 & d20140622_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(24) = 5*std(halphavarscaledsub20140623_sn2014ab_1(find(d20140623_sn2014ab_1(1,:) >= 6000 & d20140623_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(25) = 5*std(halphavarscaledsub20140624_sn2014ab_1(find(d20140624_sn2014ab_1(1,:) >= 6000 & d20140624_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(26) = 5*std(halphavarscaledsub20140626_sn2014ab_1(find(d20140626_sn2014ab_1(1,:) >= 6000 & d20140626_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(27) = 5*std(halphavarscaledsub20140630_sn2014ab_1(find(d20140630_sn2014ab_1(1,:) >= 6000 & d20140630_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(28) = 5*std(halphavarscaledsub20140722_sn2014ab_1(find(d20140722_sn2014ab_1(1,:) >= 6000 & d20140722_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(29) = 5*std(halphavarscaledsub20140722_sn2014ab_2(find(d20140722_sn2014ab_2(1,:) >= 6000 & d20140722_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(30) = 5*std(halphavarscaledsub20140722_sn2014ab_3(find(d20140722_sn2014ab_3(1,:) >= 6000 & d20140722_sn2014ab_3(1,:) <= 6300)));
rightNEWerr(31) = 5*std(halphavarscaledsub20140722_sn2014ab_4(find(d20140722_sn2014ab_4(1,:) >= 6000 & d20140722_sn2014ab_4(1,:) <= 6300)));
rightNEWerr(32) = 5*std(halphavarscaledsub20140722_sn2014ab_5(find(d20140722_sn2014ab_5(1,:) >= 6000 & d20140722_sn2014ab_5(1,:) <= 6300)));
rightNEWerr(33) = 5*std(halphavarscaledsub20140722_sn2014ab_6(find(d20140722_sn2014ab_6(1,:) >= 6000 & d20140722_sn2014ab_6(1,:) <= 6300)));
rightNEWerr(34) = 5*std(halphavarscaledsub20140808_sn2014ab_1(find(d20140808_sn2014ab_1(1,:) >= 6000 & d20140808_sn2014ab_1(1,:) <= 6300)));
rightNEWerr(35) = 5*std(halphavarscaledsub20140808_sn2014ab_2(find(d20140808_sn2014ab_2(1,:) >= 6000 & d20140808_sn2014ab_2(1,:) <= 6300)));
rightNEWerr(36) = 5*std(halphavarscaledsub20140808_sn2014ab_3(find(d20140808_sn2014ab_3(1,:) >= 6000 & d20140808_sn2014ab_3(1,:) <= 6300)));


rightdEWHalpha(1)  = rightNEWerr(1)  * rightEWHalpha(1) 
rightdEWHalpha(2)  = rightNEWerr(2)  * rightEWHalpha(2) 
rightdEWHalpha(3)  = rightNEWerr(3)  * rightEWHalpha(3) 
rightdEWHalpha(4)  = rightNEWerr(4)  * rightEWHalpha(4) 
rightdEWHalpha(5)  = rightNEWerr(5)  * rightEWHalpha(5) 
rightdEWHalpha(6)  = rightNEWerr(6)  * rightEWHalpha(6) 
rightdEWHalpha(7)  = rightNEWerr(7)  * rightEWHalpha(7) 
rightdEWHalpha(8)  = rightNEWerr(8)  * rightEWHalpha(8) 
rightdEWHalpha(9)  = rightNEWerr(9)  * rightEWHalpha(9) 
rightdEWHalpha(10) = rightNEWerr(10) * rightEWHalpha(10)
rightdEWHalpha(11) = rightNEWerr(11) * rightEWHalpha(11)
rightdEWHalpha(12) = rightNEWerr(12) * rightEWHalpha(12)
rightdEWHalpha(13) = rightNEWerr(13) * rightEWHalpha(13)
rightdEWHalpha(14) = rightNEWerr(14) * rightEWHalpha(14)
rightdEWHalpha(15) = rightNEWerr(15) * rightEWHalpha(15)
rightdEWHalpha(16) = rightNEWerr(16) * rightEWHalpha(16)
rightdEWHalpha(17) = rightNEWerr(17) * rightEWHalpha(17)
rightdEWHalpha(18) = rightNEWerr(18) * rightEWHalpha(18)
rightdEWHalpha(19) = rightNEWerr(19) * rightEWHalpha(19)
rightdEWHalpha(20) = rightNEWerr(20) * rightEWHalpha(20)
rightdEWHalpha(21) = rightNEWerr(21) * rightEWHalpha(21)
rightdEWHalpha(22) = rightNEWerr(22) * rightEWHalpha(22)
rightdEWHalpha(23) = rightNEWerr(23) * rightEWHalpha(23)
rightdEWHalpha(24) = rightNEWerr(24) * rightEWHalpha(24)
rightdEWHalpha(25) = rightNEWerr(25) * rightEWHalpha(25)
rightdEWHalpha(26) = rightNEWerr(26) * rightEWHalpha(26)
rightdEWHalpha(27) = rightNEWerr(27) * rightEWHalpha(27)
rightdEWHalpha(28) = rightNEWerr(28) * rightEWHalpha(28)
rightdEWHalpha(29) = rightNEWerr(29) * rightEWHalpha(29)
rightdEWHalpha(30) = rightNEWerr(30) * rightEWHalpha(30)
rightdEWHalpha(31) = rightNEWerr(31) * rightEWHalpha(31)
rightdEWHalpha(32) = rightNEWerr(32) * rightEWHalpha(32)
rightdEWHalpha(33) = rightNEWerr(33) * rightEWHalpha(33)
rightdEWHalpha(34) = rightNEWerr(34) * rightEWHalpha(34)
rightdEWHalpha(35) = rightNEWerr(35) * rightEWHalpha(35)
rightdEWHalpha(36) = rightNEWerr(36) * rightEWHalpha(36)






%set relative dates into one array
reldate(1)  = p20140310_sn2014ab_1(1,1)
reldate(2)  = p20140324_sn2014ab_1(1,1)
reldate(3)  = p20140329_sn2014ab_1(1,1)
reldate(4)  = p20140330_sn2014ab_1(1,1)
reldate(5)  = p20140331_sn2014ab_1(1,1)
reldate(6)  = p20140402_sn2014ab_1(1,1)
reldate(7)  = p20140426_sn2014ab_1(1,1)
reldate(8)  = p20140427_sn2014ab_1(1,1)
reldate(9)  = p20140428_sn2014ab_1(1,1)
reldate(10) = p20140430_sn2014ab_1(1,1)
reldate(11) = p20140501_sn2014ab_1(1,1)
reldate(12) = p20140523_sn2014ab_1(1,1)
reldate(13) = p20140524_sn2014ab_1(1,1)
reldate(14) = p20140526_sn2014ab_1(1,1)
reldate(15) = p20140526_sn2014ab_2(1,1)
reldate(16) = p20140526_sn2014ab_3(1,1)
reldate(17) = p20140526_sn2014ab_4(1,1)
reldate(18) = p20140528_sn2014ab_1(1,1)
reldate(19) = p20140602_sn2014ab_1(1,1)
reldate(20) = p20140602_sn2014ab_2(1,1)
reldate(21) = p20140602_sn2014ab_3(1,1)
reldate(22) = p20140621_sn2014ab_1(1,1)
reldate(23) = p20140622_sn2014ab_1(1,1)
reldate(24) = p20140623_sn2014ab_1(1,1)
reldate(25) = p20140624_sn2014ab_1(1,1)
reldate(26) = p20140626_sn2014ab_1(1,1)
reldate(27) = p20140630_sn2014ab_1(1,1)
reldate(28) = p20140722_sn2014ab_1(1,1)
reldate(29) = p20140722_sn2014ab_2(1,1)
reldate(30) = p20140722_sn2014ab_3(1,1)
reldate(31) = p20140722_sn2014ab_4(1,1)
reldate(32) = p20140722_sn2014ab_5(1,1)
reldate(33) = p20140722_sn2014ab_6(1,1)
reldate(34) = p20140808_sn2014ab_1(1,1)
reldate(35) = p20140808_sn2014ab_2(1,1)
reldate(36) = p20140808_sn2014ab_3(1,1)



%%Blackbody plot1
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf
semilogy(10^-8.*d20140310_sn2014ab_1(1,:),contscaled20140310_sn2014ab_1(2,:),'LineWidth',2,'Color',[1 0 0])
hold on
semilogy(wavetemp11,squeeze(bbodyfit11),'LineWidth',2,'Color',[0 0 0])
semilogy(wavetemp12,squeeze(bbodyfit12),'LineWidth',2,'Color',[0 0 0])
htext = text(7750*10^-8,1,num2str(bestT(1,:)),'interpreter','latex','FontName','CMU Serif');
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3000*10^-8 9150*10^-8] [0.01 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')
saveas(plotting, ['blackbody1.eps'], 'epsc');
eval(['!epstopdf blackbody1.eps']);


	
%%Blackbody plot2
set(plotting,'PaperUnits','normalized','PaperPosition',[0 0 3 1.5]);
set(gcf,'color','w');
clf
semilogy(10^-8.*d20140808_sn2014ab_3(1,:),contscaled20140808_sn2014ab_3(2,:),'LineWidth',2,'Color',[1 0 0])
hold on
semilogy(wavetemp21,squeeze(bbodyfit21),'LineWidth',2,'Color',[0 0 0])
semilogy(wavetemp22,squeeze(bbodyfit22),'LineWidth',2,'Color',[0 0 0])
htext = text(7750*10^-8,1,num2str(bestT(2,:)),'interpreter','latex','FontName','CMU Serif');
set(htext, 'Color', 'black')	
set(htext, 'FontSize',26)
htext = text(2965,0.1,'.','interpreter','latex','FontName','CMU Serif Roman');
xlabel('Rest Wavelength ($\AA$) ','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
ylabel('$F_\lambda$ (Scaled)','interpreter','latex','FontSize',24,'FontName','CMU Serif Roman')
axis([[3000*10^-8 9150*10^-8] [0.001 5]])
ax1 = gca;
ax2 = axes('Position',get(ax1,'Position'),'YAxisLocation','right','XAxisLocation','top','Color','none');
ylabel(ax2,'','FontSize',22)
xlabel(ax2,'')
set(ax2,'xtick',[],'YTick',[])
set(ax1,'FontSize',22)
set(ax2,'FontSize',22)
set(ax1,'XMinorTick','on','YMinorTick','on')
saveas(plotting, ['blackbody2.eps'], 'epsc');
eval(['!epstopdf blackbody2.eps']);